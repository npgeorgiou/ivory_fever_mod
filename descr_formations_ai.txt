;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;TRIPLE_CHAOS_MASTERS_FORMATIONS(DARTH's RTW 16.2/BI 16.2/M2TW 4.5) & ExRM/EB-Sinuhet 7.0 & Marcus Camillus's);;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
; This is version 1.38 for Vanilla Rome: Total War
;
; Modification of:
;
; "Rome - Total War: Darth's Dark Formation 16.2" by Darth Vader (internal version RTW/BI)
;	Customised version for "Europa Barbarorum" by Lysander13
;	Customised version for "Extended Greek Mod" by DimeBagHo
;	Customised version for "Rome - Total Realism: Platinum Edition"
;	Customised version for "Arthurian - Total War"
;	Customised version for "Chivalry - Total War"
;	Customised version for "Invasio Barbarorum"
;	Customised version for "Fourth Age - Total War" by Aradan
;	Customised version for "Diadochi - Total War" by RedFox
;
; "Rome - Total War: "Sinuhet's AI Battle Formations Mod 7.0"  by Sinuhet/Pavel Vesely
;	Customised version for "Europa Barbarorum" by Lyasander13
;	Customised version for "Fortuna Orbis" by Caligula Caesar
;	Customised version for "Bares Bone War"
;	Customised version for "Rome - Total Realism: Platinum Edition", version 2.0 (i.e. only for RTW with patch 1.5), September 30, 2006
;		(This file was manually modified for a bit more challenging AI in battles - Sinuhet.)"
;		for Candelarius Extended Realism Mod version 2.2 - by Twix
;		Updated for ExRM 3.3.4 by Quinn Inuit, with guidance from Aradan.
;		Updated for ExRM 4.0 by Quinn Inuit--changes to all multi-line spearmen formations
;
; "Rome - Total War: Marcus Camillus's Player Foramtion Mod" by Marcus Camillus
; "Rome - Total War: Typhoon's player formation modification"
; "Rome - Total War: Pax Barbaricia"
; "Rome - Total War: Barbarians Revenge"
;
; "Medieval II - Total War: Darth's Dark Formation 4.5" by Darth Vader
; "Medieval II - Total War: Sinuhet's Battle Mechanics 5.0"  by Sinuhet/Pavel Vesely
; "Medieval II - Total War: ReallyBadAI for Stainless Steel 6.4"  by Germanicu5
;
;	This file describes the unit group formation templates, any number of group formations can be specified
;	these templates are used to give a group of units a formation, the units available  in the group may not
;	totally fit the template in which case a best-fit is determined when the formation is created
;
;	Formation block positions can either be specified with a relative normalised (x,z) or they can be specified
;	relative to another formation block (when specifying in this manner rotation CANNOT be given)
;	a formation must be described entirely in one method or the other
;
;	Dummy blocks can be specified when positioning blocks relatively. They do not contain units but encompass other
;	blocks, blocks can then be positioned relative to dummy blocks. When specifying multiple rows of troops each row
;	should be encased in a dummy block and the row behind should be position relative to this. This will avoid intersecting
;	blocks which would occur if the block that the rear row was positioned relative to had no units assigned to it.
;
;	formation					the name given to this formation template
;
;	formation purposes				hints to ai for using this formation  included basic purpose of march, attack, defend, pursue and other specific advance purposes
;
;	ai_priority					hint to the ai, denotes priority of using this template
;
;	supported_factions				list of factions supported, comma separated
;
;	BLOCK SPEC
;
;	begin_block <block_num>				begin a formation block
;	end_block					end a formation block
;
;	begin_dummy_block				begin a dummy block
;	spans <spanned blocks>				specify the blocks it will span
;	end_dummy_block					end dummy block
;
;		min_units <VALUE>			minimum number of units block can have (if more than max_units will cause ctd)
;		max_units <VALUE>			maximum number of units block can have
;		not_general				this block cannot contain the general unit
;		unit_type				specifies units that can be allocated to the block
;							either : -
;								any
;								phalanx
;								shield_wall
;								non_phalanx_spear
;								chanting_screeching
;								ranged_missile_infantry
;								elephants
;								heavy_chariots
;								pilum_infantry
;								general_unit
;								<UNIT_CLASS> <UNIT_CATEGORY> <PRIORITY> if either unit class or priority is not present then the missing field can be anything
;							the priority dictates the order of assigning different unit types
;							a priority of zero means that type will only ever be assigned to this block
;							to fulfill block minimums
;		default_melee_state <OPTIONAL>		the melee state that will be assigned to units in the formation
;		unit_formation				the formation the units within this block will be in (wedge, square, ...)
;		unit_density				either loose or close
;		min_unit_width				minimum unit width in men (if more than max_unit_width will cause ctd)
;		max_unit_width				maximum unit width in men
;		block_formation				the formation to organise the block into    (square, column, line)
;		normalised_pos				(x,z) position relative to the center of the template (in normalised coords)
;		normalised_rot				rotation in degress relative to the orientation of the template
;		block_relative_pos			b x z (x,z) position (in metres) relative to formation block b
;		inter_unit_spacing			distance to space units (in metres)
;		priority				dictates the order in which units are assigned to the block
;
;
; Priority's range
;
; Small formation range
;
;	10.00		Small elephant set (attack/defend)							(1 elephants)
;	10.00		Small heavy chariot set (attack/defend)							(1 heavy chariot)
;	10.00		Small missile cavalry set (attack/defend)						(1-3 missile/skirmish cavalry or chariot)
;	10.00		Small foot skirmisher set (attack/defend)						(1-2 missile/skirmish infantry)
;	10.00		Small phalanx set (attack/defend)							(2-6 phalanx spearmen)
;	10.00		Small spearmen set (attack/defend)							(2-6 non-phalanx spearmen)
;	10.00		Small heavy/light infantry set (attack/defend)						(1-5 heavy/light infantry)
;	10.00		Small general unit defend								(1 general unit)
;	 9.50		Small light cavalry set (attack/defend)							(light cavalry, varies)
;	 4.10		Small light cavalry in pursue								(1-2 light cavalry)
;	 4.00		Small heavy cavalry set (attack/defend)							(heavy cavalry, varies)
;	 1.00		Small ranged missile infantry set (attack/defend)					(1-2 ranged missile infantry)
;	 1.00		Small missile cavalry in pursue								(1-2 missile/skirmish cavalry)
;	 1.00		Small general unit attack								(1 general unit)
;	 0.98		Small cavalry in pursue									(1-2 light/heavy cavalry)
;	 0.96		Small missile infantry in pursue							(1-2 missile infantry)
;	 0.95		Small infantry in pursue								(1-2 light/heavy/spearman infantry)
;
; special elephants and chariot formation
;
;	 5.00		Fortuna Orbis's Mauryan Elephants Attack Formation					(Gandhara/Meroe only, min 5 elephants/heavy chariot, 5-12 missile/skirmish infantry, max 7 phalanx)
;
; cavalry with infantry support formations range (max 2 phalanx, max 7 non-phalanx spearmen, max 6 light/heavy infantry, max 12 missile/skirmish infantry)
;
;	 4.00		Pax Barbaricia's heavy cavalry wedge attack formation set				(min 6 heavy cavalry/elephants)
;	 3.95		Sinuhet's chariots and mixed missile cavalry army formation set				(min 3 heavy chariots, min 1 light/heavy cavalry, max 4 elephants)
;	 3.90		Sinuhet's M2TW Crescent formation set							(min 5 missile/skirmish cavalry, min 4 light/heavy cavalry, max 0 elephants/heavy chariots, 2-7 non-phalanx spearmen, max 9 missile/skirmish infantry)
;	 3.85		Sinuhet's mixed missile and cavalry army formation set					(min 5 missile/skirmish cavalry, min 3 light/heavy cavalry, max 4 elephants/heavy chariots)
;	 3.80		Darth-BI's Arab formation set								(min 5 missile/skirmish cavalry, max 2 light/heavy cavalry, max 4 elephants/heavy chariots)
;	 3.75		Sinuhet's horse archer army formation set						(min 5 missile/skirmish cavalry, min 1 light/heavy cavalry, max 0 elephants/heavy chariots)
;
; pure cavalry formations range (max 0 phalanx, max 0 non-phalanx spearmen, max 0 light/heavy infantry, max 0 missile/skirmish infantry)
;
;	 3.70		Sinuhet's missile cavalry army formation set						(min 1 missile/skirmish cavalry, max 0 infantry)
;	 3.60		Sinuhet's generic missile cavalry armies formation set					(min 5 missile/skirmish cavalry, min 1 light/heavy cavalry, max 0 infantry)
;	 3.50		Sinuhet's cavalry army formation set							(max 4 missile/skirmish cavalry, min 1 heavy cavalry, max 0 infantry)
;	 3.50		Sinuhet's light cavalry army formation set						(max 8 missile/skirmish cavalry, min 1 light cavalry, max 0 heavy cavalry, max 0 infantry)
;
; missile infantry formation range
;
;	 3.30		Sinuhet's missile and cavalry without melee infantry formation set			(1-12 missile/skirmish infantry, max 0 light infantry, max 0 heavy infantry, max 0 spearmen)
;	 3.20		Sinuhet's missile and cavalry with infantry formation set				(min 13 missile/skirmish infantry)
;
; Last resort for horse culture army (max 2 phalanx, max 7 non-phalanx spearmen, max 6 light/heavy infantry, max 12 missile/skirmish infantry)
;
;	 2.15		Darth's Nomadic (RTW) battle formation set						(Sarmatia and Parthia only, last resort for cavalry with infantry support formation for cavalry only)
;	 2.15		Darth's Nomadic (BI) battle formation set						(Tukhara only, last resort for cavalry with infantry support formation for cavalry only)
;
; Roman infantry formations range
;
;	 3.00		Darth&Sinuhet&Typhoon's Unified Roman pre-Marian Manipular formation set		(roman only, min 3 light prec infantry, 1-6 heavy prec infantry, 1-5 non-phalanx spearmen, max 5 skirmish infantry)
;	 2.98		Sinuhet's Roman post-Marian wedge formation set						(roman only, 13-17 heavy prec infantry)
;	 2.95		Darth&Marcus Camillus&RedFox&Sinuhet's Roman post-Marian formation set			(roman only, 7-12 heavy prec infantry, max 4 skirmish infantry)
;	 2.25		Darth-BI's Byzantine precursor formation set						(roman only, 3-6 heavy infantry, 6-8 non-phalanx spearmen)
;	 2.25		Sinuhet's Roman pre-Marian single line formation set					(roman only, max 4 light prec infantry, max 2 heavy infantry, 6-8 non-phalanx spearmen)
;	 2.20		Sinuhet's Roman phalanx line formation set						(roman only, min 3 phalanx)
;	 2.10		Sinuhet's Roman non-phalanx line formation set						(roman only, min 9 non-phalanx spearmen)
;	 2.00		Sinuhet's Simplified Roman pre-cursor/infantry line					(roman only, last resort in case stack could not fit in anything else)
;
; Barbarian infantry formations range
;
;	 2.90		Darth BI/FATW/ATW/Pax Barbaricia's Barbarian wedge formation set			(min 10 heavy infantry)
;	 2.80		Darth's Semi-barbarian formation set							(1-9 light/heavy prec infantry, max 6 non-phalanx spearmen)
;	 2.70		Modified Darth's Barbarian onslaught formation set					(max 9 heavy infantry, max 6 non-phalanx spearmen)
;	 2.50		Sinuhet's barbarian phalanx line formation set						(barbarian, nomad, and oriental only, min 3 phalanx, max 12 non-phalanx spearmen)
;	 2.40		Modified Darth's Barbarian spear wall formation set					(gauls, galatians,, germans, spain only, max 9 heavy infantry, 7-12 non-phalanx spearmen)
;	 2.30		Sinuhet's barbarian non-phalanx single line formation set				(barbarian, nomad, and oriental only, min 13 non-phalanx spearmen)
;	 2.00		Original Darth's Barbarian onslaught (RTW version) formation set			(gauls, galatians,, germans only, last resort in case stack could not fit in anything else)
;
; Asian/Nomad infantry formations range
;
;	 2.75		Darth's Skirmish battle formation set							(max 9 heavy infantry, 5-12 missile/skirmish infantry)
;	 2.25		Darth's Asian battle formation set							(max 7 non-phalanx spearmen, 5-12 missile/skirmish infantry)
;
; generic phalanx&spearmen formations range (non-roman civilized)
;
;	 2.90		Darth's Carthaginian battle formation set						(Carthage/Numidia/Gandhara/Meroe/Himyar only, 3-7 phalanx, max 12 non-phalanx spearmen, min 2 light/heavy prec infantry)
;	 2.80		Sinuhet's multiwave phalanx attack formation with spearmen set				(3-7 phalanx, 1-7 non-phalanx spearmen, min 7 light/heavy infantry)
;	 2.80		Sinuhet's multiwave phalanx attack formation without spearmen set			(3-7 phalanx, 0 non-phalanx, min 7 light/heavy infantry)
;	 2.80		Darth&Sinuhet's Philip/Alexander battle formation set					(3-7 phalanx, 3-7 light/heavy cavalry)
;	 2.75		Quin Inuit's phalanx single line formation set with double archer line			(3-7 phalanx, 5-16 missile/skirmish infantry)
;	 2.70		Sinuhet's mixed spearmen tri-section line with reserves (2-7 phalanx)			(3-7 phalanx, min 8 non-phalanx spearmen)
;	 2.60		Modified Darth's Epigonus battle formation set						(diadochi only, min 8 phalanx)
;	 2.60		Quin Inuit's universal phalanx tri-section line formation set				(for non-diadochi ,min 8 phalanx)
;	 2.55		Sinuhet's mixed spearmen tri-section line with reserves (8+ phalanx)			(min 8 phalanx, max 7 non-phalanx spearmen)
;	 2.50		Sinuhet's civilized phalanx single line attack formation set				(3-7 phalanx, last resort when not fit anything else)
;	 2.40		Darth's Theban battle formation set							(greek, thrace, and pontus only, min 8 non-phalanx spearmen)
;	 2.40		Sinuhet's universal non-phalanx tri-section line with reserves formation		(carthage, armenia, parthia, and oriental only, min 13 non-phalanx spearmen)
;	 2.30		Quin Inuit's universal non-phalanx tri-section line formation				(carthage, armenia, parthia, and oriental only, 8-12 non-phalanx spearmen)
;	 2.20		Sinuhet's universal non-phalanx single line formation set				(max 7 non-phalanx spearmen)
;
; generic heavy infantry formation range (non-roman civilized + spain & thrace)
;
;	 2.10		Sinuhet's pseudo-roman formation (modified with Marcus Camillus's non-roman generic)	(greek, carthage, numidia, eastern, and oriental only, unrestricted heavy infantry formation)
;
; generic formation range (incomplete formation sets, idea which AI would choose when nothing else left to)
;
;	 1.90		Sinuhet's Standard formation								(min 1 phalanx)
;	 1.50		Darth-M2TW's cavalry on the front formations set					(min 6 light/heavy cavalry)
;	 1.20		Sinuhet M2TW's Universal Attack formation						(fail-safe)
;	 1.10		Sinuhet M2TW's Triple lines missiles in front						(min 6 missile/skirmish infantry, min 3 light/heavy/spearmen infantry)
;	 0.30		Germanicu5's Triple lines missiles in front
;				Triple missiles in front plus infantry on flanks
;	 0.20		Double-lines formation set (mixed of various authors)
;				Double line missile in front							(min 6 missile/skirmish infantry)
;				Double line heavy/spearmen infantry in front					(min 6 heavy/spearmen infantry)
;				Double attack line heavy/light assault infantry in front			(min 6 heavy/light assault infantry)
;				Double attack line cavalry in front						(min 6 heavy/light cavalry/chariot)
;	 0.10		Aggressive ordered single line								(min 1 infantry)
;	 0.30		triple-lines formation set (mixed of various authors)
;				Darth-M2TW's Triple lines cavalry first						(min 2 light/heavy cavalry or heavy chariot, min 4 missile/skirmish cavalry or light chariot)
;				Triple lines pursue
;				Triple lines non-missile infantry in front					(min 4 light/heavy/skirmish/spearmen infantry, min 2 light/heavy/skirmish infantry)
;	 0.20		(AI Purpose)
;
; Sinuhet's generic march formations range
;
;	 0.60			Column light infantry on the front						(min 4 light/skirmish infantry, min 2 spearmen/heavy infantry)
;	 0.60			Column cavalry on the front							(min 4 missile/skirmish cavalry or chariot, min 2 light/heavy cavalry or heavy chariot)
;	 0.60			Column spearmen on the front							(min 4 spearmen/heavy infantry, min 2 spearmen/light infantry)
;
; Bridge assault formations range
;
;	 1.08		Darth's Bridge assault - cavalry							(min 5 heavy/spearmen/light cavalry)
;	 1.03		Darth's Bridge assault - precursor							(min 3 heavy/light assault or heavy infantry, min 4 heavy/light/spearmen infantry)
;	 1.01		Darth's Bridge assault - spearmen/infantry						(min 3 non-phalanx spearmen or heavy infantry, min 4 phalanx/infantry)
;	 1.00		Darth's Bridge assault - swimmer							(min 1 light/heavy/spearmen infantry, min 2 swimmer)
;
;	 1.00		Darth's Cross assault cover
;
;	 1.10		Darth's Cross block M2TW								(3-14 missile/skirmish infantry/cavalry, max 14 infantry)
;	 1.00		Darth's Cross block RTW									(min 1 light/heavy/spearmen infantry)
;
;	 1.00		Darth's Cross defend
;
; small formation/MISC range
;	 1.10
;	 1.00		Darth's Wall assault formation set							(culture-based)
;	 1.00		Darth's Siege deployment formation set							(culture-based)
;	 1.00		M2TW breach defend forces
;				Spearmen version								(min 2 spearmen)
;				heavy/light infantry version							(min 2 heavy/light infantry)
;	 1.00		Ambushed defend formation set								(culture-based)
;	 0.98
;	 0.96
;	 0.95
;	 0.80
;	 0.60		March formations
;	 0.30
;	 0.25
;	 0.20		AI purpose/gen line
;	 0.20		M2TW's AI settlement attack reform
;	 0.20		M2TWs' AI settlement assault gate
;	 0.10		(not use, potential bug)
;

;*******************************
;*******************************
; AI Purpose
;*******************************
;*******************************

;****************************************************************
; 3-lines non-precursor infantry attack formation (generic formation)
; elephants/scythed chariots stay in the front
; 3 lines of infantry in the center
; missile at the wings
; cavalry on back flank
; artillery and handlers at the back
;****************************************************************

;(AI purposes)
begin_formation ai_gen_heavy_infantry_line_approach

	;;; purpose flags
	attack						; ATTACK AND DEFEND
	defend

	ai_priority				0.20

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, carthage, pontus, numidia, gauls, galatians,,, britons, dacia, germans, spain, thrace, slave

	;; First line of infantry
	begin_block 0
		min_units				3
		not_general
		unit_type				light infantry 1.0
		unit_type				heavy infantry 0.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; second line of infantry
	begin_block 1
		min_units				3
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		0 0.0 -2.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; 3rd line of infantry
	begin_block 2
		min_units				2
		not_general
		unit_type				heavy infantry 0.4
		unit_type				spearmen infantry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		1 0.0 -2.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; Archers behind
	begin_block 3
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		2 0.0 -30.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	begin_dummy_block 4
		spans	0 1 2 3
	end_dummy_block

	; Screen of missile inf
	begin_block 5
		not_general
		unit_type				missile infantry 0.5
		unit_type				skirmish infantry 1.0
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 0.0 -6.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; artillery and handlers at the back
	begin_block 6
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				any 0.001
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 0.0 -10.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block


	;; cavalry on the flanks and back a bit
	;; left flank cav
	begin_block 7
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		6 -10.0 -15.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; left flank cav(more)
	begin_block 8
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		7 1 -3.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; right flank cav
	begin_block 9
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		6 10.0 -15.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; right flank cav(more)
	begin_block 10
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		9 -1 -3.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	begin_dummy_block 11
		spans	0 1 2 3 4 5 6 7 8 9 10
	end_dummy_block

	;; left flank missile(decides to support the flank more)
	begin_block 12
		min_units				1
		max_units				2
		not_general
		unit_type				missile infantry 0.5
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		11 -5.0 0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile(decides to support the flank more)
	begin_block 13
		min_units				1
		max_units				2
		not_general
		unit_type				missile infantry 0.5
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		11 5.0 0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; general at the back
	begin_block 14
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		4 0.0 -40.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 15
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		14 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

end_formation



;(AI purposes)
begin_formation ai_gen_heavy_infantry_line_pursue

	;;; purpose flags
	pursue						; ATTACK AND DEFEND

	ai_priority				0.20

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, carthage, pontus, numidia, gauls, galatians,,, britons, dacia, germans, spain, thrace, slave

	;; First line of infantry
	begin_block 0
		min_units				3
		not_general
		unit_type				light infantry 1.0
		unit_type				heavy infantry 0.0
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; second line of infantry
	begin_block 1
		min_units				3
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.0
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 -2.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; 3rd line of infantry
	begin_block 2
		min_units				2
		not_general
		unit_type				heavy infantry 0.4
		unit_type				spearmen infantry 1.0
		default_melee_state		fire_at_will
		unit_formation			phalanx, shield_wall, square
		block_formation			line
		block_relative_pos		1 0.0 -2.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; Archers behind
	begin_block 3
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		max_unit_width			40
		block_formation			line
		block_relative_pos		2 0.0 -20.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	begin_dummy_block 4
		spans	0 1 2 3
	end_dummy_block

	; Screen of missile inf
	begin_block 5
		not_general
		unit_type				missile infantry 0.5
		unit_type				skirmish infantry 1.0
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		default_melee_state		fire_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 0.0 -6.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; artillery and handlers at the back
	begin_block 6
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				any 0.001
		default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 0.0 -10.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block


	;; cavalry on the flanks and back a bit
	;; left flank cav
	begin_block 7
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			square
		block_relative_pos		6 -10.0 -15.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; left flank cav(more)
	begin_block 8
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			square
		block_relative_pos		7 1 -3.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; right flank cav
	begin_block 9
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			square
		block_relative_pos		6 10.0 -15.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; right flank cav(more)
	begin_block 10
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			square
		block_relative_pos		9 -1 -3.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	begin_dummy_block 11
		spans	0 1 2 3 4 5 6 7 8 9 10
	end_dummy_block

	;; left flank missile(decides to support the flank more)
	begin_block 12
		min_units				1
		max_units				2
		not_general
		unit_type				missile infantry 0.5
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			line
		block_relative_pos		11 -5.0 0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile(decides to support the flank more)
	begin_block 13
		min_units				1
		max_units				2
		not_general
		unit_type				missile infantry 0.5
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			line
		block_relative_pos		11 5.0 0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; general at the back
	begin_block 14
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		4 0.0 -40.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 15
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		14 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

end_formation



;(AI purposes)
begin_formation ai_gen_line_standard_approach

	;;; purpose flags
	attack						; can use this for anything
	defend

	ai_priority				0.20

	supported_factions			romans_julii, slave

	;; First line of infantry
	begin_block 0
		min_units				3
		not_general
		unit_type				light infantry 1.0
		unit_type				light_pilum_infantry 0.9
		unit_type				heavy_pilum_infantry 0.7
		unit_type				heavy infantry 0.0
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; second line of infantry
	begin_block 1
		min_units				3
		not_general
		unit_type				heavy_pilum_infantry 1.0
		unit_type				light_pilum_infantry 0.1
		unit_type				heavy infantry 0.0
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		0 0.0 -2.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; 3rd line of infantry
	begin_block 2
		min_units				2
		not_general
		unit_type				heavy infantry 0.4
		unit_type				spearmen infantry 1.0
		unit_type				general_unit infantry 3.0
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		1 0.0 -2.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; Archers behind
	begin_block 3
		not_general
		unit_type				ranged_missile_infantry 2.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		2 0.0 -30.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block


	begin_dummy_block 4
		spans	0 1 2 3
	end_dummy_block

	; Screen of missile inf
	begin_block 5
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 0.0 -6.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; artillery and handlers at the back
	begin_block 6
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				any 0.001
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block


	;; cavalry on the flanks and back a bit

	;; left flank cav
	begin_block 7
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		6 -10.0 -15.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; left flank cav(more)
	begin_block 8
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		7 1 -3.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank cav
	begin_block 9
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		6 10.0 -15.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; right flank cav(more)
	begin_block 10
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		9 -1 -3.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	begin_dummy_block 11
		spans	0 1 2 3 4 5 6 7 8 9 10
	end_dummy_block

	 ;; left flank missile(decides to support the flank more)
	begin_block 12
		min_units				1
		max_units				2
		not_general
		unit_type				missile infantry 0.5
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		11 -5.0 0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile(decides to support the flank more)
	begin_block 13
		min_units				1
		max_units				2
		not_general
		unit_type				missile infantry 0.5
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			square
		block_relative_pos		11 5.0 0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; Commander at the back
	begin_block 14
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		4 0.0 -50.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 15
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		14 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block


end_formation


;(AI purposes)
begin_formation ai_gen_line_standard_attack

	;;; purpose flags
	attack						; can use this for anything
	pursue

	ai_priority				0.20

	supported_factions			romans_julii, slave

	;; Missile cavalry or Elephants in front
	begin_block 0
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 1.0
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		default_melee_state		fire_at_will
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; Foot Skirmishers follow
	begin_block 1
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; The main Infantry line
	begin_block 2
		min_units				2
		not_general
		unit_type				infantry 1.0
		;unit_formation			square
		block_formation			line
		block_relative_pos		1 0.0 -15.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; the right cover of infantry
	begin_block 3
		max_units				3
		not_general
		unit_type				light infantry 1.0
		unit_type				infantry 0.5
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		block_formation			line
		block_relative_pos		2 0.2 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; the left cover of infantry
	begin_block 4
		max_units				3
		not_general
		unit_type				light infantry 1.0
		unit_type				infantry 0.5
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		block_formation			line
		block_relative_pos		2 -0.2 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	begin_dummy_block 5
		spans	2 3 4
	end_dummy_block

	begin_block 6
		not_general
		unit_type				ranged_missile_infantry 2.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	;; cavalry will attack right flank
	begin_block 7
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			square
		block_relative_pos		5 15 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; cavalry will attack left flank
	begin_block 8
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			square
		block_relative_pos		5 -15 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block


	;; put the artillery and handlers and long range missiles behind everyone
	begin_dummy_block 9
		spans	0 1 2 3 4 5 6 7 8
	end_dummy_block

	;; commander at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		5 0.0 -30.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		unit_type				general_unit infantry 0.1
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		10 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block


	begin_block 12
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		unit_type				any 0.001
		default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 0.0 -50.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

end_formation


;*******************************
;*******************************
; Roman's Formation System start here
; Merge Darth and Sinuhet design together
;*******************************
;*******************************

;***********************************************************************************************
; Roman manipular formation. A really classy formation that wins the day for the AI!
; More historical formation for Romans with premarian units
; ( modified from Darth, Sinuhet, and Typhoon)
;***********************************************************************************************

begin_formation ai_maniple_line_march

	;;; purpose flags - regrouping
	march

	ai_priority				3.00

	supported_factions			romans_julii,

	; Centre of the Skirmish line - velites, 1 unit used as a reference - offset centre
	begin_block 0
		max_units				1
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		skirmish
		;unit_formation			square
		;unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; Left wing of skirmish line
	begin_block 1
		max_units				2
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		skirmish
		;unit_formation			square
		;unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 -0.2 0.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;; Right wing of skirmish line
	begin_block 2
		max_units				2
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		skirmish
		;unit_formation			square
		;unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.2 0.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	begin_dummy_block 3
		spans	0 1 2
	end_dummy_block

	;; Center of First line of Infantry - Hastati - 1 unit for reference - offset right of centre
	begin_block 4
		min_units				1
		not_general
		unit_type				light_pilum_infantry 1.0
		;default_melee_state		defend
		;unit_formation			square, testudo, horde
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		3 0.0 -6.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	;; Left wing of Hastati
	begin_block 5
		min_units				1
		not_general
		unit_type				light_pilum_infantry 1.0
		;default_melee_state		defend
		;unit_formation			square, testudo, horde
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		4 -6.0 0.0
		inter_unit_spacing		6.0
		priority			0.8
	end_block

	;; Right wing of Hastati
	begin_block 6
		min_units				1
		not_general
		unit_type				light_pilum_infantry 1.0
		;default_melee_state		defend
		;unit_formation			square, testudo, horde
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		4 6.0 0.0
		inter_unit_spacing		6.0
		priority			0.9
	end_block

	;;  Center of Second line of Infantry - Principe - 1 unit for reference
	begin_block 7
		min_units				1
		max_units				2
		not_general
		unit_type				heavy_pilum_infantry 1.0
		;default_melee_state		defend
		;unit_formation			square, testudo, horde
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		4 0.0 -6.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	;; Left wing of Principe
	begin_block 8
		max_units				2
		unit_type				heavy_pilum_infantry 1.0
		unit_type				general_unit infantry 3.0
		;default_melee_state		defend
		;unit_formation			square, testudo, horde
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		7 -6.0 0.0
		inter_unit_spacing		6.0
		priority			0.7
	end_block

	;; Right wing of Principe
	begin_block 9
		max_units				2
		unit_type				heavy_pilum_infantry 1.0
		unit_type				general_unit infantry 3.0
		;default_melee_state		defend
		;unit_formation			square, testudo, horde
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		7 6.0 0.0
		inter_unit_spacing		6.0
		priority			0.8
	end_block

	begin_dummy_block 10
		spans	0 1 2 3 4 5 6 7 8 9
	end_dummy_block

	;;  Center of 3rd line of Infantry Triarii - 1 unit for reference - offset right of centre (going to the triarii!)
	begin_block 11
		min_units				1
		max_units				3
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square, horde
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		10 0.0 -6.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; Left wing of Triarii
	begin_block 12
		max_units				1
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square, horde
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		11 -0.1 0.0
		inter_unit_spacing		0.1
		priority			0.7
	end_block


	;; Right wing of Triarii
	begin_block 13
		max_units				1
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square, horde
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		11 0.1 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	begin_dummy_block 14
		spans	11 12 13
	end_dummy_block

	;; Archers behind
	begin_block 15
		max_units				4
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		;unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		14 0.0 -20.0
		inter_unit_spacing		0.1
		priority			0.6
	end_block

	;; commander at the back
	begin_block 16
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		14 0.0 -15.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 17
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		16 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; artillery and handlers at the back
	begin_block 18
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		17 0.0 -20.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; any behind
	begin_block 19
		max_units				0
		unit_type				any 0.001
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		18 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	begin_dummy_block 20
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank cav
	begin_block 21
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			15
		block_formation			column
		block_relative_pos		20 -1.0 -1.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; left flank cav(more)
	begin_block 22
		not_general
		unit_type				light cavalry 1.0
		unit_type				heavy cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			15
		block_formation			square
		block_relative_pos		21 -1.0 -3.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;; right flank cav
	begin_block 23
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			15
		block_formation			column
		block_relative_pos		20 1.0 -1.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; right flank cav(more)
	begin_block 24
		not_general
		unit_type				light cavalry 1.0
		unit_type				heavy cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			15
		block_formation			square
		block_relative_pos		23 1.0 -3.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	;; left flank missile cav
	begin_block 25
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		22 -1.0 10.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; left flank missile cav(more)
	begin_block 26
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			15
		block_formation			column
		block_relative_pos		25 -1.0 -6.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;; right flank missile cav
	begin_block 27
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			15
		block_formation			column
		block_relative_pos		24 1.0 10.0
		inter_unit_spacing		0.2
		priority			0.7
	end_block

	;; right flank missile cav(more)
	begin_block 28
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			column
		block_relative_pos		27 5.0 -6.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	begin_block 29
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			20
		block_formation			column
		block_relative_pos		20 -20.0 1.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

end_formation


begin_formation ai_maniple_line_deploy

	;;; purpose flags - deploy, defending
	defend
	march

	ai_priority				3.00

	supported_factions			romans_julii,

	; Centre of the Skirmish line - velites, 1 unit used as a reference - offset centre
	begin_block 0
		max_units				1
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; Left wing of skirmish line
	begin_block 1
		max_units				2
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 -0.2 0.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;; Right wing of skirmish line
	begin_block 2
		max_units				2
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.2 0.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	begin_dummy_block 3
		spans	0 1 2
	end_dummy_block

	;; Center of First line of Infantry - Hastati - 1 unit for reference - offset right of centre
	begin_block 4
		min_units				1
		not_general
		unit_type				light_pilum_infantry 1.0
		default_melee_state		fire_at_will
		unit_formation			shield_wall, testudo, horde, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		3 0.0 -7.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; Left wing of Hastati
	begin_block 5
		min_units				1
		not_general
		unit_type				light_pilum_infantry 1.0
		default_melee_state		fire_at_will
		unit_formation			shield_wall, testudo, horde, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		4 -10.0 0.0
		inter_unit_spacing		10.0
		priority			0.8
	end_block

	;; Right wing of Hastati
	begin_block 6
		min_units				1
		not_general
		unit_type				light_pilum_infantry 1.0
		default_melee_state		fire_at_will
		unit_formation			shield_wall, testudo, horde, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		4 10.0 0.0
		inter_unit_spacing		10.0
		priority			0.9
	end_block

	;;  Center of Second line of Infantry - Principe - 1 unit for reference - offset right of centre
	begin_block 7
		min_units				1
		max_units				2
		not_general
		unit_type				heavy_pilum_infantry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, testudo, horde, shield_wall
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		4 0.0 -6.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; Left wing of Principe
	begin_block 8
		max_units				2
		unit_type				heavy_pilum_infantry 1.0
		unit_type				general_unit infantry 3.0
		default_melee_state		fire_at_will
		;unit_formation			square, testudo, horde, shield_wall
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		7 -10.0 0.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; Right wing of Principe
	begin_block 9
		max_units				2
		unit_type				heavy_pilum_infantry 1.0
		unit_type				general_unit infantry 3.0
		default_melee_state		fire_at_will
		;unit_formation			square, testudo, horde, shield_wall
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		7 10.0 0.0
		inter_unit_spacing		10.0
		priority			0.8
	end_block

	begin_dummy_block 10
		spans	0 1 2 3 4 5 6 7 8 9
	end_dummy_block

	;;  Center of 3rd line of Infantry Triarii - 1 unit for reference - offset right of centre (going to the triarii!)
	begin_block 11
		min_units				1
		max_units				3
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, horde, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 0.0 -6.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; Left wing of Triarii
	begin_block 12
		max_units				1
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, horde, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		11 -0.1 0.0
		inter_unit_spacing		0.1
		priority			0.7
	end_block


	;; Right wing of Triarii
	begin_block 13
		max_units				1
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, horde, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		11 0.1 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	begin_dummy_block 14
		spans	11 12 13
	end_dummy_block

	;; Archers behind
	begin_block 15
		max_units				4
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		14 0.0 -30.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; commander at the back
	begin_block 16
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		14 0.0 -25.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 17
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		16 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; artillery and handlers at the back
	begin_block 18
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		17 0.0 -20.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; any behind
	begin_block 19
		max_units				0
		unit_type				any 0.001
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		18 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	begin_dummy_block 20
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank cav
	begin_block 21
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		20 -25.0 -1.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; left flank cav(more)
	begin_block 22
		not_general
		unit_type				light cavalry 1.0
		unit_type				heavy cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		21 -10.0 -3.0
		inter_unit_spacing		4.0
		priority			0.3
	end_block

	;; right flank cav
	begin_block 23
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		20 25.0 -1.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; right flank cav(more)
	begin_block 24
		not_general
		unit_type				light cavalry 1.0
		unit_type				heavy cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		23 10.0 -3.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	;; left flank missile cav
	begin_block 25
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		21 -5.0 10.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; left flank missile cav(more)
	begin_block 26
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		25 -1.0 -6.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; right flank missile cav
	begin_block 27
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		23 5.0 10.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; right flank missile cav(more)
	begin_block 28
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		27 1.0 -6.0
		inter_unit_spacing		10.0
		priority			0.4
	end_block

	begin_block 29
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		20 -20.0 -5.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

end_formation


;the formation attacks and attacks with coordination. Skirmishers are energetic. The general will not risk with close fighting with the enemy.
begin_formation ai_maniple_line_attack_march

	;;; purpose flags - attacking
	attack
	march

	ai_priority				3.00

	supported_factions			romans_julii,

	; Centre of the Skirmish line - velites, 1 unit used as a reference - offset centre
	begin_block 0
		max_units				1
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		;unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 15.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; Left wing of skirmish line
	begin_block 1
		max_units				2
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		;unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 -0.2 0.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;; Right wing of skirmish line
	begin_block 2
		max_units				2
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		;unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.2 0.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	begin_dummy_block 3
		spans	0 1 2
	end_dummy_block

	;; Center of First line of Infantry - Hastati - 1 unit for reference - offset right of centre
	begin_block 4
		min_units				1
		not_general
		unit_type				light_pilum_infantry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, testudo, horde
		;unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		3 0.0 -7.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; Left wing of Hastati
	begin_block 5
		min_units				1
		not_general
		unit_type				light_pilum_infantry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, testudo, horde
		;unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		4 -10.0 0.0
		inter_unit_spacing		10.0
		priority			0.8
	end_block

	;; Right wing of Hastati
	begin_block 6
		min_units				1
		not_general
		unit_type				light_pilum_infantry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, testudo, horde
		;unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		4 10.0 0.0
		inter_unit_spacing		10.0
		priority			0.9
	end_block

	;;  Center of Second line of Infantry - Principe - 1 unit for reference - offset right of centre
	begin_block 7
		min_units				1
		max_units				2
		not_general
		unit_type				heavy_pilum_infantry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, testudo, horde
		;unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		4 0.0 -10.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; Left wing of Principe
	begin_block 8
		max_units				2
		unit_type				heavy_pilum_infantry 1.0
		unit_type				general_unit infantry 3.0
		default_melee_state		fire_at_will
		;unit_formation			square, testudo, horde
		;unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		7 -10.0 0.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; Right wing of Principe
	begin_block 9
		max_units				2
		unit_type				heavy_pilum_infantry 1.0
		unit_type				general_unit infantry 3.0
		default_melee_state		fire_at_will
		;unit_formation			square, testudo, horde
		;unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		7 10.0 0.0
		inter_unit_spacing		10.0
		priority			0.8
	end_block

	begin_dummy_block 10
		spans	0 1 2 3 4 5 6 7 8 9
	end_dummy_block

	;;  Center of 3rd line of Infantry Triarii - 1 unit for reference - offset right of centre (going to the triarii!)
	begin_block 11
		min_units				1
		max_units				3
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square	; when march let's ai decide
		;unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 0.0 -10.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; Left wing of Triarii
	begin_block 12
		max_units				1
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square	; when march let's ai decide
		;unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		11 -10.0 0.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block


	;; Right wing of Triarii
	begin_block 13
		max_units				1
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square	; when march let's ai decide
		;unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		11 10.0 0.0
		inter_unit_spacing		10.0
		priority			0.8
	end_block

	begin_dummy_block 14
		spans	11 12 13
	end_dummy_block

	;; Archers behind
	begin_block 15
		max_units				4
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		14 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; commander at the back
	begin_block 16
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		14 0.0 -40.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 17
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		16 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; artillery and handlers at the back
	begin_block 18
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		17 0.0 -20.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; any behind
	begin_block 19
		max_units				0
		unit_type				any 0.001
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		18 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	begin_dummy_block 20
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank cav
	begin_block 21
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			square
		block_relative_pos		20 -10.0 15.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; left flank cav(more)
	begin_block 22
		not_general
		unit_type				light cavalry 1.0
		unit_type				heavy cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			24
		block_formation			square
		block_relative_pos		21 -20.0 -1.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;; right flank cav
	begin_block 23
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			square
		block_relative_pos		20 10.0 15.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; right flank cav(more)
	begin_block 24
		not_general
		unit_type				light cavalry 1.0
		unit_type				heavy cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			24
		block_formation			square
		block_relative_pos		23 20.0 -1.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	;; left flank missile cav
	begin_block 25
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			column
		block_relative_pos		21 -5.0 10.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; left flank missile cav(more)
	begin_block 26
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			column
		block_relative_pos		25 -1.0 -6.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; right flank missile cav
	begin_block 27
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			column
		block_relative_pos		23 5.0 10.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; right flank missile cav(more)
	begin_block 28
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			column
		block_relative_pos		27 1.0 -6.0
		inter_unit_spacing		10.0
		priority			0.4
	end_block

	begin_block 29
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		20 -30.0 20.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

end_formation


begin_formation ai_maniple_line_regrouped_pursue

	;;; purpose flags - charing
	pursue
	march

	ai_priority				3.00

	supported_factions			romans_julii,

	;;  Center of 3rd line of Infantry Triarii - 1 unit for reference - offset right of centre (going to the triarii!)
	begin_block 0
		min_units				1
		max_units				3
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square, horde
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -6.0
		inter_unit_spacing		0.1
		priority			2.0
	end_block

	;; Left wing of Triarii
	begin_block 1
		max_units				1
		not_general
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		unit_formation			shield_wall, square, horde
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 -0.1 0.0
		inter_unit_spacing		0.1
		priority			0.7
	end_block


	;; Right wing of Triarii
	begin_block 2
		max_units				1
		not_general
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		unit_formation			shield_wall, square, horde
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.1 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	begin_dummy_block 3
		spans	0 1 2
	end_dummy_block

	;;  Center of Second line of Infantry - Principe - 1 unit for reference - offset right of centre
	begin_block 4
		min_units				1
		max_units				2
		unit_type				heavy_pilum_infantry 1.0
		;default_melee_state		defend
		;unit_formation			square, testudo, horde
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 -6.0
		inter_unit_spacing		0.2
		priority			1.5
	end_block

	;; Left wing of Principe
	begin_block 5
		max_units				2
		unit_type				heavy_pilum_infantry 1.0
		unit_type				general_unit infantry 3.0
		;default_melee_state		defend
		;unit_formation			square, testudo, horde
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		4 -6.0 0.0
		inter_unit_spacing		6.0
		priority			0.7
	end_block


	;; Right wing of Principe
	begin_block 6
		max_units				2
		unit_type				heavy_pilum_infantry 1.0
		unit_type				general_unit infantry 3.0
		;default_melee_state		defend
		;unit_formation			square, testudo, horde
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		4 6.0 0.0
		inter_unit_spacing		6.0
		priority			0.8
	end_block

	;; 3rd line of infantry(Light infantry retreats!)
	begin_block 7
		min_units				1
		not_general
		unit_type				light_pilum_infantry 1.0
		;default_melee_state		defend
		;unit_formation			square, testudo, horde
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		4 0.0 -6.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; Left wing of Hastati
	begin_block 8
		min_units				1
		not_general
		unit_type				light_pilum_infantry 1.0
		;default_melee_state		defend
		;unit_formation			square, testudo, horde
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		7 -6.0 0.0
		inter_unit_spacing		6.0
		priority			0.8
	end_block

	;; Right wing of Hastati
	begin_block 9
		min_units				1
		not_general
		unit_type				light_pilum_infantry 1.0
		;default_melee_state		defend
		;unit_formation			square, testudo, horde
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		7 6.0 0.0
		inter_unit_spacing		6.0
		priority			0.9
	end_block

	begin_dummy_block 10
		spans	4 5 6 7 8 9
	end_dummy_block

	; Screen of skirmish infantry - velites
	begin_block 11
		max_units				4
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		10 0.0 -10.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; Left wing of skirmish line
	begin_block 12
		max_units				2
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		11 -0.2 0.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;; Right wing of skirmish line
	begin_block 13
		max_units				2
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		11 0.2 0.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	begin_dummy_block 14
		spans	11 12 13
	end_dummy_block

	;; Archers behind
	begin_block 15
		max_units				4
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		;unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		14 0.0 -20.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; commander at the back
	begin_block 16
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		14 0.0 -30.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 17
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		16 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; artillery and handlers at the back
	begin_block 18
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;unit_formation			square
		;unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		17 0.0 -10.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; any behind
	begin_block 19
		max_units				0
		unit_type				any 0.001
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		18 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	begin_dummy_block 20
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank cav
	begin_block 21
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		20 -15.0 10.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; left flank cav(more)
	begin_block 22
		not_general
		unit_type				light cavalry 1.0
		unit_type				heavy cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		21 -30.0 3.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;; right flank cav
	begin_block 23
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		20 15.0 10.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; right flank cav(more)
	begin_block 24
		not_general
		unit_type				light cavalry 1.0
		unit_type				heavy cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		23 30.0 3.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	;; left flank missile cav
	begin_block 25
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		21 -5.0 -5.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; left flank missile cav(more)
	begin_block 26
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		25 -5.0 -6.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; right flank missile cav
	begin_block 27
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		23 5.0 -5.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile cav(more)
	begin_block 28
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		27 5.0 -6.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	begin_block 29
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			40
		block_formation			line
		block_relative_pos		20 5.0 10.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

end_formation


;the multirole swap of the formation will make cavalry to cover flanks than attack and also this applies to foot missiles
begin_formation ai_maniple_line_regrouped_approach

	;;; purpose flags - approaching
	attack
	defend
	march

	ai_priority				3.00

	supported_factions			romans_julii,

	; Centre of the Skirmish line - velites, 1 unit used as a reference - offset centre
	begin_block 0
		max_units				1
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; Left wing of skirmish line
	begin_block 1
		max_units				2
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 -0.2 0.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;; Right wing of skirmish line
	begin_block 2
		max_units				2
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.2 0.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	begin_dummy_block 3
		spans	0 1 2
	end_dummy_block

	;; Center of First line of Infantry - Hastati - 1 unit for reference - offset right of centre
	begin_block 4
		min_units				1
		not_general
		unit_type				light_pilum_infantry 1.0
		;default_melee_state		defend
		;unit_formation			square, testudo, horde
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 0.0 -7.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; Left wing of Hastati
	begin_block 5
		min_units				1
		not_general
		unit_type				light_pilum_infantry 1.0
		;default_melee_state		defend
		;unit_formation			square, testudo, horde
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 -10.0 0.0
		inter_unit_spacing		10.0
		priority			0.8
	end_block

	;; Right wing of Hastati
	begin_block 6
		min_units				1
		not_general
		unit_type				light_pilum_infantry 1.0
		;default_melee_state		defend
		;unit_formation			square, testudo, horde
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 10.0 0.0
		inter_unit_spacing		10.0
		priority			0.9
	end_block

	;;  Center of Second line of Infantry - Principe - 1 unit for reference
	begin_block 7
		min_units				1
		max_units				2
		not_general
		unit_type				heavy_pilum_infantry 1.0
		;default_melee_state		defend
		;unit_formation			square, testudo, horde
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 0.0 -10.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; Left wing of Principe
	begin_block 8
		max_units				2
		unit_type				heavy_pilum_infantry 1.0
		unit_type				general_unit infantry 3.0
		;default_melee_state		defend
		;unit_formation			square, testudo, horde
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		7 -10.0 0.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; Right wing of Principe
	begin_block 9
		max_units				2
		unit_type				heavy_pilum_infantry 1.0
		unit_type				general_unit infantry 3.0
		;default_melee_state		defend
		;unit_formation			square, testudo, horde
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		7 10.0 0.0
		inter_unit_spacing		10.0
		priority			0.8
	end_block

	begin_dummy_block 10
		spans	0 1 2 3 4 5 6 7 8 9
	end_dummy_block

	;;  Center of 3rd line of Infantry Triarii - 1 unit for reference - offset right of centre (going to the triarii!)
	begin_block 11
		min_units				1
		max_units				3
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square, horde
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 0.0 -10.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; Left wing of Triarii
	begin_block 12
		max_units				1
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square, horde
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		11 -10.0 0.0
		inter_unit_spacing		0.1
		priority			0.7
	end_block


	;; Right wing of Triarii
	begin_block 13
		max_units				1
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square, horde
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		11 10.0 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	begin_dummy_block 14
		spans	11 12 13
	end_dummy_block

	;; Archers behind
	begin_block 15
		max_units				4
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		14 0.0 -30.0
		inter_unit_spacing		0.1
		priority			0.6
	end_block

	;; commander at the back
	begin_block 16
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		14 0.0 -30.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 17
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		16 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; artillery and handlers at the back
	begin_block 18
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		17 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; any behind
	begin_block 19
		max_units				0
		unit_type				any 0.001
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		18 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	begin_dummy_block 20
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank cav
	begin_block 21
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		20 -10.0 -10.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; left flank cav(more)
	begin_block 22
		not_general
		unit_type				light cavalry 1.0
		unit_type				heavy cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		21 -20.0 -3.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;; right flank cav
	begin_block 23
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		20 10.0 -10.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; right flank cav(more)
	begin_block 24
		not_general
		unit_type				light cavalry 1.0
		unit_type				heavy cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		23 20.0 -3.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	;; left flank missile cav
	begin_block 25
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		22 -1.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; left flank missile cav(more)
	begin_block 26
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		25 -5.0 6.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; right flank missile cav
	begin_block 27
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		24 1.0 0.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; right flank missile cav(more)
	begin_block 28
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		27 5.0 -6.0
		inter_unit_spacing		10.0
		priority			0.4
	end_block

	begin_block 29
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		20 -20.0 1.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

end_formation



;***********************************************************************************************************************************************************************
; More historical formation for Romans with postmarian units
; Modified from work of Darth's BI cohort formation, Sinuhet's, RedFox's, Marcus Camillus's Imperial Roman Legion Formation
;***********************************************************************************************************************************************************************

begin_formation ai_roman_precursor_line_enhanced_march

	;;; purpose flags - regrouping
	march

	ai_priority				2.95

	supported_factions			romans_julii,

	;; First cohort with Eagle
	begin_block 0
		min_units				1
		max_units				1
		unit_type				heavy_pilum_infantry 2.0
		;default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	;; first line of the legion - legionarii- reference center
	begin_block 1
		min_units				1
		max_units				1
		not_general
		unit_type				heavy_pilum_infantry 1.95
		;default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.50
	end_block

	;; first line of the legion - left of centre
	begin_block 2
		min_units				1
		max_units				2
		not_general
		unit_type				heavy_pilum_infantry 1.95
		;default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		1 -3.0 0.0
		inter_unit_spacing		3.0
		priority			0.70
	end_block

	;; first line of the legion - right of centre
	begin_block 3
		min_units				1
		max_units				2
		not_general
		unit_type				heavy_pilum_infantry 1.95
		;default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		1 3.0 0.0
		inter_unit_spacing		3.0
		priority			0.70
	end_block

	;; second line of the legion - legionarii
	begin_block 4
		min_units				3
		max_units				6
		not_general
		unit_type				heavy_pilum_infantry 1.2
		;default_melee_state		fire_at_will
		;unit_formation			shield_wall, testudo, square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		1 0.0 -15.0
		inter_unit_spacing		4.0
		priority			0.95
	end_block

	;; left flank spears
	begin_block 5
		not_general
		unit_type				non_phalanx_spear 1.0
		unit_type				general_unit infantry 3.0
		;unit_formation			shield_wall, square
		max_unit_width			15
		block_formation			line
		block_relative_pos		4 -5.0 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; right_flank spears
	begin_block 6
		not_general
		unit_type				non_phalanx_spear 1.0
		unit_type				general_unit infantry 3.0
		;unit_formation			shield_wall, square
		max_unit_width			15
		block_formation			line
		block_relative_pos		4 5.0 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; third line of infantry - spearmen
	begin_block 7
		not_general
		unit_type				spearmen_pilum_infantry 2.0
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		4 0.0 -10.0
		inter_unit_spacing		4.0
		priority			0.8
	end_block

	begin_dummy_block 8
		spans	4 5 6 7
	end_dummy_block

	; Screen of missile inf
	begin_block 9
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		;default_melee_state		skirmish
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 0.0 30.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; Archers behind
	begin_block 10
		max_units				4
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			15
		block_formation			line
		block_relative_pos		8 0.0 -20.0
		inter_unit_spacing		6.0
		priority			0.6
	end_block

	;; commander at the back
	begin_block 11
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		8 0.0 -20.0
		inter_unit_spacing		0.2
		priority			2.0
	end_block

	;; VIP is here
	begin_block 12
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		;unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		11 0.0 -5.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; light infantry attachment
	begin_block 13
		unit_type				light infantry 1.0
		default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			line
		block_relative_pos		12 0.0 -5.0
		inter_unit_spacing		10.0
		priority			0.1
	end_block

	;; any behind
	begin_block 14
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		13 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handlers left side
	begin_block 15
		;max_units				1
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			line
		block_relative_pos		11 -10.0 0.0
		inter_unit_spacing		2.0
		priority			0.1
	end_block

	;; artillery and handlers right side
	begin_block 16
		;max_units				1
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			line
		block_relative_pos		11 10.0 0.0
		inter_unit_spacing		2.0
		priority			0.1
	end_block

	begin_dummy_block 17
		spans	11 12 13 14 15 16
	end_dummy_block

	begin_block 18
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			20
		block_formation			column
		block_relative_pos		8 -20.0 1.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_dummy_block 19
		spans	0 1 2 3 8 9 10 17
	end_dummy_block

	;; cavalry on the flanks and topwards back

	;; left flank cav
	begin_block 20
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			square
		block_relative_pos		8 -5.0 1.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank cav(more)
	begin_block 21
		not_general
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			square
		block_relative_pos		20 -1.0 -3.0
		inter_unit_spacing		4.0
		priority			0.3
	end_block

	;; right flank cav
	begin_block 22
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			square
		block_relative_pos		8 5.0 1.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; right flank cav(more)
	begin_block 23
		not_general
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			square
		block_relative_pos		22 1.0 -3.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; left flank missile cav(decides to support the flank more)
	begin_block 24
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		20 -5.0 1.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; right flank missile cav(decides to support the flank more)
	begin_block 25
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		22 5.0 1.0
		inter_unit_spacing		0.2
		priority			0.7
	end_block

end_formation


begin_formation ai_roman_precursor_line_enhanced_deploy

	;;; purpose flags - deploy, defending
	defend

	ai_priority				2.95

	supported_factions			romans_julii,

	;; First cohort with Eagle
	begin_block 0
		min_units				1
		max_units				1
		unit_type				heavy_pilum_infantry 2.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		20.0
		priority			1.0
	end_block

	;; first line of the legion - legionarii- reference center
	begin_block 1
		min_units				1
		max_units				1
		not_general
		unit_type				heavy_pilum_infantry 1.95
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		20.0
		priority			0.50
	end_block

	;; first line of the legion - left of centre
	begin_block 2
		min_units				1
		max_units				2
		not_general
		unit_type				heavy_pilum_infantry 1.95
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		1 -20.0 0.0
		inter_unit_spacing		20.0
		priority			0.70
	end_block

	;; first line of the legion - right of centre
	begin_block 3
		min_units				1
		max_units				2
		not_general
		unit_type				heavy_pilum_infantry 1.95
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		1 20.0 0.0
		inter_unit_spacing		20.0
		priority			0.70
	end_block

	;; second line of the legion - legionarii
	begin_block 4
		min_units				3
		max_units				6
		not_general
		unit_type				heavy_pilum_infantry 1.2
		default_melee_state		fire_at_will
		unit_formation			shield_wall, testudo, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		20.0
		priority			0.95
	end_block

	;; left flank spears
	begin_block 5
		not_general
		unit_type				non_phalanx_spear 1.0
		unit_type				general_unit infantry 3.0
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		4 -5.0 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; right_flank spears
	begin_block 6
		not_general
		unit_type				non_phalanx_spear 1.0
		unit_type				general_unit infantry 3.0
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		4 5.0 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; third line of infantry - spearmen
	begin_block 7
		not_general
		unit_type				spearmen_pilum_infantry 2.0
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		4 0.0 -10.0
		inter_unit_spacing		4.0
		priority			0.8
	end_block

	begin_dummy_block 8
		spans	4 5 6 7
	end_dummy_block

	; Screen of missile inf
	begin_block 9
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 30.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; Archers behind
	begin_block 10
		max_units				4
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		8 0.0 -30.0
		inter_unit_spacing		6.0
		priority			0.6
	end_block

	;; commander at the back
	begin_block 11
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		8 0.0 -25.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 12
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		11 0.0 -10.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; light infantry attachment
	begin_block 13
		unit_type				light infantry 1.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		12 0.0 -5.0
		inter_unit_spacing		20.0
		priority			0.1
	end_block

	;; any behind
	begin_block 14
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		13 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handlers left side
	begin_block 15
		;max_units				1
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		11 -10.0 0.0
		inter_unit_spacing		2.0
		priority			0.1
	end_block

	;; artillery and handlers right side
	begin_block 16
		;max_units				1
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		11 10.0 0.0
		inter_unit_spacing		2.0
		priority			0.1
	end_block

	begin_dummy_block 17
		spans	11 12 13 14 15 16
	end_dummy_block

	begin_block 18
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		17 -20.0 -5.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_dummy_block 19
		spans	0 1 2 3 8 9 10 17
	end_dummy_block

	;; cavalry on the flanks and topwards back

	;; left flank cav
	begin_block 20
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		8 -5.0 -1.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank cav(more)
	begin_block 21
		not_general
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		20 -10.0 -3.0
		inter_unit_spacing		2.0
		priority			0.3
	end_block

	;; right flank cav
	begin_block 22
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		8 5.0 -1.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; right flank cav(more)
	begin_block 23
		not_general
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		22 10.0 -3.0
		inter_unit_spacing		2.0
		priority			0.4
	end_block

	;; left flank missile cav(decides to support the flank more)
	begin_block 24
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		20 -5.0 1.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile cav(decides to support the flank more)
	begin_block 25
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		22 5.0 1.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

end_formation


;The formation attacks and Various swap of positions create a super roman mobile force. The discipline and effectiveness of the formation is unparalleled.
begin_formation ai_roman_precursor_line_enhanced_attack

	;;; purpose flags - attacking
	attack
	march

	ai_priority				2.95

	supported_factions			romans_julii,

	;; First cohort with Eagle
	begin_block 0
		min_units				1
		max_units				1
		unit_type				heavy_pilum_infantry 2.0
		default_melee_state		fire_at_will
		;unit_formation			square, testudo
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		20.0
		priority			1.0
	end_block

	;; first line of the legion - legionarii- reference center
	begin_block 1
		min_units				1
		max_units				1
		not_general
		unit_type				heavy_pilum_infantry 1.95
		default_melee_state		fire_at_will
		;unit_formation			square, testudo
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		20.0
		priority			0.50
	end_block

	;; first line of the legion - left of centre
	begin_block 2
		min_units				1
		max_units				2
		not_general
		unit_type				heavy_pilum_infantry 1.95
		default_melee_state		fire_at_will
		;unit_formation			square, testudo
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		1 -20.0 0.0
		inter_unit_spacing		20.0
		priority			0.70
	end_block

	;; first line of the legion - right of centre
	begin_block 3
		min_units				1
		max_units				2
		not_general
		unit_type				heavy_pilum_infantry 1.95
		default_melee_state		fire_at_will
		;unit_formation			square, testudo
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		1 20.0 0.0
		inter_unit_spacing		20.0
		priority			0.70
	end_block

	;; second line of the legion - legionarii
	begin_block 4
		min_units				3
		max_units				6
		not_general
		unit_type				heavy_pilum_infantry 1.2
		default_melee_state		fire_at_will
		;unit_formation			square, testudo
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		1 0.0 -15.0
		inter_unit_spacing		20.0
		priority			0.95
	end_block

	;; left flank spears
	begin_block 5
		not_general
		unit_type				non_phalanx_spear 1.0
		unit_type				general_unit infantry 3.0
		;unit_formation			shield_wall, square
		max_unit_width			24
		block_formation			line
		block_relative_pos		4 -5.0 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; right_flank spears
	begin_block 6
		not_general
		unit_type				non_phalanx_spear 1.0
		unit_type				general_unit infantry 3.0
		;unit_formation			shield_wall, square
		max_unit_width			24
		block_formation			line
		block_relative_pos		4 5.0 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; third line of infantry - spearmen
	begin_block 7
		not_general
		unit_type				spearmen_pilum_infantry 2.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		4 0.0 -10.0
		inter_unit_spacing		4.0
		priority			0.8
	end_block

	begin_dummy_block 8
		spans	4 5 6 7
	end_dummy_block

	; Screen of missile inf
	begin_block 9
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 20.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; Archers behind
	begin_block 10
		max_units				4
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		8 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; commander at the back
	begin_block 11
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		8 0.0 -40.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 12
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		11 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; light infantry attachment
	begin_block 13
		unit_type				light infantry 1.0
		default_melee_state		fire_at_will
		max_unit_width			30
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		0.2
		priority			0.1
	end_block

	;; any behind
	begin_block 14
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		13 0.0 10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handlers left side
	begin_block 15
		;max_units				1
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		14 -10.0 0.0
		inter_unit_spacing		2.0
		priority			0.1
	end_block

	;; artillery and handlers right side
	begin_block 16
		;max_units				1
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		14 10.0 0.0
		inter_unit_spacing		2.0
		priority			0.1
	end_block

	begin_dummy_block 17
		spans	11 12 13 14 15 16
	end_dummy_block

	begin_block 18
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		8 -30.0 20.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_dummy_block 19
		spans	0 1 2 3 8 9 10 17
	end_dummy_block

	;; cavalry on the flanks and topwards back

	;; left flank cav
	begin_block 20
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		2 -25.0 1.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank cav(more)
	begin_block 21
		not_general
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		20 -10.0 -3.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;; right flank cav
	begin_block 22
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		3 25.0 1.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; right flank cav(more)
	begin_block 23
		not_general
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		22 10.0 -3.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	;; left flank missile cav(decides to support the flank more)
	begin_block 24
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		20 -5.0 1.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile cav(decides to support the flank more)
	begin_block 25
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		22 5.0 1.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

end_formation


begin_formation ai_roman_precursor_line_enhanced_pursue

	;;; purpose flags - charging, pursue
	pursue
	march

	ai_priority				2.95

	supported_factions			romans_julii,

	;; First cohort with Eagle
	begin_block 0
		min_units				1
		max_units				1
		unit_type				heavy_pilum_infantry 2.0
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, testudo, square
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; first line of the legion - legionarii- reference center
	begin_block 1
		min_units				1
		max_units				1
		not_general
		unit_type				heavy_pilum_infantry 1.95
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, testudo, square
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		10.0
		priority			0.50
	end_block

	;; first line of the legion - left of centre
	begin_block 2
		min_units				1
		max_units				2
		not_general
		unit_type				heavy_pilum_infantry 1.95
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, testudo, square
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 -10.0 0.0
		inter_unit_spacing		10.0
		priority			0.70
	end_block

	;; first line of the legion - right of centre
	begin_block 3
		min_units				1
		max_units				2
		not_general
		unit_type				heavy_pilum_infantry 1.95
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, testudo, square
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 10.0 0.0
		inter_unit_spacing		10.0
		priority			0.70
	end_block

	;; second line of the legion - legionarii
	begin_block 4
		min_units				3
		max_units				6
		not_general
		unit_type				heavy_pilum_infantry 1.2
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, testudo, square
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -15.0
		inter_unit_spacing		10.0
		priority			0.95
	end_block

	;; left flank spears
	begin_block 5
		not_general
		unit_type				non_phalanx_spear 1.0
		unit_type				general_unit infantry 3.0
		unit_formation			shield_wall, square
		max_unit_width			24
		block_formation			line
		block_relative_pos		4 -5.0 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; right_flank spears
	begin_block 6
		not_general
		unit_type				non_phalanx_spear 1.0
		unit_type				general_unit infantry 3.0
		unit_formation			shield_wall, square
		max_unit_width			24
		block_formation			line
		block_relative_pos		4 5.0 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; third line of infantry - spearmen
	begin_block 7
		not_general
		unit_type				spearmen_pilum_infantry 2.0
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		4 0.0 -10.0
		inter_unit_spacing		4.0
		priority			0.8
	end_block

	begin_dummy_block 8
		spans	0 1 2 3 4 5 6 7
	end_dummy_block

	; Screen of missile inf
	begin_block 9
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		;unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		8 0.0 -10.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; Archers behind
	begin_block 10
		max_units				4
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 0.0 -20.0
		inter_unit_spacing		6.0
		priority			0.6
	end_block

	;; commander at the back
	begin_block 11
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		8 0.0 -30.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 12
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		11 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; light infantry attachment
	begin_block 13
		unit_type				light infantry 1.0
		default_melee_state		fire_at_will
		max_unit_width			40
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		0.2
		priority			0.1
	end_block

	;; any behind
	begin_block 14
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		13 0.0 10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handlers left side
	begin_block 15
		;max_units				1
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		14 -10.0 0.0
		inter_unit_spacing		2.0
		priority			0.1
	end_block

	;; artillery and handlers right side
	begin_block 16
		;max_units				1
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		14 10.0 0.0
		inter_unit_spacing		2.0
		priority			0.1
	end_block

	begin_dummy_block 17
		spans	13 14 15 16
	end_dummy_block

	begin_block 18
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			40
		block_formation			line
		block_relative_pos		8 5.0 10.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_dummy_block 19
		spans	0 1 2 3 8 9 10 17
	end_dummy_block

	;; cavalry on the flanks and topwards back

	;; left flank cav
	begin_block 20
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		8 -5.0 -1.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank cav(more)
	begin_block 21
		not_general
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		20 -30.0 3.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;; right flank cav
	begin_block 22
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		8 5.0 -1.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; right flank cav(more)
	begin_block 23
		not_general
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		22 30.0 3.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	;; left flank missile cav(decides to support the flank more)
	begin_block 24
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		20 -5.0 -1.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile cav(decides to support the flank more)
	begin_block 25
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		22 5.0 1.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

end_formation


;the multirole swap of the formation will make cavalry to envelop the enemy.
begin_formation ai_roman_precursor_line_enhanced_approach

	;;; purpose flags - approaching
	attack
	defend

	ai_priority				2.95

	supported_factions			romans_julii,

	;; First cohort with Eagle
	begin_block 0
		min_units				1
		max_units				1
		unit_type				heavy_pilum_infantry 2.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		20.0
		priority			1.0
	end_block

	;; first line of the legion - legionarii- reference center
	begin_block 1
		min_units				1
		max_units				1
		not_general
		unit_type				heavy_pilum_infantry 1.95
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		20.0
		priority			0.50
	end_block

	;; first line of the legion - left of centre
	begin_block 2
		min_units				1
		max_units				2
		not_general
		unit_type				heavy_pilum_infantry 1.95
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		1 -20.0 0.0
		inter_unit_spacing		20.0
		priority			0.70
	end_block

	;; first line of the legion - right of centre
	begin_block 3
		min_units				1
		max_units				2
		not_general
		unit_type				heavy_pilum_infantry 1.95
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		1 20.0 0.0
		inter_unit_spacing		20.0
		priority			0.70
	end_block

	;; second line of the legion - legionarii
	begin_block 4
		min_units				3
		max_units				6
		not_general
		unit_type				heavy_pilum_infantry 1.2
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, testudo, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		1 0.0 -15.0
		inter_unit_spacing		4.0
		priority			0.95
	end_block

	;; left flank spears
	begin_block 5
		not_general
		unit_type				non_phalanx_spear 1.0
		unit_type				general_unit infantry 3.0
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		4 -5.0 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; right_flank spears
	begin_block 6
		not_general
		unit_type				non_phalanx_spear 1.0
		unit_type				general_unit infantry 3.0
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		4 5.0 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; third line of infantry - spearmen
	begin_block 7
		not_general
		unit_type				spearmen_pilum_infantry 2.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		4 0.0 -10.0
		inter_unit_spacing		4.0
		priority			0.8
	end_block

	begin_dummy_block 8
		spans	4 5 6 7
	end_dummy_block

	; Screen of missile inf
	begin_block 9
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 30.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; Archers behind
	begin_block 10
		max_units				4
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		8 0.0 -30.0
		inter_unit_spacing		6.0
		priority			0.6
	end_block

	;; commander at the back
	begin_block 11
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		8 0.0 -30.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 12
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		11 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; light infantry attachment
	begin_block 13
		unit_type				light infantry 1.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		12 0.0 -5.0
		inter_unit_spacing		0.2
		priority			0.1
	end_block

	;; any behind
	begin_block 14
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		13 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handlers left side
	begin_block 15
		;max_units				1
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		11 -10.0 0.0
		inter_unit_spacing		2.0
		priority			0.1
	end_block

	;; artillery and handlers right side
	begin_block 16
		;max_units				1
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		11 10.0 0.0
		inter_unit_spacing		2.0
		priority			0.1
	end_block

	begin_dummy_block 17
		spans	11 12 13 14 15 16
	end_dummy_block

	begin_block 18
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		8 -20.0 1.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_dummy_block 19
		spans	0 1 2 3 8 9 10 17
	end_dummy_block

	;; cavalry on the flanks and topwards back

	;; left flank cav
	begin_block 20
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		8 -15.0 1.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank cav(more)
	begin_block 21
		not_general
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		20 -20.0 -3.0
		inter_unit_spacing		4.0
		priority			0.3
	end_block

	;; right flank cav
	begin_block 22
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		8 15.0 1.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; right flank cav(more)
	begin_block 23
		not_general
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		22 20.0 -3.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; left flank missile cav(decides to support the flank more)
	begin_block 24
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		20 -5.0 1.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile cav(decides to support the flank more)
	begin_block 25
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		22 5.0 1.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

end_formation



;****************************************************************************
;More historical formation for Romans with postmarian units
; (and other factions with precursor weapons) - Wedge - created by Sinuhet
;****************************************************************************

begin_formation special_Roman_wedge_march

	;;; purpose flags - regrouping
	march

	ai_priority				2.98

	supported_factions			romans_julii,

	;; First cohort with Eagle
	begin_block 0
		min_units				1
		max_units				1
		unit_type				heavy_pilum_infantry 1.0
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	;; First line of infantry
	begin_block 1
		min_units				1
		max_units				1
		unit_type				heavy_pilum_infantry 1.0
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 0.0 90.0
		inter_unit_spacing		3.0
		priority			0.95
	end_block

	;; second line of infantry
	begin_block 2
		min_units				3
		max_units				3
		unit_type				heavy_pilum_infantry 1.0
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		1 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.95
	end_block

	;; 3rd line of infantry
	begin_block 3
		min_units				5
		max_units				5
		unit_type				heavy_pilum_infantry 1.0
		;default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		2 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.9
	end_block

	;; 4th line of infantry
	begin_block 4
		min_units				3
		max_units				7
		unit_type				heavy_pilum_infantry 1.0
		;default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		3 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.8
	end_block

	begin_dummy_block 5
		spans	0 1 2 3 4
	end_dummy_block

	;; general at the back, inserted by Sinuhet
	begin_block 6
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		5 0.0 -25.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 7
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		6 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry on the flanks

	;; left flank cav
	begin_block 8
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		5 -10.0 0.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank cav
	begin_block 9
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		5 10.0 0.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; left flank missile cav
	begin_block 10
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		8 -5.0 0.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; right flank missile cav
	begin_block 11
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		9 5.0 0.0
		inter_unit_spacing		0.2
		priority			0.7
	end_block

	;; Line of missile inf
	begin_block 12
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		5 0.0 -10.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; Archers behind
	begin_block 13
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend	; was defend_and_skirmish
		max_unit_width			15
		block_formation			line
		block_relative_pos		7 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; artillery and handlers at the back
	begin_block 14
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				any 0.001
		default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			line
		block_relative_pos		13 0.0 -10.0
		inter_unit_spacing		2.0
		priority			0.1
	end_block

end_formation


begin_formation special_Roman_wedge_attack

	;;; purpose flags - attacking
	attack
	march

	ai_priority				2.98

	supported_factions			romans_julii,

	;; First cohort with Eagle
	begin_block 0
		min_units				1
		max_units				1
		unit_type				heavy_pilum_infantry 1.0
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		1.0
		priority			1.0
	end_block

	;; First line of infantry
	begin_block 1
		min_units				1
		max_units				1
		unit_type				heavy_pilum_infantry 1.0
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 90.0
		inter_unit_spacing		1.0
		priority			0.95
	end_block

	;; second line of infantry
	begin_block 2
		min_units				3
		max_units				3
		unit_type				heavy_pilum_infantry 1.0
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		1 0.0 -5.0
		inter_unit_spacing		1.0
		priority			0.95
	end_block

	;; 3rd line of infantry
	begin_block 3
		min_units				5
		max_units				5
		unit_type				heavy_pilum_infantry 1.0
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		2 0.0 -5.0
		inter_unit_spacing		1.0
		priority			0.9
	end_block

	;; 4th line of infantry
	begin_block 4
		min_units				3
		max_units				7
		unit_type				heavy_pilum_infantry 1.0
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		3 0.0 -5.0
		inter_unit_spacing		1.0
		priority			0.8
	end_block

	begin_dummy_block 5
		spans	0 1 2 3 4
	end_dummy_block

	;; general at the back, inserted by Sinuhet
	begin_block 6
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 7
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		6 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry on the flanks

	;; left flank cav
	begin_block 8
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		5 -10.0 0.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank cav
	begin_block 9
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		5 10.0 0.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; left flank missile cav
	begin_block 10
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		8 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile cav
	begin_block 11
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		9 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; Line of missile inf
	begin_block 12
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			column
		block_relative_pos		6 0.0 -10.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; Archers behind
	begin_block 13
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend	; was defend_and_skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; artillery and handlers at the back
	begin_block 14
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				any 0.001
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		13 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.1
	end_block

end_formation


begin_formation special_Roman_wedge_pursue

	;;; purpose flags - charging, pursue
	pursue
	march

	ai_priority				2.98

	supported_factions			romans_julii,

	;; First cohort with Eagle
	begin_block 0
		min_units				1
		max_units				1
		unit_type				heavy_pilum_infantry 1.0
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		1.0
		priority			1.0
	end_block

	;; First line of infantry
	begin_block 1
		min_units				1
		max_units				1
		unit_type				heavy_pilum_infantry 1.0
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 90.0
		inter_unit_spacing		1.0
		priority			0.95
	end_block

	;; second line of infantry
	begin_block 2
		min_units				3
		max_units				3
		unit_type				heavy_pilum_infantry 1.0
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		1 0.0 -5.0
		inter_unit_spacing		1.0
		priority			0.95
	end_block

	;; 3rd line of infantry
	begin_block 3
		min_units				5
		max_units				5
		unit_type				heavy_pilum_infantry 1.0
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		2 0.0 -5.0
		inter_unit_spacing		1.0
		priority			0.9
	end_block

	;; 4th line of infantry
	begin_block 4
		min_units				3
		max_units				7
		unit_type				heavy_pilum_infantry 1.0
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		3 0.0 -5.0
		inter_unit_spacing		1.0
		priority			0.8
	end_block

	begin_dummy_block 5
		spans	0 1 2 3 4
	end_dummy_block

	;; general at the back, inserted by Sinuhet
	begin_block 6
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		5 0.0 -30.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 7
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		6 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry on the flanks

	;; left flank cav
	begin_block 8
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		5 -10.0 10.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank cav
	begin_block 9
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		5 10.0 10.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; left flank missile cav
	begin_block 10
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		8 -5.0 -10.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile cav
	begin_block 11
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		9 5.0 -10.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; Line of missile inf
	begin_block 12
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 0.0 -10.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; Archers behind
	begin_block 13
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend	; was defend_and_skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; artillery and handlers at the back
	begin_block 14
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				any 0.001
		;default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		13 0.0 -10.0
		inter_unit_spacing		2.0
		priority			0.1
	end_block

end_formation


begin_formation special_Roman_wedge_approach

	;;; purpose flags - approaching, deploy
	defend
	attack

	ai_priority				2.98

	supported_factions			romans_julii,

	;; First cohort with Eagle
	begin_block 0
		min_units				1
		max_units				1
		unit_type				heavy_pilum_infantry 1.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		1.0
		priority			1.0
	end_block

	;; First line of infantry
	begin_block 1
		min_units				1
		max_units				1
		unit_type				heavy_pilum_infantry 1.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 90.0
		inter_unit_spacing		1.0
		priority			0.95
	end_block

	;; second line of infantry
	begin_block 2
		min_units				3
		max_units				3
		unit_type				heavy_pilum_infantry 1.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		1 0.0 -5.0
		inter_unit_spacing		1.0
		priority			0.95
	end_block

	;; 3rd line of infantry
	begin_block 3
		min_units				5
		max_units				5
		unit_type				heavy_pilum_infantry 1.0
		;default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		2 0.0 -5.0
		inter_unit_spacing		1.0
		priority			0.9
	end_block

	;; 4th line of infantry
	begin_block 4
		min_units				3
		max_units				7
		unit_type				heavy_pilum_infantry 1.0
		;default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		3 0.0 -5.0
		inter_unit_spacing		1.0
		priority			0.8
	end_block

	begin_dummy_block 5
		spans	0 1 2 3 4
	end_dummy_block

	;; general at the back, inserted by Sinuhet
	begin_block 6
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		5 0.0 -25.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 7
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		6 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry on the flanks

	;; left flank cav
	begin_block 8
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		5 -10.0 0.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank cav
	begin_block 9
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		5 10.0 0.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; left flank missile cav
	begin_block 10
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		8 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile cav
	begin_block 11
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		9 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; Line of missile inf
	begin_block 12
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		5 0.0 -10.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; Archers behind
	begin_block 13
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		7 0.0 -30.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; artillery and handlers at the back
	begin_block 14
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				any 0.001
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		13 0.0 -10.0
		inter_unit_spacing		2.0
		priority			0.1
	end_block

end_formation



;***************************************************************************************************************************************
; Byzantine formation mentioned in "strategikon".The skirmishers/missile units or light infantry
; form a line in front. Heavy cavalry is following and then cover of heavy infantry. Large reserve forces wait behind for support on demand
; Orientalized roman formation, represent army of Marc Anthony in Parthia campaign
;***************************************************************************************************************************************

;Infantry AI will form shielwall around the general. Missiles ahead. cavalry will cover them from behind. The cleverest formation of all!
begin_formation ai_byzantine_line_march

	;;; purpose flags - regrouping
	march

	ai_priority				2.25

	supported_factions			romans_julii,

	; Screen of missile inf
	begin_block 0
		max_units				8
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; the heavy troops that advance
	begin_block 1
		min_units				3
		max_units				6
		not_general
		unit_type				heavy infantry 1.0
		;unit_formation			shield_wall, square, testudo
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 0.0 -6.0
		inter_unit_spacing		6.0
		priority			0.8
	end_block

	;; the reserve are mostly spearmen
	begin_block 2
		min_units				3
		max_units				4
		not_general
		unit_type				non_phalanx_spear 0.9
		unit_type				spearmen_pilum_infantry 0.1
		;default_melee_state		defend
		;unit_formation			shield_wall, square, horde
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		1 0.0 -6.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; the reserve are mostly spearmen (2)
	begin_block 3
		min_units				1
		max_units				2
		not_general
		unit_type				spearmen_pilum_infantry 0.9
		unit_type				non_phalanx_spear 0.1
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		2 0.0 -2.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	begin_dummy_block 4
		spans	1 2 3
	end_dummy_block

	;; archers behind
	begin_block 5
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		4 0.0 -20.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	;; commander at the center
	begin_block 6
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		4 0.0 -20.0
		inter_unit_spacing		0.2
		priority			2.0
	end_block

	;; VIP is here
	begin_block 7
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		;unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		6 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; the reserve are mostly spearmen (3) left Protecting and following the general.
	begin_block 8
		min_units				1
		max_units				1
		not_general
		unit_type				spearmen_pilum_infantry 0.9
		unit_type				non_phalanx_spear 0.1
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		6 -10.0 0.0
		inter_unit_spacing		2.0
		priority			0.1
	end_block

	;; the reserve are mostly spearmen (3) right Protecting and following the general.
	begin_block 9
		min_units				1
		max_units				1
		not_general
		unit_type				spearmen_pilum_infantry 0.9
		unit_type				non_phalanx_spear 0.1
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		6 10.0 0.0
		inter_unit_spacing		2.0
		priority			0.1
	end_block

	;; the reserve for foot nobles
	begin_block 10
		unit_type				general_unit infantry 3.0
		unit_type				chanting_screeching 3.0
		;unit_formation			square
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		7 0.0 -5.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; light infantry attachment
	begin_block 11
		unit_type				light infantry 1.0
		unit_type				skirmish infantry 0.5
		unit_type				missile infantry 0.1
		default_melee_state		skirmish
		unit_formation			square
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		10 0.0 -5.0
		inter_unit_spacing		2.0
		priority			0.1
	end_block

	begin_block 12
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		max_unit_width			15
		block_formation			line
		block_relative_pos		11 0.0 -1.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; put the cavalry ahead of everyone
	begin_dummy_block 13
		spans	0 5 6 7 8 9 10 11 12
	end_dummy_block

	;; Heavy cavalry goes right
	begin_block 14
		;min_units				2
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		unit_density			close
		max_unit_width			15
		block_formation			square
		block_relative_pos		13 10.0 0.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	;; support cavalry left
	begin_block 15
		not_general
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		13 -10.0 0.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	begin_block 16
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			20
		block_formation			column
		block_relative_pos		4 -20.0 1.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; any behind
	begin_block 17
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		13 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation


;Infantry AI will form shielwall around the general. Missiles ahead. cavalry will cover them from behind. The cleverest formation of all!
begin_formation ai_byzantine_line_deploy

	;;; purpose flags - deploy, defending
	defend
	march

	ai_priority				2.25

	supported_factions			romans_julii,

	; Screen of missile inf
	begin_block 0
		max_units				8
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; the heavy troops that advance
	begin_block 1
		min_units				3
		max_units				6
		not_general
		unit_type				heavy infantry 1.0
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square, testudo
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		6.0
		priority			0.8
	end_block

	;; the reserve are mostly spearmen
	begin_block 2
		min_units				3
		max_units				4
		not_general
		unit_type				non_phalanx_spear 0.9
		unit_type				spearmen_pilum_infantry 0.1
		default_melee_state		defend
		unit_formation			shield_wall, square, horde
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -6.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; the reserve are mostly spearmen (2)
	begin_block 3
		min_units				1
		max_units				2
		not_general
		unit_type				spearmen_pilum_infantry 0.9
		unit_type				non_phalanx_spear 0.1
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		2 0.0 -2.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	begin_dummy_block 4
		spans	1 2 3
	end_dummy_block

	;; archers behind
	begin_block 5
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 0.0 -30.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	;; commander at the center
	begin_block 6
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		4 0.0 -40.0
		inter_unit_spacing		0.2
		priority			2.0
	end_block

	;; VIP is here
	begin_block 7
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		6 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; the reserve are mostly spearmen (3) left Protecting and following the general.
	begin_block 8
		min_units				1
		max_units				1
		not_general
		unit_type				spearmen_pilum_infantry 0.9
		unit_type				non_phalanx_spear 0.1
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 -10.0 0.0
		inter_unit_spacing		2.0
		priority			0.1
	end_block

	;; the reserve are mostly spearmen (3) right Protecting and following the general.
	begin_block 9
		min_units				1
		max_units				1
		not_general
		unit_type				spearmen_pilum_infantry 0.9
		unit_type				non_phalanx_spear 0.1
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 10.0 0.0
		inter_unit_spacing		2.0
		priority			0.1
	end_block

	;; the reserve for foot nobles
	begin_block 10
		unit_type				general_unit infantry 3.0
		unit_type				chanting_screeching 3.0
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		7 0.0 -5.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; light infantry attachment
	begin_block 11
		unit_type				light infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		10 0.0 -5.0
		inter_unit_spacing		2.0
		priority			0.1
	end_block

	begin_block 12
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		11 0.0 -3.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; put the cavalry behind of everyone
	begin_dummy_block 13
		spans	5 6 7 8 9 10 11 12
	end_dummy_block

	;; Heavy cavalry forms a mass ahead.
	begin_block 14
		;min_units				2
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		13 20.0 -10.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	;; support cavalry behind
	begin_block 15
		not_general
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		13 -20.0 -10.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	begin_block 16
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		13 -20.0 -5.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; any behind
	begin_block 17
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		13 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation


;the formation attacks and sends the skirmishers to provoke the enemy.The vanguard stays well behind. Also cavalry comes upfront to be ready for a charge.
begin_formation ai_byzantine_line_attack

	;;; purpose flags - attacking
	attack
	march

	ai_priority				2.25

	supported_factions			romans_julii,

	; Screen of missile inf
	begin_block 0
		max_units				8
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 10.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; the heavy troops that advance
	begin_block 1
		min_units				3
		max_units				6
		not_general
		unit_type				heavy infantry 1.0
		;unit_formation			square, testudo
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		6.0
		priority			0.8
	end_block

	;; the reserve are mostly spearmen
	begin_block 2
		min_units				3
		max_units				4
		not_general
		unit_type				non_phalanx_spear 0.9
		unit_type				spearmen_pilum_infantry 0.1
		default_melee_state		defend
		;unit_formation			shield_wall, square, horde
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -6.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; the reserve are mostly spearmen (2)
	begin_block 3
		min_units				1
		max_units				2
		not_general
		unit_type				spearmen_pilum_infantry 0.9
		unit_type				non_phalanx_spear 0.1
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		2 0.0 -2.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	begin_dummy_block 4
		spans	1 2 3
	end_dummy_block

	;; archers behind
	begin_block 5
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 0.0 -20.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	;; commander at the center
	begin_block 6
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		4 0.0 -35.0
		inter_unit_spacing		0.2
		priority			2.0
	end_block

	;; VIP is here
	begin_block 7
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		6 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; the reserve are mostly spearmen (3) left Protecting and following the general.
	begin_block 8
		min_units				1
		max_units				1
		not_general
		unit_type				spearmen_pilum_infantry 0.9
		unit_type				non_phalanx_spear 0.1
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 -10.0 0.0
		inter_unit_spacing		2.0
		priority			0.1
	end_block

	;; the reserve are mostly spearmen (3) right Protecting and following the general.
	begin_block 9
		min_units				1
		max_units				1
		not_general
		unit_type				spearmen_pilum_infantry 0.9
		unit_type				non_phalanx_spear 0.1
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 10.0 0.0
		inter_unit_spacing		2.0
		priority			0.1
	end_block

	;; the reserve for foot nobles
	begin_block 10
		unit_type				general_unit infantry 3.0
		unit_type				chanting_screeching 3.0
		;unit_formation			square
		;unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		7 0.0 -15.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; light infantry attachment
	begin_block 11
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		;unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		10 0.0 -5.0
		inter_unit_spacing		2.0
		priority			0.1
	end_block

	begin_block 12
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		max_unit_width			24
		block_formation			line
		block_relative_pos		11 0.0 -1.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; put the cavalry and missile ahead of everyone
	begin_dummy_block 13
		spans	0 5 6 7 8 9 10 11 12
	end_dummy_block

	;; Heavy cavalry forms a mass ahead.(made it right)
	begin_block 14
		;min_units				2
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		4 10.0 8.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	;; support cavalry behind(made it left)
	begin_block 15
		not_general
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		4 -10.0 8.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	begin_block 16
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 -30.0 20.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; any behind
	begin_block 17
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		13 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation


begin_formation ai_byzantine_line_pursue

	;;; purpose flags - charging, pursue
	pursue

	ai_priority				2.25

	supported_factions			romans_julii,

	; Screen of missile inf
	begin_block 0
		max_units				8
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; the heavy troops that advance
	begin_block 1
		min_units				3
		max_units				6
		not_general
		unit_type				heavy infantry 1.0
		unit_formation			shield_wall, square, testudo
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		6.0
		priority			0.8
	end_block

	;; the reserve are mostly spearmen
	begin_block 2
		min_units				3
		max_units				4
		not_general
		unit_type				non_phalanx_spear 0.9
		unit_type				spearmen_pilum_infantry 0.1
		default_melee_state		defend
		unit_formation			shield_wall, square, horde
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -6.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; the reserve are mostly spearmen (2)
	begin_block 3
		min_units				1
		max_units				2
		not_general
		unit_type				spearmen_pilum_infantry 0.9
		unit_type				non_phalanx_spear 0.1
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		2 0.0 -2.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	begin_dummy_block 4
		spans	1 2 3
	end_dummy_block

	;; archers behind
	begin_block 5
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 0.0 -20.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	;; commander at the center
	begin_block 6
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		4 0.0 -40.0
		inter_unit_spacing		0.2
		priority			2.0
	end_block

	;; VIP is here
	begin_block 7
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		6 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; the reserve are mostly spearmen (3) left Protecting and following the general.
	begin_block 8
		min_units				1
		max_units				1
		not_general
		unit_type				spearmen_pilum_infantry 0.9
		unit_type				non_phalanx_spear 0.1
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 -10.0 0.0
		inter_unit_spacing		2.0
		priority			0.1
	end_block

	;; the reserve are mostly spearmen (3) right Protecting and following the general.
	begin_block 9
		min_units				1
		max_units				1
		not_general
		unit_type				spearmen_pilum_infantry 0.9
		unit_type				non_phalanx_spear 0.1
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 10.0 0.0
		inter_unit_spacing		2.0
		priority			0.1
	end_block

	;; the reserve for foot nobles
	begin_block 10
		unit_type				general_unit infantry 3.0
		unit_type				chanting_screeching 3.0
		;unit_formation			square
		;unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		7 0.0 -5.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; light infantry attachment
	begin_block 11
		unit_type				light infantry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		10 0.0 -5.0
		inter_unit_spacing		2.0
		priority			0.1
	end_block

	begin_block 12
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		max_unit_width			24
		block_formation			line
		block_relative_pos		11 0.0 -1.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; put the cavalry and missile ahead of everyone
	begin_dummy_block 13
		spans	0 5 6 7 8 9 10 11 12
	end_dummy_block

	;; Heavy cavalry forms a mass ahead.
	begin_block 14
		;min_units				2
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		unit_formation			wedge
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		4 0.0 40.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	;; support cavalry behind
	begin_block 15
		not_general
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		14 0.0 8.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	begin_block 16
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 5.0 10.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; any behind
	begin_block 17
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		13 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation


;the multirole swap of the formation will make cavalry to envelop from flanks.
begin_formation ai_byzantine_line_approach

	;;; purpose flags - approaching
	attack
	defend
	march

	ai_priority				2.25

	supported_factions			romans_julii,

	; Screen of missile inf
	begin_block 0
		max_units				8
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; the heavy troops that advance
	begin_block 1
		min_units				3
		max_units				6
		not_general
		unit_type				heavy infantry 1.0
		;unit_formation			shield_wall, square, testudo
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 -6.0
		inter_unit_spacing		6.0
		priority			0.8
	end_block

	;; the reserve are mostly spearmen
	begin_block 2
		min_units				3
		max_units				4
		not_general
		unit_type				non_phalanx_spear 0.9
		unit_type				spearmen_pilum_infantry 0.1
		default_melee_state		defend
		;unit_formation			shield_wall, square, horde
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -6.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; the reserve are mostly spearmen (2)
	begin_block 3
		min_units				1
		max_units				2
		not_general
		unit_type				spearmen_pilum_infantry 0.9
		unit_type				non_phalanx_spear 0.1
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		2 0.0 -2.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	begin_dummy_block 4
		spans	1 2 3
	end_dummy_block

	;; archers behind
	begin_block 5
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 0.0 -30.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	;; commander at the center
	begin_block 6
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		4 0.0 -30.0
		inter_unit_spacing		0.2
		priority			2.0
	end_block

	;; VIP is here
	begin_block 7
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		6 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; the reserve are mostly spearmen (3) left Protecting and following the general.
	begin_block 8
		min_units				1
		max_units				1
		not_general
		unit_type				spearmen_pilum_infantry 0.9
		unit_type				non_phalanx_spear 0.1
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 -10.0 0.0
		inter_unit_spacing		2.0
		priority			0.1
	end_block

	;; the reserve are mostly spearmen (3) right Protecting and following the general.
	begin_block 9
		min_units				1
		max_units				1
		not_general
		unit_type				spearmen_pilum_infantry 0.9
		unit_type				non_phalanx_spear 0.1
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 10.0 0.0
		inter_unit_spacing		2.0
		priority			0.1
	end_block

	;; the reserve for foot nobles
	begin_block 10
		unit_type				general_unit infantry 3.0
		unit_type				chanting_screeching 3.0
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		7 0.0 -5.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; light infantry attachment
	begin_block 11
		unit_type				light infantry 1.0
		unit_type				skirmish infantry 0.5
		unit_type				missile infantry 0.1
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		10 0.0 -5.0
		inter_unit_spacing		2.0
		priority			0.1
	end_block

	begin_block 12
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		11 0.0 -1.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; put the cavalry ahead of everyone
	begin_dummy_block 13
		spans	0 5 6 7 8 9 10 11 12
	end_dummy_block

	;; Heavy cavalry goes right
	begin_block 14
		;min_units				2
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		13 10.0 0.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	;; support cavalry left
	begin_block 15
		not_general
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		13 -10.0 0.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	begin_block 16
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 -20.0 1.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; any behind
	begin_block 17
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		13 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation



;*********************************************************************************
; More historical formation for Romans with premarian units
; (and other factions with precursor weapons) - Single line - created by Sinuhet
; modified by Suppanut to have triarii at center instead of wing
;*********************************************************************************

begin_formation special_Roman_single_line_march

	;;; purpose flags - regrouping
	march

	ai_priority				2.25

	supported_factions			romans_julii,

	;; triarii line
	begin_block 0
		min_units				6
		max_units				8
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; hastati left side
	begin_block 1
		max_units				1
		unit_type				light_pilum_infantry 1.0
		;default_melee_state		fire_at_will_and_defend
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 -0.3 0.0
		inter_unit_spacing		0.3
		priority			0.9
	end_block

	;; hastati right side
	begin_block 2
		max_units				1
		unit_type				light_pilum_infantry 1.0
		;default_melee_state		fire_at_will_and_defend
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 0.3 0.0
		inter_unit_spacing		0.3
		priority			0.9
	end_block

	;; princeps left side
	begin_block 3
		max_units				1
		unit_type				heavy infantry 1.0
		;default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		1 -0.3 0.0
		inter_unit_spacing		0.3
		priority			0.9
	end_block

	;; princeps right side
	begin_block 4
		max_units				1
		unit_type				heavy infantry 1.0
		;default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		2 0.3 0.0
		inter_unit_spacing		0.3
		priority			0.9
	end_block

	begin_dummy_block 5
		spans	0 1 2 3 4
	end_dummy_block

	;; missile troops behind the infantry

	begin_block 6
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		;default_melee_state		skirmish
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		5 0.0 -10.0
		inter_unit_spacing		2.0
		priority			0.7
	end_block

	;; archers behind
	begin_block 7
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend	; was defend_and_skirmish
		max_unit_width			15
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; general
	begin_block 8
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		5 0.0 -35.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 9
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		8 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; artillery and handler on the sides

	begin_block 10
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			line
		block_relative_pos		9 -10.0 0.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 11
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			line
		block_relative_pos		9 10.0 0.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;; cavalry on the flanks

	;; left flank
	begin_block 13
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		12 -5.0 0.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank
	begin_block 14
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		12 5.0 0.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; left flank missile cav
	begin_block 15
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		;unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		13 -5.0 0.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; right flank missile cav
	begin_block 16
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		;unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		14 5.0 0.0
		inter_unit_spacing		0.2
		priority			0.7
	end_block

	;; any behind
	begin_block 17
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		16 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation


begin_formation special_Roman_single_line_attack

	;;; purpose flags - attacking
	attack

	ai_priority				2.25

	supported_factions			romans_julii,

	;; triarii line
	begin_block 0
		min_units				6
		max_units				8
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; hastati left side
	begin_block 1
		max_units				1
		unit_type				light_pilum_infantry 1.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close
		block_formation			line
		block_relative_pos		0 -0.3 0.0
		inter_unit_spacing		0.3
		priority			0.9
	end_block

	;; hastati right side
	begin_block 2
		max_units				1
		unit_type				light_pilum_infantry 1.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.3 0.0
		inter_unit_spacing		0.3
		priority			0.9
	end_block

	;; princeps left side
	begin_block 3
		max_units				1
		unit_type				heavy infantry 1.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close
		block_formation			line
		block_relative_pos		1 -0.3 0.0
		inter_unit_spacing		0.3
		priority			0.9
	end_block

	;; princeps right side
	begin_block 4
		max_units				1
		unit_type				heavy infantry 1.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close
		block_formation			line
		block_relative_pos		2 0.3 0.0
		inter_unit_spacing		0.3
		priority			0.9
	end_block

	begin_dummy_block 5
		spans	0 1 2 3 4
	end_dummy_block

	;; missile troops behind the infantry

	begin_block 6
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		;unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		5 0.0 -10.0
		inter_unit_spacing		2.0
		priority			0.7
	end_block

	;; archers behind
	begin_block 7
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend	; was defend_and_skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; general
	begin_block 8
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		5 0.0 -40.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 9
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		8 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; artillery and handler on the sides

	begin_block 10
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		7 -10.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 11
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		7 10.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;; cavalry on the flanks

	;; left flank
	begin_block 13
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		12 -5.0 0.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank
	begin_block 14
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		12 5.0 0.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; left flank missile cav
	begin_block 15
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		13 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile cav
	begin_block 16
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		14 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; any behind
	begin_block 17
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		12 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation


begin_formation special_Roman_single_line_pursue

	;;; purpose flags - charging, pursue
	pursue

	ai_priority				2.25

	supported_factions			romans_julii,

	;; triarii line
	begin_block 0
		min_units				6
		max_units				8
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; hastati left side
	begin_block 1
		max_units				1
		unit_type				light_pilum_infantry 1.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close
		block_formation			line
		block_relative_pos		0 -0.3 0.0
		inter_unit_spacing		0.3
		priority			0.9
	end_block

	;; hastati right side
	begin_block 2
		max_units				1
		unit_type				light_pilum_infantry 1.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.3 0.0
		inter_unit_spacing		0.3
		priority			0.9
	end_block

	;; princeps left side
	begin_block 3
		max_units				1
		unit_type				heavy infantry 1.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close
		block_formation			line
		block_relative_pos		1 -0.3 0.0
		inter_unit_spacing		0.3
		priority			0.9
	end_block

	;; princeps right side
	begin_block 4
		max_units				1
		unit_type				heavy infantry 1.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close
		block_formation			line
		block_relative_pos		2 0.3 0.0
		inter_unit_spacing		0.3
		priority			0.9
	end_block

	begin_dummy_block 5
		spans	0 1 2 3 4
	end_dummy_block

	;; missile troops behind the infantry

	begin_block 6
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		5 0.0 -10.0
		inter_unit_spacing		2.0
		priority			0.7
	end_block

	;; archers behind
	begin_block 7
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend	; was defend_and_skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; general
	begin_block 8
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		5 0.0 -30.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 9
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		8 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; artillery and handler on the sides

	begin_block 10
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 -10.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 11
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 10.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;; cavalry on the flanks

	;; left flank
	begin_block 13
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		12 -5.0 0.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank
	begin_block 14
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		12 5.0 0.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; left flank missile cav
	begin_block 15
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		13 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile cav
	begin_block 16
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		14 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; any behind
	begin_block 17
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		12 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation


begin_formation special_Roman_single_line_approach

	;;; purpose flags - put on early as using this to deploy instead of defend form
	defend
	attack

	ai_priority				2.25

	supported_factions			romans_julii,

	;; triarii line
	begin_block 0
		min_units				6
		max_units				8
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; hastati left side
	begin_block 1
		max_units				1
		unit_type				light_pilum_infantry 1.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		0 -0.3 0.0
		inter_unit_spacing		0.3
		priority			0.9
	end_block

	;; hastati right side
	begin_block 2
		max_units				1
		unit_type				light_pilum_infantry 1.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		0 0.3 0.0
		inter_unit_spacing		0.3
		priority			0.9
	end_block

	;; princeps left side
	begin_block 3
		max_units				1
		unit_type				heavy infantry 1.0
		;default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		1 -0.3 0.0
		inter_unit_spacing		0.3
		priority			0.9
	end_block

	;; princeps right side
	begin_block 4
		max_units				1
		unit_type				heavy infantry 1.0
		;default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		2 0.3 0.0
		inter_unit_spacing		0.3
		priority			0.9
	end_block

	begin_dummy_block 5
		spans	0 1 2 3 4
	end_dummy_block

	;; missile troops behind the infantry

	begin_block 6
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		5 0.0 -10.0
		inter_unit_spacing		2.0
		priority			0.7
	end_block

	;; archers behind
	begin_block 7
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		5 0.0 -30.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; general
	begin_block 8
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		5 0.0 -35.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 9
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		8 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; artillery and handler on the sides

	begin_block 10
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 -10.0 0.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 11
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 10.0 0.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;; cavalry on the flanks

	;; left flank
	begin_block 13
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		12 -5.0 0.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank
	begin_block 14
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		12 5.0 0.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; left flank missile cav
	begin_block 15
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		13 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile cav
	begin_block 16
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		14 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; any behind
	begin_block 17
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		16 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation


begin_formation special_Roman_single_line_defend

	;;; purpose flags - put after approach in sequence of file as this formation not suit for deployment
	defend

	ai_priority				2.25

	supported_factions			romans_julii,

	;; triarii line
	begin_block 0
		min_units				6
		max_units				8
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; hastati left side
	begin_block 1
		max_units				1
		unit_type				light_pilum_infantry 1.0
		default_melee_state		defend
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		0 -0.3 0.0
		inter_unit_spacing		0.3
		priority			0.9
	end_block

	;; hastati right side
	begin_block 2
		max_units				1
		unit_type				light_pilum_infantry 1.0
		default_melee_state		defend
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		0 0.3 0.0
		inter_unit_spacing		0.3
		priority			0.9
	end_block

	;; princeps left side
	begin_block 3
		max_units				1
		unit_type				heavy infantry 1.0
		default_melee_state		defend
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		1 -0.3 0.0
		inter_unit_spacing		0.3
		priority			0.9
	end_block

	;; princeps right side
	begin_block 4
		max_units				1
		unit_type				heavy infantry 1.0
		default_melee_state		defend
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		2 0.3 0.0
		inter_unit_spacing		0.3
		priority			0.9
	end_block

	begin_dummy_block 5
		spans	0 1 2 3 4
	end_dummy_block

	;; missile troops behind the infantry

	begin_block 6
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		5 0.0 -10.0
		inter_unit_spacing		2.0
		priority			0.7
	end_block

	;; archers behind
	begin_block 7
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		5 0.0 -30.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; general
	begin_block 8
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		5 0.0 -35.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 9
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		8 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; artillery and handler on the sides

	begin_block 10
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 -10.0 0.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 11
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 10.0 0.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;; cavalry on the flanks

	;; left flank
	begin_block 13
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		12 -5.0 0.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank
	begin_block 14
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		12 5.0 0.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; left flank missile cav
	begin_block 15
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		13 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile cav
	begin_block 16
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		14 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; any behind
	begin_block 17
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		12 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation



;**************************************************************************************************
; Roman Phalanx formation
; Modified from Phalanx triple line formation, , min 13 phalanx units (created by Sinuhet)
; Edited by Quinn Inuit to make it min 8 units and to move the rear 2 blocks to flanking positions
; Modified by Suppanut to make it single line in attempt to fix early reshuffling
;**************************************************************************************************

begin_formation roman_phalanx_1_march

	;;; purpose flags - regrouping
	march

	ai_priority				2.20

	supported_factions			romans_julii,

	; Screen of missile inf
	begin_block 0
		max_units				8
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		;default_melee_state		fire_at_will_and_skirmish
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; phalanx line
	begin_block 1
		min_units				3
		;max_units				6
		unit_type				phalanx 1.0
		;default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.3
		priority			1.0
	end_block

	;; archers behind the spearmen
	begin_block 2
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend	; was defend_and_skirmish
		max_unit_width			15
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 3
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.7
		unit_type				light infantry 0.8
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			square, testudo
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		1 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.7
	end_block

	;; right side
	begin_block 4
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.7
		unit_type				light infantry 0.8
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			square, testudo
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		1 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 5
		spans	1 2 3 4
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		1 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank
	begin_block 7
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		1 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; left flank missile cav
	begin_block 8
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		6 -5.0 0.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; right flank missile cav
	begin_block 9
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		7 5.0 0.0
		inter_unit_spacing		0.2
		priority			0.7
	end_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		10 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 12
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 13
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

end_formation


begin_formation roman_phalanx_1_deploy

	;;; purpose flags - deploy, defending
	defend

	ai_priority				2.20

	supported_factions			romans_julii,

	; Screen of missile inf
	begin_block 0
		max_units				8
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; phalanx line
	begin_block 1
		min_units				3
		;max_units				6
		unit_type				phalanx 1.0
		default_melee_state		defend
		unit_formation			phalanx
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.3
		priority			1.0
	end_block

	;; archers behind the spearmen
	begin_block 2
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -30.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 3
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.7
		unit_type				light infantry 0.8
		default_melee_state		defend
		;unit_formation			square, testudo
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		1 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.7
	end_block

	;; right side
	begin_block 4
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.7
		unit_type				light infantry 0.8
		default_melee_state		defend
		;unit_formation			square, testudo
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		1 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 5
		spans	1 2 3 4
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank
	begin_block 7
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; left flank missile cav
	begin_block 8
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		6 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile cav
	begin_block 9
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		7 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		10 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 12
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 13
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

end_formation


begin_formation roman_phalanx_1_attack

	;;; purpose flags - attacking
	attack

	ai_priority				2.20

	supported_factions			romans_julii,

	; Screen of missile inf
	begin_block 0
		max_units				8
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; phalanx line
	begin_block 1
		min_units				3
		;max_units				6
		unit_type				phalanx 1.0
		default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; archers behind the spearmen
	begin_block 2
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend	; was defend_and_skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 3
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.7
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square, testudo
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.7
	end_block

	;; right side
	begin_block 4
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.7
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square, testudo
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 5
		spans	1 2 3 4
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 -20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank
	begin_block 7
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; left flank missile cav
	begin_block 8
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		6 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile cav
	begin_block 9
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		7 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		10 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 12
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 13
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 0.0 -50.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

end_formation


begin_formation roman_phalanx_1_pursue

	;;; purpose flags - charging, pursue
	pursue

	ai_priority				2.20

	supported_factions			romans_julii,

	; Screen of missile inf
	begin_block 0
		max_units				8
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; first (center) spearmen line
	begin_block 1
		min_units				3
		;max_units				6
		unit_type				phalanx 1.0
		default_melee_state		defend
		unit_formation			phalanx
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 10.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; archers behind the spearmen
	begin_block 2
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend	; was defend_and_skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 3
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		;unit_formation			square, testudo
		unit_density			close
		block_formation			line
		block_relative_pos		1 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.7
	end_block

	;; right side
	begin_block 4
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		;unit_formation			square, testudo
		unit_density			close
		block_formation			line
		block_relative_pos		1 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 5
		spans	1 2 3 4
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 -20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank
	begin_block 7
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; left flank missile cav
	begin_block 8
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		6 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile cav
	begin_block 9
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		7 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		5 0.0 -30.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		10 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 12
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		11 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 13
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 0.0 -50.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

end_formation


begin_formation roman_phalanx_1_approach

	;;; purpose flags - approaching
	defend
	attack

	ai_priority				2.20

	supported_factions			romans_julii,

	; Screen of missile inf
	begin_block 0
		max_units				8
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; phalanx line
	begin_block 1
		min_units				3
		;max_units				6
		unit_type				phalanx 1.0
		default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.3
		priority			1.0
	end_block

	;; archers behind the spearmen
	begin_block 2
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -30.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 3
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.7
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square, testudo
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		1 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.7
	end_block

	;; right side
	begin_block 4
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.7
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square, testudo
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		1 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 5
		spans	1 2 3 4
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank
	begin_block 7
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; left flank missile cav
	begin_block 8
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		6 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile cav
	begin_block 9
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		7 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		10 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 12
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 13
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

end_formation



;**************************************************************************************************
; Roman Non-Phalanx line formation, min 9 spearmen
; Modified from Phalanx triple line formation, min 13 spearmen units (created by Sinuhet)
; Modified by Suppanut to make it min 9 spearmen units and single line
;**************************************************************************************************

begin_formation roman_nonphalanx_1_march

	;;; purpose flags - regrouping
	march

	ai_priority				2.10

	supported_factions			romans_julii,

	; Screen of missile inf
	begin_block 0
		max_units				8
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		;default_melee_state		fire_at_will_and_skirmish
		;unit_density			close		; always deploy and defend as close
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; spearmen line
	begin_block 1
		min_units				9
		;max_units				8
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.3
		priority			1.0
	end_block

	;; archers behind the spearmen
	begin_block 2
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend	; was defend_and_skirmish
		max_unit_width			15
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 3
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			square, testudo
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		1 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.7
	end_block

	;; right side
	begin_block 4
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.1
		unit_type				light infantry 0.8
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			square, testudo
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		1 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 5
		spans	1 2 3 4
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		1 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank
	begin_block 7
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		1 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; left flank missile cav
	begin_block 8
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		skirmish	; was defend_and_skirmish
		;unit_formation			square
		;unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		6 -5.0 0.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; right flank missile cav
	begin_block 9
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		skirmish	; was defend_and_skirmish
		;unit_formation			square
		;unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		7 5.0 0.0
		inter_unit_spacing		0.2
		priority			0.7
	end_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		10 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 12
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 13
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

end_formation


begin_formation roman_nonphalanx_1_deploy

	;;; purpose flags - deploy, defending
	defend

	ai_priority				2.10

	supported_factions			romans_julii,

	; Screen of missile inf
	begin_block 0
		max_units				8
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; spearmen line
	begin_block 1
		min_units				9
		;max_units				8
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.3
		priority			1.0
	end_block

	;; archers behind the spearmen
	begin_block 2
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -30.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 3
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.1
		unit_type				light infantry 0.8
		default_melee_state		defend
		;unit_formation			square, testudo
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		1 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.7
	end_block

	;; right side
	begin_block 4
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.1
		unit_type				light infantry 0.8
		default_melee_state		defend
		;unit_formation			square, testudo
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		1 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 5
		spans	1 2 3 4
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank
	begin_block 7
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; left flank missile cav
	begin_block 8
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		6 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile cav
	begin_block 9
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		7 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		10 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 12
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 13
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

end_formation


begin_formation roman_nonphalanx_1_attack

	;;; purpose flags - attacking
	attack

	ai_priority				2.10

	supported_factions			romans_julii,

	; Screen of missile inf
	begin_block 0
		max_units				8
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; spearmen line
	begin_block 1
		min_units				9
		;max_units				8
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; archers behind the spearmen
	begin_block 2
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend	; was defend_and_skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 3
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.1
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square, testudo
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.7
	end_block

	;; right side
	begin_block 4
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.1
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square, testudo
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 5
		spans	1 2 3 4
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 -20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank
	begin_block 7
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; left flank missile cav
	begin_block 8
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		6 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile cav
	begin_block 9
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		7 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		10 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 12
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 13
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 0.0 -40.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

end_formation


begin_formation roman_nonphalanx_1_pursue

	;;; purpose flags - attacking
	pursue

	ai_priority				2.10

	supported_factions			romans_julii,

	; Screen of missile inf
	begin_block 0
		max_units				8
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; first (center) spearmen line
	begin_block 1
		min_units				5
		max_units				8
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 15.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; second (left) spearmen line
	begin_block 2
		min_units				2
		max_units				6
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -2.0 5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; third (right) spearmen line
	begin_block 3
		min_units				2
		max_units				6
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 2.0 5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; archers behind the spearmen
	begin_block 4
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend	; was defend_and_skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 5
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.1
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		2 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.7
	end_block

	;; right side
	begin_block 6
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.1
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		3 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 7
		spans	1 2 3 4 5 6
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 8
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		7 -20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank
	begin_block 9
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		7 20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; left flank missile cav
	begin_block 10
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		8 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile cav
	begin_block 11
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		9 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; general at the back
	begin_block 12
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		7 0.0 -30.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 13
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		12 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 14
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		13 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 15
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		7 0.0 -50.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

end_formation


begin_formation roman_nonphalanx_1_approach

	;;; purpose flags - approaching
	defend
	attack

	ai_priority				2.10

	supported_factions			romans_julii,

	; Screen of missile inf
	begin_block 0
		max_units				8
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; spearmen line
	begin_block 1
		min_units				9
		;max_units				8
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.3
		priority			1.0
	end_block

	;; archers behind the spearmen
	begin_block 2
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -30.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 3
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square, testudo
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		1 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.7
	end_block

	;; right side
	begin_block 4
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.1
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square, testudo
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		1 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 5
		spans	1 2 3 4
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank
	begin_block 7
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; left flank missile cav
	begin_block 8
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		6 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile cav
	begin_block 9
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		7 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		10 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 12
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 13
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

end_formation



;****************************************************************
; Sinuhet's Simplified Roman pre-cursor/infantry line
; Special formation with precursor weapons, 3 lines of inf,
; cav on the wings - adapted by Sinuhet
;****************************************************************

begin_formation ai_precursor_line_march

	;;; purpose flags - regrouping
	march

	ai_priority				2.0

	supported_factions			romans_julii,

	; Screen of missile inf
	begin_block 0
		max_units				5
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		;default_melee_state		fire_at_will_and_skirmish
		;unit_density			close		; always deploy and defend as close
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; First line of infantry
	begin_block 1
		unit_type				light_pilum_infantry 1.0
		unit_type				light infantry 1.0
		unit_type				heavy_pilum_infantry 0.9
		unit_type				heavy infantry 0.9
		;default_melee_state		fire_at_will
		;unit_formation			square, testudo
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 0.0 -7.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; second line of infantry
	begin_block 2
		unit_type				heavy_pilum_infantry 1.0
		unit_type				heavy infantry 1.0
		unit_type				light_pilum_infantry 0.9
		unit_type				light infantry 0.9
		;default_melee_state		fire_at_will
		;unit_formation			square, testudo
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		1 0.0 -10.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; 3rd line of infantry, guard of archers
	begin_block 3
		unit_type				non_phalanx_spear 1.0
		unit_type				heavy_pilum_infantry 0.6
		unit_type				heavy infantry 0.6
		unit_type				light_pilum_infantry 0.2
		unit_type				light infantry 0.2
		;default_melee_state		fire_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		2 0.0 -10.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; Archers behind
	begin_block 4
		max_units				10
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend
		max_unit_width			15
		block_formation			line
		block_relative_pos		3 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	begin_dummy_block 5
		spans	1 2 3 4
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		2 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank
	begin_block 7
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		2 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; left flank missile cav
	begin_block 8
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		6 -5.0 0.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; right flank missile cav
	begin_block 9
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		;unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		7 5.0 0.0
		inter_unit_spacing		0.2
		priority			0.7
	end_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		10 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 12
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		11 0.0 -23.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 13
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

end_formation


begin_formation ai_precursor_line_deploy

	;;; purpose flags - deploy, defending
	defend

	ai_priority				2.0

	supported_factions			romans_julii,

	; Screen of missile inf
	begin_block 0
		max_units				5
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; First line of infantry
	begin_block 1
		unit_type				light_pilum_infantry 1.0
		unit_type				light infantry 1.0
		unit_type				heavy_pilum_infantry 0.9
		unit_type				heavy infantry 0.9
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 -7.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; second line of infantry
	begin_block 2
		unit_type				heavy_pilum_infantry 1.0
		unit_type				heavy infantry 1.0
		unit_type				light_pilum_infantry 0.9
		unit_type				light infantry 0.9
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			20
		block_formation			line
		block_relative_pos		1 0.0 -10.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; 3rd line of infantry, guard of archers
	begin_block 3
		unit_type				non_phalanx_spear 1.0
		unit_type				heavy_pilum_infantry 0.6
		unit_type				heavy infantry 0.6
		unit_type				light_pilum_infantry 0.2
		unit_type				light infantry 0.2
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		2 0.0 -10.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; Archers behind
	begin_block 4
		max_units				10
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 0.0 -30.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	begin_dummy_block 5
		spans	1 2 3 4
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		5 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank
	begin_block 7
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		5 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; left flank missile cav
	begin_block 8
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		6 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile cav
	begin_block 9
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		7 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		10 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 12
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		11 0.0 -23.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 13
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

end_formation


begin_formation ai_precursor_line_attack

	;;; purpose flags - attacking
	attack
	march

	ai_priority				2.0

	supported_factions			romans_julii,

	; Screen of missile inf
	begin_block 0
		max_units				5
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; First line of infantry
	begin_block 1
		unit_type				light_pilum_infantry 1.0
		unit_type				light infantry 1.0
		unit_type				heavy_pilum_infantry 0.9
		unit_type				heavy infantry 0.9
		default_melee_state		fire_at_will
		;unit_formation			square, testudo
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 -7.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; second line of infantry
	begin_block 2
		unit_type				heavy_pilum_infantry 1.0
		unit_type				heavy infantry 1.0
		unit_type				light_pilum_infantry 0.9
		unit_type				light infantry 0.9
		default_melee_state		fire_at_will
		;unit_formation			square, testudo
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		1 0.0 -10.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; 3rd line of infantry, guard of archers
	begin_block 3
		unit_type				non_phalanx_spear 1.0
		unit_type				heavy_pilum_infantry 0.6
		unit_type				heavy infantry 0.6
		unit_type				light_pilum_infantry 0.2
		unit_type				light infantry 0.2
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		2 0.0 -10.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; Archers behind
	begin_block 4
		max_units				10
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	begin_dummy_block 5
		spans	1 2 3 4
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		5 -20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank
	begin_block 7
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		5 20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; left flank missile cav
	begin_block 8
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		6 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile cav
	begin_block 9
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		7 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		10 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 12
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 13
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 0.0 -40.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

end_formation


begin_formation ai_precursor_line_pursue

	;;; purpose flags - attacking
	pursue
	march

	ai_priority				2.0

	supported_factions			romans_julii,

	; Screen of missile inf
	begin_block 0
		max_units				5
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; First line of infantry
	begin_block 1
		min_units				3
		unit_type				light_pilum_infantry 1.0
		unit_type				light infantry 1.0
		unit_type				heavy_pilum_infantry 0.9
		unit_type				heavy infantry 0.9
		default_melee_state		fire_at_will
		;unit_formation			square, testudo
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 -7.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; second line of infantry
	begin_block 2
		min_units				3
		unit_type				heavy_pilum_infantry 1.0
		unit_type				heavy infantry 1.0
		unit_type				light_pilum_infantry 0.9
		unit_type				light infantry 0.9
		default_melee_state		fire_at_will
		;unit_formation			square, testudo
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		1 0.0 -10.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; 3rd line of infantry, guard of archers
	begin_block 3
		min_units				2
		unit_type				non_phalanx_spear 1.0
		unit_type				heavy_pilum_infantry 0.6
		unit_type				heavy infantry 0.6
		unit_type				light_pilum_infantry 0.2
		unit_type				light infantry 0.2
		default_melee_state		fire_at_will
		unit_formation			shield_wall, testudo, square
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		2 0.0 -10.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; Archers behind
	begin_block 4
		max_units				10
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	begin_dummy_block 5
		spans	1 2 3 4
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		5 -20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank
	begin_block 7
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		5 20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; left flank missile cav
	begin_block 8
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		6 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile cav
	begin_block 9
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		7 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		5 0.0 -30.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		10 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 12
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		11 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 13
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 0.0 -50.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

end_formation


begin_formation ai_precursor_line_approach

	;;; purpose flags - approaching
	defend
	attack

	ai_priority				2.0

	supported_factions			romans_julii,

	; Screen of missile inf
	begin_block 0
		max_units				5
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; First line of infantry
	begin_block 1
		unit_type				light_pilum_infantry 1.0
		unit_type				light infantry 1.0
		unit_type				heavy_pilum_infantry 0.9
		unit_type				heavy infantry 0.9
		;default_melee_state		fire_at_will
		;unit_formation			square, testudo
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -7.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; second line of infantry
	begin_block 2
		unit_type				heavy_pilum_infantry 1.0
		unit_type				heavy infantry 1.0
		unit_type				light_pilum_infantry 0.9
		unit_type				light infantry 0.9
		;default_melee_state		fire_at_will
		;unit_formation			square, testudo
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -10.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; 3rd line of infantry, guard of archers
	begin_block 3
		unit_type				non_phalanx_spear 1.0
		unit_type				heavy_pilum_infantry 0.6
		unit_type				heavy infantry 0.6
		unit_type				light_pilum_infantry 0.2
		unit_type				light infantry 0.2
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		2 0.0 -10.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; Archers behind
	begin_block 4
		max_units				10
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 0.0 -30.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	begin_dummy_block 5
		spans	1 2 3 4
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		5 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank
	begin_block 7
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		5 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; left flank missile cav
	begin_block 8
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		6 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile cav
	begin_block 9
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		7 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		10 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 12
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		11 0.0 -23.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 13
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

end_formation



;****************************************************************
;****************************************************************
; Barbarian formations section
;****************************************************************
;****************************************************************

;**********************************************************************************************************************************************
; Semi-barbarian formation (combine cavalry and missile).It has no great weaknesses and provides good infantry cover
;**********************************************************************************************************************************************

;Great infantry all around cover. Cavalry on the flanks
begin_formation ai_semi_barbarian_line_march

	;;; purpose flags - regrouping
	march

	ai_priority				2.80

	supported_factions			dacia, numidia, gauls, galatians,, britons, spain, thrace, slave

	;; First line of infantry
	begin_block 0
		not_general
		unit_type				light infantry 1.0
		unit_type				heavy infantry 0.1
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, schiltrom, square
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; second line of infantry - center
	begin_block 1
		min_units				1
		max_units				3
		not_general
		unit_type				heavy_pilum_infantry 1.0
		unit_type				light_pilum_infantry 0.5
		;default_melee_state		defend
		;unit_formation			shield_wall, schiltrom, square
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 -2.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; second line of infantry - left
	begin_block 2
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy_pilum_infantry 0.5
		unit_type				light_pilum_infantry 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, schiltrom, square
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		1 -10.0 0.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	;; second line of infantry - right
	begin_block 3
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy_pilum_infantry 0.5
		unit_type				light_pilum_infantry 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, schiltrom, square
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		1 10.0 0.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	;; 3rd line of infantry
	begin_block 4
		max_units				6
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		max_unit_width			20
		block_formation			line
		block_relative_pos		1 0.0 -2.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; Archers behind
	begin_block 5
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			20
		block_formation			line
		block_relative_pos		4 0.0 -20.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	begin_dummy_block 6
		spans	0 1 2 3 4 5
	end_dummy_block

	;; Screen of missile inf
	begin_block 7
		not_general
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		6 0.0 6.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; artillery and handlers at the back
	begin_block 8
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			20
		block_formation			line
		block_relative_pos		7 0.0 -20.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; left flank missile
	begin_block 9
		not_general
		unit_type				missile infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			20
		block_formation			line
		block_relative_pos		2 -10.0 -5.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; right flank missile
	begin_block 10
		not_general
		unit_type				missile infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			20
		block_formation			line
		block_relative_pos		3 10.0 -5.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	begin_dummy_block 11
		spans	0 1 2 3 4 5 7 8 9 10
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank cav
	begin_block 12
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			20
		block_formation			square
		block_relative_pos		11 -1.0 -5.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; left flank cav(more)
	begin_block 13
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			20
		block_formation			square
		block_relative_pos		12 -1.0 -3.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;; right flank cav
	begin_block 14
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			20
		block_formation			square
		block_relative_pos		11 1.0 -5.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; right flank cav(more)
	begin_block 15
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			20
		block_formation			square
		block_relative_pos		14 1.0 -3.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	;; general at the back
	begin_block 16
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 17
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		max_unit_width			15
		block_formation			line
		block_relative_pos		16 0.0 -5.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_dummy_block 18
		spans	11 12 13 14 15 16 17
	end_dummy_block

	;; left flank missile(decides to support the flank more)
	begin_block 19
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			20
		block_formation			column
		block_relative_pos		18 -5.0 0.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;; right flank missile(decides to support the flank more)
	begin_block 20
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			20
		block_formation			column
		block_relative_pos		18 5.0 0.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	begin_block 21
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			wedge
		max_unit_width			20
		block_formation			column
		block_relative_pos		2 -20.0 1.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; any behind
	begin_block 22
		max_units				0
		unit_type				any 0.001
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		18 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation


;Great infantry all around cover. cavalry on the flanks
begin_formation ai_semi_barbarian_line_deploy

	;;; purpose flags - deploy, defending
	defend

	ai_priority				2.80

	supported_factions			dacia, numidia, gauls, galatians,, britons, spain, thrace, slave

	;; 3rd line of infantry
	begin_block 0
		max_units				6
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 2.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; second line of infantry - center
	begin_block 1
		min_units				1
		max_units				3
		not_general
		unit_type				heavy_pilum_infantry 1.0
		unit_type				light_pilum_infantry 0.5
		;default_melee_state		defend
		;unit_formation			shield_wall, schiltrom, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; second line of infantry - left
	begin_block 2
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy_pilum_infantry 0.5
		unit_type				light_pilum_infantry 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, schiltrom, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 -1.5 0.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	;; second line of infantry - right
	begin_block 3
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy_pilum_infantry 0.5
		unit_type				light_pilum_infantry 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, schiltrom, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 1.5 0.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	;; First line of infantry
	begin_block 4
		not_general
		unit_type				light infantry 1.0
		unit_type				heavy infantry 0.1
		;default_melee_state		defend
		;unit_formation			shield_wall, schiltrom, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -2.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; Archers behind
	begin_block 5
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 0.0 -30.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	begin_dummy_block 6
		spans	0 1 2 3 4 5
	end_dummy_block

	;; Screen of missile inf
	begin_block 7
		not_general
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 0.0 -6.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; artillery and handlers at the back
	begin_block 8
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		7 0.0 -20.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; left flank missile
	begin_block 9
		not_general
		unit_type				missile infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		2 -1.0 -5.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; right flank missile
	begin_block 10
		not_general
		unit_type				missile infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 1.0 -5.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	begin_dummy_block 11
		spans	0 1 2 3 4 5 6 7 8 9 10
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank cav
	begin_block 12
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		11 -10.0 -3.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; left flank cav(more)
	begin_block 13
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		12 -1.0 -3.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;; right flank cav
	begin_block 14
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		11 10.0 -3.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; right flank cav(more)
	begin_block 15
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		14 1.0 -3.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	;; general at the back
	begin_block 16
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 17
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		16 0.0 -5.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_dummy_block 18
		spans	11 12 13 14 15 16 17
	end_dummy_block

	;; left flank missile(decides to support the flank more)
	begin_block 19
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		18 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; right flank missile(decides to support the flank more)
	begin_block 20
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		18 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.4
	end_block

	begin_block 21
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		18 0.0 -10.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; any behind
	begin_block 22
		max_units				0
		unit_type				any 0.001
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		18 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation


;the formation attacks and maneuvres the cavalry
begin_formation ai_semi_barbarian_line_attack

	;;; purpose flags - attacking
	attack

	ai_priority				2.80

	supported_factions			dacia, numidia, gauls, galatians,, britons, spain, thrace, slave

	;; First line of infantry
	begin_block 0
		not_general
		unit_type				light infantry 1.0
		unit_type				heavy infantry 0.1
		;default_melee_state		defend
		;unit_formation			shield_wall, schiltrom, square
		;unit_density			close
		max_unit_width			36
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; second line of infantry - center
	begin_block 1
		min_units				1
		max_units				3
		not_general
		unit_type				heavy_pilum_infantry 1.0
		unit_type				light_pilum_infantry 0.5
		;default_melee_state		defend
		;unit_formation			shield_wall, schiltrom, square
		;unit_density			close
		max_unit_width			36
		block_formation			line
		block_relative_pos		0 0.0 2.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; second line of infantry - left
	begin_block 2
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy_pilum_infantry 0.5
		unit_type				light_pilum_infantry 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, schiltrom, square
		;unit_density			close
		max_unit_width			36
		block_formation			line
		block_relative_pos		1 -10.0 0.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	;; second line of infantry - right
	begin_block 3
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy_pilum_infantry 0.5
		unit_type				light_pilum_infantry 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, schiltrom, square
		;unit_density			close
		max_unit_width			36
		block_formation			line
		block_relative_pos		1 10.0 0.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	;; 3rd line of infantry
	begin_block 4
		max_units				6
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -6.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; Archers behind
	begin_block 5
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 0.0 -20.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	begin_dummy_block 6
		spans	0 1 2 3 4 5
	end_dummy_block

	;; Screen of missile inf
	begin_block 7
		not_general
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		;unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 0.0 -6.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; artillery and handlers at the back
	begin_block 8
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			24
		block_formation			line
		block_relative_pos		7 0.0 -20.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; left flank missile
	begin_block 9
		not_general
		unit_type				missile infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 -35.0 25.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; right flank missile
	begin_block 10
		not_general
		unit_type				missile infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 35.0 25.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	begin_dummy_block 11
		spans	0 1 2 3 4 5 7 8 9 10
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank cav
	begin_block 12
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			square
		block_relative_pos		11 -35.0 25.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; left flank cav(more)
	begin_block 13
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			24
		block_formation			square
		block_relative_pos		12 -1.0 -3.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;; right flank cav
	begin_block 14
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			square
		block_relative_pos		11 35.0 25.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; right flank cav(more)
	begin_block 15
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			24
		block_formation			square
		block_relative_pos		14 1.0 -3.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	;; general at the back
	begin_block 16
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 17
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		block_formation			line
		block_relative_pos		16 10.0 0.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_dummy_block 18
		spans	11 12 13 14 15 16 17
	end_dummy_block

	;; left flank missile(decides to support the flank more)
	begin_block 19
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			column
		block_relative_pos		18 -5.0 0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; right flank missile(decides to support the flank more)
	begin_block 20
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			column
		block_relative_pos		18 5.0 0
		inter_unit_spacing		10.0
		priority			0.4
	end_block

	begin_block 21
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			wedge
		max_unit_width			40
		block_formation			line
		block_relative_pos		2 -30.0 20.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; any behind
	begin_block 22
		max_units				0
		unit_type				any 0.001
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		18 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation


;Great infantry all around cover. cavalry on the flanks
begin_formation ai_semi_barbarian_pursue

	;;; purpose flags - charging, pursue
	pursue

	ai_priority				2.80

	supported_factions			dacia, numidia, gauls, galatians,, britons, spain, thrace, slave

	;; First line of infantry
	begin_block 0
		not_general
		unit_type				light infantry 1.0
		unit_type				heavy infantry 0.1
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, schiltrom, square
		;unit_density			close
		max_unit_width			36
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; second line of infantry - center
	begin_block 1
		min_units				1
		max_units				3
		not_general
		unit_type				heavy_pilum_infantry 1.0
		unit_type				light_pilum_infantry 0.5
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, schiltrom, square
		;unit_density			close
		max_unit_width			36
		block_formation			line
		block_relative_pos		0 0.0 -2.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; second line of infantry - left
	begin_block 2
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy_pilum_infantry 0.5
		unit_type				light_pilum_infantry 1.0
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, schiltrom, square
		;unit_density			close
		max_unit_width			36
		block_formation			line
		block_relative_pos		1 -10.0 0.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	;; second line of infantry - right
	begin_block 3
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy_pilum_infantry 0.5
		unit_type				light_pilum_infantry 1.0
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, schiltrom, square
		;unit_density			close
		max_unit_width			36
		block_formation			line
		block_relative_pos		1 10.0 0.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	;; 3rd line of infantry
	begin_block 4
		max_units				6
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -2.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; Archers behind
	begin_block 5
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 0.0 -20.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	begin_dummy_block 6
		spans	0 1 2 3 4 5
	end_dummy_block

	;; Screen of missile inf
	begin_block 7
		not_general
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		;unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 0.0 -16.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; artillery and handlers at the back
	begin_block 8
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			24
		block_formation			line
		block_relative_pos		7 0.0 -30.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; left flank missile
	begin_block 9
		not_general
		unit_type				missile infantry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 -1.0 -5.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; right flank missile
	begin_block 10
		not_general
		unit_type				missile infantry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 1.0 -5.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	begin_dummy_block 11
		spans	0 1 2 3 4 5 6 8 9 10
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank cav
	begin_block 12
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			square
		block_relative_pos		11 -15.0 -15.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; left flank cav(more)
	begin_block 13
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			square
		block_relative_pos		12 -1.0 -3.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;; right flank cav
	begin_block 14
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			square
		block_relative_pos		11 15.0 -15.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; right flank cav(more)
	begin_block 15
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			square
		block_relative_pos		14 1.0 -3.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	;; general at the back
	begin_block 16
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		11 0.0 -30.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 17
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		block_formation			line
		block_relative_pos		16 10.0 0.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_dummy_block 18
		spans	11 12 13 14 15 16 17
	end_dummy_block

	;; left flank missile(decides to support the flank more)
	begin_block 19
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			30
		block_formation			column
		block_relative_pos		18 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; right flank missile(decides to support the flank more)
	begin_block 20
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			30
		block_formation			column
		block_relative_pos		18 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.4
	end_block

	begin_block 21
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		default_melee_state		fire_at_will
		;unit_formation			wedge
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 5.0 15.0	; hook from left to right
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; any behind
	begin_block 22
		max_units				0
		unit_type				any 0.001
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		18 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation


;the multirole swap of the formation will make cavalry to pull back and archers to go to flanks
begin_formation ai_semi_barbarian_line_approach

	;;; purpose flags - approaching
	attack
	defend

	ai_priority				2.80

	supported_factions			dacia, numidia, gauls, galatians,, britons, spain, thrace, slave

	;; First line of infantry
	begin_block 0
		not_general
		unit_type				light infantry 1.0
		unit_type				heavy infantry 0.1
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, schiltrom, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; second line of infantry - center
	begin_block 1
		min_units				1
		max_units				3
		not_general
		unit_type				heavy_pilum_infantry 1.0
		unit_type				light_pilum_infantry 0.5
		;default_melee_state		defend
		;unit_formation			shield_wall, schiltrom, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 -2.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; second line of infantry - left
	begin_block 2
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy_pilum_infantry 0.5
		unit_type				light_pilum_infantry 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, schiltrom, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		1 -10.0 0.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	;; second line of infantry - right
	begin_block 3
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy_pilum_infantry 0.5
		unit_type				light_pilum_infantry 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, schiltrom, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		1 10.0 0.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	;; 3rd line of infantry
	begin_block 4
		max_units				6
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -10.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; Archers behind
	begin_block 5
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 0.0 -30.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	begin_dummy_block 6
		spans	0 1 2 3 4 5
	end_dummy_block

	;; Screen of missile inf
	begin_block 7
		not_general
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 0.0 6.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; artillery and handlers at the back
	begin_block 8
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		7 0.0 -20.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; left flank missile
	begin_block 9
		not_general
		unit_type				missile infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		2 -15.0 -15.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; right flank missile
	begin_block 10
		not_general
		unit_type				missile infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 15.0 -15.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	begin_dummy_block 11
		spans	0 1 2 3 4 5 7 8 9 10
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank cav
	begin_block 12
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		11 -10.0 -3.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; left flank cav(more)
	begin_block 13
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		12 -1.0 -3.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;; right flank cav
	begin_block 14
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		11 10.0 -3.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; right flank cav(more)
	begin_block 15
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		14 1.0 -3.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	;; general at the back
	begin_block 16
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 17
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		16 0.0 -5.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_dummy_block 18
		spans	11 12 13 14 15 16 17
	end_dummy_block

	;; left flank missile(decides to support the flank more)
	begin_block 19
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		18 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; right flank missile(decides to support the flank more)
	begin_block 20
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		18 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.4
	end_block

	begin_block 21
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		2 -20.0 1.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; any behind
	begin_block 22
		max_units				0
		unit_type				any 0.001
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		18 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation



;**********************************************************************************************************************************************
; Barbarian Wedge (modified from Darth-BI/FATW/ATW and Pax Barbaricia's). Barbarian more aggressive manuveuring alternative of Barbarian Onslaught (This relies more on heavy Infantry)
;**********************************************************************************************************************************************

;Powerful center attack.
begin_formation ai_barbarian_wedge_line_march

	;;; purpose flags - regrouping
	march

	ai_priority				2.90

	supported_factions			dacia, gauls, galatians,, britons, germans, spain, thrace

	;; wedge top (champion is here)
	begin_block 0
		max_units				1
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; Center block of infantry
	begin_block 1
		min_units				2
		max_units				2
		not_general
		unit_type				heavy infantry 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 0.0 -0.02
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; Rear block of infantry
	begin_block 2
		min_units				3
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		1 0.0 -0.02
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; fourth line of the infantry - center
	begin_block 3
		min_units				2
		max_units				2
		not_general
		unit_type				heavy infantry 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		2 0.0 -0.2
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;;; fourth line of the infantry - left side
	begin_block 4
		min_units				1
		max_units				1
		unit_type				heavy infantry 1.0
		unit_type				non_phalanx_spear 0.7
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		3 -0.02 0.0
		inter_unit_spacing		0.1
		priority			0.95
	end_block

	;;; fourth line of the infantry - right side
	begin_block 5
		min_units				1
		max_units				1
		unit_type				heavy infantry 1.0
		unit_type				non_phalanx_spear 0.7
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		3 0.02 0.0
		inter_unit_spacing		0.1
		priority			0.9
	end_block

	;; fifth line of the infantry - center
	begin_block 6
		min_units				2
		max_units				3
		unit_type				heavy infantry 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		3 0.0 -0.2
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;;; fifth line of the infantry - left side
	begin_block 7
		min_units				1
		max_units				1
		unit_type				heavy infantry 0.2
		unit_type				non_phalanx_spear 1.0
		unit_type				chanting_screeching 3.0
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		6 -0.02 0.0
		inter_unit_spacing		0.1
		priority			0.75
	end_block

	;;; fifth line of the infantry - right side
	begin_block 8
		min_units				1
		max_units				1
		unit_type				heavy infantry 0.2
		unit_type				non_phalanx_spear 1.0
		unit_type				chanting_screeching 3.0
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		6 0.02 0.0
		inter_unit_spacing		0.1
		priority			0.7
	end_block

	;; Reserve block of infantry (1) (heavy infantry)
	begin_block 9
		unit_type				general_unit infantry 3.0
		unit_type				chanting_screeching 3.0
		unit_type				heavy infantry 0.3
		;default_melee_state		defend
		;unit_formation			shield_wall
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		6 0.0 -0.2
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;; Reserve block of infantry (2) (light/spearmen infantry)
	begin_block 10
		max_units				2
		unit_type				non_phalanx_spear 0.5
		unit_type				light infantry 0.5
		;default_melee_state		defend
		;unit_formation			shield_wall
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		7 0.0 -0.2
		inter_unit_spacing		0.2
		priority			0.1
	end_block

	begin_dummy_block 11
		spans	0 1 2 3 4 5 6 7 8 9 10
	end_dummy_block

	;; Archers behind
	begin_block 12
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			15
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block


	;; artillery and handlers at the back
	begin_block 13
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			15
		block_formation			line
		block_relative_pos		12 0.0 -6.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; left flank missile
	begin_block 14
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			15
		block_formation			column
		block_relative_pos		11 -1.0 0.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; right flank missile
	begin_block 15
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			15
		block_formation			column
		block_relative_pos		11 1.0 0.0
		inter_unit_spacing		6.0
		priority			0.55
	end_block

	begin_dummy_block 16
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank cavalry
	begin_block 17
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			15
		block_formation			square
		block_relative_pos		16 -1.0 0.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; right flank cavalry
	begin_block 18
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			15
		block_formation			square
		block_relative_pos		16 1.0 0.0
		inter_unit_spacing		6.0
		priority			0.6
	end_block

	;; left flank missile cavalry(decides to support the flank more)
	begin_block 19
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			20
		block_formation			column
		block_relative_pos		16 -5.0 0.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; right flank missile cavalry(decides to support the flank more)
	begin_block 20
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			20
		block_formation			column
		block_relative_pos		16 5.0 0.0
		inter_unit_spacing		0.2
		priority			0.7
	end_block

	;; general at the back
	begin_block 21
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		16 0.0 -20.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 22
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		21 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 23
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			20
		block_formation			column
		block_relative_pos		11 -20.0 1.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; any behind
	begin_block 24
		max_units				0
		unit_type				any 0.001
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		22 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation


begin_formation ai_barbarian_wedge_line_deploy

	;;; purpose flags - deploy, defending
	defend

	ai_priority				2.90

	supported_factions			dacia, gauls, galatians,, britons, germans, spain, thrace

	;; wedge top (champion is here)
	begin_block 0
		max_units				1
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; Center block of infantry
	begin_block 1
		min_units				2
		max_units				2
		not_general
		unit_type				heavy infantry 1.0
		;default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -0.2
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; Rear block of infantry
	begin_block 2
		min_units				3
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		;default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -0.2
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; fourth line of the infantry - center
	begin_block 3
		min_units				2
		max_units				2
		not_general
		unit_type				heavy infantry 1.0
		;default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -0.2
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;;; fourth line of the infantry - left side
	begin_block 4
		min_units				1
		max_units				1
		unit_type				heavy infantry 1.0
		unit_type				non_phalanx_spear 0.7
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		3 -0.02 0.0
		inter_unit_spacing		0.1
		priority			0.95
	end_block

	;;; fourth line of the infantry - right side
	begin_block 5
		min_units				1
		max_units				1
		unit_type				heavy infantry 1.0
		unit_type				non_phalanx_spear 0.7
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		3 0.02 0.0
		inter_unit_spacing		0.1
		priority			0.9
	end_block

	;; fifth line of the infantry - center
	begin_block 6
		min_units				2
		max_units				3
		unit_type				heavy infantry 1.0
		;default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		3 0.0 -0.2
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;;; fifth line of the infantry - left side
	begin_block 7
		min_units				1
		max_units				1
		unit_type				heavy infantry 0.2
		unit_type				non_phalanx_spear 1.0
		unit_type				chanting_screeching 3.0
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 -0.02 0.0
		inter_unit_spacing		0.1
		priority			0.75
	end_block

	;;; fifth line of the infantry - right side
	begin_block 8
		min_units				1
		max_units				1
		unit_type				heavy infantry 0.2
		unit_type				non_phalanx_spear 1.0
		unit_type				chanting_screeching 3.0
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 0.02 0.0
		inter_unit_spacing		0.1
		priority			0.7
	end_block

	;; Reserve block of infantry (1) (heavy infantry)
	begin_block 9
		unit_type				general_unit infantry 3.0
		unit_type				chanting_screeching 3.0
		unit_type				heavy infantry 0.3
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			15
		block_formation			line
		block_relative_pos		6 0.0 -0.2
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;; Reserve block of infantry (2) (light/spearmen infantry)
	begin_block 10
		max_units				2
		unit_type				non_phalanx_spear 0.5
		unit_type				light infantry 0.5
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		7 0.0 -0.2
		inter_unit_spacing		0.2
		priority			0.1
	end_block

	begin_dummy_block 11
		spans	0 1 2 3 4 5 6 7 8 9 10
	end_dummy_block

	;; Archers behind
	begin_block 12
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		11 0.0 -30.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block


	;; artillery and handlers at the back
	begin_block 13
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 0.0 -6.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; left flank missile
	begin_block 14
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		11 -1.0 -5.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; right flank missile
	begin_block 15
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		11 1.0 -5.0
		inter_unit_spacing		6.0
		priority			0.55
	end_block

	begin_dummy_block 16
		spans 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank cavalry
	begin_block 17
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		16 -10.0 -3.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; right flank cavalry
	begin_block 18
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		16 10.0 -3.0
		inter_unit_spacing		6.0
		priority			0.6
	end_block

	;; left flank missile cavalry(decides to support the flank more)
	begin_block 19
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		16 -15.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile cavalry(decides to support the flank more)
	begin_block 20
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		16 15.0 0.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; general at the back
	begin_block 21
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		16 0.0 -20.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 22
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		21 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 23
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		16 -20.0 -5.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; any behind
	begin_block 24
		max_units				0
		unit_type				any 0.001
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		23 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation


;the formation attacks and maneuvres the cavalry to the flanks and on distance ready to charge from afar.
begin_formation ai_barbarian_wedge_line_attack

	;;; purpose flags - attacking
	attack

	ai_priority				2.90

	supported_factions			dacia, gauls, galatians,, britons, germans, spain, thrace

	;; wedge top (champion is here)
	begin_block 0
		max_units				1
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; Center block of infantry
	begin_block 1
		min_units				2
		max_units				2
		not_general
		unit_type				heavy infantry 1.0
		;default_melee_state		defend
		;unit_formation			square
		;unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -0.2
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; Rear block of infantry
	begin_block 2
		min_units				3
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -0.2
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; fourth line of the infantry - center
	begin_block 3
		min_units				2
		max_units				2
		not_general
		unit_type				heavy infantry 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		2 0.0 -0.2
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;;; fourth line of the infantry - left side
	begin_block 4
		min_units				1
		max_units				1
		unit_type				heavy infantry 1.0
		unit_type				non_phalanx_spear 0.7
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		3 -0.02 0.0
		inter_unit_spacing		0.1
		priority			0.95
	end_block

	;;; fourth line of the infantry - right side
	begin_block 5
		min_units				1
		max_units				1
		unit_type				heavy infantry 1.0
		unit_type				non_phalanx_spear 0.7
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		3 0.02 0.0
		inter_unit_spacing		0.1
		priority			0.9
	end_block

	;; fifth line of the infantry - center
	begin_block 6
		min_units				2
		max_units				3
		unit_type				heavy infantry 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		3 0.0 -0.2
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;;; fifth line of the infantry - left side
	begin_block 7
		min_units				1
		max_units				1
		unit_type				heavy infantry 0.2
		unit_type				non_phalanx_spear 1.0
		unit_type				chanting_screeching 3.0
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 -0.02 0.0
		inter_unit_spacing		0.1
		priority			0.75
	end_block

	;;; fifth line of the infantry - right side
	begin_block 8
		min_units				1
		max_units				1
		unit_type				heavy infantry 0.2
		unit_type				non_phalanx_spear 1.0
		unit_type				chanting_screeching 3.0
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 0.02 0.0
		inter_unit_spacing		0.1
		priority			0.7
	end_block

	;; Reserve block of infantry (1) (heavy infantry)
	begin_block 9
		unit_type				general_unit infantry 3.0
		unit_type				chanting_screeching 3.0
		unit_type				heavy infantry 0.3
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		6 0.0 -0.2
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;; Reserve block of infantry (2) (light/spearmen infantry)
	begin_block 10
		max_units				2
		unit_type				non_phalanx_spear 0.5
		unit_type				light infantry 0.5
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		7 0.0 -0.2
		inter_unit_spacing		0.2
		priority			0.1
	end_block

	begin_dummy_block 11
		spans	0 1 2 3 4 5 6 7 8 9 10
	end_dummy_block

	;; Archers behind
	begin_block 12
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block


	;; artillery and handlers at the back
	begin_block 13
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 0.0 -30.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block


	;; cavalry on the flanks and back a bit

	;; left flank missile
	begin_block 14
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			40
		block_formation			column
		block_relative_pos		11 -25.0 15.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; right flank missile
	begin_block 15
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			40
		block_formation			column
		block_relative_pos		11 25.0 15.0
		inter_unit_spacing		6.0
		priority			0.55
	end_block

	begin_dummy_block 16
		spans 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15
	end_dummy_block

	;; left flank cavalry
	begin_block 17
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			square
		block_relative_pos		16 -35 25.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; right flank cavalry
	begin_block 18
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			square
		block_relative_pos		16 35.0 25.0
		inter_unit_spacing		6.0
		priority			0.6
	end_block

	;; left flank missile cavalry(decides to support the flank more)
	begin_block 19
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			column
		block_relative_pos		16 -41.0 -3.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile cavalry(decides to support the flank more)
	begin_block 20
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			column
		block_relative_pos		16 41.0 -3.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; general at the back
	begin_block 21
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		16 0.0 -20.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 22
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		21 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 23
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		unit_formation			wedge
		max_unit_width			40
		block_formation			line
		block_relative_pos		11 -30.0 20.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; any behind
	begin_block 24
		max_units				0
		unit_type				any 0.001
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		22 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation


begin_formation ai_barbarian_wedge_line_pursue

	;;; purpose flags - charging, pursue
	pursue

	ai_priority				2.90

	supported_factions			dacia, gauls, galatians,, britons, germans, spain, thrace

	;; wedge top (champion is here)
	begin_block 0
		max_units				1
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; Center block of infantry
	begin_block 1
		min_units				2
		max_units				2
		not_general
		unit_type				heavy infantry 1.0
		;default_melee_state		defend
		;unit_formation			square
		;unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -0.2
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; Rear block of infantry
	begin_block 2
		min_units				3
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -0.2
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; fourth line of the infantry - center
	begin_block 3
		min_units				2
		max_units				2
		not_general
		unit_type				heavy infantry 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		2 0.0 -0.2
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;;; fourth line of the infantry - left side
	begin_block 4
		min_units				1
		max_units				1
		unit_type				heavy infantry 1.0
		unit_type				non_phalanx_spear 0.7
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		3 -0.02 0.0
		inter_unit_spacing		0.1
		priority			0.95
	end_block

	;;; fourth line of the infantry - right side
	begin_block 5
		min_units				1
		max_units				1
		unit_type				heavy infantry 1.0
		unit_type				non_phalanx_spear 0.7
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		3 0.02 0.0
		inter_unit_spacing		0.1
		priority			0.9
	end_block

	;; fifth line of the infantry - center
	begin_block 6
		min_units				2
		max_units				3
		unit_type				heavy infantry 1.0
		;default_melee_state		defend
		unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		3 0.0 -0.2
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;;; fifth line of the infantry - left side
	begin_block 7
		min_units				1
		max_units				1
		unit_type				heavy infantry 0.2
		unit_type				non_phalanx_spear 1.0
		unit_type				chanting_screeching 3.0
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 -0.02 0.0
		inter_unit_spacing		0.1
		priority			0.75
	end_block

	;;; fifth line of the infantry - right side
	begin_block 8
		min_units				1
		max_units				1
		unit_type				heavy infantry 0.2
		unit_type				non_phalanx_spear 1.0
		unit_type				chanting_screeching 3.0
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 0.02 0.0
		inter_unit_spacing		0.1
		priority			0.7
	end_block

	;; Reserve block of infantry (1) (heavy infantry)
	begin_block 9
		unit_type				general_unit infantry 3.0
		unit_type				chanting_screeching 3.0
		unit_type				heavy infantry 0.3
		;default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		6 0.0 -0.2
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;; Reserve block of infantry (2) (light/spearmen infantry)
	begin_block 10
		max_units				2
		unit_type				non_phalanx_spear 0.5
		unit_type				light infantry 0.5
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		7 0.0 -0.2
		inter_unit_spacing		0.2
		priority			0.1
	end_block

	begin_dummy_block 11
		spans	0 1 2 3 4 5 6 7 8 9 10
	end_dummy_block

	;; Archers behind
	begin_block 12
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block


	;; artillery and handlers at the back
	begin_block 13
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 0.0 -40.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; left flank missile
	begin_block 14
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		12 -1.0 -5.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; right flank missile
	begin_block 15
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		12 1.0 -5.0
		inter_unit_spacing		6.0
		priority			0.55
	end_block

	begin_dummy_block 16
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank cavalry
	begin_block 17
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			square
		block_relative_pos		16 -15.0 -15.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; right flank cavalry
	begin_block 18
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			square
		block_relative_pos		16 15.0 -15.0
		inter_unit_spacing		6.0
		priority			0.6
	end_block

	;; left flank missile cavalry(decides to support the flank more)
	begin_block 19
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			column
		block_relative_pos		16 -15.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile cavalry(decides to support the flank more)
	begin_block 20
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			column
		block_relative_pos		16 15.0 0.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; general at the back
	begin_block 21
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		16 0.0 -30.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 22
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		21 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 23
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		11 5.0 10.0	; hook from left to right
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; any behind
	begin_block 24
		max_units				0
		unit_type				any 0.001
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		22 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation


;the multirole swap of the formation will make cavalry to pull back and infantry to form a semi-square
begin_formation ai_barbarian_wedge_line_approach

	;;; purpose flags - approaching, swap
	attack
	defend

	ai_priority				2.90

	supported_factions			dacia, gauls, galatians,, britons, germans, spain, thrace

	;; wedge top (champion is here)
	begin_block 0
		max_units				1
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 5.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; Center block of infantry
	begin_block 1
		min_units				2
		max_units				2
		not_general
		unit_type				heavy infantry 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -0.2
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; Rear block of infantry
	begin_block 2
		min_units				3
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -0.2
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; fourth line of the infantry - center
	begin_block 3
		min_units				2
		max_units				2
		not_general
		unit_type				heavy infantry 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		2 0.0 -0.2
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;;; fourth line of the infantry - left side
	begin_block 4
		min_units				1
		max_units				1
		unit_type				heavy infantry 1.0
		unit_type				non_phalanx_spear 0.7
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		3 -0.02 0.0
		inter_unit_spacing		0.1
		priority			0.95
	end_block

	;;; fourth line of the infantry - right side
	begin_block 5
		min_units				1
		max_units				1
		unit_type				heavy infantry 1.0
		unit_type				non_phalanx_spear 0.7
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		3 0.02 0.0
		inter_unit_spacing		0.1
		priority			0.9
	end_block

	;; fifth line of the infantry - center
	begin_block 6
		min_units				2
		max_units				3
		unit_type				heavy infantry 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		3 0.0 -0.2
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;;; fifth line of the infantry - left side
	begin_block 7
		min_units				1
		max_units				1
		unit_type				heavy infantry 0.2
		unit_type				non_phalanx_spear 1.0
		unit_type				chanting_screeching 3.0
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 -0.02 0.0
		inter_unit_spacing		0.1
		priority			0.75
	end_block

	;;; fifth line of the infantry - right side
	begin_block 8
		min_units				1
		max_units				1
		unit_type				heavy infantry 0.2
		unit_type				non_phalanx_spear 1.0
		unit_type				chanting_screeching 3.0
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 0.02 0.0
		inter_unit_spacing		0.1
		priority			0.7
	end_block

	;; Reserve block of infantry (1) (heavy infantry)
	begin_block 9
		unit_type				general_unit infantry 3.0
		unit_type				chanting_screeching 3.0
		unit_type				heavy infantry 0.3
		;default_melee_state		defend
		;unit_formation			shield_wall
		unit_density			close		; always deploy and defend as close
		max_unit_width			15
		block_formation			line
		block_relative_pos		6 0.0 -0.2
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;; Reserve block of infantry (2) (light/spearmen infantry)
	begin_block 10
		max_units				2
		unit_type				non_phalanx_spear 0.5
		unit_type				light infantry 0.5
		default_melee_state		defend
		;unit_formation			shield_wall
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		7 0.0 -0.2
		inter_unit_spacing		0.2
		priority			0.1
	end_block

	begin_dummy_block 11
		spans	0 1 2 3 4 5 6 7 8 9 10
	end_dummy_block

	;; Archers behind
	begin_block 12
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		11 0.0 -30.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block


	;; artillery and handlers at the back
	begin_block 13
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 0.0 -6.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; left flank missile
	begin_block 14
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		11 -1.0 -5.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; right flank missile
	begin_block 15
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		11 1.0 -5.0
		inter_unit_spacing		6.0
		priority			0.55
	end_block

	begin_dummy_block 16
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank cavalry
	begin_block 17
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		16 -10.0 -3.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; right flank cavalry
	begin_block 18
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		16 10.0 -3.0
		inter_unit_spacing		6.0
		priority			0.6
	end_block

	;; left flank missile cavalry(decides to support the flank more)
	begin_block 19
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		16 -15.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile cavalry(decides to support the flank more)
	begin_block 20
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		16 15.0 0.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; general at the back
	begin_block 21
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		16 0.0 -20.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 22
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		21 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 23
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		11 -20.0 1.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; any behind
	begin_block 24
		max_units				0
		unit_type				any 0.001
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		22 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation



;**********************************************************************************************************************************************
; Barbaric Onslaught (modified from Darth-BI). Powerful center. En mass deployment of infantry for maximum effect of charge.
;**********************************************************************************************************************************************

;Powerful center attack.
begin_formation ai_barbarian_onslaught_line_march

	;;; purpose flags - regrouping
	march

	ai_priority				2.70

	supported_factions			dacia, gauls, galatians,, britons, germans, spain, thrace

	;; Center block of infantry
	begin_block 0
		;min_units				3
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		0 0.0 5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; Right block of infantry
	begin_block 1
		;min_units				3
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		0 0.2 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; Left block of infantry
	begin_block 2
		;min_units				3
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		0 -0.2 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; Left of left block of infantry
	begin_block 3
		min_units				1
		max_units				2
		not_general
		unit_type				light infantry 0.5
		unit_type				non_phalanx_spear 0.1
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		2 -0.2 0.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; Right of right block of infantry
	begin_block 4
		min_units				1
		max_units				2
		not_general
		unit_type				light infantry 0.5
		unit_type				non_phalanx_spear 0.1
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		1 0.2 0.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; Reserve block of infantry
	begin_block 5
		max_units				6
		unit_type				general_unit infantry 3.0
		unit_type				light infantry 0.1
		unit_type				chanting_screeching 3.0
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		0.2
		priority			0.1
	end_block

	;; spearmen on left_flank
	begin_block 6
		max_units				1
		unit_type				non_phalanx_spear 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		5 -5.0 0.0
		inter_unit_spacing		0.1
		priority			0.4
	end_block

	;; spearmen on right flank
	begin_block 7
		max_units				1
		unit_type				non_phalanx_spear 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		5 5.0 0.0
		inter_unit_spacing		0.1
		priority			0.4
	end_block

	begin_dummy_block 8
		spans	0 1 2 3 4 5 6 7
	end_dummy_block

	;; Archers behind
	begin_block 9
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			15
		block_formation			line
		block_relative_pos		8 0.0 -20.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block


	;; artillery and handlers at the back
	begin_block 10
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			15
		block_formation			line
		block_relative_pos		9 0.0 -6.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; left flank missile
	begin_block 11
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			15
		block_formation			line
		block_relative_pos		8 -1.0 -5.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; right flank missile
	begin_block 12
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			15
		block_formation			line
		block_relative_pos		8 1.0 -5.0
		inter_unit_spacing		6.0
		priority			0.6
	end_block

	begin_dummy_block 13
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank cavalry
	begin_block 14
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			15
		block_formation			square
		block_relative_pos		13 -1.0 -3.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; right flank cavalry
	begin_block 15
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			15
		block_formation			square
		block_relative_pos		13 1.0 -3.0
		inter_unit_spacing		6.0
		priority			0.6
	end_block

	;; left flank missile cavalry(decides to support the flank more)
	begin_block 16
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			20
		block_formation			column
		block_relative_pos		13 -5.0 0.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;; right flank missile cavalry(decides to support the flank more)
	begin_block 17
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			20
		block_formation			column
		block_relative_pos		13 5.0 0.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	;; commander at the back
	begin_block 18
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		13 0.0 -10.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 19
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		18 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 20
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			20
		block_formation			column
		block_relative_pos		13 -20.0 1.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; any behind
	begin_block 21
		max_units				0
		unit_type				any 0.001
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		19 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation


;Powerful center attack.
begin_formation ai_barbarian_onslaught_line_deploy

	;;; purpose flags - deploy, defending
	defend

	ai_priority				2.70

	supported_factions			dacia, gauls, galatians,, britons, germans, spain, thrace

	;; Center block of infantry
	begin_block 0
		;min_units				3
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; Right block of infantry
	begin_block 1
		;min_units				3
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.1 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; Left block of infantry
	begin_block 2
		;min_units				3
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 -0.1 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; Left of left block of infantry
	begin_block 3
		min_units				1
		max_units				2
		not_general
		unit_type				light infantry 0.5
		unit_type				non_phalanx_spear 0.1
		;default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		2 -0.1 0.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; Right of right block of infantry
	begin_block 4
		min_units				1
		max_units				2
		not_general
		unit_type				light infantry 0.5
		unit_type				non_phalanx_spear 0.1
		;default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.1 0.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; Reserve block of infantry
	begin_block 5
		max_units				6
		unit_type				general_unit infantry 3.0
		unit_type				light infantry 0.1
		unit_type				chanting_screeching 3.0
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		0.2
		priority			0.1
	end_block

	;; spearmen on left_flank
	begin_block 6
		max_units				1
		unit_type				non_phalanx_spear 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 -5.0 0.0
		inter_unit_spacing		0.1
		priority			0.4
	end_block

	;; spearmen on right flank
	begin_block 7
		max_units				1
		unit_type				non_phalanx_spear 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 5.0 0.0
		inter_unit_spacing		0.1
		priority			0.4
	end_block

	begin_dummy_block 8
		spans	0 1 2 3 4 5 6 7
	end_dummy_block

	;; Archers behind
	begin_block 9
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		8 0.0 -30.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block


	;; artillery and handlers at the back
	begin_block 10
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 0.0 -30.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; left flank missile
	begin_block 11
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 -1.0 -5.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; right flank missile
	begin_block 12
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 1.0 -5.0
		inter_unit_spacing		6.0
		priority			0.6
	end_block

	begin_dummy_block 13
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank cavalry
	begin_block 14
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		13 -10.0 -3.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; right flank cavalry
	begin_block 15
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		13 10.0 -3.0
		inter_unit_spacing		6.0
		priority			0.6
	end_block

	;; left flank missile cavalry(decides to support the flank more)
	begin_block 16
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		13 -15.0 0.0
		inter_unit_spacing		3.0
		priority			0.3
	end_block

	;; right flank missile cavalry(decides to support the flank more)
	begin_block 17
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		13 15.0 0.0
		inter_unit_spacing		3.0
		priority			0.4
	end_block

	;; commander at the back
	begin_block 18
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		13 0.0 -20.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 19
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		18 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 20
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		13 -20.0 -5.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; any behind
	begin_block 21
		max_units				0
		unit_type				any 0.001
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		19 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation


;the formation attacks and maneuvres the cavalry to the flanks and on distance ready to charge from afar.
begin_formation ai_barbarian_onslaught_line_attack

	;;; purpose flags - attacking
	attack

	ai_priority				2.70

	supported_factions			dacia, gauls, galatians,, britons, germans, spain, thrace

	;; Center block of infantry
	begin_block 0
		;min_units				3
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		0 0.0 5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; Right block of infantry
	begin_block 1
		;min_units				3
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		0 0.1 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; Left block of infantry
	begin_block 2
		;min_units				3
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		0 -0.1 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; Left of left block of infantry
	begin_block 3
		min_units				1
		max_units				2
		not_general
		unit_type				light infantry 0.5
		unit_type				non_phalanx_spear 0.1
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		2 -0.1 0.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; Right of right block of infantry
	begin_block 4
		min_units				1
		max_units				2
		not_general
		unit_type				light infantry 0.5
		unit_type				non_phalanx_spear 0.1
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		1 0.1 0.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; Reserve block of infantry
	begin_block 5
		max_units				6
		unit_type				general_unit infantry 3.0
		unit_type				light infantry 0.1
		unit_type				chanting_screeching 3.0
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		0.2
		priority			0.1
	end_block

	;; spearmen on left_flank
	begin_block 6
		max_units				1
		unit_type				non_phalanx_spear 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 -5.0 0.0
		inter_unit_spacing		0.1
		priority			0.4
	end_block

	;; spearmen on right flank
	begin_block 7
		max_units				1
		unit_type				non_phalanx_spear 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 5.0 0.0
		inter_unit_spacing		0.1
		priority			0.4
	end_block

	begin_dummy_block 8
		spans	0 1 2 3 4 5 6 7
	end_dummy_block

	;; Archers behind
	begin_block 9
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		8 0.0 -20.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block


	;; artillery and handlers at the back
	begin_block 10
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 0.0 -30.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; left flank missile
	begin_block 11
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		8 -1.0 -35.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; right flank missile
	begin_block 12
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		8 1.0 -35.0
		inter_unit_spacing		6.0
		priority			0.6
	end_block

	begin_dummy_block 13
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank cavalry
	begin_block 14
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			square
		block_relative_pos		13 -35.0 25.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; right flank cavalry
	begin_block 15
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			square
		block_relative_pos		13 35.0 25.0
		inter_unit_spacing		6.0
		priority			0.6
	end_block

	;; left flank missile cavalry(decides to support the flank more)
	begin_block 16
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			column
		block_relative_pos		13 -45.0 0.0
		inter_unit_spacing		3.0
		priority			0.3
	end_block

	;; right flank missile cavalry(decides to support the flank more)
	begin_block 17
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			column
		block_relative_pos		13 45.0 0.0
		inter_unit_spacing		3.0
		priority			0.4
	end_block

	;; commander at the back
	begin_block 18
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		13 0.0 -20.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 19
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		18 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 20
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		13 -30.0 20.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; any behind
	begin_block 21
		max_units				0
		unit_type				any 0.001
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		19 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation


begin_formation ai_barbarian_onslaught_line_pursue

	;;; purpose flags - charging, pursue
	pursue

	ai_priority				2.70

	supported_factions			dacia, gauls, galatians,, britons, germans, spain, thrace

	;; Center block of infantry
	begin_block 0
		;min_units				3
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close
		max_unit_width			38
		block_formation			line
		block_relative_pos		0 0.0 5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; Right block of infantry
	begin_block 1
		;min_units				3
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close
		max_unit_width			38
		block_formation			line
		block_relative_pos		0 0.1 5.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; Left block of infantry
	begin_block 2
		;min_units				3
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close
		max_unit_width			38
		block_formation			line
		block_relative_pos		0 -0.1 5.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; Left of left block of infantry
	begin_block 3
		min_units				1
		max_units				2
		not_general
		unit_type				light infantry 0.5
		unit_type				non_phalanx_spear 0.1
		;default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		2 0.0 -0.2
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; Right of right block of infantry
	begin_block 4
		min_units				1
		max_units				2
		not_general
		unit_type				light infantry 0.5
		unit_type				non_phalanx_spear 0.1
		;default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -0.2
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; Reserve block of infantry
	begin_block 5
		max_units				6
		unit_type				general_unit infantry 3.0
		unit_type				light infantry 0.1
		unit_type				chanting_screeching 3.0
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		0.2
		priority			0.1
	end_block

	;; spearmen on left_flank
	begin_block 6
		max_units				1
		unit_type				non_phalanx_spear 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 -5.0 0.0
		inter_unit_spacing		0.1
		priority			0.4
	end_block

	;; spearmen on right flank
	begin_block 7
		max_units				1
		unit_type				non_phalanx_spear 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 5.0 0.0
		inter_unit_spacing		0.1
		priority			0.4
	end_block

	begin_dummy_block 8
		spans	0 1 2 3 4 5 6 7
	end_dummy_block

	;; Archers behind
	begin_block 9
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		8 0.0 -20.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block


	;; artillery and handlers at the back
	begin_block 10
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 0.0 -40.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; left flank missile
	begin_block 11
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 -1.0 -5.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; right flank missile
	begin_block 12
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 1.0 -5.0
		inter_unit_spacing		6.0
		priority			0.6
	end_block

	begin_dummy_block 13
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank cavalry
	begin_block 14
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			square
		block_relative_pos		13 -15.0 -15.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; right flank cavalry
	begin_block 15
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			square
		block_relative_pos		13 15.0 -15.0
		inter_unit_spacing		6.0
		priority			0.6
	end_block

	;; left flank missile cavalry(decides to support the flank more)
	begin_block 16
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			column
		block_relative_pos		13 -25.0 0.0
		inter_unit_spacing		3.0
		priority			0.3
	end_block

	;; right flank missile cavalry(decides to support the flank more)
	begin_block 17
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			column
		block_relative_pos		13 25.0 0.0
		inter_unit_spacing		3.0
		priority			0.4
	end_block

	;; commander at the back
	begin_block 18
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		13 0.0 -30.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 19
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		18 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 20
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		13 5.0 10.0	; hook from left to right
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; any behind
	begin_block 21
		max_units				0
		unit_type				any 0.001
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		19 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation


;the multirole swap of the formation will make cavalry to pull back and infantry to form a semi-square
begin_formation ai_barbarian_onslaught_line_approach

	;;; purpose flags - approaching
	attack
	defend

	ai_priority				2.70

	supported_factions			dacia, gauls, galatians,, britons, germans, spain, thrace

	;; Center block of infantry
	begin_block 0
		;min_units				3
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; Right block of infantry
	begin_block 1
		;min_units				3
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 0.1 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; Left block of infantry
	begin_block 2
		;min_units				3
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 -0.1 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; Left of left block of infantry
	begin_block 3
		min_units				1
		max_units				2
		not_general
		unit_type				light infantry 0.5
		unit_type				non_phalanx_spear 0.1
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		2 -0.2 -0.2
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; Right of right block of infantry
	begin_block 4
		min_units				1
		max_units				2
		not_general
		unit_type				light infantry 0.5
		unit_type				non_phalanx_spear 0.1
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		1 0.2 0.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; Reserve block of infantry
	begin_block 5
		max_units				6
		unit_type				general_unit infantry 3.0
		unit_type				light infantry 0.1
		unit_type				chanting_screeching 3.0
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		0.2
		priority			0.1
	end_block

	;; spearmen on left_flank
	begin_block 6
		max_units				1
		unit_type				non_phalanx_spear 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 -5.0 0.0
		inter_unit_spacing		0.1
		priority			0.4
	end_block

	;; spearmen on right flank
	begin_block 7
		max_units				1
		unit_type				non_phalanx_spear 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 5.0 0.0
		inter_unit_spacing		0.1
		priority			0.4
	end_block

	begin_dummy_block 8
		spans	0 1 2 3 4 5 6 7
	end_dummy_block

	;; Archers behind
	begin_block 9
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		8 0.0 -30.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block


	;; artillery and handlers at the back
	begin_block 10
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 0.0 -6.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; left flank missile
	begin_block 11
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		8 -1.0 -5.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; right flank missile
	begin_block 12
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		8 1.0 -5.0
		inter_unit_spacing		6.0
		priority			0.6
	end_block

	begin_dummy_block 13
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank cavalry
	begin_block 14
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		13 -1.0 -3.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; right flank cavalry
	begin_block 15
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		13 1.0 -3.0
		inter_unit_spacing		6.0
		priority			0.6
	end_block

	;; left flank missile cavalry(decides to support the flank more)
	begin_block 16
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		13 -15.0 0.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;; right flank missile cavalry(decides to support the flank more)
	begin_block 17
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		13 15.0 0.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	;; commander at the back
	begin_block 18
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		13 0.0 -20.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 19
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		18 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 20
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		13 -20.0 1.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; any behind
	begin_block 21
		max_units				0
		unit_type				any 0.001
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		19 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation



;**********************************************************************************************************************************************
; Barbaric Spear Wall (modified from Darth RTW). Powerful center. En mass deployment of infantry for maximum effect of charge.(This relies more on heavy spearmen)
;**********************************************************************************************************************************************

;the multirole swap of the formation will make cavalry to pull back and infantry to form a semi-square
begin_formation ai_barbarian_defend_line_march

	;;; purpose flags - regrouping
	march

	ai_priority				2.40

	supported_factions			gauls, galatians,, britons, germans, spain, scythia, dacia

	;; Center block of infantry
	begin_block 0
		min_units				3
		max_units				3
		not_general
		unit_type				non_phalanx_spear 0.1
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; Right block of infantry
	begin_block 1
		min_units				2
		max_units				2
		not_general
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		0 0.1 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; Left block of infantry
	begin_block 2
		min_units				2
		max_units				2
		not_general
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		0 -0.1 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; Left of left block of infantry
	begin_block 3
		max_units				1
		not_general
		unit_type				non_phalanx_spear 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		2 -0.3 0.0
		inter_unit_spacing		0.1
		priority			0.6
	end_block

	;; Right of right block of infantry
	begin_block 4
		max_units				1
		not_general
		unit_type				non_phalanx_spear 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		1 0.3 0.0
		inter_unit_spacing		0.1
		priority			0.6
	end_block

	;; Back spearmen line
	begin_block 5
		min_units				1
		max_units				3
		unit_type				spearmen_pilum_infantry 1.0
		unit_type				non_phalanx_spear 0.2
		unit_type				light infantry 0.1
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; Left flank guards
	begin_block 6
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		3 -0.3 0.0
		inter_unit_spacing		0.1
		priority			0.6
	end_block

	;; Right flank guards
	begin_block 7
		max_units				4
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		;unit_formation			square
		;unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		4 0.3 0.0
		inter_unit_spacing		0.1
		priority			0.6
	end_block

	;; Left back flank guards
	begin_block 8
		max_units				1
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		3 -0.3 0.0
		inter_unit_spacing		0.1
		priority			0.3
	end_block

	;; Right back flank guards
	begin_block 9
		max_units				1
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		;unit_formation			square
		;unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		4 0.3 0.0
		inter_unit_spacing		0.1
		priority			0.3
	end_block

	begin_dummy_block 10
		spans	0 1 2 3 4 5 6 7 8 9
	end_dummy_block

	;; Archers behind
	begin_block 11
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		skirmish
		unit_formation			square
		max_unit_width			15
		block_formation			line
		block_relative_pos		10 0.0 -20.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block


	;; artillery and handlers at the back
	begin_block 12
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			15
		block_formation			line
		block_relative_pos		11 0.0 -6.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; left flank missile
	begin_block 13
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 1.0
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			15
		block_formation			line
		block_relative_pos		10 -1.0 -5.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; right flank missile
	begin_block 14
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 1.0
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			15
		block_formation			column
		block_relative_pos		10 1.0 -5.0
		inter_unit_spacing		6.0
		priority			0.6
	end_block

	begin_dummy_block 15
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13 14
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank cavalry
	begin_block 16
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			15
		block_formation			square
		block_relative_pos		15 -1.0 -3.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; right flank cavalry
	begin_block 17
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			15
		block_formation			square
		block_relative_pos		15 1.0 -3.0
		inter_unit_spacing		6.0
		priority			0.6
	end_block

	;; left flank missile cavalry(decides to support the flank more)
	begin_block 18
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			15
		block_formation			column
		block_relative_pos		15 -5.0 0.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;; right flank missile cavalry(decides to support the flank more)
	begin_block 19
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			15
		block_formation			column
		block_relative_pos		15 5.0 0.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	;; commander at the back
	begin_block 20
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		15 0.0 -10.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 21
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		20 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 22
		max_units				0
		unit_type				any 0.001
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		22 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	begin_block 23
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			20
		block_formation			column
		block_relative_pos		3 -20.0 1.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

end_formation


;Powerful center attack.
begin_formation ai_barbarian_defend_line_deploy

	;;; purpose flags - deploy, defending
	defend

	ai_priority				2.40

	supported_factions			gauls, galatians,, britons, germans, spain, scythia, dacia

	;; Center block of infantry
	begin_block 0
		min_units				3
		max_units				3
		not_general
		unit_type				non_phalanx_spear 0.1
		;default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; Right block of infantry
	begin_block 1
		min_units				2
		max_units				2
		not_general
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.1 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; Left block of infantry
	begin_block 2
		min_units				2
		max_units				2
		not_general
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 -0.1 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; Left of left block of infantry
	begin_block 3
		max_units				1
		not_general
		unit_type				non_phalanx_spear 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		2 -0.3 0.0
		inter_unit_spacing		0.1
		priority			0.6
	end_block

	;; Right of right block of infantry
	begin_block 4
		max_units				1
		not_general
		unit_type				non_phalanx_spear 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		1 0.3 0.0
		inter_unit_spacing		0.1
		priority			0.6
	end_block

	;; Back spearmen line
	begin_block 5
		min_units				1
		max_units				3
		unit_type				spearmen_pilum_infantry 1.0
		unit_type				non_phalanx_spear 0.2
		unit_type				light infantry 0.1
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; Left flank guards
	begin_block 6
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		3 -0.3 0.0
		inter_unit_spacing		0.1
		priority			0.6
	end_block

	;; Right flank guards
	begin_block 7
		max_units				4
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.1
		default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		4 0.3 0.0
		inter_unit_spacing		0.1
		priority			0.6
	end_block

	;; Left back flank guards
	begin_block 8
		max_units				1
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.1
		default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		3 -0.3 0.0
		inter_unit_spacing		0.1
		priority			0.3
	end_block

	;; Right back flank guards
	begin_block 9
		max_units				1
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		unit_formation			shield_wall, schiltrom, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		4 0.3 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	begin_dummy_block 10
		spans	0 1 2 3 4 5 6 7 8 9
	end_dummy_block

	;; Archers behind
	begin_block 11
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		10 0.0 -30.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block


	;; artillery and handlers at the back
	begin_block 12
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		11 0.0 -6.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; left flank missile
	begin_block 13
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		10 -1.0 -5.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; right flank missile
	begin_block 14
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		10 1.0 -5.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	begin_dummy_block 15
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13 14
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank cavalry
	begin_block 16
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		15 -10.0 -3.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; right flank cavalry
	begin_block 17
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		15 10.0 -3.0
		inter_unit_spacing		6.0
		priority			0.6
	end_block

	;; left flank missile cavalry(decides to support the flank more)
	begin_block 18
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		15 -15.0 0.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; right flank missile cavalry(decides to support the flank more)
	begin_block 19
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		15 15.0 0.0
		inter_unit_spacing		10.0
		priority			0.4
	end_block

	;; commander at the back
	begin_block 20
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		15 0.0 -20.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 21
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		20 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 22
		max_units				0
		unit_type				any 0.001
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		21 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	begin_block 23
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		15 -20.0 -5.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

end_formation


;the formation attacks and maneuvres the cavalry to the flanks and on distance ready to charge from afar.
begin_formation ai_barbarian_defend_line_attack

	;;; purpose flags - attacking
	attack

	ai_priority				2.40

	supported_factions			gauls, galatians,, britons, germans, spain, scythia, dacia

	;; Center block of infantry
	begin_block 0
		min_units				3
		max_units				3
		not_general
		unit_type				non_phalanx_spear 0.1
		;default_melee_state		defend
		;unit_formation			square
		;unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		0 0.0 5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; Right block of infantry
	begin_block 1
		min_units				2
		max_units				2
		not_general
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		;unit_formation			square
		;unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		0 0.1 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; Left block of infantry
	begin_block 2
		min_units				2
		max_units				2
		not_general
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		;unit_formation			square
		;unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		0 -0.1 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; Left of left block of infantry
	begin_block 3
		max_units				1
		not_general
		unit_type				non_phalanx_spear 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		;unit_formation			square
		;unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		2 -0.3 0.0
		inter_unit_spacing		0.1
		priority			0.6
	end_block

	;; Right of right block of infantry
	begin_block 4
		max_units				1
		not_general
		unit_type				non_phalanx_spear 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		;unit_formation			square
		;unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.3 0.0
		inter_unit_spacing		0.1
		priority			0.6
	end_block

	;; Back spearmen line
	begin_block 5
		min_units				1
		max_units				3
		unit_type				spearmen_pilum_infantry 1.0
		unit_type				non_phalanx_spear 0.2
		unit_type				light infantry 0.1
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; Left flank guards
	begin_block 6
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.1
		default_melee_state		defend
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		3 -0.3 0.0
		inter_unit_spacing		0.1
		priority			0.6
	end_block

	;; Right flank guards
	begin_block 7
		max_units				4
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.1
		default_melee_state		defend
		;unit_formation			square
		;unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		4 0.3 0.0
		inter_unit_spacing		0.1
		priority			0.6
	end_block

	;; Left back flank guards
	begin_block 8
		max_units				1
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.1
		default_melee_state		defend
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		3 -0.3 0.0
		inter_unit_spacing		0.1
		priority			0.3
	end_block

	;; Right back flank guards
	begin_block 9
		max_units				1
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.1
		default_melee_state		defend
		;unit_formation			square
		;unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		4 0.3 0.0
		inter_unit_spacing		0.1
		priority			0.3
	end_block

	begin_dummy_block 10
		spans	0 1 2 3 4 5 6 7 8 9
	end_dummy_block

	;; Archers behind
	begin_block 11
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		10 0.0 -20.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block


	;; artillery and handlers at the back
	begin_block 12
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			24
		block_formation			line
		block_relative_pos		11 0.0 -30.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; left flank missile
	begin_block 13
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		11 -1.0 -35.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; right flank missile
	begin_block 14
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		11 1.0 -35.0
		inter_unit_spacing		6.0
		priority			0.6
	end_block

	begin_dummy_block 15
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13 14
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank cavalry
	begin_block 16
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			square
		block_relative_pos		15 -35.0 25.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; right flank cavalry
	begin_block 17
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			square
		block_relative_pos		15 35.0 25.0
		inter_unit_spacing		6.0
		priority			0.6
	end_block

	;; left flank missile cavalry(decides to support the flank more)
	begin_block 18
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			column
		block_relative_pos		15 -45.0 0.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; right flank missile cavalry(decides to support the flank more)
	begin_block 19
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			column
		block_relative_pos		15 45.0 0.0
		inter_unit_spacing		10.0
		priority			0.4
	end_block

	;; commander at the back
	begin_block 20
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		15 0.0 -20.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 21
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		20 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 22
		max_units				0
		unit_type				any 0.001
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		21 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	begin_block 23
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 -30.0 20.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

end_formation


begin_formation ai_barbarian_defend_line_pursue

	;;; purpose flags - charging, pursue
	pursue

	ai_priority				2.40

	supported_factions			gauls, galatians,, britons, germans, spain, scythia, dacia

	;; Center block of infantry
	begin_block 0
		min_units				3
		max_units				3
		not_general
		unit_type				non_phalanx_spear 0.1
		;default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; Right block of infantry
	begin_block 1
		min_units				2
		max_units				2
		not_general
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.1 0.0
		inter_unit_spacing		0.0
		priority			0.8
	end_block

	;; Left block of infantry
	begin_block 2
		min_units				2
		max_units				2
		not_general
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 -0.1 0.0
		inter_unit_spacing		0.0
		priority			0.8
	end_block

	;; Left of left block of infantry
	begin_block 3
		max_units				1
		not_general
		unit_type				non_phalanx_spear 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		2 0.0 -0.2
		inter_unit_spacing		0.1
		priority			0.6
	end_block

	;; Right of right block of infantry
	begin_block 4
		max_units				1
		not_general
		unit_type				non_phalanx_spear 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -0.2
		inter_unit_spacing		0.1
		priority			0.6
	end_block

	;; Back spearmen line
	begin_block 5
		min_units				1
		max_units				3
		unit_type				spearmen_pilum_infantry 1.0
		unit_type				non_phalanx_spear 0.2
		unit_type				light infantry 0.1
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; Left flank guards
	begin_block 6
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.1
		default_melee_state		defend
		;unit_formation			square
		unit_density			close
		max_unit_width			38
		block_formation			line
		block_relative_pos		3 -0.3 0.0
		inter_unit_spacing		0.1
		priority			0.6
	end_block

	;; Right flank guards
	begin_block 7
		max_units				4
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.1
		default_melee_state		defend
		;unit_formation			square
		;unit_density			close
		max_unit_width			38
		block_formation			line
		block_relative_pos		4 0.3 0.0
		inter_unit_spacing		0.1
		priority			0.6
	end_block

	;; Left back flank guards
	begin_block 8
		max_units				1
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.1
		default_melee_state		defend
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		3 -0.3 0.0
		inter_unit_spacing		0.1
		priority			0.3
	end_block

	;; Right back flank guards
	begin_block 9
		max_units				1
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.1
		default_melee_state		defend
		;unit_formation			square
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		4 0.3 0.0
		inter_unit_spacing		0.1
		priority			0.3
	end_block

	begin_dummy_block 10
		spans	0 1 2 3 4 5 6 7 8 9
	end_dummy_block

	;; Archers behind
	begin_block 11
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		10 0.0 -20.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block


	;; artillery and handlers at the back
	begin_block 12
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			24
		block_formation			line
		block_relative_pos		11 0.0 -40.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; left flank missile
	begin_block 13
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		11 -1.0 -5.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; right flank missile
	begin_block 14
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		11 1.0 -5.0
		inter_unit_spacing		6.0
		priority			0.6
	end_block

	begin_dummy_block 15
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank cavalry
	begin_block 16
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			square
		block_relative_pos		15 -15.0 -15.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; right flank cavalry
	begin_block 17
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			square
		block_relative_pos		15 15.0 -15.0
		inter_unit_spacing		6.0
		priority			0.6
	end_block

	;; left flank missile cavalry(decides to support the flank more)
	begin_block 18
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			column
		block_relative_pos		15 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; right flank missile cavalry(decides to support the flank more)
	begin_block 19
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			column
		block_relative_pos		15 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.4
	end_block

	;; commander at the back
	begin_block 20
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		15 0.0 -30.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 21
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		20 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 22
		max_units				0
		unit_type				any 0.001
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		21 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	begin_block 23
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 5.0 10.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

end_formation


;the multirole swap of the formation will make cavalry to pull back and infantry to form a semi-square
begin_formation ai_barbarian_defend_line_approach

	;;; purpose flags - approaching
	attack
	defend

	ai_priority				2.40

	supported_factions			gauls, galatians,, britons, germans, spain, scythia, dacia

	;; Center block of infantry
	begin_block 0
		min_units				3
		max_units				3
		not_general
		unit_type				non_phalanx_spear 0.1
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; Right block of infantry
	begin_block 1
		min_units				2
		max_units				2
		not_general
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		0 0.1 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; Left block of infantry
	begin_block 2
		min_units				2
		max_units				2
		not_general
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		0 -0.1 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; Left of left block of infantry
	begin_block 3
		max_units				1
		not_general
		unit_type				non_phalanx_spear 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		2 0.0 -0.2
		inter_unit_spacing		0.1
		priority			0.6
	end_block

	;; Right of right block of infantry
	begin_block 4
		max_units				1
		not_general
		unit_type				non_phalanx_spear 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -0.2
		inter_unit_spacing		0.1
		priority			0.6
	end_block

	;; Back spearmen line
	begin_block 5
		min_units				1
		max_units				3
		unit_type				spearmen_pilum_infantry 1.0
		unit_type				non_phalanx_spear 0.2
		unit_type				light infantry 0.1
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; Left flank guards
	begin_block 6
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.1
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			15
		block_formation			column
		block_relative_pos		3 -0.3 0.0
		inter_unit_spacing		0.1
		priority			0.6
	end_block

	;; Right flank guards
	begin_block 7
		max_units				4
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.1
		default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			15
		block_formation			column
		block_relative_pos		4 0.3 0.0
		inter_unit_spacing		0.1
		priority			0.6
	end_block

	;; Left back flank guards
	begin_block 8
		max_units				1
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.1
		default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			15
		block_formation			column
		block_relative_pos		3 -0.3 0.0
		inter_unit_spacing		0.1
		priority			0.3
	end_block

	;; Right back flank guards
	begin_block 9
		max_units				1
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.1
		default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			15
		block_formation			column
		block_relative_pos		4 0.3 0.0
		inter_unit_spacing		0.1
		priority			0.3
	end_block

	begin_dummy_block 10
		spans	0 1 2 3 4 5 6 7 8 9
	end_dummy_block

	;; Archers behind
	begin_block 11
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		10 0.0 -30.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block


	;; artillery and handlers at the back
	begin_block 12
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		11 0.0 -6.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; left flank missile
	begin_block 13
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		10 -1.0 -5.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; right flank missile
	begin_block 14
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		10 1.0 -5.0
		inter_unit_spacing		6.0
		priority			0.6
	end_block

	begin_dummy_block 15
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13 14
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank cavalry
	begin_block 16
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		15 -10.0 -3.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; right flank cavalry
	begin_block 17
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		15 10.0 -3.0
		inter_unit_spacing		6.0
		priority			0.6
	end_block

	;; left flank missile cavalry(decides to support the flank more)
	begin_block 18
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		15 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; right flank missile cavalry(decides to support the flank more)
	begin_block 19
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		15 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.4
	end_block

	;; commander at the back
	begin_block 20
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		15 0.0 -20.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 21
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		20 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 22
		max_units				0
		unit_type				any 0.001
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		22 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	begin_block 23
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 -20.0 1.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

end_formation



;************************************************************************************************
; phalanx barbarian/non-hellenistic single line attack formation, min 3 phalax units (created by Sinuhet)
;************************************************************************************************

begin_formation phalanx_barbar_attack_1_march

	;;; purpose flags - regrouping
	march

	ai_priority				2.50

	supported_factions			gauls, galatians,, britons, germans, spain, thrace, dacia, scythia, numidia, slave

	; Screen of missile inf
	begin_block 0
		max_units				3
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_density			close		; always deploy and defend as close
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; phalanx line
	begin_block 1
		min_units				3
		unit_type				phalanx 1.0
		default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		0.1
		priority			0.95
	end_block

	;; missile troops behind the spearmen

	begin_block 2
		max_units				4
		unit_type				chanting_screeching 3.0
		unit_type				ranged_missile_infantry 1.5
		unit_type				missile infantry 0.1
		;default_melee_state		fire_at_will_and_skirmish
		max_unit_width			15
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_block 3
		max_units				8
		unit_type				ranged_missile_infantry 2.0
		;default_melee_state		fire_at_will_and_defend
		max_unit_width			15
		block_formation			line
		block_relative_pos		2 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; left non-phalanx lines
	begin_block 4
		max_units				6
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		1 -0.3 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; right non-phalanx lines
	begin_block 5
		max_units				6
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		1 0.3 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 6
		max_units				6
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.8
		;default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		4 -1.5 0.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; right side
	begin_block 7
		max_units				6
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.8
		;default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		5 1.5 0.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	begin_dummy_block 8
		spans	1 2 3 4 5 6 7
	end_dummy_block

	;; Screen of missile inf on both flanks

	;; left flank
	begin_block 9
		max_units				3
		unit_type				skirmish infantry 1.0
		;default_melee_state		fire_at_will_and_skirmish
		;unit_density			close		; always deploy and defend as close
		max_unit_width			15
		block_formation			column
		block_relative_pos		8 -5.0 5.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; right flank
	begin_block 10
		max_units				3
		unit_type				skirmish infantry 1.0
		;default_melee_state		fire_at_will_and_skirmish
		;unit_density			close		; always deploy and defend as close
		max_unit_width			15
		block_formation			column
		block_relative_pos		8 5.0 5.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	begin_dummy_block 11
		spans	0 1 2 3 4 5 6 7 8 9 10
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 12
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		11 -10.0 -3.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank
	begin_block 13
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		11 10.0 -3.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; left flank missile cav
	begin_block 14
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		11 -15.0 0.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	;; right flank missile cav
	begin_block 15
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		11 15.0 0.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; general at the back
	begin_block 16
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 17
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		16 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; artillery and handler behind
	begin_block 18
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			line
		block_relative_pos		11 0.0 -50.0
		inter_unit_spacing		10.0
		priority			0.1
	end_block

	;; back line of other units
	begin_block 19
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		11 0.0 -30.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation


begin_formation phalanx_barbar_attack_1_deploy

	;;; purpose flags - defending
	defend

	ai_priority				2.50

	supported_factions			gauls, galatians,, britons, germans, spain, thrace, dacia, scythia, numidia, slave

	; Screen of missile inf
	begin_block 0
		max_units				3
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; phalanx line
	begin_block 1
		min_units				3
		unit_type				phalanx 1.0
		default_melee_state		defend
		unit_formation			phalanx
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		0.1
		priority			0.95
	end_block

	;; missile troops behind the spearmen

	begin_block 2
		max_units				4
		unit_type				chanting_screeching 3.0
		unit_type				ranged_missile_infantry 1.5
		unit_type				missile infantry 0.1
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_block 3
		max_units				8
		unit_type				ranged_missile_infantry 2.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		2 0.0 -30.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; left non-phalanx lines
	begin_block 4
		max_units				6
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -1.5 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; right non-phalanx lines
	begin_block 5
		max_units				6
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 1.5 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 6
		max_units				6
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		4 -0.3 0.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; right side
	begin_block 7
		max_units				6
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		5 0.3 0.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	begin_dummy_block 8
		spans	1 2 3 4 5 6 7
	end_dummy_block

	;; Screen of missile inf on both flanks

	;; left flank
	begin_block 9
		max_units				3
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		8 -5.0 5.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; right flank
	begin_block 10
		max_units				3
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		8 5.0 5.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	begin_dummy_block 11
		spans	0 1 2 3 4 5 6 7 8 9 10
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 12
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		11 -10.0 -3.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank
	begin_block 13
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		11 10.0 -3.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; left flank missile cav
	begin_block 14
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		11 -15.0 0.0
		inter_unit_spacing		10.0
		priority			0.4
	end_block

	;; right flank missile cav
	begin_block 15
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		11 15.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; general at the back
	begin_block 16
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 17
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		16 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; artillery and handler behind
	begin_block 18
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		11 0.0 -50.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; back line of other units
	begin_block 19
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		11 0.0 -40.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation


begin_formation phalanx_barbar_attack_1_attack

	;;; purpose flags - attacking
	attack

	ai_priority				2.50

	supported_factions			gauls, galatians,, britons, germans, spain, thrace, dacia, scythia, numidia, slave

	; Screen of missile inf
	begin_block 0
		max_units				3
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; phalanx line
	begin_block 1
		min_units				3
		unit_type				phalanx 1.0
		default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		0.1
		priority			0.95
	end_block

	;; missile troops behind the spearmen

	begin_block 2
		max_units				4
		unit_type				chanting_screeching 3.0
		unit_type				ranged_missile_infantry 1.5
		unit_type				missile infantry 0.1
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_block 3
		max_units				8
		unit_type				ranged_missile_infantry 2.0
		default_melee_state		fire_at_will_and_defend
		max_unit_width			40
		block_formation			line
		block_relative_pos		2 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; left non-phalanx lines
	begin_block 4
		max_units				6
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -0.3 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; right non-phalanx lines
	begin_block 5
		max_units				6
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.3 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 6
		max_units				6
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.8
		;default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		;unit_density			close
		block_formation			column
		block_relative_pos		4 -0.3 0.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; right side
	begin_block 7
		max_units				6
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		;unit_density			close
		block_formation			column
		block_relative_pos		5 0.3 0.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	begin_dummy_block 8
		spans	1 2 3 4 5 6 7
	end_dummy_block

	;; Screen of missile inf on both flanks

	;; left flank
	begin_block 9
		max_units				3
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			column
		block_relative_pos		8 -10.0 35.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; right flank
	begin_block 10
		max_units				3
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			column
		block_relative_pos		8 10.0 35.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	begin_dummy_block 11
		spans	0 1 2 3 4 5 6 7 8 9 10
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 12
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		11 -35.0 25.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank
	begin_block 13
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		11 35.0 25.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; left flank missile cav
	begin_block 14
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		11 -15.0 0.0
		inter_unit_spacing		10.0
		priority			0.4
	end_block

	;; right flank missile cav
	begin_block 15
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		11 15.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; general at the back
	begin_block 16
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 17
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		16 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; artillery and handler behind
	begin_block 18
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		11 0.0 -50.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; back line of other units
	begin_block 19
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		11 0.0 -40.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation


begin_formation phalanx_barbar_attack_1_pursue

	;;; purpose flags - charging, pursue
	pursue

	ai_priority				2.50

	supported_factions			gauls, galatians,, britons, germans, spain, thrace, dacia, scythia, numidia, slave

	; Screen of missile inf
	begin_block 0
		max_units				3
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; phalanx line
	begin_block 1
		min_units				3
		unit_type				phalanx 1.0
		default_melee_state		defend
		unit_formation			phalanx
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		0.1
		priority			0.95
	end_block

	;; missile troops behind the spearmen

	begin_block 2
		max_units				4
		unit_type				chanting_screeching 3.0
		unit_type				ranged_missile_infantry 1.5
		unit_type				missile infantry 0.1
		default_melee_state		fire_at_will
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_block 3
		max_units				8
		unit_type				ranged_missile_infantry 2.0
		default_melee_state		fire_at_will_and_defend
		max_unit_width			40
		block_formation			line
		block_relative_pos		2 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; left non-phalanx lines
	begin_block 4
		max_units				6
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -0.3 5.0
		inter_unit_spacing		0.1
		priority			0.1
	end_block

	;; right non-phalanx lines
	begin_block 5
		max_units				6
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.3 5.0
		inter_unit_spacing		0.1
		priority			0.1
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 6
		max_units				6
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.8
		;default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close
		block_formation			line
		block_relative_pos		4 -0.3 0.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; right side
	begin_block 7
		max_units				6
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.8
		;default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close
		block_formation			line
		block_relative_pos		5 0.3 0.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	begin_dummy_block 8
		spans	1 2 3 4 5 6 7
	end_dummy_block

	;; Screen of missile inf on both flanks

	;; left flank
	begin_block 9
		max_units				3
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		8 -10.0 35.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; right flank
	begin_block 10
		max_units				3
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		8 10.0 35.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	begin_dummy_block 11
		spans	0 1 2 3 4 5 6 7 8 9 10
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 12
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		11 -15.0 -15.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank
	begin_block 13
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		11 15.0 -15.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; left flank missile cav
	begin_block 14
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		11 -15.0 0.0
		inter_unit_spacing		10.0
		priority			0.4
	end_block

	;; right flank missile cav
	begin_block 15
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		14 15.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; general at the back
	begin_block 16
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		11 0.0 -30.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 17
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		16 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; artillery and handler behind
	begin_block 18
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		11 0.0 -50.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; back line of other units
	begin_block 19
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		11 0.0 -40.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation


begin_formation phalanx_barbar_attack_1_approach

	;;; purpose flags - approaching
	defend
	attack

	ai_priority				2.50

	supported_factions			gauls, galatians,, britons, germans, spain, thrace, dacia, scythia, numidia, slave

	; Screen of missile inf
	begin_block 0
		max_units				3
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; phalanx line
	begin_block 1
		min_units				3
		unit_type				phalanx 1.0
		default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		0.1
		priority			0.95
	end_block

	;; missile troops behind the spearmen

	begin_block 2
		max_units				4
		unit_type				chanting_screeching 3.0
		unit_type				ranged_missile_infantry 1.5
		unit_type				missile infantry 0.1
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_block 3
		max_units				8
		unit_type				ranged_missile_infantry 2.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		2 0.0 -30.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; left non-phalanx lines
	begin_block 4
		max_units				6
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -0.3 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; right non-phalanx lines
	begin_block 5
		max_units				6
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.3 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 6
		max_units				6
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		4 -1.5 0.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; right side
	begin_block 7
		max_units				6
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		5 1.5 0.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	begin_dummy_block 8
		spans	1 2 3 4 5 6 7
	end_dummy_block

	;; Screen of missile inf on both flanks

	;; left flank
	begin_block 9
		max_units				3
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		8 -5.0 5.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; right flank
	begin_block 10
		max_units				3
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		8 5.0 5.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	begin_dummy_block 11
		spans	0 1 2 3 4 5 6 7 8 9 10
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 12
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		11 -10.0 -3.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank
	begin_block 13
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		11 10.0 -3.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; left flank missile cav
	begin_block 14
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		11 -15.0 0.0
		inter_unit_spacing		10.0
		priority			0.4
	end_block

	;; right flank missile cav
	begin_block 15
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		11 15.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; general at the back
	begin_block 16
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 17
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		16 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; artillery and handler behind
	begin_block 18
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		11 0.0 -50.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; back line of other units
	begin_block 19
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		11 0.0 -30.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation



;************************************************************************************************
; barbarian non-phalanx single line with reserves formations, min 13 spearmen units (created by Sinuhet)
; modified by Suppanut with element from Pax Barbaricia's barbarian formations
;************************************************************************************************

begin_formation nonphalanx_barbar_attack_1_march

	;;; purpose flags - regrouping
	march

	ai_priority				2.30

	supported_factions			gauls, galatians,, britons, germans, spain, thrace, dacia, scythia, numidia, slave

	; Screen of missile inf
	begin_block 0
		max_units				3
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		;default_melee_state		fire_at_will_and_skirmish
		;unit_density			close		; always deploy and defend as close
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; spearmen line
	begin_block 1
		min_units				13
		unit_type				non_phalanx_spear 1.0
		unit_type				spearmen_pilum_infantry 0.1
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; second spearmen line - precursor spearmen
	begin_block 2
		unit_type				spearmen_pilum_infantry 1.0
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		max_unit_width			15
		block_formation			line
		block_relative_pos		1 0.0 -5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; archer troops behind the spearmen
	begin_block 3
		max_units				4
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend
		max_unit_width			15
		block_formation			line
		block_relative_pos		2 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 4
		max_units				3
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.8
		;default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		1 -0.3 0.0
		inter_unit_spacing		0.3
		priority			0.8
	end_block

	;; right side
	begin_block 5
		max_units				3
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.8
		;default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		1 0.3 0.0
		inter_unit_spacing		0.3
		priority			0.8
	end_block

	;; left of left side
	begin_block 6
		max_units				2
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.8
		;default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		4 -0.3 0.0
		inter_unit_spacing		0.3
		priority			0.5
	end_block

	;; right of right side
	begin_block 7
		max_units				2
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.8
		;default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		5 0.3 0.0
		inter_unit_spacing		0.3
		priority			0.5
	end_block

	begin_dummy_block 8
		spans	1 2 3 4 5 6 7
	end_dummy_block

	;; Screen of missile inf on both flanks

	;; left flank
	begin_block 9
		max_units				3
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		;default_melee_state		fire_at_will_and_skirmish
		;unit_density			close		; always deploy and defend as close
		max_unit_width			15
		block_formation			column
		block_relative_pos		8 -5.0 5.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; right flank
	begin_block 10
		max_units				3
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		;default_melee_state		fire_at_will_and_skirmish
		;unit_density			close		; always deploy and defend as close
		max_unit_width			15
		block_formation			column
		block_relative_pos		8 5.0 5.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	begin_dummy_block 11
		spans	1 2 3 4 5 6 7 8 9 10
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 12
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		11 -10.0 -3.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank
	begin_block 13
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		11 10.0 -3.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; left flank missile cav
	begin_block 14
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		11 -15.0 0.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	;; right flank missile cav
	begin_block 15
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		11 15.0 0.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; general at the back
	begin_block 16
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 17
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		16 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; artillery and handler behind
	begin_block 18
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			line
		block_relative_pos		11 0.0 -50.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; back line of other units
	begin_block 19
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		11 0.0 -30.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation


begin_formation nonphalanx_barbar_attack_1_deploy

	;;; purpose flags - deploy, defending
	defend

	ai_priority				2.30

	supported_factions			gauls, galatians,, britons, germans, spain, thrace, dacia, scythia, numidia, slave

	; Screen of missile inf
	begin_block 0
		max_units				3
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; spearmen line
	begin_block 1
		min_units				13
		unit_type				non_phalanx_spear 1.0
		unit_type				spearmen_pilum_infantry 0.1
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; second spearmen line - precursor spearmen
	begin_block 2
		unit_type				spearmen_pilum_infantry 1.0
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; archer troops behind the spearmen
	begin_block 3
		max_units				4
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		2 0.0 -30.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 4
		max_units				3
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		1 -1.5 0.0
		inter_unit_spacing		0.3
		priority			0.8
	end_block

	;; right side
	begin_block 5
		max_units				3
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		1 1.5 0.0
		inter_unit_spacing		0.3
		priority			0.8
	end_block

	;; left of left side
	begin_block 6
		max_units				2
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		4 -0.3 0.0
		inter_unit_spacing		0.3
		priority			0.5
	end_block

	;; right of right side
	begin_block 7
		max_units				2
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		5 0.3 0.0
		inter_unit_spacing		0.3
		priority			0.5
	end_block

	begin_dummy_block 8
		spans	1 2 3 4 5 6 7
	end_dummy_block

	;; Screen of missile inf on both flanks

	;; left flank
	begin_block 9
		max_units				3
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		8 -5.0 5.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; right flank
	begin_block 10
		max_units				3
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		8 5.0 5.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	begin_dummy_block 11
		spans	0 1 2 3 4 5 6 7 8 9 10
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 12
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		11 -10.0 -3.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank
	begin_block 13
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		11 10.0 -3.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; left flank missile cav
	begin_block 14
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		11 -15.0 0.0
		inter_unit_spacing		10.0
		priority			0.4
	end_block

	;; right flank missile cav
	begin_block 15
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		11 15.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; general at the back
	begin_block 16
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 17
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		16 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; artillery and handler behind
	begin_block 18
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		11 0.0 -50.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; back line of other units
	begin_block 19
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		11 0.0 -30.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation


begin_formation nonphalanx_barbar_attack_1_attack

	;;; purpose flags - attacking
	attack

	ai_priority				2.30

	supported_factions			gauls, galatians,, britons, germans, spain, thrace, dacia, scythia, numidia, slave

	; Screen of missile inf
	begin_block 0
		max_units				3
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; spearmen line
	begin_block 1
		min_units				13
		unit_type				non_phalanx_spear 1.0
		unit_type				spearmen_pilum_infantry 0.1
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; second spearmen line - precursor spearmen
	begin_block 2
		unit_type				spearmen_pilum_infantry 1.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; archer troops behind the spearmen
	begin_block 3
		max_units				4
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		max_unit_width			40
		block_formation			line
		block_relative_pos		2 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 4
		max_units				3
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.8
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		block_formation			column
		block_relative_pos		1 -1.5 0.0
		inter_unit_spacing		0.3
		priority			0.8
	end_block

	;; right side
	begin_block 5
		max_units				3
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.8
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		block_formation			column
		block_relative_pos		1 1.5 0.0
		inter_unit_spacing		0.3
		priority			0.8
	end_block

	;; left of left side
	begin_block 6
		max_units				2
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		;unit_density			close
		block_formation			column
		block_relative_pos		4 -0.3 0.0
		inter_unit_spacing		0.3
		priority			0.5
	end_block

	;; right of right side
	begin_block 7
		max_units				2
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		;unit_density			close
		block_formation			column
		block_relative_pos		5 0.3 0.0
		inter_unit_spacing		0.3
		priority			0.5
	end_block

	begin_dummy_block 8
		spans	1 2 3 4 5 6 7
	end_dummy_block

	;; Screen of missile inf on both flanks

	;; left flank
	begin_block 9
		max_units				3
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			column
		block_relative_pos		8 -10.0 35.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; right flank
	begin_block 10
		max_units				3
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			column
		block_relative_pos		8 10.0 35.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	begin_dummy_block 11
		spans	0 1 2 3 4 5 6 7 8 9 10
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 12
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		11 -35.0 25.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank
	begin_block 13
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		11 35.0 25.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; left flank missile cav
	begin_block 14
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		11 -15.0 0.0
		inter_unit_spacing		10.0
		priority			0.4
	end_block

	;; right flank missile cav
	begin_block 15
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		11 15.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; general at the back
	begin_block 16
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 17
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		16 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; artillery and handler behind
	begin_block 18
		unit_type				handler 1.0
		unit_type				siege 3.0
		max_unit_width			24
		block_formation			line
		block_relative_pos		11 0.0 -50.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; back line of other units
	begin_block 19
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		11 0.0 -30.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation


begin_formation nonphalanx_barbar_attack_1_pursue

	;;; purpose flags - charging, pursue
	pursue

	ai_priority				2.30

	supported_factions			gauls, galatians,, britons, germans, spain, thrace, dacia, scythia, numidia, slave

	; Screen of missile inf
	begin_block 0
		max_units				3
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; spearmen line
	begin_block 1
		min_units				13
		unit_type				non_phalanx_spear 1.0
		unit_type				spearmen_pilum_infantry 0.1
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; second spearmen line - precursor spearmen
	begin_block 2
		unit_type				spearmen_pilum_infantry 1.0
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; archer troops behind the spearmen
	begin_block 3
		max_units				4
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		max_unit_width			40
		block_formation			line
		block_relative_pos		2 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 4
		max_units				3
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.8
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close
		block_formation			line
		block_relative_pos		1 -1.5 0.0
		inter_unit_spacing		0.3
		priority			0.8
	end_block

	;; right side
	begin_block 5
		max_units				3
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.8
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close
		block_formation			line
		block_relative_pos		1 1.5 0.0
		inter_unit_spacing		0.3
		priority			0.8
	end_block

	;; left of left side
	begin_block 6
		max_units				2
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.8
		;default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close
		block_formation			line
		block_relative_pos		4 -0.3 0.0
		inter_unit_spacing		0.3
		priority			0.5
	end_block

	;; right of right side
	begin_block 7
		max_units				2
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.8
		;default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close
		block_formation			line
		block_relative_pos		5 0.3 0.0
		inter_unit_spacing		0.3
		priority			0.5
	end_block

	begin_dummy_block 8
		spans	1 2 3 4 5 6 7
	end_dummy_block

	;; Screen of missile inf on both flanks

	;; left flank
	begin_block 9
		max_units				3
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		8 -10.0 35.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; right flank
	begin_block 10
		max_units				3
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		8 10.0 35.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	begin_dummy_block 11
		spans	0 1 2 3 4 5 6 7 8 9 10
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 12
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		11 -15.0 -15.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank
	begin_block 13
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		11 15.0 -15.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; left flank missile cav
	begin_block 14
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		11 -15.0 0.0
		inter_unit_spacing		10.0
		priority			0.4
	end_block

	;; right flank missile cav
	begin_block 15
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		11 15.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; general at the back
	begin_block 16
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		11 0.0 -30.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 17
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		16 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; artillery and handler behind
	begin_block 18
		unit_type				handler 1.0
		unit_type				siege 3.0
		max_unit_width			24
		block_formation			line
		block_relative_pos		11 0.0 -50.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; back line of other units
	begin_block 19
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		11 0.0 -30.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation


begin_formation nonphalanx_barbar_attack_1_approach

	;;; purpose flags - approaching
	defend
	attack

	ai_priority				2.30

	supported_factions			gauls, galatians,, britons, germans, spain, thrace, dacia, scythia, numidia, slave

	; Screen of missile inf
	begin_block 0
		max_units				3
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; spearmen line
	begin_block 1
		min_units				13
		unit_type				non_phalanx_spear 1.0
		unit_type				spearmen_pilum_infantry 0.1
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; second spearmen line - precursor spearmen
	begin_block 2
		unit_type				spearmen_pilum_infantry 1.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; archer troops behind the spearmen
	begin_block 3
		max_units				4
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		2 0.0 -30.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 4
		max_units				3
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		1 -0.3 0.0
		inter_unit_spacing		0.3
		priority			0.8
	end_block

	;; right side
	begin_block 5
		max_units				3
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		1 0.3 0.0
		inter_unit_spacing		0.3
		priority			0.8
	end_block

	;; left of left side
	begin_block 6
		max_units				2
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		4 -0.3 0.0
		inter_unit_spacing		0.3
		priority			0.5
	end_block

	;; right of right side
	begin_block 7
		max_units				2
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		5 0.3 0.0
		inter_unit_spacing		0.3
		priority			0.5
	end_block

	begin_dummy_block 8
		spans	1 2 3 4 5 6 7
	end_dummy_block

	;; Screen of missile inf on both flanks

	;; left flank
	begin_block 9
		max_units				3
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		8 -5.0 5.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; right flank
	begin_block 10
		max_units				3
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		8 5.0 5.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	begin_dummy_block 11
		spans	1 2 3 4 5 6 7 8 9 10
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 12
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		11 -10.0 -3.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank
	begin_block 13
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		11 10.0 -3.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; left flank missile cav
	begin_block 14
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		11 -15.0 0.0
		inter_unit_spacing		10.0
		priority			0.4
	end_block

	;; right flank missile cav
	begin_block 15
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		11 15.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; general at the back
	begin_block 16
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 17
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		16 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; artillery and handler behind
	begin_block 18
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		11 0.0 -50.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; back line of other units
	begin_block 19
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		11 0.0 -30.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation



;**********************************************************************************************************************************************
; Barbaric Onslaught (original Darth-RTW). Powerful center. En mass deployment of infantry for maximum effect of charge.
;**********************************************************************************************************************************************

;Powerful center attack.
begin_formation ai_barbarian_line_2_march

	;;; purpose flags - regrouping
	march

	ai_priority				2.00

	supported_factions			gauls, galatians,, britons, germans, dacia

	;; Center block of infantry
	begin_block 0
		min_units				1
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		unit_type				spearmen 0.3
		unit_type				any 0.001
		;default_melee_state		defend
		;unit_formation			square
		;unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		0 0.0 5.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;;Right block of infantry
	begin_block 1
		min_units				1
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		unit_type				spearmen 0.3
		unit_type				any 0.001
		;default_melee_state		defend
		;unit_formation			square
		;unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		0 0.2 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; Left block of infantry
	begin_block 2
		min_units				1
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		unit_type				spearmen 0.3
		unit_type				any 0.001
		;default_melee_state		defend
		;unit_formation			square
		;unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		0 -0.2 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; Left of left block of infantry
	begin_block 3
		min_units				1
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		unit_type				spearmen 0.3
		unit_type				any 0.001
		;default_melee_state		defend
		;unit_formation			square
		;unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		2 -0.2 0.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; Right of right block of infantry
	begin_block 4
		min_units				1
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		unit_type				spearmen 0.3
		unit_type				any 0.001
		;default_melee_state		defend
		;unit_formation			square
		;unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		1 0.2 0.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	begin_dummy_block 5
		spans  0 1 2 3 4
	end_dummy_block

	;; Archers behind
	begin_block 6
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		unit_type				missile infantry 0.2
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			20
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block


	;; artillery and handlers at the back
	begin_block 7
		not_general
		unit_type				handler 1.0
		unit_type				siege 1.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			20
		block_formation			line
		block_relative_pos		6 0.0 -6.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	begin_dummy_block 8
		spans 0 1 2 3 4 5 6 7
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank cav
	begin_block 9
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		max_unit_width			20
		block_formation			line
		block_relative_pos		5 -1.0 -5.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; right flank cav
	begin_block 10
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		max_unit_width			20
		block_formation			line
		block_relative_pos		5 1.0 -5.0
		inter_unit_spacing		6.0
		priority			0.6
	end_block

	;; left flank cav(more)
	begin_block 11
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		max_unit_width			20
		block_formation			line
		block_relative_pos		9 0.0 -3.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; right flank cav(more)
	begin_block 12
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		max_unit_width			20
		block_formation			line
		block_relative_pos		10 0.0 -3.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; general at the back
	begin_block 13
		;min_units				1
		;max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		8 0.0 -20.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 14
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		13 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 15
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;unit_formation			wedge
		;default_melee_state		skirmish
		max_unit_width			20
		block_formation			column
		block_relative_pos		3 -20.0 1.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

end_formation


;Powerful center attack.
begin_formation ai_barbarian_line_2_deploy

	;;; purpose flags - deploy, defending
	defend

	ai_priority				2.00

	supported_factions			gauls, galatians,, britons, germans, dacia

	;; Center block of infantry
	begin_block 0
		min_units				1
		max_units				3
		not_general
		unit_type				spearmen 1.0
		unit_type				heavy infantry 0.8
		unit_type				light infantry 0.5
		unit_type				any 0.001
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;;Right block of infantry
	begin_block 1
		min_units				1
		max_units				3
		not_general
		unit_type				spearmen 1.0
		unit_type				heavy infantry 0.8
		unit_type				light infantry 0.5
		unit_type				any 0.001
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		0 0.2 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; Left block of infantry
	begin_block 2
		min_units				1
		max_units				3
		not_general
		unit_type				spearmen 1.0
		unit_type				heavy infantry 0.8
		unit_type				light infantry 0.5
		unit_type				any 0.001
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		0 -0.2 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; Left of left block of infantry
	begin_block 3
		min_units				1
		max_units				3
		not_general
		unit_type				spearmen 1.0
		unit_type				heavy infantry 0.8
		unit_type				light infantry 0.5
		unit_type				any 0.001
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		2 -0.2 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; Right of right block of infantry
	begin_block 4
		min_units				1
		max_units				3
		not_general
		unit_type				spearmen 1.0
		unit_type				heavy infantry 0.8
		unit_type				light infantry 0.5
		unit_type				any 0.001
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		1 0.2 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	begin_dummy_block 5
		spans  0 1 2 3 4
	end_dummy_block

	;; Archers behind
	begin_block 6
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		unit_type				missile infantry 0.2
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		5 0.0 -30.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; artillery and handlers at the back
	begin_block 7
		not_general
		unit_type				handler 1.0
		unit_type				siege 1.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 0.0 -6.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	begin_dummy_block 8
		spans 0 1 2 3 4 5 6 7
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank cav
	begin_block 9
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		8 -1.0 -5.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; right flank cav
	begin_block 10
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		8 1.0 -5.0
		inter_unit_spacing		6.0
		priority			0.6
	end_block

	;; left flank cav(more)
	begin_block 11
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		9 0.0 -3.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank cav(more)
	begin_block 12
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		10 0.0 -3.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; general at the back
	begin_block 13
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			20
		block_formation			line
		block_relative_pos		8 0.0 -20.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 14
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		13 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 15
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;unit_formation			wedge
		;default_melee_state		skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		14 0.0 -5.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

end_formation


;the formation attacks and maneuvres the cavalry to the flanks and on distance ready to charge from afar.
begin_formation ai_barbarian_line_2_attack

	;;; purpose flags - attacking
	attack

	ai_priority				2.00

	supported_factions			gauls, galatians,, britons, germans, dacia

	;; Center block of infantry
	begin_block 0
		min_units				1
		max_units				3
		not_general
		unit_type				spearmen 1.0
		unit_type				heavy infantry 0.8
		unit_type				light infantry 0.5
		unit_type				any 0.001
		;default_melee_state		defend
		;unit_formation			square
		;unit_density			close
		max_unit_width			36
		block_formation			column
		block_relative_pos		0 0.0 5.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;;Right block of infantry
	begin_block 1
		min_units				1
		max_units				3
		not_general
		unit_type				spearmen 1.0
		unit_type				heavy infantry 0.8
		unit_type				light infantry 0.5
		unit_type				any 0.001
		;default_melee_state		defend
		;unit_formation			square
		;unit_density			close
		max_unit_width			36
		block_formation			column
		block_relative_pos		0 0.2 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; Left block of infantry
	begin_block 2
		min_units				1
		max_units				3
		not_general
		unit_type				spearmen 1.0
		unit_type				heavy infantry 0.8
		unit_type				light infantry 0.5
		unit_type				any 0.001
		;default_melee_state		defend
		;unit_formation			square
		;unit_density			close
		max_unit_width			36
		block_formation			column
		block_relative_pos		0 -0.2 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; Left of left block of infantry
	begin_block 3
		min_units				1
		max_units				3
		not_general
		unit_type				spearmen 1.0
		unit_type				heavy infantry 0.8
		unit_type				light infantry 0.5
		unit_type				any 0.001
		;default_melee_state		defend
		;unit_formation			square
		;unit_density			close
		max_unit_width			36
		block_formation			column
		block_relative_pos		2 -0.2 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; Right of right block of infantry
	begin_block 4
		min_units				1
		max_units				3
		not_general
		unit_type				spearmen 1.0
		unit_type				heavy infantry 0.8
		unit_type				light infantry 0.5
		unit_type				any 0.001
		;default_melee_state		defend
		;unit_formation			square
		;unit_density			close
		max_unit_width			36
		block_formation			column
		block_relative_pos		1 0.2 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	begin_dummy_block 5
		spans  0 1 2 3 4
	end_dummy_block

	;; Archers behind
	begin_block 6
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		unit_type				missile infantry 0.2
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; artillery and handlers at the back
	begin_block 7
		not_general
		unit_type				handler 1.0
		unit_type				siege 1.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 0.0 -6.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	begin_dummy_block 8
		spans 0 1 2 3 4 5 6 7
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank cav
	begin_block 9
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 -1.0 -35.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; right flank cav
	begin_block 10
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 1.0 -35.0
		inter_unit_spacing		6.0
		priority			0.6
	end_block

	;; left flank cav(more)
	begin_block 11
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		max_unit_width			30
		block_formation			line
		block_relative_pos		9 -1.0 -3.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank cav(more)
	begin_block 12
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		max_unit_width			30
		block_formation			line
		block_relative_pos		10 1.0 -3.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; general at the back
	begin_block 13
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		8 0.0 -20.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 14
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		13 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 15
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;unit_formation			wedge
		;default_melee_state		skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 -30.0 20.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

end_formation


begin_formation ai_barbarian_line_2_pursue

	;;; purpose flags - charging, pursue
	pursue

	ai_priority				2.00

	supported_factions			gauls, galatians,, britons, germans, dacia

	;; Center block of infantry
	begin_block 0
		min_units				1
		max_units				3
		not_general
		unit_type				light infantry 1.0
		unit_type				heavy infantry 0.5
		unit_type				any 0.001
		;default_melee_state		defend
		;unit_formation			square
		;unit_density			close
		max_unit_width			38
		block_formation			column
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;;Right block of infantry
	begin_block 1
		min_units				1
		max_units				3
		not_general
		unit_type				light infantry 1.0
		unit_type				heavy infantry 0.5
		unit_type				any 0.001
		;default_melee_state		defend
		;unit_formation			square
		;unit_density			close
		max_unit_width			38
		block_formation			column
		block_relative_pos		0 0.2 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; Left block of infantry
	begin_block 2
		min_units				1
		max_units				3
		not_general
		unit_type				light infantry 1.0
		unit_type				heavy infantry 0.5
		unit_type				any 0.001
		;default_melee_state		defend
		;unit_formation			square
		;unit_density			close
		max_unit_width			38
		block_formation			column
		block_relative_pos		0 -0.2 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; Left of left block of infantry
	begin_block 3
		min_units				1
		max_units				3
		not_general
		unit_type				light infantry 1.0
		unit_type				heavy infantry 0.5
		unit_type				any 0.001
		;default_melee_state		defend
		;unit_formation			square
		;unit_density			close
		max_unit_width			38
		block_formation			column
		block_relative_pos		2 0.0 -0.2
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; Right of right block of infantry
	begin_block 4
		min_units				1
		max_units				3
		not_general
		unit_type				light infantry 1.0
		unit_type				heavy infantry 0.5
		unit_type				any 0.001
		;default_melee_state		defend
		;unit_formation			square
		;unit_density			close
		max_unit_width			38
		block_formation			column
		block_relative_pos		1 0.0 -0.2
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	begin_dummy_block 5
		spans  0 1 2 3 4
	end_dummy_block

	;; Archers behind
	begin_block 6
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		unit_type				missile infantry 0.2
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block


	;; artillery and handlers at the back
	begin_block 7
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 0.0 -6.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	begin_dummy_block 8
		spans 0 1 2 3 4 5 6 7
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank cav
	begin_block 9
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 -15.0 -5.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; right flank cav
	begin_block 10
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 15.0 -5.0
		inter_unit_spacing		6.0
		priority			0.6
	end_block

	;; left flank cav(more)
	begin_block 11
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 1.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 0.0 -3.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank cav(more)
	begin_block 12
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 1.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		10 0.0 -3.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; general at the back
	begin_block 13
		;min_units				1
		;max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		8 0.0 -30.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 14
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		13 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 15
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;unit_formation			wedge
		;default_melee_state		skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 5.0 15.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

end_formation


;the multirole swap of the formation will make cavalry to pull back and infantry to form a semi-square
begin_formation ai_barbarian_line_2_approach

	;;; purpose flags - approaching
	attack
	defend

	ai_priority				2.00

	supported_factions			gauls, galatians,, britons, germans, dacia

	;; Center block of infantry
	begin_block 0
		min_units				1
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		unit_type				spearmen 0.3
		unit_type				any 0.001
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;;Right block of infantry
	begin_block 1
		min_units				1
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		unit_type				spearmen 0.3
		unit_type				any 0.001
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 0.2 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; Left block of infantry
	begin_block 2
		min_units				1
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		unit_type				spearmen 0.3
		unit_type				any 0.001
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 -0.2 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; Left of left block of infantry
	begin_block 3
		min_units				1
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		unit_type				spearmen 0.3
		unit_type				any 0.001
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		2 0.0 -0.2
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; Right of right block of infantry
	begin_block 4
		min_units				1
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		unit_type				spearmen 0.3
		unit_type				any 0.001
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		1 0.0 -0.2
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	begin_dummy_block 5
		spans  0 1 2 3 4
	end_dummy_block

	;; Archers behind
	begin_block 6
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		unit_type				missile infantry 0.2
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		5 0.0 -30.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block


	;; artillery and handlers at the back
	begin_block 7
		not_general
		unit_type				handler 1.0
		unit_type				siege 1.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		6 0.0 -6.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	begin_dummy_block 8
		spans 0 1 2 3 4 5 6 7
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank cav
	begin_block 9
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		8 -15.0 -5.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; right flank cav
	begin_block 10
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		8 15.0 -5.0
		inter_unit_spacing		6.0
		priority			0.6
	end_block

	;; left flank cav(more)
	begin_block 11
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		9 -1 -3.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank cav(more)
	begin_block 12
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 0.5
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		10 1 -3.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; general at the back
	begin_block 13
		;min_units				1
		;max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		8 0.0 -20.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 14
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		13 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 15
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 -20.0 1.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

end_formation



;****************************************************************
;****************************************************************
; Asian/Nomad infantry formations section
;****************************************************************
;****************************************************************

;***********************************************************************************************
; Skirmishing battle formation. Formation for missile strong armies. Missile Cavalry are in front.
; The skirmishers/missile units form a shield in front of vanguard.
;***********************************************************************************************

begin_formation ai_skirmish_line_march

	;;; purpose flags - regrouping									; can use this for anything
	march

	ai_priority				2.75

	supported_factions			carthage, pontus, armenia, parthia, numidia, scythia, slave

	;; Missile cavalry in front
	begin_block 0
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; Foot Skirmishers follow
	begin_block 1
		min_units				3
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; left Skirmishers
	begin_block 2
		min_units				1
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 -3.0 -1.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; right Skirmishers
	begin_block 3
		min_units				1
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 3.0 -1.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; The main heavy Infantry line
	begin_block 4
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		;default_melee_state		skirmish
		;unit_formation			shield_wall, schiltrom, square
		max_unit_width			20
		block_formation			line
		block_relative_pos		1 0.0 -15.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; the left cover of heavy infantry
	begin_block 5
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		;default_melee_state		skirmish
		;unit_formation			shield_wall, schiltrom, square
		max_unit_width			20
		block_formation			column
		block_relative_pos		4 -0.2 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; the right cover of heavy infantry
	begin_block 6
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		;default_melee_state		skirmish
		;unit_formation			shield_wall, schiltrom, square
		max_unit_width			20
		block_formation			column
		block_relative_pos		4 0.2 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; Secondary Infantry line (mainly light infantry)
	begin_block 7
		not_general
		unit_type				light infantry 1.0
		;default_melee_state		skirmish
		;unit_formation			shield_wall, square
		max_unit_width			20
		block_formation			line
		block_relative_pos		4 0.0 -5.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; Archer and chanter/screecher is here
	begin_block 8
		max_units				4
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			20
		block_formation			line
		block_relative_pos		7 0.0 -20.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	begin_dummy_block 9
		spans	4 5 6 7 8
	end_dummy_block

	;; Guards line
	begin_block 10
		not_general
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		max_unit_width			20
		block_formation			line
		block_relative_pos		9 0.0 -15.0
		inter_unit_spacing		0.1
		priority			0.3
	end_block

	;; commander at the back
	begin_block 11
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		9 0.0 -30.0
		inter_unit_spacing		40.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 12
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		11 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; left cavalry will protect the general at all costs.
	begin_block 13
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;unit_formation			square
		max_unit_width			20
		block_formation			square
		block_relative_pos		11 -2.0 0.0
		inter_unit_spacing		0.2
		priority			0.7
	end_block

	;; right cavalry will protect the general at all costs.
	begin_block 14
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;unit_formation			square
		max_unit_width			20
		block_formation			square
		block_relative_pos		11 2.0 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; put the artillery and handlers and long range missiles behind everyone
	begin_dummy_block 15
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13 14
	end_dummy_block

	;; elephants
	begin_block 16
		not_general
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			20
		block_formation			column
		block_relative_pos		9 -20.0 1.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_block 17
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			15
		block_formation			line
		block_relative_pos		15 0.0 -8.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	;; any behind
	begin_block 18
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		15 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	begin_block 19
		;not_general
		unit_type				heavy_chariots 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			15
		block_formation			column
		block_relative_pos		9 -10.0 10.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

end_formation


begin_formation ai_skirmish_line_deploy

	;;; purpose flags - deploy, defending
	defend
	march

	ai_priority				2.75

	supported_factions			carthage, pontus, armenia, parthia, numidia, scythia, slave

	;; Missile cavalry or Elephants in front
	begin_block 0
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		10.0
		priority			1.0
		end_block

	;; Foot Skirmishers follow
	begin_block 1
		min_units				3
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; left Skirmishers
	begin_block 2
		min_units				1
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 -3.0 -1.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; right Skirmishers
	begin_block 3
		min_units				1
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 3.0 -1.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; The main heavy Infantry line
	begin_block 4
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		;default_melee_state		defend
		unit_formation			shield_wall, schiltrom, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -15.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; the left cover of heavy infantry
	begin_block 5
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		;default_melee_state		defend
		unit_formation			shield_wall, schiltrom, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		4 -0.2 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; the right cover of heavy infantry
	begin_block 6
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		;default_melee_state		defend
		unit_formation			shield_wall, schiltrom, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		4 0.2 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; Secondary Infantry line (mainly light infantry)
	begin_block 7
		not_general
		unit_type				light infantry 1.0
		;default_melee_state		skirmish
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			20
		block_formation			line
		block_relative_pos		4 0.0 -5.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; Archer and chanter/screecher is here
	begin_block 8
		max_units				4
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		7 0.0 -30.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	begin_dummy_block 9
		spans	4 5 6 7 8
	end_dummy_block

	;; Guards line
	begin_block 10
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 0.0 -15.0
		inter_unit_spacing		0.1
		priority			0.3
	end_block

	;; commander at the back
	begin_block 11
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		9 0.0 -30.0
		inter_unit_spacing		40.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 12
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		11 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry will protect the general at all costs.
	begin_block 13
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		11 -2.0 0.0
		inter_unit_spacing		0.2
		priority			0.7
	end_block

	;; cavalry will protect the general at all costs.
	begin_block 14
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		11 2.0 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; elephants
	begin_block 15
		not_general
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		12 0.0 -10.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; put the artillery and handlers and long range missiles behind everyone
	begin_dummy_block 16
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15
	end_dummy_block

	begin_block 17
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		16 0.0 -8.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	;; any behind
	begin_block 18
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		16 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	begin_block 19
		;not_general
		unit_type				heavy_chariots 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		9 -20.0 -5.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

end_formation


;the formation attacks and the missile cavalry goes ahead to pepper the enemy. The archers will cover the infantry and support cavalry will predate
begin_formation ai_skirmish_line_attack

	;;; purpose flags - attacking
	attack
	march

	ai_priority				2.75

	supported_factions			carthage, pontus, armenia, parthia, numidia, scythia, slave

	;; Missile cavalry or Elephants in front
	begin_block 0
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		20.0
		priority			1.0
	end_block

	;; Foot Skirmishers follow
	begin_block 1
		min_units				3
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; left Skirmishers
	begin_block 2
		min_units				1
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 -3.0 -1.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; right Skirmishers
	begin_block 3
		min_units				1
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 3.0 -1.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; The main heavy Infantry line
	begin_block 4
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		;default_melee_state		skirmish
		;unit_formation			shield_wall, schiltrom, square
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -55.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; the left cover of heavy infantry
	begin_block 5
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		;default_melee_state		skirmish
		;unit_formation			shield_wall, schiltrom, square
		max_unit_width			24
		block_formation			column
		block_relative_pos		2 -0.2 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; the right cover of heavy infantry
	begin_block 6
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		;default_melee_state		skirmish
		;unit_formation			shield_wall, schiltrom, square
		max_unit_width			24
		block_formation			column
		block_relative_pos		2 0.2 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; Secondary Infantry line (mainly light infantry)
	begin_block 7
		not_general
		unit_type				light infantry 1.0
		;default_melee_state		skirmish
		;unit_formation			shield_wall, square
		max_unit_width			20
		block_formation			line
		block_relative_pos		4 0.0 -5.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; Archer and chanter/screecher is here
	begin_block 8
		max_units				4
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		7 0.0 -20.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	begin_dummy_block 9
		spans	4 5 6 7 8
	end_dummy_block

	;; Guards line
	begin_block 10
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 0.0 -15.0
		inter_unit_spacing		0.1
		priority			0.3
	end_block

	;; commander at the back
	begin_block 11
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		9 0.0 -30.0
		inter_unit_spacing		40.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 12
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		11 0.0 -10.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry will protect the general at all costs.
	begin_block 13
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			24
		block_formation			square
		block_relative_pos		11 -22.0 0.0
		inter_unit_spacing		0.2
		priority			0.7
	end_block

	;; cavalry will protect the general at all costs.
	begin_block 14
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			24
		block_formation			square
		block_relative_pos		11 22.0 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; put the artillery and handlers and long range missiles behind everyone
	begin_dummy_block 15
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13 14
	end_dummy_block

	;; elephants
	begin_block 16
		not_general
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 -30.0 20.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_block 17
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			24
		block_formation			line
		block_relative_pos		15 0.0 -30.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	;; any behind
	begin_block 18
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		17 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	begin_block 19
		;not_general
		unit_type				heavy_chariots 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			line
		block_relative_pos		15 -30.0 -20.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

end_formation


begin_formation ai_skirmish_line_pursue

	;;; purpose flags - charging, pursue
	pursue
	march

	ai_priority				2.75

	supported_factions			carthage, pontus, armenia, parthia, numidia, scythia, slave

	;; Missile cavalry or Elephants in front
	begin_block 0
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; Foot Skirmishers follow
	begin_block 1
		min_units				3
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; left Skirmishers
	begin_block 2
		min_units				1
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 -3.0 -1.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; right Skirmishers
	begin_block 3
		min_units				1
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 3.0 -1.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; The main heavy Infantry line
	begin_block 4
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		;default_melee_state		skirmish
		unit_formation			shield_wall, square
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -15.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; the left cover of heavy infantry
	begin_block 5
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		;default_melee_state		skirmish
		unit_formation			shield_wall, schiltrom, square
		max_unit_width			30
		block_formation			column
		block_relative_pos		4 -0.2 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; the right cover of heavy infantry
	begin_block 6
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		;default_melee_state		skirmish
		unit_formation			shield_wall, schiltrom, square
		max_unit_width			30
		block_formation			column
		block_relative_pos		4 0.2 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; Secondary Infantry line (mainly light infantry)
	begin_block 7
		not_general
		unit_type				light infantry 1.0
		;default_melee_state		skirmish
		unit_formation			shield_wall, square
		max_unit_width			30
		block_formation			line
		block_relative_pos		4 0.0 -5.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; Archer and chanter/screecher is here
	begin_block 8
		max_units				4
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		7 0.0 -20.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	begin_dummy_block 9
		spans	4 5 6 7 8
	end_dummy_block

	;; Guards line
	begin_block 10
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 0.0 -15.0
		inter_unit_spacing		0.1
		priority			0.3
	end_block

	;; commander at the back
	begin_block 11
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		9 0.0 -40.0
		inter_unit_spacing		40.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 12
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		11 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;;cavalry will attack left flank
	begin_block 13
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			square
		block_relative_pos		9 -15 0.0
		inter_unit_spacing		0.2
		priority			0.7
	end_block

	;;cavalry will attack right flank
	begin_block 14
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			square
		block_relative_pos		9 15 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; put the artillery and handlers and long range missiles behind everyone
	begin_dummy_block 15
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13 14
	end_dummy_block

	;; elephants
	begin_block 16
		not_general
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 5.0 15.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_block 17
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			24
		block_formation			line
		block_relative_pos		15 0.0 -8.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	;; any behind
	begin_block 18
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		17 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	begin_block 19
		;not_general
		unit_type				heavy_chariots 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			line
		block_relative_pos		9 5.0 10.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

end_formation


;ther multirole swap of the formation will make cavalry to pick flanks and attack!
begin_formation ai_skirmish_line_approach

	;;; purpose flags - approaching
	attack
	defend

	ai_priority				2.75

	supported_factions			carthage, pontus, armenia, parthia, numidia, scythia, slave

	;; Missile cavalry or Elephants in front
	begin_block 0
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		20.0
		priority			1.0
	end_block

	;; Foot Skirmishers follow
	begin_block 1
		min_units				3
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; left Skirmishers
	begin_block 2
		min_units				1
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 -3.0 -1.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; right Skirmishers
	begin_block 3
		min_units				1
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 3.0 -1.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; The main heavy Infantry line
	begin_block 4
		max_units				3
		not_general
		unit_type				heavy infantry 1.0
		;default_melee_state		skirmish
		;unit_formation			shield_wall, schiltrom, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -15.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; the left cover of heavy infantry
	begin_block 5
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		;default_melee_state		skirmish
		;unit_formation			shield_wall, schiltrom, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			36
		block_formation			column
		block_relative_pos		4 -0.2 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; the right cover of heavy infantry
	begin_block 6
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		;default_melee_state		skirmish
		;unit_formation			shield_wall, schiltrom, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			36
		block_formation			column
		block_relative_pos		4 0.2 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; Secondary Infantry line (mainly light infantry)
	begin_block 7
		not_general
		unit_type				light infantry 1.0
		;default_melee_state		skirmish
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			20
		block_formation			line
		block_relative_pos		4 0.0 -5.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; Archer and chanter/screecher is here
	begin_block 8
		max_units				4
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		7 0.0 -30.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	begin_dummy_block 9
		spans	4 5 6 7 8
	end_dummy_block

	;; Guards line
	begin_block 10
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 0.0 -15.0
		inter_unit_spacing		0.1
		priority			0.3
	end_block

	;; commander at the back
	begin_block 11
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		9 0.0 -30.0
		inter_unit_spacing		40.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 12
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		11 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;;cavalry will attack left flank
	begin_block 13
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		9 -15.0 0.0
		inter_unit_spacing		0.2
		priority			0.7
	end_block

	;;cavalry will attack right flank
	begin_block 14
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		9 15.0 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; put the artillery and handlers and long range missiles behind everyone
	begin_dummy_block 15
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13 14
	end_dummy_block

	;; elephants
	begin_block 16
		not_general
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 -20.0 1.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_block 17
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		15 0.0 -8.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	;; any behind
	begin_block 18
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		15 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	begin_block 19
		;not_general
		unit_type				heavy_chariots 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		9 -10.0 10.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

end_formation



;****************************************************************************************************************************
; Asian battle formation. Skirmishing will be a priority and also missile cavalry will cover flanks
; Modified by Suppanut by integrate modification of eastern formation by RedFox
;****************************************************************************************************************************

begin_formation ai_asian_line_march

	;;; purpose flags - regrouping
	march

	ai_priority				2.25

	supported_factions			pontus, armenia, parthia, scythia, seleucid

	;; If there are elephants, skirmishers will follow them to support them. The formation will stretch.
	begin_block 0
		min_units				1
		max_units				2
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		;unit_formation			square
		;default_melee_state		fire_at_will
		max_unit_width			80
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; right missile units
	begin_block 1
		min_units				1
		max_units				3
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.5
		;default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 2.0 -1.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	;; left missile units
	begin_block 2
		min_units				1
		max_units				3
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.5
		;default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 -2.0 -1.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	begin_dummy_block 3
		spans	0 1 2
	end_dummy_block

	;; The main troop line. Spearmen will form a mass.
	begin_block 4
		max_units				7
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		3 0.0 -6.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; Left secondary spearmen flank (mostly light spearmen)
	begin_block 5
		not_general
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		max_unit_width			15
		block_formation			line
		block_relative_pos		4 -1.0 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; Right secondary spearmen flank (mostly light spearmen)
	begin_block 6
		not_general
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		max_unit_width			15
		block_formation			line
		block_relative_pos		4 1.0 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	begin_dummy_block 7
		spans	4 5 6
	end_dummy_block

	;; the left cover of infantry
	begin_block 8
		min_units				1
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				spearmen_pilum_infantry 0.1
		;default_melee_state		skirmish
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		7 -1.0 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; the right cover of infantry
	begin_block 9
		min_units				1
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				spearmen_pilum_infantry 0.1
		;default_melee_state		skirmish
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		7 1.0 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; left light infantry (hillmen)
	begin_block 10
		min_units				1
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			line
		block_relative_pos		8 -5.0 0.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; right light infantry (hillmen)
	begin_block 11
		min_units				1
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			line
		block_relative_pos		9 5.0 0.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;missile line
	begin_block 13
		max_units				4
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		0.5
		priority			1.0
	end_block

	begin_dummy_block 14
		spans	3 7 12 13
	end_dummy_block

	; cavalry will protect the general at all costs.
	begin_block 15
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;unit_formation			square
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		14 0.0 -10.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; general at the back
	begin_block 16
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		14 0.0 -20.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 17
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		16 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;missile cavalry will cover the left
	begin_block 18
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			15
		block_formation			column
		block_relative_pos		14 -7.0 -3.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;missile cavalry will cover the right
	begin_block 19
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			15
		block_formation			column
		block_relative_pos		14 7.0 -3.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	begin_dummy_block 20
		spans	14 15 16 17 18 19
	end_dummy_block

	begin_block 21
		not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			20
		block_formation			column
		block_relative_pos		3 -20.0 1.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; put the artillery and handlers behind everyone
	begin_dummy_block 22
		spans	20 21
	end_dummy_block

	begin_block 23
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			15
		block_formation			line
		block_relative_pos		22 0.0 -2.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 24
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		22 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation


begin_formation ai_asian_line_deploy

	;;; purpose flags - deploy, defending
	defend

	ai_priority				2.25

	supported_factions			pontus, armenia, parthia, scythia, seleucid

	;; If there are elephants, skirmishers will follow them to support them.
	begin_block 0
		min_units				1
		max_units				2
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 10.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; right missile units
	begin_block 1
		min_units				1
		max_units				3
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.5
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 2.0 -1.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	;; left missile units
	begin_block 2
		min_units				1
		max_units				3
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.5
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 -2.0 -1.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	begin_dummy_block 3
		spans	0 1 2
	end_dummy_block

	;; The main troop line. Spearmen will form a mass.
	begin_block 4
		max_units				7
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		3 0.0 -6.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; Left secondary spearmen flank (mostly light spearmen)
	begin_block 5
		not_general
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		4 -1.0 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; Right secondary spearmen flank (mostly light spearmen)
	begin_block 6
		not_general
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		4 1.0 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	begin_dummy_block 7
		spans	4 5 6
	end_dummy_block

	;; the left cover of infantry
	begin_block 8
		min_units				1
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				spearmen_pilum_infantry 0.1
		;default_melee_state		defend
		unit_formation			shield_wall
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		4 -1.0 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; the right cover of infantry
	begin_block 9
		min_units				1
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				spearmen_pilum_infantry 0.1
		;default_melee_state		defend
		unit_formation			shield_wall
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		4 1.0 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; left light infantry (hillmen)
	begin_block 10
		min_units				1
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		8 -5.0 0.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; right light infantry (hillmen)
	begin_block 11
		min_units				1
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 5.0 0.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;missile line
	begin_block 13
		max_units				4
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		12 0.0 -30.0
		inter_unit_spacing		0.5
		priority			1.0
	end_block

	begin_dummy_block 14
		spans	3 7 12 13
	end_dummy_block

	; cavalry will protect the general at all costs.
	begin_block 15
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		14 0.0 -10.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; general at the back
	begin_block 16
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		14 0.0 -20.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 17
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		16 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	; missile cavalry will cover the left
	begin_block 18
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		14 -7.0 -3.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	; missile cavalry will cover the right
	begin_block 19
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		14 7.0 -3.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	begin_dummy_block 20
		spans	14 15 16 17 18 19
	end_dummy_block

	begin_block 21
		not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		20 -20.0 -5.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; put the artillery and handlers behind everyone
	begin_dummy_block 22
		spans	20 21
	end_dummy_block

	begin_block 23
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		22 0.0 -2.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 24
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		22 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation


;the formation attacks and sends skirmishers to challenge the enemy. The missile cavalry will challenge the enemy also.
begin_formation ai_asian_line_attack

	;;; purpose flags - attacking
	attack

	ai_priority				2.25

	supported_factions			pontus, armenia, parthia, scythia, seleucid

	;; If there are elephants, skirmishers will follow them to support them.
	begin_block 0
		min_units				1
		max_units				2
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; right missile units
	begin_block 1
		min_units				1
		max_units				3
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 2.0 25.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	;; left missile units
	begin_block 2
		min_units				1
		max_units				3
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 -2.0 25.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	begin_dummy_block 3
		spans	0 1 2
	end_dummy_block

	;; The main troop line. Spearmen will form a mass.
	begin_block 4
		max_units				7
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		3 0.0 -6.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; Left secondary spearmen flank (mostly light spearmen)
	begin_block 5
		not_general
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		block_formation			line
		block_relative_pos		4 -1.0 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; Right secondary spearmen flank (mostly light spearmen)
	begin_block 6
		not_general
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		block_formation			line
		block_relative_pos		4 1.0 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	begin_dummy_block 7
		spans	4 5 6
	end_dummy_block

	;; the left cover of infantry
	begin_block 8
		min_units				1
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				spearmen_pilum_infantry 0.1
		;default_melee_state		skirmish
		;unit_formation			shield_wall
		;unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 -1.0 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; the right cover of infantry
	begin_block 9
		min_units				1
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				spearmen_pilum_infantry 0.1
		;default_melee_state		skirmish
		;unit_formation			shield_wall
		;unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 1.0 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; left light infantry (hillmen)
	begin_block 10
		min_units				1
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will
		max_unit_width			40
		block_formation			line
		block_relative_pos		8 -5.0 0.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; right light infantry (hillmen)
	begin_block 11
		min_units				1
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 5.0 0.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;missile line
	begin_block 13
		max_units				4
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		0.5
		priority			1.0
	end_block

	begin_dummy_block 14
		spans	3 7 12 13
	end_dummy_block

	; cavalry will protect the general at all costs.
	begin_block 15
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		14 0.0 -30.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; general at the back
	begin_block 16
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		12 0.0 -45.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 17
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		16 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	; missile cavalry will cover the left
	begin_block 18
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			column
		block_relative_pos		14 -20 25.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	; missile cavalry will cover the right
	begin_block 19
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			column
		block_relative_pos		14 20 25.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	begin_dummy_block 20
		spans	14 15 16 17 18 19
	end_dummy_block

	begin_block 21
		not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 -30.0 20.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_block 22
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			24
		block_formation			line
		block_relative_pos		20 0.0 -2.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 23
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		22 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation


;the multirole swap of the formation will make missile cavalry to cover both flanks than attack.Missiles swap behind
begin_formation ai_asian_line_pursue

	;;; purpose flags - charging, pursue
	pursue

	ai_priority				2.25

	supported_factions			pontus, armenia, parthia, scythia, seleucid

	;; If there are elephants, skirmishers will follow them to support them. The formation will stretch.
	begin_block 0
		min_units				1
		max_units				2
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		;unit_formation			square
		;default_melee_state		fire_at_will
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; right missile units
	begin_block 1
		min_units				1
		max_units				3
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.5
		;default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 2.0 -1.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	;; left missile units
	begin_block 2
		min_units				1
		max_units				3
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.5
		;default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 -2.0 -1.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	begin_dummy_block 3
		spans	0 1 2
	end_dummy_block

	;; The main troop line. Spearmen will form a mass.
	begin_block 4
		max_units				7
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		3 0.0 10.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; Left secondary spearmen flank (mostly light spearmen)
	begin_block 5
		not_general
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		block_formation			line
		block_relative_pos		4 -1.0 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; Right secondary spearmen flank (mostly light spearmen)
	begin_block 6
		not_general
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		block_formation			line
		block_relative_pos		4 1.0 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	begin_dummy_block 7
		spans	4 5 6
	end_dummy_block

	;; the left cover of infantry
	begin_block 8
		min_units				1
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				spearmen_pilum_infantry 0.1
		;default_melee_state		skirmish
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		7 -1.0 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; the right cover of infantry
	begin_block 9
		min_units				1
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				spearmen_pilum_infantry 0.1
		;default_melee_state		skirmish
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		7 1.0 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; left light infantry (hillmen)
	begin_block 10
		min_units				1
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will
		max_unit_width			40
		block_formation			line
		block_relative_pos		8 -5.0 0.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; right light infantry (hillmen)
	begin_block 11
		min_units				1
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 5.0 0.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;missile line
	begin_block 13
		max_units				4
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		0.5
		priority			1.0
	end_block

	begin_dummy_block 14
		spans	3 7 12 13
	end_dummy_block

	; cavalry will protect the general at all costs.
	begin_block 15
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		14 0.0 -10.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; general at the back
	begin_block 16
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		12 0.0 -36.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 17
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		16 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	; missile cavalry will cover the left of general
	begin_block 18
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			column
		block_relative_pos		16 -17.0 -13.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	; missile cavalry will cover the right of general
	begin_block 19
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			column
		block_relative_pos		16 17.0 -13.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block


	begin_dummy_block 20
		spans	14 15 16 17 18 19
	end_dummy_block

	begin_block 21
		not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 5.0 10.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_block 22
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			24
		block_formation			line
		block_relative_pos		20 0.0 -12.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 23
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		22 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation


;the multirole swap of the formation will make missile cavalry to cover both flanks than attack.Missiles swap behind
begin_formation ai_asian_line_approach

	;;; purpose flags - approaching
	attack
	defend
	march

	ai_priority				2.25

	supported_factions			pontus, armenia, parthia, scythia, seleucid

	;; If there are elephants, skirmishers will follow them to support them. The formation will stretch.
	begin_block 0
		min_units				1
		max_units				2
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		;unit_formation			square
		;default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; right missile units
	begin_block 1
		min_units				1
		max_units				3
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.5
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 2.0 -1.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	;; left missile units
	begin_block 2
		min_units				1
		max_units				3
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.5
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 -2.0 -1.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	begin_dummy_block 3
		spans	0 1 2
	end_dummy_block

	;; The main troop line. Spearmen will form a mass.
	begin_block 4
		max_units				7
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		3 0.0 15.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; Left secondary spearmen flank (mostly light spearmen)
	begin_block 5
		not_general
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		4 -1.0 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; Right secondary spearmen flank (mostly light spearmen)
	begin_block 6
		not_general
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		4 1.0 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	begin_dummy_block 7
		spans	4 5 6
	end_dummy_block

	;; the left cover of infantry
	begin_block 8
		min_units				1
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				spearmen_pilum_infantry 0.1
		;default_melee_state		skirmish
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 -1.0 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; the right cover of infantry
	begin_block 9
		min_units				1
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				spearmen_pilum_infantry 0.1
		;default_melee_state		skirmish
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 1.0 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; left light infantry (hillmen)
	begin_block 10
		min_units				1
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		8 -5.0 0.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; right light infantry (hillmen)
	begin_block 11
		min_units				1
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 5.0 0.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;missile line
	begin_block 13
		max_units				4
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		12 0.0 -30.0
		inter_unit_spacing		0.5
		priority			1.0
	end_block

	begin_dummy_block 14
		spans	3 7 12 13
	end_dummy_block

	; cavalry will protect the general at all costs.
	begin_block 15
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		14 0.0 -10.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; general at the back
	begin_block 16
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		12 0.0 -25.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 17
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		16 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;missile cavalry will cover the left of general
	begin_block 18
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		16 -17.0 -3.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;missile cavalry will cover the right of general
	begin_block 19
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		16 17.0 -3.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block


	begin_dummy_block 20
		spans	14 15 16 17 18 19
	end_dummy_block

	begin_block 21
		not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 -20.0 1.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; put the artillery and handlers behind everyone
	begin_dummy_block 22
		spans	20 21
	end_dummy_block

	begin_block 23
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		22 0.0 -2.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 24
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		22 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

end_formation



;****************************************************************
;****************************************************************
; Phalanx&Spearmen-based formations section (hellenistic factions)
;****************************************************************
;****************************************************************

;***********************************************************************************************
; Carthaginian battle formation. Elephants are in front.The skirmishers/missile units
; form a shield in front of vanguard. Cavalry on the flanks. A resilient formation
;***********************************************************************************************

begin_formation ai_carthage_line_march

	;;; purpose flags - regrouping
	march

	ai_priority				2.90

	supported_factions			carthage, numidia

	; Screen of missile inf
	begin_block 0
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		;default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; The main troop line. Spearmen will form a mass.

	;; main phalanx line, maximal 7 phalanges
	begin_block 1
		min_units				3
		max_units				7
		not_general
		unit_type				phalanx 1.0
		;default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; the left cover of infantry
	begin_block 2
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.6
		;default_melee_state		skirmish
		;unit_formation			square
		;unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		1 -1.0 -8.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; the right cover of infantry
	begin_block 3
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.6
		;default_melee_state		skirmish
		;unit_formation			square
		;unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		1 1.0 -8.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; flank line left - light infantry, prec infantry
	begin_block 4
		min_units				1
		not_general
		unit_type				heavy_pilum_infantry 1.0
		unit_type				light_pilum_infantry 0.6
		default_melee_state		fire_at_will
		max_unit_width			20
		block_formation			line
		block_relative_pos		2 -5.0 0.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; flank line right - light infantry, prec infantry
	begin_block 5
		min_units				1
		not_general
		unit_type				heavy_pilum_infantry 1.0
		unit_type				light_pilum_infantry 0.6
		default_melee_state		fire_at_will
		max_unit_width			20
		block_formation			line
		block_relative_pos		3 5.0 0.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_dummy_block 6
		spans	1 2 3 4 5
	end_dummy_block

	;; left missile units
	begin_block 7
		max_units				3
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			20
		block_formation			line
		block_relative_pos		6 -2.0 -1.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	;; right missile units
	begin_block 8
		max_units				3
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			20
		block_formation			line
		block_relative_pos		6 2.0 -1.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	;; the left cover of infantry
	begin_block 9
		max_units				2
		unit_type				heavy infantry 1.0
		unit_type				non_phalanx_spear 0.5
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		max_unit_width			20
		block_formation			column
		block_relative_pos		7 -1.0 -8.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; the right cover of infantry
	begin_block 10
		max_units				2
		unit_type				heavy infantry 1.0
		unit_type				non_phalanx_spear 0.5
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		max_unit_width			20
		block_formation			column
		block_relative_pos		8 1.0 -8.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_dummy_block 11
		spans	7 8 9 10
	end_dummy_block

	;; Spearmen will form a back up force.
	begin_block 12
		max_units				8
		not_general
		unit_type				non_phalanx_spear 1.0
		unit_type				light infantry 0.1
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		max_unit_width			20
		block_formation			line
		block_relative_pos		11 0.0 -5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	begin_dummy_block 13
		spans	0 1 2 3 4 5 6 8 9 10 11 12
	end_dummy_block


	;; commander at the back
	begin_block 14
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		13 0.0 -10.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 15
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		14 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; If there are elephants, infantry will follow them to support them.
	begin_block 16
		not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		;unit_density			close		; always deploy and defend as close
		max_unit_width			20
		block_formation			column
		block_relative_pos		13 -20.0 1.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	; cavalry left
	begin_block 17
		unit_type				heavy cavalry 0.8
		unit_type				light cavalry 0.5
		;unit_formation			square, wedge
		;unit_density			close
		max_unit_width			20
		block_formation			square
		block_relative_pos		13 -7.0 -3.0
		inter_unit_spacing		0.2
		priority			0.7
	end_block

	; cavalry right
	begin_block 18
		unit_type				heavy cavalry 0.8
		unit_type				light cavalry 0.5
		;unit_formation			square, wedge
		;unit_density			close
		max_unit_width			20
		block_formation			square
		block_relative_pos		13 7.0 -3.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	; cavalry left (more)
	begin_block 19
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		;unit_density			close
		max_unit_width			20
		block_formation			square
		block_relative_pos		17 -1.0 -1.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	; cavalry right (more)
	begin_block 20
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		;unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		18 1.0 -1.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; put the artillery and handlers behind everyone
	begin_dummy_block 21
		spans	13 14 15 17 18 19 20
	end_dummy_block

	;; any behind
	begin_block 22
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		21 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	begin_block 23
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			15
		block_formation			line
		block_relative_pos		21 0.0 -2.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

end_formation


begin_formation ai_carthage_line_deploy

	;;; purpose flags - deploy, defend
	defend
	march

	ai_priority				2.90

	supported_factions			carthage, numidia

	;; If there are elephants, infantry will follow them to support them.
	begin_block 0
		max_units				5
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; The main troop line. Spearmen will form a mass.

	;; main phalanx line, maximal 7 phalanges
	begin_block 1
		min_units				3
		max_units				7
		not_general
		unit_type				phalanx 1.0
		default_melee_state		defend
		unit_formation			phalanx
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; the left cover of infantry
	begin_block 2
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.6
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		1 -1.0 -8.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; the right cover of infantry
	begin_block 3
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.6
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		1 1.0 -8.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; flank line left - light infantry, prec infantry
	begin_block 4
		min_units				1
		not_general
		unit_type				heavy_pilum_infantry 1.0
		unit_type				light_pilum_infantry 0.6
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		2 -5.0 0.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; flank line right - light infantry, prec infantry
	begin_block 5
		min_units				1
		not_general
		unit_type				heavy_pilum_infantry 1.0
		unit_type				light_pilum_infantry 0.6
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		3 5.0 0.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_dummy_block 6
		spans 0 1 2 3 4 5
	end_dummy_block

	;; left missile units
	begin_block 7
		max_units				3
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 -2.0 -1.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	;; right missile units
	begin_block 8
		max_units				3
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 2.0 -1.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	;; the left cover of infantry
	begin_block 9
		max_units				2
		unit_type				heavy infantry 1.0
		unit_type				non_phalanx_spear 0.5
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		7 -1.0 -8.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; the right cover of infantry
	begin_block 10
		max_units				2
		unit_type				heavy infantry 1.0
		unit_type				non_phalanx_spear 0.5
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		8 1.0 -8.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_dummy_block 11
		spans	6 7 8 9 10
	end_dummy_block

	;; Spearmen will form a back up force.
	begin_block 12
		max_units				8
		not_general
		unit_type				non_phalanx_spear 1.0
		unit_type				light infantry 0.1
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		11 0.0 -5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	begin_dummy_block 13
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12
	end_dummy_block


	;; commander at the back
	begin_block 14
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		13 0.0 -20.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 15
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		14 0.0 -10.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 16
		not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		13 -20.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	; cavalry left
	begin_block 17
		unit_type				heavy cavalry 0.8
		unit_type				light cavalry 0.5
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		13 -7.0 -3.0
		inter_unit_spacing		0.2
		priority			0.7
	end_block

	; cavalry right
	begin_block 18
		unit_type				heavy cavalry 0.8
		unit_type				light cavalry 0.5
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		13 7.0 -3.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	; cavalry left (more)
	begin_block 19
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		17 -1.0 -1.0
		inter_unit_spacing		10.0
		priority			0.4
	end_block

	; cavalry right (more)
	begin_block 20
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		18 1.0 -1.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; put the artillery and handlers behind everyone
	begin_dummy_block 21
		spans	13 14 15 16 17 18 19 20
	end_dummy_block

	;; any behind
	begin_block 22
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		21 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	begin_block 23
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		21 0.0 -2.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

end_formation


;the formation attacks and attacks with coordination. No real skirmishing but really punishing missile attack.The Elephants will be a covering powerful force.Lively flanking
begin_formation ai_carthage_line_attack

	;;; purpose flags - attacking
	attack

	ai_priority				2.90

	supported_factions			carthage, numidia

	; Screen of missile inf
	begin_block 0
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; The main troop line. Spearmen will form a mass.

	;; main phalanx line, maximal 7 phalanges
	begin_block 1
		min_units				3
		max_units				7
		not_general
		unit_type				phalanx 1.0
		default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; the left cover of infantry
	begin_block 2
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.6
		;default_melee_state		skirmish
		;unit_formation			square
		;unit_density			close
		max_unit_width			40
		block_formation			column
		block_relative_pos		1 -1.0 -15.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; the right cover of infantry
	begin_block 3
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.6
		;default_melee_state		skirmish
		;unit_formation			square
		;unit_density			close
		max_unit_width			40
		block_formation			column
		block_relative_pos		1 1.0 -15.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; flank line left - light infantry, prec infantry
	begin_block 4
		min_units				1
		not_general
		unit_type				heavy_pilum_infantry 1.0
		unit_type				light_pilum_infantry 0.6
		default_melee_state		fire_at_will
		block_formation			line
		block_relative_pos		2 -5.0 0.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; flank line right - light infantry, prec infantry
	begin_block 5
		min_units				1
		not_general
		unit_type				heavy_pilum_infantry 1.0
		unit_type				light_pilum_infantry 0.6
		default_melee_state		fire_at_will
		block_formation			line
		block_relative_pos		3 5.0 0.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_dummy_block 6
		spans	0 1 2 3 4 5
	end_dummy_block

	;; left missile units
	begin_block 7
		max_units				3
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 -2.0 -20.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	;; right missile units
	begin_block 8
		max_units				3
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 2.0 -20.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	;; the left cover of infantry
	begin_block 9
		max_units				2
		unit_type				heavy infantry 1.0
		unit_type				non_phalanx_spear 0.5
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		max_unit_width			24
		block_formation			column
		block_relative_pos		7 -1.0 -8.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; the right cover of infantry
	begin_block 10
		max_units				2
		unit_type				heavy infantry 1.0
		unit_type				non_phalanx_spear 0.5
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		max_unit_width			24
		block_formation			column
		block_relative_pos		8 1.0 -8.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_dummy_block 11
		spans	6 7 8 9 10
	end_dummy_block

	;; Spearmen will form a back up force.
	begin_block 12
		max_units				8
		not_general
		unit_type				non_phalanx_spear 1.0
		unit_type				light infantry 0.1
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		max_unit_width			24
		block_formation			line
		block_relative_pos		11 0.0 -30.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	begin_dummy_block 13
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12
	end_dummy_block

	;; commander at the back
	begin_block 14
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		13 0.0 -20.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 15
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		14 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; If there are elephants, skirmishers will follow them to support them.
	begin_block 16
		not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		13 -30.0 20.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	; cavalry left
	begin_block 17
		unit_type				heavy cavalry 0.8
		unit_type				light cavalry 0.5
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		13 -17.0 -30.0
		inter_unit_spacing		0.2
		priority			0.7
	end_block

	; cavalry right
	begin_block 18
		unit_type				heavy cavalry 0.8
		unit_type				light cavalry 0.5
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		13 17.0 -30.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	; cavalry left (more)
	begin_block 19
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		;unit_density			close
		max_unit_width			30
		block_formation			square
		block_relative_pos		17 -1.0 -1.0
		inter_unit_spacing		10.0
		priority			0.4
	end_block

	; cavalry right (more)
	begin_block 20
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		;unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		18 1.0 -1.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; put the artillery and handlers behind everyone
	begin_dummy_block 21
		spans	13 14 15 17 18 19 20
	end_dummy_block

	;; any behind
	begin_block 22
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		21 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	begin_block 23
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			24
		block_formation			line
		block_relative_pos		21 0.0 -10.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

end_formation


begin_formation ai_carthage_line_pursue

	;;; purpose flags - charging, pursue
	pursue

	ai_priority				2.90

	supported_factions			carthage, numidia

	;; main phalanx line, maximal 7 phalanges
	begin_block 0
		min_units				3
		max_units				7
		not_general
		unit_type				phalanx 1.0
		default_melee_state		defend
		unit_formation			phalanx
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; the left cover of infantry
	begin_block 1
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.6
		;default_melee_state		skirmish
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 -1.0 -10.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; the right cover of infantry
	begin_block 2
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.6
		;default_melee_state		skirmish
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 1.0 -10.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	; Screen of missile inf
	begin_block 3
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		;default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; flank line left - light infantry, prec infantry
	begin_block 4
		min_units				1
		not_general
		unit_type				heavy_pilum_infantry 1.0
		unit_type				light_pilum_infantry 0.6
		default_melee_state		fire_at_will
		block_formation			line
		block_relative_pos		1 -5.0 0.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; flank line right - light infantry, prec infantry
	begin_block 5
		min_units				1
		not_general
		unit_type				heavy_pilum_infantry 1.0
		unit_type				light_pilum_infantry 0.6
		default_melee_state		fire_at_will
		block_formation			line
		block_relative_pos		2 5.0 0.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_dummy_block 6
		spans	1 2 3 4 5
	end_dummy_block

	;; left missile units
	begin_block 7
		max_units				3
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 -2.0 -8.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	;; right missile units
	begin_block 8
		max_units				3
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 2.0 -8.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	;; the left cover of infantry
	begin_block 9
		max_units				2
		unit_type				heavy infantry 1.0
		unit_type				non_phalanx_spear 0.5
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		max_unit_width			24
		block_formation			column
		block_relative_pos		7 -1.0 -8.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; the right cover of infantry
	begin_block 10
		max_units				2
		unit_type				heavy infantry 1.0
		unit_type				non_phalanx_spear 0.5
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		max_unit_width			24
		block_formation			column
		block_relative_pos		8 1.0 -8.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_dummy_block 11
		spans	7 8 9 10
	end_dummy_block

	;; Spearmen will form a back up force.
	begin_block 12
		max_units				8
		not_general
		unit_type				non_phalanx_spear 1.0
		unit_type				light infantry 0.1
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		max_unit_width			24
		block_formation			line
		block_relative_pos		11 0.0 -5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	begin_dummy_block 13
		spans	0 1 2 3 4 5 6 8 9 10 11 12
	end_dummy_block


	;; commander at the back
	begin_block 14
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		13 0.0 -30.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 15
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		14 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; If there are elephants, infantry will follow them to support them.
	begin_block 16
		not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		13 5.0 10.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	; cavalry left
	begin_block 17
		unit_type				heavy cavalry 0.8
		unit_type				light cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		13 -17.0 -15.0
		inter_unit_spacing		0.2
		priority			0.7
	end_block

	; cavalry right
	begin_block 18
		unit_type				heavy cavalry 0.8
		unit_type				light cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		13 17.0 -15.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	; cavalry left (more)
	begin_block 19
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		;unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		17 -1.0 -1.0
		inter_unit_spacing		10.0
		priority			0.4
	end_block

	; cavalry right (more)
	begin_block 20
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		;unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		18 1.0 -1.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; put the artillery and handlers behind everyone
	begin_dummy_block 21
		spans	13 14 15 17 18 19 20
	end_dummy_block

	;; any behind
	begin_block 22
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		21 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	begin_block 23
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			24
		block_formation			line
		block_relative_pos		21 0.0 -12.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

end_formation


;the multirole swap of the formation will make cavalry to cover flanks than attack and also this applies to foot missiles
begin_formation ai_carthage_line_approach

	;;; purpose flags - approaching
	attack
	defend
	march

	ai_priority				2.90

	supported_factions			carthage, numidia

	; Screen of missile inf
	begin_block 0
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; The main troop line. Spearmen will form a mass.

	;; main phalanx line, maximal 7 phalanges
	begin_block 1
		min_units				3
		max_units				7
		not_general
		unit_type				phalanx 1.0
		default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; the left cover of infantry
	begin_block 2
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.6
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			20
		block_formation			column
		block_relative_pos		1 -1.0 -10.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; the right cover of infantry
	begin_block 3
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.6
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			20
		block_formation			column
		block_relative_pos		1 1.0 -10.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; flank line left - light infantry, prec infantry
	begin_block 4
		min_units				1
		not_general
		unit_type				heavy_pilum_infantry 1.0
		unit_type				light_pilum_infantry 0.6
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		2 -5.0 0.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; flank line right - light infantry, prec infantry
	begin_block 5
		min_units				1
		not_general
		unit_type				heavy_pilum_infantry 1.0
		unit_type				light_pilum_infantry 0.6
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		3 5.0 0.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_dummy_block 6
		spans	1 2 3 4 5
	end_dummy_block

	;; left missile units
	begin_block 7
		max_units				3
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 -2.0 -10.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	;; right missile units
	begin_block 8
		max_units				3
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 2.0 -10.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	;; the left cover of infantry
	begin_block 9
		max_units				2
		unit_type				heavy infantry 1.0
		unit_type				non_phalanx_spear 0.5
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		7 -1.0 -8.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; the right cover of infantry
	begin_block 10
		max_units				2
		unit_type				heavy infantry 1.0
		unit_type				non_phalanx_spear 0.5
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		8 1.0 -8.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_dummy_block 11
		spans	7 8 9 10
	end_dummy_block

	;; Spearmen will form a back up force.
	begin_block 12
		max_units				8
		not_general
		unit_type				non_phalanx_spear 1.0
		unit_type				light infantry 0.1
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		11 0.0 -5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	begin_dummy_block 13
		spans	0 1 2 3 4 5 6 8 9 10 11 12
	end_dummy_block


	;; commander at the back
	begin_block 14
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		13 0.0 -20.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 15
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		14 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; If there are elephants, infantry will follow them to support them.
	begin_block 16
		not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		13 -20.0 1.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	; cavalry left
	begin_block 17
		unit_type				heavy cavalry 0.8
		unit_type				light cavalry 0.5
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		13 -17.0 -15.0
		inter_unit_spacing		0.2
		priority			0.7
	end_block

	; cavalry right
	begin_block 18
		unit_type				heavy cavalry 0.8
		unit_type				light cavalry 0.5
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		13 17.0 -15.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	; cavalry left (more)
	begin_block 19
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			square
		block_relative_pos		17 -1.0 -1.0
		inter_unit_spacing		10.0
		priority			0.4
	end_block

	; cavalry right (more)
	begin_block 20
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		18 1.0 -1.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; put the artillery and handlers behind everyone
	begin_dummy_block 21
		spans	13 14 15 17 18 19 20
	end_dummy_block

	;; any behind
	begin_block 22
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		21 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	begin_block 23
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		21 0.0 -2.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

end_formation



;*******************************************************************************
; Phalanx multiwave attack formation with spearmen, 1-7 phalanx, 1-7 spearmen units, min 7 light/heavy infantry (created by Sinuhet)
;*******************************************************************************

begin_formation phalanx_with_infantry_1_march

	;;; purpose flags - regrouping
	march

	ai_priority				2.80

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, pontus, carthage, slave

	; Screen of missile inf
	begin_block 0
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		;default_melee_state		fire_at_will_and_skirmish
		;unit_density			close		; always deploy and defend as close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; heavy and light infantry before the spearmen

	;; light and heavy infantry
	begin_block 1
		min_units				7
		unit_type				light infantry 1.0
		unit_type				heavy infantry 0.9
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 -7.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; non_phalanx spearmen infantry
	begin_block 2
		min_units				1
		max_units				7
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		1 0.0 -10.0
		inter_unit_spacing		0.1
		priority			0.90
	end_block

	;; phalanx line, maximal 7 phalanges
	begin_block 3
		min_units				3
		max_units				7
		unit_type				phalanx 1.0
		;default_melee_state		defend	; Mac phalanx
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		2 0.0 -10.0
		inter_unit_spacing		0.0
		priority			0.95
	end_block

	;; missile troops behind the spearmen
	begin_block 4
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend
		max_unit_width			20
		block_formation			line
		block_relative_pos		3 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	begin_dummy_block 5
		spans	1 2 3 4
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		3 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 7
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		3 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 8
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		6 -5.0 0.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; right flank missile cav
	begin_block 9
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		7 5.0 0.0
		inter_unit_spacing		0.2
		priority			0.7
	end_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		10 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;; any behind
	begin_block 13
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		12 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 14
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

end_formation


begin_formation phalanx_with_infantry_1_deploy

	;;; purpose flags - deploy, defending
	defend

	ai_priority				2.80

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, pontus, carthage, slave

	; Screen of missile inf
	begin_block 0
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; heavy and light infantry before the spearmen

	;; light and heavy infantry
	begin_block 1
		min_units				7
		unit_type				light infantry 1.0
		unit_type				heavy infantry 0.9
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		0 0.0 -7.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; non_phalanx spearmen infantry
	begin_block 2
		min_units				1
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -10.0
		inter_unit_spacing		0.1
		priority			0.90
	end_block

	;; phalanx line, maximal 7 phalanges
	begin_block 3
		min_units				3
		max_units				7
		unit_type				phalanx 1.0
		default_melee_state		defend	; Mac phalanx
		unit_formation			phalanx
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		2 0.0 -10.0
		inter_unit_spacing		0.0
		priority			0.95
	end_block

	;; missile troops behind the spearmen
	begin_block 4
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 0.0 -30.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	begin_dummy_block 5
		spans	1 2 3 4
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 7
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 8
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		6 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile cav
	begin_block 9
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		7 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		10 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;; any behind
	begin_block 13
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		12 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 14
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

end_formation


begin_formation phalanx_with_infantry_1_attack

	;;; purpose flags - attacking
	attack

	ai_priority				2.80

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, pontus, carthage, slave

	; Screen of missile inf
	begin_block 0
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; heavy and light infantry before the spearmen

	;; light and heavy infantry
	begin_block 1
		min_units				7
		unit_type				light infantry 1.0
		unit_type				heavy infantry 0.9
		default_melee_state		fire_at_will
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 -7.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; non_phalanx spearmen infantry
	begin_block 2
		min_units				1
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -10.0
		inter_unit_spacing		0.1
		priority			0.90
	end_block

	;; phalanx line, maximal 7 phalanges
	begin_block 3
		min_units				3
		max_units				7
		unit_type				phalanx 1.0
		default_melee_state		defend	; Mac phalanx
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		2 0.0 -10.0
		inter_unit_spacing		0.0
		priority			0.95
	end_block

	;; missile troops behind the spearmen
	begin_block 4
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	begin_dummy_block 5
		spans	1 2 3 4
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 -20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 7
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 8
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		6 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile cav
	begin_block 9
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		7 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		10 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;; any behind
	begin_block 13
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		12 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 14
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

end_formation


begin_formation phalanx_with_infantry_1_pursue

	;;; purpose flags - charging, pursue
	pursue

	ai_priority				2.80

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, pontus, carthage, slave

	; Screen of missile inf
	begin_block 0
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; heavy and light infantry before the spearmen

	;; light and heavy infantry
	begin_block 1
		min_units				7
		unit_type				light infantry 1.0
		unit_type				heavy infantry 0.9
		default_melee_state		fire_at_will
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 -7.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; non_phalanx spearmen infantry
	begin_block 2
		min_units				1
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -10.0
		inter_unit_spacing		0.1
		priority			0.90
	end_block

	;; phalanx line, maximal 7 phalanges
	begin_block 3
		min_units				3
		max_units				7
		unit_type				phalanx 1.0
		default_melee_state		defend	; Mac phalanx
		unit_formation			phalanx
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		2 0.0 -10.0
		inter_unit_spacing		0.0
		priority			0.95
	end_block

	;; missile troops behind the spearmen
	begin_block 4
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	begin_dummy_block 5
		spans	1 2 3 4
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 -20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 7
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 8
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		6 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile cav
	begin_block 9
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		7 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		5 0.0 -30.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		10 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;; any behind
	begin_block 13
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		12 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 14
		unit_type				handler 1.0
		unit_type				siege 3.0
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

end_formation


begin_formation phalanx_with_infantry_1_approach

	;;; purpose flags - approaching
	defend
	attack

	ai_priority				2.80

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, pontus, carthage, slave

	; Screen of missile inf
	begin_block 0
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; heavy and light infantry before the spearmen

	;; light and heavy infantry
	begin_block 1
		min_units				7
		unit_type				light infantry 1.0
		unit_type				heavy infantry 0.9
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		0 0.0 -7.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; non_phalanx spearmen infantry
	begin_block 2
		min_units				1
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -10.0
		inter_unit_spacing		0.1
		priority			0.90
	end_block

	;; phalanx line, maximal 7 phalanges
	begin_block 3
		min_units				3
		max_units				7
		unit_type				phalanx 1.0
		default_melee_state		defend	; Mac phalanx
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		2 0.0 -10.0
		inter_unit_spacing		0.0
		priority			0.95
	end_block

	;; missile troops behind the spearmen
	begin_block 4
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 0.0 -30.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	begin_dummy_block 5
		spans	1 2 3 4
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 7
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 8
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		6 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile cav
	begin_block 9
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		7 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		10 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;; any behind
	begin_block 13
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		12 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 14
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

end_formation



;*********************************************************************************************
; Phalanx multiwave attack formation without spearmen, 1-7 phalanx, 0 non-phalanx spearmen, min 7 light/heavy infantry units (created by Sinuhet)
;*********************************************************************************************

begin_formation phalanx_with_infantry_2_march

	;;; purpose flags - regrouping
	march

	ai_priority				2.80

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, pontus, carthage, slave

	; Screen of missile inf
	begin_block 0
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		;default_melee_state		fire_at_will_and_skirmish
		;unit_density			close		; always deploy and defend as close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; heavy and light infantry before the spearmen

	;; light infantry
	begin_block 1
		min_units				3
		max_units				9
		unit_type				light infantry 1.0
		unit_type				heavy infantry 0.8
		;default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 -7.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; heavy infantry
	begin_block 2
		min_units				4
		max_units				10
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.8
		;default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		1 0.0 -10.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; phalanx line, maximal 7 phalanges
	begin_block 3
		min_units				3
		max_units				7
		unit_type				phalanx 1.0
		;default_melee_state		defend	; Mac phalanx
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		2 0.0 -10.0
		inter_unit_spacing		0.0
		priority			0.95
	end_block

	;; missile troops behind the spearmen
	begin_block 4
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend
		max_unit_width			20
		block_formation			line
		block_relative_pos		3 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	begin_dummy_block 5
		spans	1 2 3 4
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		3 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 7
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		3 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 8
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		6 -5.0 0.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; right flank missile cav
	begin_block 9
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		7 5.0 0.0
		inter_unit_spacing		0.2
		priority			0.7
	end_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		10 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;; any behind
	begin_block 13
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		12 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 14
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

end_formation


begin_formation phalanx_with_infantry_2_deploy

	;;; purpose flags - deploy, defending
	defend

	ai_priority				2.80

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, pontus, carthage, slave

	; Screen of missile inf
	begin_block 0
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; heavy and light infantry before the spearmen

	;; light infantry
	begin_block 1
		min_units				3
		max_units				9
		unit_type				light infantry 1.0
		unit_type				heavy infantry 0.8
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		0 0.0 -7.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; heavy infantry
	begin_block 2
		min_units				4
		max_units				10
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		unit_density			close
		block_formation			line
		block_relative_pos		1 0.0 -10.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; phalanx line, maximal 7 phalanges
	begin_block 3
		min_units				3
		max_units				7
		unit_type				phalanx 1.0
		default_melee_state		defend	; Mac phalanx
		unit_formation			phalanx
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		2 0.0 -10.0
		inter_unit_spacing		0.0
		priority			0.95
	end_block

	;; missile troops behind the spearmen
	begin_block 4
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 0.0 -30.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	begin_dummy_block 5
		spans	1 2 3 4
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 7
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 8
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		6 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile cav
	begin_block 9
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		7 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		10 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;; any behind
	begin_block 13
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		12 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 14
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

end_formation


begin_formation phalanx_with_infantry_2_attack

	;;; purpose flags - attacking
	attack

	ai_priority				2.80

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, pontus, carthage, slave

	; Screen of missile inf
	begin_block 0
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; heavy and light infantry before the spearmen

	;; light infantry
	begin_block 1
		min_units				3
		max_units				9
		unit_type				light infantry 1.0
		unit_type				heavy infantry 0.8
		;default_melee_state		fire_at_will
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 -7.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; heavy infantry
	begin_block 2
		min_units				4
		max_units				10
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		unit_density			close
		block_formation			line
		block_relative_pos		1 0.0 -10.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; phalanx line, maximal 7 phalanges
	begin_block 3
		min_units				3
		max_units				7
		unit_type				phalanx 1.0
		default_melee_state		defend	; Mac phalanx
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		2 0.0 -10.0
		inter_unit_spacing		0.0
		priority			0.95
	end_block

	;; missile troops behind the spearmen
	begin_block 4
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	begin_dummy_block 5
		spans	1 2 3 4
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 -20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 7
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 8
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		6 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile cav
	begin_block 9
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		7 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		10 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;; any behind
	begin_block 13
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		12 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 14
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

end_formation


begin_formation phalanx_with_infantry_2_pursue

	;;; purpose flags - charging, pursue
	pursue

	ai_priority				2.80

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, pontus, carthage, slave

	; Screen of missile inf
	begin_block 0
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; heavy and light infantry before the spearmen

	;; light infantry
	begin_block 1
		min_units				3
		max_units				9
		unit_type				light infantry 1.0
		unit_type				heavy infantry 0.8
		default_melee_state		fire_at_will
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 -7.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; heavy infantry
	begin_block 2
		min_units				4
		max_units				10
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		unit_density			close
		block_formation			line
		block_relative_pos		1 0.0 -10.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; phalanx line, maximal 7 phalanges
	begin_block 3
		min_units				3
		max_units				7
		unit_type				phalanx 1.0
		default_melee_state		defend	; Mac phalanx
		unit_formation			phalanx
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		2 0.0 -10.0
		inter_unit_spacing		0.0
		priority			0.95
	end_block

	;; missile troops behind the spearmen
	begin_block 4
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	begin_dummy_block 5
		spans	1 2 3 4
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 -20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 7
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 8
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		6 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile cav
	begin_block 9
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		7 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		5 0.0 -30.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		10 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;; any behind
	begin_block 13
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		12 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 14
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

end_formation


begin_formation phalanx_with_infantry_2_approach

	;;; purpose flags - approaching
	defend
	attack

	ai_priority				2.80

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, pontus, carthage, slave

	; Screen of missile inf
	begin_block 0
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; heavy and light infantry before the spearmen

	;; light infantry
	begin_block 1
		min_units				3
		max_units				9
		unit_type				light infantry 1.0
		unit_type				heavy infantry 0.8
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		0 0.0 -7.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; heavy infantry
	begin_block 2
		min_units				4
		max_units				10
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		1 0.0 -10.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; phalanx line, maximal 7 phalanges
	begin_block 3
		min_units				3
		max_units				7
		unit_type				phalanx 1.0
		default_melee_state		defend	; Mac phalanx
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		2 0.0 -10.0
		inter_unit_spacing		0.0
		priority			0.95
	end_block

	;; missile troops behind the spearmen
	begin_block 4
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 0.0 -30.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	begin_dummy_block 5
		spans	1 2 3 4
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 7
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 8
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		6 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile cav
	begin_block 9
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		7 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		10 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;; any behind
	begin_block 13
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		12 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 14
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

end_formation



;***********************************************************************************************
; Philip/Alexander's Macedonian battle formation. Elephants are in front.The skirmishers/missile units
; form a shield in front of vanguard. Cavalry will launch a devastating charge from the right in semi-wedge formation. The general will lead the attack
; Modified from Darth's and Sinuhet's by Suppanut
;***********************************************************************************************

begin_formation ai_alexanders_line_march

	;;; purpose flags - regrouping
	march

	ai_priority				2.80

	supported_factions			macedon, egypt, seleucid, pontus

	; Screen of missile inf
	begin_block 0
		max_units				4
		not_general
		unit_type				missile infantry 0.5
		unit_type				skirmish infantry 0.9
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; phalanx units
	begin_block 1
		min_units				3
		max_units				7
		not_general
		unit_type				phalanx 1.0
		default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; infantry troops behind the spearmen
	begin_block 2
		max_units				3
		not_general
		unit_type				non_phalanx_spear 0.7
		unit_type				light infantry 0.3
		unit_type				heavy infantry 0.1
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		1 0.0 -10.0
		inter_unit_spacing		0.1
		priority			0.1
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side - heavy infantry in close to phalanx
	begin_block 3
		max_units				2
		not_general
		unit_type				heavy infantry 0.7
		unit_type				light infantry 0.5
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		1 -0.5 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; right side - heavy infantry in close to phalanx
	begin_block 4
		max_units				2
		not_general
		unit_type				heavy infantry 0.7
		unit_type				light infantry 0.5
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		1 0.5 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	begin_dummy_block 5
		spans	1 2 3 4
	end_dummy_block

	;; left wing cover
	begin_block 6
		unit_type				general_unit infantry 3.0
		unit_type				light infantry 0.8
		unit_type				missile infantry 0.6
		;unit_formation			shield_wall, square
		max_unit_width			20
		block_formation			line
		block_relative_pos		5 -3.0 0.0
		inter_unit_spacing		0.1
		priority			0.7
	end_block

	;; right wing cover
	begin_block 7
		unit_type				general_unit infantry 3.0
		unit_type				light infantry 0.5
		unit_type				missile infantry 0.6
		;unit_formation			shield_wall, square
		max_unit_width			20
		block_formation			line
		block_relative_pos		5 3.0 0.0
		inter_unit_spacing		0.1
		priority			0.7
	end_block

	;; Archer is here
	begin_block 8
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			20
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	begin_dummy_block 9
		spans	1 2 3 4 5 6 7 8
	end_dummy_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		9 0.0 -5.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		10 0.0 -5.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	;; any behind
	begin_block 12
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.01
	end_block

	;; artillery and handlers at the back
	begin_block 13
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;unit_formation			square
		max_unit_width			15
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; infantry troops prepared in the right wing
	begin_block 14
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.7
		unit_type				light infantry 0.9
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		7 10.0 0.0
		inter_unit_spacing		2.0
		priority			0.9
	end_block

	;; missile cavalry in the right wing
	begin_block 15
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		9 10.0 -20.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	;; cavalry on left flank in wedge(ALMOST!)

	;; left flank cav (top wedge)
	begin_block 16
		min_units				1
		max_units				1
		unit_type				heavy cavalry 0.8
		unit_type				light cavalry 0.4
		unit_formation			wedge
		max_unit_width			20
		block_formation			column
		block_relative_pos		9 -15.0 -10.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; left flank cav(second)
	begin_block 17
		min_units				2
		max_units				2
		unit_type				heavy cavalry 0.8
		unit_type				light cavalry 0.3
		;unit_formation			square
		max_unit_width			20
		block_formation			column
		block_relative_pos		16 0.0 -0.2
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; left flank cav(third)
	begin_block 18
		max_units				4
		not_general
		unit_type				heavy cavalry 0.8
		unit_type				light cavalry 0.3
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			20
		block_formation			square
		block_relative_pos		17 0.0 -0.2
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; left flank elephants, infront of left flank cavalry
	begin_block 19
		not_general
		unit_type				elephants 3.0
		max_unit_width			20
		block_formation			column
		block_relative_pos		16 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, infront of right flank cavalry
	begin_block 20
		not_general
		unit_type				elephants 3.0
		max_unit_width			20
		block_formation			column
		block_relative_pos		15 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	begin_dummy_block 21
		spans	0 9 10 11 12 13 14 15 16 17 18 19 20
	end_dummy_block

	; Heavy Chariots
	begin_block 22
		not_general
		unit_type				heavy_chariots 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			15
		block_formation			column
		block_relative_pos		5 -20.0 1.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

end_formation


begin_formation ai_alexanders_line_deploy

	;;; purpose flags - deploy, defending
	defend

	ai_priority				2.80

	supported_factions			macedon, egypt, seleucid, pontus

	; Screen of missile inf
	begin_block 0
		max_units				4
		not_general
		unit_type				missile infantry 0.5
		unit_type				skirmish infantry 0.9
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; phalanx units
	begin_block 1
		min_units				3
		max_units				7
		not_general
		unit_type				phalanx 1.0
		default_melee_state		defend
		unit_formation			phalanx
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; infantry troops behind the spearmen
	begin_block 2
		max_units				3
		not_general
		unit_type				non_phalanx_spear 0.7
		unit_type				light infantry 0.3
		unit_type				heavy infantry 0.1
		;default_melee_state		skirmish
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -10.0
		inter_unit_spacing		0.1
		priority			0.1
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side - heavy infantry in close to phalanx
	begin_block 3
		max_units				2
		not_general
		unit_type				heavy infantry 0.7
		unit_type				light infantry 0.5
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		1 -0.5 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; right side - heavy infantry in close to phalanx
	begin_block 4
		max_units				2
		not_general
		unit_type				heavy infantry 0.7
		unit_type				light infantry 0.5
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		1 0.5 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	begin_dummy_block 5
		spans	0 1 2 3 4
	end_dummy_block

	;; left wing cover
	begin_block 6
		unit_type				general_unit infantry 3.0
		unit_type				light infantry 0.8
		unit_type				missile infantry 0.6
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		5 -5.0 -9.0
		inter_unit_spacing		0.1
		priority			0.7
	end_block

	;; right wing cover
	begin_block 7
		unit_type				general_unit infantry 3.0
		unit_type				light infantry 0.5
		unit_type				missile infantry 0.6
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		5 5.0 -9.0
		inter_unit_spacing		0.1
		priority			0.7
	end_block

	;; Archer is here
	begin_block 8
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		5 0.0 -30.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	begin_dummy_block 9
		spans	1 2 3 4 5 6 7 8
	end_dummy_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		9 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		10 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 12
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.01
	end_block

	;; artillery and handlers at the back
	begin_block 13
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; infantry troops prepared in the right wing
	begin_block 14
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.7
		unit_type				light infantry 0.9
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		7 10.0 0.0
		inter_unit_spacing		2.0
		priority			0.9
	end_block

	;; missile cavalry in the right wing
	begin_block 15
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		5 10.0 -20.0
		inter_unit_spacing		10.0
		priority			0.4
	end_block

	;; cavalry on left flank in wedge(ALMOST!)

	;; left flank cav (top wedge)
	begin_block 16
		min_units				1
		max_units				1
		unit_type				heavy cavalry 0.8
		unit_type				light cavalry 0.4
		unit_formation			wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 -10.0 -20.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; left flank cav(second)
	begin_block 17
		min_units				2
		max_units				2
		unit_type				heavy cavalry 0.8
		unit_type				light cavalry 0.3
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		16 0.0 -0.2
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; left flank cav(third)
	begin_block 18
		max_units				4
		not_general
		unit_type				heavy cavalry 0.8
		unit_type				light cavalry 0.3
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		17 0.0 -0.2
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; left flank elephants, behind of left flank cavalry
	begin_block 19
		not_general
		unit_type				elephants 3.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		16 0.0 -26.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, behind of right flank cavalry
	begin_block 20
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		15 0.0 -6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	begin_dummy_block 21
		spans	0 9 10 11 12 13 14 15 16 17 18 19 20
	end_dummy_block

	; Heavy Chariots
	begin_block 22
		not_general
		unit_type				heavy_chariots 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		21 -20.0 -5.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

end_formation


;the formation attacks and sends skirmishers to challenge the enemy. The cavalry will attack once the phalanx is in position.
begin_formation ai_alexanders_line_attack

	;;; purpose flags - attacking
	attack
	march

	ai_priority				2.80

	supported_factions			macedon, egypt, seleucid, pontus

	; Screen of missile inf
	begin_block 0
		max_units				4
		not_general
		unit_type				missile infantry 0.5
		unit_type				skirmish infantry 0.9
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; phalanx units
	begin_block 1
		min_units				3
		max_units				7
		not_general
		unit_type				phalanx 1.0
		default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; infantry troops behind the spearmen
	begin_block 2
		max_units				3
		not_general
		unit_type				non_phalanx_spear 0.7
		unit_type				light infantry 0.3
		unit_type				heavy infantry 0.1
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -10.0
		inter_unit_spacing		0.1
		priority			0.1
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side - heavy infantry in close to phalanx
	begin_block 3
		max_units				2
		not_general
		unit_type				heavy infantry 0.7
		unit_type				light infantry 0.5
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		unit_density			close
		block_formation			line
		block_relative_pos		1 -0.5 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; right side - heavy infantry in close to phalanx
	begin_block 4
		max_units				2
		not_general
		unit_type				heavy infantry 0.7
		unit_type				light infantry 0.5
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		unit_density			close
		block_formation			line
		block_relative_pos		1 0.5 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	begin_dummy_block 5
		spans	1 2 3 4
	end_dummy_block

	;; left wing cover
	begin_block 6
		unit_type				general_unit infantry 3.0
		unit_type				light infantry 0.8
		unit_type				missile infantry 0.6
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			shield_wall, square
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 -3.0 0.0
		inter_unit_spacing		0.1
		priority			0.7
	end_block

	;; right wing cover
	begin_block 7
		unit_type				general_unit infantry 3.0
		unit_type				light infantry 0.5
		unit_type				missile infantry 0.6
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			shield_wall, square
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 3.0 0.0
		inter_unit_spacing		0.1
		priority			0.7
	end_block

	;; Archer is here
	begin_block 8
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	begin_dummy_block 9
		spans	1 2 3 4 5 6 7 8
	end_dummy_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		9 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		10 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 12
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.01
	end_block

	;; artillery and handlers at the back
	begin_block 13
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;unit_formation			square
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 0.0 -40.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; infantry troops prepared in the right wing
	begin_block 14
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.7
		unit_type				light infantry 0.9
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		9 10.0 0.0
		inter_unit_spacing		2.0
		priority			0.9
	end_block

	;; missile cavalry in the right wing
	begin_block 15
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		9 20.0 -20.0
		inter_unit_spacing		10.0
		priority			0.4
	end_block

	;; cavalry on left flank in wedge(ALMOST!)

	;; left flank cav (top wedge)
	begin_block 16
		min_units				1
		max_units				1
		unit_type				heavy cavalry 0.8
		unit_type				light cavalry 0.4
		unit_formation			wedge
		max_unit_width			24
		block_formation			column
		block_relative_pos		9 -35.0 -45.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; left flank cav(second)
	begin_block 17
		min_units				2
		max_units				2
		unit_type				heavy cavalry 0.8
		unit_type				light cavalry 0.3
		;unit_formation			square
		max_unit_width			24
		block_formation			line
		block_relative_pos		16 0.0 -0.2
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; left flank cav(third)
	begin_block 18
		max_units				4
		not_general
		unit_type				heavy cavalry 0.8
		unit_type				light cavalry 0.3
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			24
		block_formation			square
		block_relative_pos		17 0.0 -0.2
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; left flank elephants, infront of left flank cavalry
	begin_block 19
		not_general
		unit_type				elephants 3.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			40
		block_formation			line
		block_relative_pos		16 -5.0 6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, infront of right flank cavalry
	begin_block 20
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		15 5.0 6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	begin_dummy_block 21
		spans	0 9 10 11 12 13 14 15 16 17 18 19 20
	end_dummy_block

	; Heavy Chariots
	begin_block 22
		not_general
		unit_type				heavy_chariots 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			line
		block_relative_pos		5 -30.0 20.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

end_formation


begin_formation ai_alexanders_line_pursue

	;;; purpose flags - charging, pursue
	pursue

	ai_priority				2.80

	supported_factions			macedon, egypt, seleucid, pontus

	; Screen of missile inf
	begin_block 0
		max_units				4
		not_general
		unit_type				missile infantry 0.5
		unit_type				skirmish infantry 0.9
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.8
		priority			1.0
	end_block

	;; phalanx units
	begin_block 1
		min_units				3
		max_units				7
		not_general
		unit_type				phalanx 1.0
		default_melee_state		defend
		unit_formation			phalanx
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; infantry troops behind the spearmen
	begin_block 2
		max_units				3
		not_general
		unit_type				non_phalanx_spear 0.7
		unit_type				light infantry 0.3
		unit_type				heavy infantry 0.1
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -10.0
		inter_unit_spacing		0.1
		priority			0.1
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side - heavy infantry in close to phalanx
	begin_block 3
		max_units				2
		not_general
		unit_type				heavy infantry 0.7
		unit_type				light infantry 0.5
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close
		block_formation			line
		block_relative_pos		1 -0.5 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; right side - heavy infantry in close to phalanx
	begin_block 4
		max_units				2
		not_general
		unit_type				heavy infantry 0.7
		unit_type				light infantry 0.5
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close
		block_formation			line
		block_relative_pos		1 0.5 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	begin_dummy_block 5
		spans	0 1 2 3 4
	end_dummy_block

	;; left wing cover
	begin_block 6
		unit_type				general_unit infantry 3.0
		unit_type				light infantry 0.8
		unit_type				missile infantry 0.6
		unit_formation			shield_wall, square
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 -3.0 0.0
		inter_unit_spacing		2.0
		priority			0.7
	end_block

	;; right wing cover
	begin_block 7
		unit_type				general_unit infantry 3.0
		unit_type				light infantry 0.5
		unit_type				missile infantry 0.6
		unit_formation			shield_wall, square
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 3.0 0.0
		inter_unit_spacing		2.0
		priority			0.7
	end_block

	;; Archer is here
	begin_block 8
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	begin_dummy_block 9
		spans	1 2 3 4 5 6 7 8
	end_dummy_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		9 0.0 -30.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		10 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 12
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		10 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.01
	end_block

	;; artillery and handlers at the back
	begin_block 13
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;unit_formation			square
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 0.0 -50.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; infantry troops prepared in the right wing
	begin_block 14
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.7
		unit_type				light infantry 0.9
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 10.0 20.0
		inter_unit_spacing		0.1
		priority			0.9
	end_block

	;; missile cavalry in the right wing
	begin_block 15
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		9 20.0 -20.0
		inter_unit_spacing		10.0
		priority			0.4
	end_block

	;; cavalry on left flank in wedge(ALMOST!)

	;; left flank cav (top wedge)
	begin_block 16
		min_units				1
		max_units				1
		unit_type				heavy cavalry 0.8
		unit_type				light cavalry 0.4
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			column
		block_relative_pos		9 -25.0 -25.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; left flank cav(second)
	begin_block 17
		min_units				2
		max_units				2
		unit_type				heavy cavalry 0.8
		unit_type				light cavalry 0.3
		;unit_formation			square
		max_unit_width			24
		block_formation			line
		block_relative_pos		16 0.0 -0.2
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; left flank cav(third)
	begin_block 18
		max_units				4
		not_general
		unit_type				heavy cavalry 0.8
		unit_type				light cavalry 0.3
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			24
		block_formation			square
		block_relative_pos		17 0.0 -0.2
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; left flank elephants, beside of left flank cavalry
	begin_block 19
		not_general
		unit_type				elephants 3.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			40
		block_formation			line
		block_relative_pos		16 5.0 -6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, beside of right flank cavalry
	begin_block 20
		not_general
		unit_type				elephants 3.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			40
		block_formation			line
		block_relative_pos		15 -5.0 -6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	begin_dummy_block 21
		spans	0 9 10 11 12 13 14 15 16 17 18 19 20
	end_dummy_block

	; Heavy Chariots
	begin_block 22
		not_general
		unit_type				heavy_chariots 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			line
		block_relative_pos		5 5.0 10.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

end_formation


;the multirole swap of the formation will make cavalry to cover both flanks than attack (swap cancelled, will maintain right thunderous charge)
begin_formation ai_alexanders_line_approach

	;;; purpose flags - approaching, swap
	attack
	defend

	ai_priority				2.80

	supported_factions			macedon, egypt, seleucid, pontus

	; Screen of missile inf
	begin_block 0
		max_units				4
		not_general
		unit_type				missile infantry 0.5
		unit_type				skirmish infantry 0.9
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.8
		priority			1.0
	end_block

	;; phalanx units
	begin_block 1
		min_units				3
		max_units				7
		not_general
		unit_type				phalanx 1.0
		default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; infantry troops behind the spearmen
	begin_block 2
		max_units				3
		not_general
		unit_type				non_phalanx_spear 0.7
		unit_type				light infantry 0.3
		unit_type				heavy infantry 0.1
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -15.0
		inter_unit_spacing		0.1
		priority			0.1
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side - heavy infantry in close to phalanx
	begin_block 3
		max_units				2
		not_general
		unit_type				heavy infantry 0.7
		unit_type				light infantry 0.5
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		1 -0.5 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; right side - heavy infantry in close to phalanx
	begin_block 4
		max_units				2
		not_general
		unit_type				heavy infantry 0.7
		unit_type				light infantry 0.5
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		1 0.5 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	begin_dummy_block 5
		spans	1 2 3 4
	end_dummy_block

	;; left wing cover
	begin_block 6
		unit_type				general_unit infantry 3.0
		unit_type				light infantry 0.8
		unit_type				missile infantry 0.6
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		5 -3.0 0.0
		inter_unit_spacing		2.0
		priority			0.7
	end_block

	;; right wing cover
	begin_block 7
		unit_type				general_unit infantry 3.0
		unit_type				light infantry 0.5
		unit_type				missile infantry 0.6
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		5 3.0 0.0
		inter_unit_spacing		2.0
		priority			0.7
	end_block

	;; Archer is here
	begin_block 8
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		5 0.0 -30.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	begin_dummy_block 9
		spans	0 1 2 3 4 5 6 7 8
	end_dummy_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		9 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		10 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 12
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.01
	end_block

	;; artillery and handlers at the back
	begin_block 13
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

	;; infantry troops prepared in the right wing
	begin_block 14
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.7
		unit_type				light infantry 0.9
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		7 10.0 0.0
		inter_unit_spacing		2.0
		priority			0.9
	end_block

	;; missile cavalry in the right wing
	begin_block 15
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		5 10.0 -20.0
		inter_unit_spacing		10.0
		priority			0.4
	end_block

	;; cavalry on left flank in wedge(ALMOST!)

	;; left flank cav (top wedge)
	begin_block 16
		min_units				1
		max_units				1
		unit_type				heavy cavalry 0.8
		unit_type				light cavalry 0.4
		unit_formation			wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 -25.0 -20.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; left flank cav(second)
	begin_block 17
		min_units				2
		max_units				2
		unit_type				heavy cavalry 0.8
		unit_type				light cavalry 0.3
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		16 0.0 -0.2
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; left flank cav(third)
	begin_block 18
		max_units				4
		not_general
		unit_type				heavy cavalry 0.8
		unit_type				light cavalry 0.3
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		17 0.0 -0.2
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; left flank elephants, infront of left flank cavalry
	begin_block 19
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		16 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, infront of right flank cavalry
	begin_block 20
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		15 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	begin_dummy_block 21
		spans	0 9 10 11 12 13 14 15 16 17 18 19 20
	end_dummy_block

	; Heavy Chariots
	begin_block 22
		not_general
		unit_type				heavy_chariots 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		5 -20.0 1.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

end_formation



;*******************************************************************************
; Quin Inuit's phalanx single line formation, max 7 phalanx units (created by Sinuhet)
; modified by Suppanut to be formation for archer-support oriented
; max 7 phalanx, 6-16 skirmish/missile infantry
;*******************************************************************************

begin_formation phalanx_attack_3_march

	;;; purpose flags - regrouping
	march

	ai_priority				2.75

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, carthage, pontus, slave

	; Screen of missile inf
	begin_block 0
		min_units				3
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		;default_melee_state		fire_at_will_and_skirmish
		;unit_density			close		; always deploy and defend as close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; phalanx line
	begin_block 1
		min_units				3
		max_units				7
		unit_type				phalanx 1.0
		;default_melee_state		defend	; Mac phalanx
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; archers behind the spearmen

	;; centerback archer
	begin_block 2
		max_units				4
		unit_type				chanting_screeching 3.0
		unit_type				ranged_missile_infantry 2.0
		;default_melee_state		fire_at_will_and_defend
		max_unit_width			20
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; centerback left
	begin_block 3
		min_units				1
		max_units				4
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.5
		unit_type				skirmish infantry 0.1
		;default_melee_state		fire_at_will_and_defend
		max_unit_width			20
		block_formation			line
		block_relative_pos		2 -10.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; centerback right
	begin_block 4
		min_units				1
		max_units				4
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.5
		unit_type				skirmish infantry 0.1
		;default_melee_state		fire_at_will_and_defend
		max_unit_width			20
		block_formation			line
		block_relative_pos		3 10.0 0.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 5
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.7
		unit_type				light infantry 0.8
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		1 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; right side
	begin_block 6
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.7
		unit_type				light infantry 0.8
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		1 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 7
		spans	1 2 3 4 5 6
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 8
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		3 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 9
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		4 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 10
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		8 -5.0 0.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 11
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		9 5.0 0.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; general at the back
	begin_block 12
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		7 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 13
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		12 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 14
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		13 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 15
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			line
		block_relative_pos		14 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 16
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			column
		block_relative_pos		7 -20.0 1.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, infront of left flank cavalry
	begin_block 17
		not_general
		unit_type				elephants 3.0
		max_unit_width			20
		block_formation			column
		block_relative_pos		8 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, infront of right flank cavalry
	begin_block 18
		not_general
		unit_type				elephants 3.0
		max_unit_width			20
		block_formation			column
		block_relative_pos		9 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


begin_formation phalanx_attack_3_deploy

	;;; purpose flags - deploy, defending
	defend

	ai_priority				2.75

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, carthage, pontus, slave

	; Screen of missile inf
	begin_block 0
		min_units				3
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; phalanx line
	begin_block 1
		min_units				3
		max_units				7
		unit_type				phalanx 1.0
		default_melee_state		defend	; Mac phalanx
		unit_formation			phalanx
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; archers behind the spearmen

	;; centerback archer
	begin_block 2
		max_units				4
		unit_type				chanting_screeching 3.0
		unit_type				ranged_missile_infantry 2.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -30.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; centerback left
	begin_block 3
		min_units				1
		max_units				4
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.5
		unit_type				skirmish infantry 0.1
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		2 -10.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; centerback right
	begin_block 4
		min_units				1
		max_units				4
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.5
		unit_type				skirmish infantry 0.1
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 10.0 0.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 5
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.7
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		1 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; right side
	begin_block 6
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.7
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		1 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 7
		spans	1 2 3 4 5 6
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 8
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		7 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 9
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		7 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 10
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		8 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 11
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		9 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; general at the back
	begin_block 12
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		7 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 13
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		12 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 14
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		13 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 15
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		14 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 16
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		7 -20.0 -5.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, behind of left flank cavalry
	begin_block 17
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		8 0.0 -6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, behind of right flank cavalry
	begin_block 18
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 0.0 -6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


begin_formation phalanx_attack_3_attack

	;;; purpose flags - attacking
	attack

	ai_priority				2.75

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, carthage, pontus, slave

	; Screen of missile inf
	begin_block 0
		min_units				3
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; phalanx line
	begin_block 1
		min_units				3
		max_units				7
		unit_type				phalanx 1.0
		default_melee_state		defend	; Mac phalanx
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; archers behind the spearmen

	;; centerback archer
	begin_block 2
		max_units				4
		unit_type				chanting_screeching 3.0
		unit_type				ranged_missile_infantry 2.0
		default_melee_state		fire_at_will_and_defend
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; centerback left
	begin_block 3
		min_units				1
		max_units				4
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.5
		unit_type				skirmish infantry 0.1
		default_melee_state		fire_at_will_and_defend
		max_unit_width			40
		block_formation			line
		block_relative_pos		2 -10.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; centerback right
	begin_block 4
		min_units				1
		max_units				4
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.5
		unit_type				skirmish infantry 0.1
		default_melee_state		fire_at_will_and_defend
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 10.0 0.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 5
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.7
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		1 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; right side
	begin_block 6
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.7
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		1 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 7
		spans	1 2 3 4 5 6
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 8
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		7 -20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 9
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		7 20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 10
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		8 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 11
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		9 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; general at the back
	begin_block 12
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		7 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 13
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		12 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 14
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		13 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 15
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		7 0.0 -40.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 16
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		max_unit_width			30
		block_formation			line
		block_relative_pos		7 -30.0 20.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, infront of left flank cavalry
	begin_block 17
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		8 -5.0 6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, infront of right flank cavalry
	begin_block 18
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 5.0 6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


begin_formation phalanx_attack_3_pursue

	;;; purpose flags - charging, pursue
	pursue

	ai_priority				2.75

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, carthage, pontus, slave

	; Screen of missile inf
	begin_block 0
		min_units				3
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; phalanx line
	begin_block 1
		min_units				3
		max_units				7
		unit_type				phalanx 1.0
		default_melee_state		defend	; Mac phalanx
		unit_formation			phalanx
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; archers behind the spearmen

	;; centerback archer
	begin_block 2
		max_units				4
		unit_type				chanting_screeching 3.0
		unit_type				ranged_missile_infantry 2.0
		default_melee_state		fire_at_will_and_defend
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; centerback left
	begin_block 3
		min_units				1
		max_units				4
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.5
		unit_type				skirmish infantry 0.1
		default_melee_state		fire_at_will_and_defend
		max_unit_width			40
		block_formation			line
		block_relative_pos		2 -10.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; centerback right
	begin_block 4
		min_units				1
		max_units				4
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.5
		unit_type				skirmish infantry 0.1
		default_melee_state		fire_at_will_and_defend
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 10.0 0.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 5
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.7
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -1.5 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; right side
	begin_block 6
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.7
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 1.5 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	begin_dummy_block 7
		spans	1 2 3 4 5 6
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 8
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		7 -20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 9
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		7 20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 10
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		8 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 11
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		9 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; general at the back
	begin_block 12
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		7 0.0 -30.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 13
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		12 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 14
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		13 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 15
		unit_type				handler 1.0
		unit_type				siege 3.0
		max_unit_width			24
		block_formation			line
		block_relative_pos		7 0.0 -50.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 16
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		max_unit_width			30
		block_formation			line
		block_relative_pos		7 5.0 10.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, beside of left flank cavalry
	begin_block 17
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		8 5.0 -6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, beside of right flank cavalry
	begin_block 18
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 -5.0 -6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


begin_formation phalanx_attack_3_approach

	;;; purpose flags - approaching
	defend
	attack

	ai_priority				2.75

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, carthage, pontus, slave

	; Screen of missile inf
	begin_block 0
		min_units				3
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; phalanx line
	begin_block 1
		min_units				3
		max_units				7
		unit_type				phalanx 1.0
		default_melee_state		defend	; Mac phalanx
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; archers behind the spearmen

	;; centerback archer
	begin_block 2
		max_units				4
		unit_type				chanting_screeching 3.0
		unit_type				ranged_missile_infantry 2.0
		;default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -30.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; centerback left
	begin_block 3
		min_units				1
		max_units				4
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.5
		unit_type				skirmish infantry 0.1
		;default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		2 -10.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; centerback right
	begin_block 4
		min_units				1
		max_units				4
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.5
		unit_type				skirmish infantry 0.1
		;default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 10.0 0.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 5
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.7
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		1 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; right side
	begin_block 6
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.7
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		1 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 7
		spans	1 2 3 4 5 6
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 8
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		7 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 9
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		7 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 10
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		8 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 11
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		9 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; general at the back
	begin_block 12
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		7 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 13
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		12 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 14
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		13 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 15
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		14 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 16
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		7 -20.0 1.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, infront of left flank cavalry
	begin_block 17
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		8 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, infront of right flank cavalry
	begin_block 18
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation



;*********************************************************************************************************
; mixed spearmen triple line formation, max 7 phalanx units, min 8 spearmen units (created by Sinuhet)
;*********************************************************************************************************

begin_formation phalanx_mixed_spearmen_attack_3_march

	;;; purpose flags - regrouping
	march

	ai_priority				2.70

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, carthage, thrace, pontus, slave

	; Screen of missile inf
	begin_block 0
		max_units				8
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_density			close		; always deploy and defend as close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; first phalanx line
	begin_block 1
		min_units				3
		max_units				7
		unit_type				phalanx 1.0
		;default_melee_state		defend	; Mac phalanx
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; non-phalanx left line
	begin_block 2
		min_units				3
		max_units				7
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		1 -0.1 -5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; non-phalanx right line
	begin_block 3
		min_units				3
		max_units				7
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		1 0.1 -5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; precursor spearmen back line
	begin_block 4
		min_units				2
		max_units				7
		unit_type				spearmen_pilum_infantry 1.0
		unit_type				non_phalanx_spear 0.1
		;default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		1.5
		priority			0.8
	end_block

	;; archers behind the spearmen

	begin_block 5
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend
		max_unit_width			20
		block_formation			line
		block_relative_pos		4 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 6
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		;default_melee_state		fire_at_will_and_defend
		;unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		2 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; right side
	begin_block 7
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		;default_melee_state		fire_at_will_and_defend
		;unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		3 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 8
		spans	1 2 3 4 5 6 7
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 9
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		2 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 10
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		3 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 11
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		9 -5.0 0.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 12
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		10 5.0 0.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; general at the back
	begin_block 13
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		8 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 14
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		13 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 15
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		14 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 16
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		defend
		max_unit_width			15
		block_formation			line
		block_relative_pos		15 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 17
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			column
		block_relative_pos		8 -20.0 1.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, infront of left flank cavalry
	begin_block 18
		not_general
		unit_type				elephants 3.0
		max_unit_width			20
		block_formation			column
		block_relative_pos		9 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, infront of right flank cavalry
	begin_block 19
		not_general
		unit_type				elephants 3.0
		max_unit_width			20
		block_formation			column
		block_relative_pos		10 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


begin_formation phalanx_mixed_spearmen_attack_3_deploy

	;;; purpose flags - deploy, defending
	defend

	ai_priority				2.70

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, carthage, thrace, pontus, slave

	; Screen of missile inf
	begin_block 0
		max_units				8
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; first phalanx line
	begin_block 1
		min_units				3
		max_units				7
		unit_type				phalanx 1.0
		default_melee_state		defend	; Mac phalanx
		unit_formation			phalanx
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; non-phalanx left line
	begin_block 2
		min_units				3
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -0.1 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; non-phalanx right line
	begin_block 3
		min_units				3
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.1 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; precursor spearmen back line
	begin_block 4
		min_units				2
		max_units				7
		unit_type				spearmen_pilum_infantry 1.0
		unit_type				non_phalanx_spear 0.1
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		1.5
		priority			0.8
	end_block

	;; archers behind the spearmen

	begin_block 5
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 0.0 -30.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 6
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		2 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; right side
	begin_block 7
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		3 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 8
		spans	1 2 3 4 5 6 7
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 9
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		8 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 10
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		8 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 11
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		9 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 12
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		10 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; general at the back
	begin_block 13
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		8 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 14
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		13 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 15
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		14 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 16
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		15 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 17
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		8 -20.0 -5.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, behind of left flank cavalry
	begin_block 18
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 0.0 -6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, behind of right flank cavalry
	begin_block 19
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		10 0.0 -6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


begin_formation phalanx_mixed_spearmen_attack_3_attack

	;;; purpose flags - attacking
	attack

	ai_priority				2.70

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, carthage, thrace, pontus, slave

	; Screen of missile inf
	begin_block 0
		max_units				8
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; first phalanx line
	begin_block 1
		min_units				3
		max_units				7
		unit_type				phalanx 1.0
		default_melee_state		defend	; Mac phalanx
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; non-phalanx left line
	begin_block 2
		min_units				3
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -0.1 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; non-phalanx right line
	begin_block 3
		min_units				3
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.1 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; precursor spearmen back line
	begin_block 4
		min_units				2
		max_units				7
		unit_type				spearmen_pilum_infantry 1.0
		unit_type				non_phalanx_spear 0.1
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		1.5
		priority			0.8
	end_block

	;; archers behind the spearmen

	begin_block 5
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend	; was defend_and_skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 6
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		;unit_density			close
		block_formation			column
		block_relative_pos		2 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; right side
	begin_block 7
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		;unit_density			close
		block_formation			column
		block_relative_pos		3 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 8
		spans	1 2 3 4 5 6 7
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 9
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		8 -20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 10
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		8 20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 11
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		9 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 12
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		10 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; general at the back
	begin_block 13
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		8 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 14
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		13 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 15
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		14 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 16
		unit_type				handler 1.0
		unit_type				siege 3.0
		max_unit_width			24
		block_formation			line
		block_relative_pos		8 0.0 -40.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 17
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		max_unit_width			30
		block_formation			line
		block_relative_pos		8 -30.0 20.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, infront of left flank cavalry
	begin_block 18
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 -5.0 6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, infront of right flank cavalry
	begin_block 19
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		10 5.0 6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


begin_formation phalanx_mixed_spearmen_attack_3_pursue

	;;; purpose flags - charging, pursue
	pursue

	ai_priority				2.70

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, carthage, thrace, pontus, slave

	; Screen of missile inf
	begin_block 0
		max_units				8
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; first phalanx line
	begin_block 1
		min_units				3
		max_units				7
		unit_type				phalanx 1.0
		default_melee_state		defend	; Mac phalanx
		unit_formation			phalanx
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; non-phalanx left line
	begin_block 2
		min_units				3
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -0.1 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; non-phalanx right line
	begin_block 3
		min_units				3
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.1 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; precursor spearmen back line
	begin_block 4
		min_units				2
		max_units				7
		unit_type				spearmen_pilum_infantry 1.0
		unit_type				non_phalanx_spear 0.1
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		1.5
		priority			0.8
	end_block

	;; archers behind the spearmen

	begin_block 5
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend	; was defend_and_skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 6
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		;unit_density			close
		block_formation			line
		block_relative_pos		2 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; right side
	begin_block 7
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		;unit_density			close
		block_formation			line
		block_relative_pos		3 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 8
		spans	1 2 3 4 5 6 7
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 9
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		8 -20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 10
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		8 20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 11
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		9 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 12
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		10 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; general at the back
	begin_block 13
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		8 0.0 -30.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 14
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		13 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 15
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		14 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 16
		unit_type				handler 1.0
		unit_type				siege 3.0
		max_unit_width			24
		block_formation			line
		block_relative_pos		8 0.0 -50.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 17
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		max_unit_width			30
		block_formation			line
		block_relative_pos		8 5.0 10.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, beside of left flank cavalry
	begin_block 18
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 5.0 -6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, beside of right flank cavalry
	begin_block 19
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		10 -5.0 -6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


begin_formation phalanx_mixed_spearmen_attack_3_approach

	;;; purpose flags - approaching
	defend
	attack

	ai_priority				2.70

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, carthage, thrace, pontus, slave

	; Screen of missile inf
	begin_block 0
		max_units				8
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; first phalanx line
	begin_block 1
		min_units				3
		max_units				7
		unit_type				phalanx 1.0
		default_melee_state		defend	; Mac phalanx
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; non-phalanx left line
	begin_block 2
		min_units				3
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -0.1 -5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; non-phalanx right line
	begin_block 3
		min_units				3
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.1 -5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; precursor spearmen back line
	begin_block 4
		min_units				2
		max_units				7
		unit_type				spearmen_pilum_infantry 1.0
		unit_type				non_phalanx_spear 0.1
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		1.5
		priority			0.8
	end_block

	;; archers behind the spearmen

	begin_block 5
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 0.0 -30.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 6
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		2 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; right side
	begin_block 7
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		3 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 8
		spans	1 2 3 4 5 6 7
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 9
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		8 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 10
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		8 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 11
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		9 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 12
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		10 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; general at the back
	begin_block 13
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		8 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 14
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		13 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; any behind
	begin_block 15
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		14 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 16
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		15 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 17
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		8 -20.0 1.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, infront of left flank cavalry
	begin_block 18
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, infront of right flank cavalry
	begin_block 19
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		10 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation



;****************************************************************************************************************************
; Epigonus battle formation. Similar with macedonian formation but not with so thunderous cavalry charge.More balanced though
; modified by Suppanut to make it support 8 phalanx or more
; using by Diadochi factions
;****************************************************************************************************************************

begin_formation ai_epigonus_line_march

	;;; purpose flags - regrouping
	march

	ai_priority				2.60

	supported_factions			macedon, egypt, seleucid, pontus

	; Screen of missile inf
	begin_block 0
		max_units				4
		not_general
		unit_type				missile infantry 0.5
		unit_type				skirmish infantry 1.0
		;default_melee_state		skirmish
		;unit_formation			square
		;unit_density			close		; always deploy and defend as close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; phalanx units
	begin_block 1
		min_units				8
		not_general
		unit_type				phalanx 1.0
		;default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; reserves line
	begin_block 2
		unit_type				general_unit infantry 3.0
		unit_type				non_phalanx_spear 0.5
		unit_type				light infantry 0.3
		unit_type				skirmish infantry 0.1
		unit_type				missile infantry 0.1
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		max_unit_width			20
		block_formation			line
		block_relative_pos		1 0.0 -15.0
		inter_unit_spacing		0.1
		priority			0.1
	end_block

	begin_dummy_block 3
		spans	1 2
	end_dummy_block

	;; left wing cover
	begin_block 4
		min_units				1
		max_units				2
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		unit_type				non_phalanx_spear 0.7
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		max_unit_width			20
		block_formation			line
		block_relative_pos		1 -5.0 -9.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; right wing cover
	begin_block 5
		min_units				1
		max_units				2
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		unit_type				non_phalanx_spear 0.7
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		max_unit_width			20
		block_formation			line
		block_relative_pos		1 5.0 -9.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; Archer is here
	begin_block 6
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			20
		block_formation			line
		block_relative_pos		3 0.0 -20.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	begin_dummy_block 7
		spans	1 2 3 4 5 6
	end_dummy_block

	;; cavalry on right flank will be in priority.

	;; left flank cav in minority
	begin_block 8
		unit_type				heavy cavalry 0.8
		unit_type				light cavalry 0.3
		max_unit_width			20
		block_formation			square
		block_relative_pos		3 -15.0 10.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; right flank cav
	begin_block 9
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			20
		block_formation			square
		block_relative_pos		3 15.0 10.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		7 0.0 -2.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		10 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;; any behind
	begin_block 13
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		12 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.01
	end_block

	;; artillery and handlers at the back
	begin_block 14
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;unit_formation			square
		max_unit_width			15
		block_formation			line
		block_relative_pos		12 0.0 20.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	; Heavy Chariots
	begin_block 15
		not_general
		unit_type				heavy_chariots 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			15
		block_formation			column
		block_relative_pos		7 -20.0 1.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, infront of left flank cavalry
	begin_block 16
		not_general
		unit_type				elephants 3.0
		max_unit_width			20
		block_formation			column
		block_relative_pos		8 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, infront of right flank cavalry
	begin_block 17
		not_general
		unit_type				elephants 3.0
		max_unit_width			20
		block_formation			column
		block_relative_pos		9 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


begin_formation ai_epigonus_line_deploy

	;;; purpose flags - deploy, defending
	defend

	ai_priority				2.60

	supported_factions			macedon, egypt, seleucid, pontus

	; Screen of missile inf
	begin_block 0
		max_units				4
		not_general
		unit_type				missile infantry 0.5
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; phalanx units
	begin_block 1
		min_units				8
		not_general
		unit_type				phalanx 1.0
		default_melee_state		defend
		unit_formation			phalanx
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; reserves line
	begin_block 2
		unit_type				general_unit infantry 3.0
		unit_type				non_phalanx_spear 0.5
		unit_type				light infantry 0.3
		unit_type				skirmish infantry 0.1
		unit_type				missile infantry 0.1
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -25.0
		inter_unit_spacing		0.1
		priority			0.1
	end_block

	begin_dummy_block 3
		spans	1 2
	end_dummy_block

	;; left wing cover
	begin_block 4
		min_units				1
		max_units				2
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		unit_type				non_phalanx_spear 0.7
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -5.0 -9.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; right wing cover
	begin_block 5
		min_units				1
		max_units				2
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		unit_type				non_phalanx_spear 0.7
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 5.0 -9.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; Archer is here
	begin_block 6
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 0.0 -30.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	begin_dummy_block 7
		spans	0 1 2 3 4 5 6
	end_dummy_block

	;; cavalry on right flank will be in priority.

	;; left flank cav in minority
	begin_block 8
		unit_type				heavy cavalry 0.8
		unit_type				light cavalry 0.3
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		3 -15.0 -20.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; right flank cav
	begin_block 9
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			square
		block_relative_pos		3 15.0 -20.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		7 0.0 -20.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		11 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;; any behind
	begin_block 13
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		12 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.01
	end_block

	;; artillery and handlers at the back
	begin_block 14
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 0.0 -8.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	; Heavy Chariots
	begin_block 15
		not_general
		unit_type				heavy_chariots 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		12 -20.0 -5.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; left flank elephants, behind of left flank cavalry
	begin_block 16
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		8 0.0 -6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, behind of right flank cavalry
	begin_block 17
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 0.0 -6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


;the formation attacks and sends skirmishers to challenge the enemy. The cavalry will cover the phalanx than make an attack.The general will stay well behind.
begin_formation ai_epigonus_line_attack

	;;; purpose flags - attacking
	attack

	ai_priority				2.60

	supported_factions			macedon, egypt, seleucid, pontus

	; Screen of missile inf
	begin_block 0
		max_units				4
		not_general
		unit_type				missile infantry 0.5
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 20.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; phalanx units
	begin_block 1
		min_units				8
		not_general
		unit_type				phalanx 1.0
		default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; reserves line
	begin_block 2
		unit_type				general_unit infantry 3.0
		unit_type				non_phalanx_spear 0.5
		unit_type				light infantry 0.3
		unit_type				skirmish infantry 0.1
		unit_type				missile infantry 0.1
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		0.1
		priority			0.1
	end_block

	begin_dummy_block 3
		spans	1 2
	end_dummy_block

	;; left wing cover
	begin_block 4
		min_units				1
		max_units				2
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		unit_type				non_phalanx_spear 0.7
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -5.0 -9.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; right wing cover
	begin_block 5
		min_units				1
		max_units				2
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		unit_type				non_phalanx_spear 0.7
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 5.0 -9.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; Archer is here
	begin_block 6
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 0.0 -20.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	begin_dummy_block 7
		spans	1 2 3 4 5 6
	end_dummy_block

	;; cavalry on right flank will be in priority.

	;; left flank cav in minority
	begin_block 8
		unit_type				heavy cavalry 0.8
		unit_type				light cavalry 0.3
		max_unit_width			24
		block_formation			square
		block_relative_pos		7 -25.0 25.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; right flank cav
	begin_block 9
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			square
		block_relative_pos		7 25.0 25.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		7 0.0 -20.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		10 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;; any behind
	begin_block 13
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		12 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.01
	end_block

	;; artillery and handlers at the back
	begin_block 14
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	; Heavy Chariots
	begin_block 15
		not_general
		unit_type				heavy_chariots 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			line
		block_relative_pos		7 -30.0 20.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, infront of left flank cavalry
	begin_block 16
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		8 -5.0 6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, infront of right flank cavalry
	begin_block 17
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 5.0 6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


begin_formation ai_epigonus_line_pursue

	;;; purpose flags - charging, pursue
	pursue

	ai_priority				2.60

	supported_factions			macedon, egypt, seleucid, pontus

	; Screen of missile inf
	begin_block 0
		max_units				4
		not_general
		unit_type				missile infantry 0.5
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		;unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; phalanx units
	begin_block 1
		min_units				8
		not_general
		unit_type				phalanx 1.0
		default_melee_state		defend
		unit_formation			phalanx
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; reserves line
	begin_block 2
		unit_type				general_unit infantry 3.0
		unit_type				non_phalanx_spear 0.5
		unit_type				light infantry 0.3
		unit_type				skirmish infantry 0.1
		unit_type				missile infantry 0.1
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -15.0
		inter_unit_spacing		0.1
		priority			0.1
	end_block

	begin_dummy_block 3
		spans	1 2
	end_dummy_block

	;; left wing cover
	begin_block 4
		min_units				1
		max_units				2
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		unit_type				non_phalanx_spear 0.7
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -5.0 -9.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; right wing cover
	begin_block 5
		min_units				1
		max_units				2
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		unit_type				non_phalanx_spear 0.7
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 5.0 -9.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; archer is here
	begin_block 6
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 0.0 -20.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 7
		spans	1 2 3 4 5 6
	end_dummy_block

	;; cavalry on right flank will be in priority.

	;; left flank cav in minority
	begin_block 8
		unit_type				heavy cavalry 0.8
		unit_type				light cavalry 0.3
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			square
		block_relative_pos		7 -25.0 -25.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; right flank cav
	begin_block 9
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square, wedge
		max_unit_width			30
		block_formation			square
		block_relative_pos		7 25.0 -20.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		7 0.0 -30.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		10 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;; any behind
	begin_block 13
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		12 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.01
	end_block

	;; artillery and handlers at the back
	begin_block 14
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;unit_formation			square
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	; Heavy Chariots
	begin_block 15
		not_general
		unit_type				heavy_chariots 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			line
		block_relative_pos		7 5.0 10.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, beside of left flank cavalry
	begin_block 16
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		8 5.0 6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, beside of right flank cavalry
	begin_block 17
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 -5.0 6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


;the multirole swap of the formation will make cavalry to cover both flanks than attack. Missiles will swap behind.
begin_formation ai_epigonus_line_approach

	;;; purpose flags - approaching
	attack
	defend
	march

	ai_priority				2.60

	supported_factions			macedon, egypt, seleucid, pontus

	; Screen of missile inf
	begin_block 0
		max_units				4
		not_general
		unit_type				missile infantry 0.5
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;; phalanx units
	begin_block 1
		min_units				8
		not_general
		unit_type				phalanx 1.0
		default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; reserves line
	begin_block 2
		unit_type				general_unit infantry 3.0
		unit_type				non_phalanx_spear 0.5
		unit_type				light infantry 0.3
		unit_type				skirmish infantry 0.1
		unit_type				missile infantry 0.1
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -15.0
		inter_unit_spacing		0.1
		priority			0.1
	end_block

	begin_dummy_block 3
		spans	1 2
	end_dummy_block

	;; left wing cover
	begin_block 4
		min_units				1
		max_units				2
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		unit_type				non_phalanx_spear 0.7
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -5.0 -9.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; right wing cover
	begin_block 5
		min_units				1
		max_units				2
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		unit_type				non_phalanx_spear 0.7
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 5.0 -9.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; Archer is here
	begin_block 6
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 0.0 -30.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	begin_dummy_block 7
		spans	1 2 3 4 5 6
	end_dummy_block

	;; cavalry on right flank will be in priority.

	;; left flank cav in minority
	begin_block 8
		unit_type				heavy cavalry 0.8
		unit_type				light cavalry 0.3
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		3 -15.0 25.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; right flank cav
	begin_block 9
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			square
		block_relative_pos		3 15.0 25.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		7 0.0 -20.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		10 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;; any behind
	begin_block 13
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		12 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.01
	end_block

	;; artillery and handlers at the back
	begin_block 14
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 0.0 20.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	; Heavy Chariots
	begin_block 15
		not_general
		unit_type				heavy_chariots 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		7 -20.0 1.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, infront of left flank cavalry
	begin_block 16
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		8 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, infront of right flank cavalry
	begin_block 17
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation



;************************************************************************************************
; Universal Phalanx triple line formation, min 13 spearmen units (created by Sinuhet)
; Edited by Quinn Inuit have min 8 phalanx and move the rear 2 blocks to flanking positions
; modified by Suppanut to support deployment of 2-8 skirmish/missile infantry
; using by non-diadochi factions
;************************************************************************************************

begin_formation phalanx_defend_3_march

	;;; purpose flags - regrouping
	march

	ai_priority				2.60

	supported_factions			greek_cities, pergamon, carthage, pontus, slave

	;; first phalanx line
	begin_block 0
		min_units				4
		max_units				6
		unit_type				phalanx 1.0
		;default_melee_state		defend	; Mac phalanx
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; left phalanx line
	begin_block 1
		min_units				2
		max_units				7
		unit_type				phalanx 1.0
		;default_melee_state		defend	; Mac phalanx
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 -0.1 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; right phalanx line
	begin_block 2
		min_units				2
		max_units				7
		unit_type				phalanx 1.0
		;default_melee_state		defend	; Mac phalanx
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.1 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; precursor spearmen back line
	begin_block 3
		unit_type				spearmen_pilum_infantry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		1.5
		priority			0.8
	end_block

	;; missile troops behind the spearmen

	;; left missile
	begin_block 4
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.8
		;default_melee_state		fire_at_will
		max_unit_width			20
		block_formation			line
		block_relative_pos		3 -10.0 0.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; right missile
	begin_block 5
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.8
		;default_melee_state		fire_at_will
		max_unit_width			20
		block_formation			line
		block_relative_pos		3 10.0 0.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; back line archer
	begin_block 6
		unit_type				chanting_screeching 3.0
		unit_type				ranged_missile_infantry 2.0
		;default_melee_state		fire_at_will_and_defend
		max_unit_width			20
		block_formation			line
		block_relative_pos		3 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 7
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.5
		unit_type				light infantry 0.8
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		1 -1.5 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; right side
	begin_block 8
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.5
		unit_type				light infantry 0.8
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		2 1.5 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	begin_dummy_block 9
		spans	1 2 3 4 5 6 7 8
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 10
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		1 -2.0 -3.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 11
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		2 2.0 -3.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 12
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		10 -5.0 0.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 13
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		11 5.0 0.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; general at the back
	begin_block 14
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		9 0.0 -10.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 15
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		14 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 16
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15
	end_dummy_block

	;; any behind
	begin_block 17
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		16 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 18
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			line
		block_relative_pos		16 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 19
		not_general
		unit_type				heavy_chariots 3.0
		;default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			column
		block_relative_pos		9 -20.0 1.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, infront of left flank cavalry
	begin_block 20
		not_general
		unit_type				elephants 3.0
		max_unit_width			20
		block_formation			column
		block_relative_pos		10 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, infront of right flank cavalry
	begin_block 21
		not_general
		unit_type				elephants 3.0
		max_unit_width			20
		block_formation			column
		block_relative_pos		11 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


begin_formation phalanx_defend_3_deploy

	;;; purpose flags - deploy, defending
	defend

	ai_priority				2.60

	supported_factions			greek_cities, pergamon, carthage, pontus, slave

	;; center phalanx line
	begin_block 0
		min_units				4
		max_units				6
		unit_type				phalanx 1.0
		default_melee_state		defend	; Mac phalanx
		unit_formation			phalanx
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; left phalanx line
	begin_block 1
		min_units				2
		max_units				7
		unit_type				phalanx 1.0
		default_melee_state		defend	; Mac phalanx
		unit_formation			phalanx
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -0.1 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; right phalanx line
	begin_block 2
		min_units				2
		max_units				7
		unit_type				phalanx 1.0
		default_melee_state		defend	; Mac phalanx
		unit_formation			phalanx
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.1 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; precursor spearmen back line
	begin_block 3
		unit_type				spearmen_pilum_infantry 1.0
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		1.5
		priority			0.8
	end_block

	;; missile troops behind the spearmen

	;; left missile
	begin_block 4
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.8
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; right missile
	begin_block 5
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.8
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 0.0 -10.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; back line archer
	begin_block 6
		unit_type				chanting_screeching 3.0
		unit_type				ranged_missile_infantry 2.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 0.0 -30.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 7
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.5
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		1 -1.5 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; right side
	begin_block 8
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.5
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		2 1.5 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	begin_dummy_block 9
		spans	1 2 3 4 5 6 7 8
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 10
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		9 -20.0 -23.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 11
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		9 20.0 -23.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 12
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		10 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 13
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		11 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; general at the back
	begin_block 14
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		9 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 15
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		14 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 16
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15
	end_dummy_block

	;; any behind
	begin_block 17
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		16 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 18
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		16 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 19
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		16 -20.0 -5.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, behind of left flank cavalry
	begin_block 20
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		10 0.0 -6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, behind of right flank cavalry
	begin_block 21
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		11 0.0 -6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


begin_formation phalanx_defend_3_attack

	;;; purpose flags - attack
	attack

	ai_priority				2.60

	supported_factions			greek_cities, pergamon, carthage, pontus, slave

	;; first phalanx line
	begin_block 0
		min_units				4
		max_units				6
		unit_type				phalanx 1.0
		default_melee_state		defend	; Mac phalanx
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; left phalanx line
	begin_block 1
		min_units				2
		max_units				7
		unit_type				phalanx 1.0
		default_melee_state		defend	; Mac phalanx
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 -0.1 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; right phalanx line
	begin_block 2
		min_units				2
		max_units				7
		unit_type				phalanx 1.0
		default_melee_state		defend	; Mac phalanx
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.1 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; precursor spearmen support line
	begin_block 3
		unit_type				spearmen_pilum_infantry 1.0
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		1.5
		priority			0.8
	end_block

	;; missile troops behind the spearmen

	;; left missile
	begin_block 4
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.8
		default_melee_state		fire_at_will
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 -10.0 0.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; right missile
	begin_block 5
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.8
		default_melee_state		fire_at_will
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 10.0 0.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; back line archer
	begin_block 6
		unit_type				chanting_screeching 3.0
		unit_type				ranged_missile_infantry 2.0
		default_melee_state		fire_at_will_and_defend
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 7
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.5
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		1 -1.5 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; right side
	begin_block 8
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.5
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		2 1.5 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	begin_dummy_block 9
		spans	1 2 3 4 5 6 7 8
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 10
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		9 -20.0 -23.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 11
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		9 20.0 -23.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 12
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		10 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 13
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		11 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; general at the back
	begin_block 14
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		9 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 15
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		14 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 16
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15
	end_dummy_block

	;; any behind
	begin_block 17
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		16 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 18
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		16 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 19
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		max_unit_width			30
		block_formation			line
		block_relative_pos		9 -30.0 20.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, infront of left flank cavalry
	begin_block 20
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		10 -5.0 6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, infront of right flank cavalry
	begin_block 21
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		11 5.0 6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


begin_formation phalanx_defend_3_pursue

	;;; purpose flags - charging, pursue
	pursue

	ai_priority				2.60

	supported_factions			greek_cities, pergamon, carthage, pontus, slave

	;; first phalanx line
	begin_block 0
		min_units				4
		max_units				6
		unit_type				phalanx 1.0
		default_melee_state		defend	; Mac phalanx
		unit_formation			phalanx
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; left phalanx line
	begin_block 1
		min_units				2
		max_units				7
		unit_type				phalanx 1.0
		default_melee_state		defend	; Mac phalanx
		unit_formation			phalanx
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 -0.1 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; right phalanx line
	begin_block 2
		min_units				2
		max_units				7
		unit_type				phalanx 1.0
		default_melee_state		defend	; Mac phalanx
		unit_formation			phalanx
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.1 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; precursor spearmen support line
	begin_block 3
		unit_type				spearmen_pilum_infantry 1.0
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		1.5
		priority			0.8
	end_block

	;; missile troops behind the spearmen

	;; left missile
	begin_block 4
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.8
		default_melee_state		fire_at_will
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 -10.0 0.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; right missile
	begin_block 5
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.8
		default_melee_state		fire_at_will
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 10.0 0.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; back line archer
	begin_block 6
		unit_type				chanting_screeching 3.0
		unit_type				ranged_missile_infantry 2.0
		default_melee_state		fire_at_will_and_defend
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 7
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.5
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, quare
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -1.5 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; right side
	begin_block 8
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.5
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		2 1.5 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	begin_dummy_block 9
		spans	1 2 3 4 5 6 7 8
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 10
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		9 -20.0 -23.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 11
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		9 20.0 -23.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 12
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		10 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 13
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		11 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; general at the back
	begin_block 14
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		9 0.0 -30.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 15
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		14 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 16
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15
	end_dummy_block

	;; any behind
	begin_block 17
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		16 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 18
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		16 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 19
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		max_unit_width			30
		block_formation			line
		block_relative_pos		9 5.0 10.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, beside of left flank cavalry
	begin_block 20
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		10 5.0 -6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, beside of right flank cavalry
	begin_block 21
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		11 -5.0 -6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


begin_formation phalanx_defend_3_approach

	;;; purpose flags - approaching
	attack
	defend

	ai_priority				2.60

	supported_factions			greek_cities, pergamon, carthage, pontus, slave

	;; first phalanx line
	begin_block 0
		min_units				4
		max_units				6
		unit_type				phalanx 1.0
		default_melee_state		defend	; Mac phalanx
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; left phalanx line
	begin_block 1
		min_units				2
		max_units				7
		unit_type				phalanx 1.0
		default_melee_state		defend	; Mac phalanx
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 -0.1 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; right phalanx line
	begin_block 2
		min_units				2
		max_units				7
		unit_type				phalanx 1.0
		default_melee_state		defend	; Mac phalanx
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.1 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; precursor spearmen back line
	begin_block 3
		unit_type				spearmen_pilum_infantry 1.0
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		1.5
		priority			0.8
	end_block

	;; missile troops behind the spearmen

	;; left missile
	begin_block 4
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.8
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 -10.0 0.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; right missile
	begin_block 5
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.8
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 10.0 0.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; back line archer
	begin_block 6
		unit_type				chanting_screeching 3.0
		unit_type				ranged_missile_infantry 2.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 0.0 -30.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 7
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.5
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		1 -1.5 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; right side
	begin_block 8
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.5
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		2 1.5 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	begin_dummy_block 9
		spans	1 2 3 4 5 6 7 8
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 10
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		9 -20.0 -23.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 11
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		9 20.0 -23.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 12
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		10 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 13
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		11 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; general at the back
	begin_block 14
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		9 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 15
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		14 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 16
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15
	end_dummy_block

	;; any behind
	begin_block 17
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		16 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 18
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		16 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 19
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		9 -20.0 1.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, infront of left flank cavalry
	begin_block 20
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		10 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, infront of right flank cavalry
	begin_block 21
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		11 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation



;*******************************************************************************
; mixed spearmen triple line formation, min 8 phalanx units, max 7 spearmen units (created by Sinuhet)
;*******************************************************************************

begin_formation phalanx_mixed_spearmen_attack_2_march

	;;; purpose flags - regrouping
	march

	ai_priority				2.55

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, carthage, pontus

	; Screen of missile inf
	begin_block 0
		max_units				8
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_density			close		; always deploy and defend as close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; first phalanx line
	begin_block 1
		min_units				8
		unit_type				phalanx 1.0
		;default_melee_state		defend	; Mac phalanx
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; non-phalanx left line
	begin_block 2
		min_units				1
		max_units				2
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		1 -0.1 -5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; non-phalanx right line
	begin_block 3
		min_units				1
		max_units				2
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		1 0.1 -5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; precursor spearmen back line
	begin_block 4
		max_units				3
		unit_type				spearmen_pilum_infantry 1.0
		unit_type				non_phalanx_spear 0.1
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		1.5
		priority			0.8
	end_block

	;; archers behind the spearmen

	begin_block 5
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend
		max_unit_width			20
		block_formation			line
		block_relative_pos		4 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 6
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		;default_melee_state		fire_at_will_and_defend
		;unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		2 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; right side
	begin_block 7
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		;default_melee_state		fire_at_will_and_defend
		;unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		3 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 8
		spans	1 2 3 4 5 6 7
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 9
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		2 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 10
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		3 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 11
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		9 -5.0 0.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 12
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		10 5.0 0.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; general at the back
	begin_block 13
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		8 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 14
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		13 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 15
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13 14
	end_dummy_block

	;; any behind
	begin_block 16
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		15 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 17
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		defend
		max_unit_width			15
		block_formation			line
		block_relative_pos		16 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 18
		not_general
		unit_type				heavy_chariots 3.0
		;default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			column
		block_relative_pos		8 -20.0 1.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, infront of left flank cavalry
	begin_block 19
		not_general
		unit_type				elephants 3.0
		max_unit_width			20
		block_formation			column
		block_relative_pos		9 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, infront of right flank cavalry
	begin_block 20
		not_general
		unit_type				elephants 3.0
		max_unit_width			20
		block_formation			column
		block_relative_pos		10 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


begin_formation phalanx_mixed_spearmen_attack_2_deploy

	;;; purpose flags - deploy, defending
	defend

	ai_priority				2.55

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, carthage, pontus

	; Screen of missile inf
	begin_block 0
		max_units				8
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; first phalanx line
	begin_block 1
		min_units				8
		unit_type				phalanx 1.0
		default_melee_state		defend	; Mac phalanx
		unit_formation			phalanx
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; non-phalanx left line
	begin_block 2
		min_units				1
		max_units				2
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -0.1 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; non-phalanx right line
	begin_block 3
		min_units				1
		max_units				2
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.1 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; precursor spearmen back line
	begin_block 4
		max_units				3
		unit_type				spearmen_pilum_infantry 1.0
		unit_type				non_phalanx_spear 0.1
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		1.5
		priority			0.8
	end_block

	;; archers behind the spearmen

	begin_block 5
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 0.0 -30.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 6
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		2 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; right side
	begin_block 7
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		3 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 8
		spans	1 2 3 4 5 6 7
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 9
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		8 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 10
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		8 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 11
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		9 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 12
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		10 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; general at the back
	begin_block 13
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		8 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 14
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		13 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 15
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13 14
	end_dummy_block

	;; any behind
	begin_block 16
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		15 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 17
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		15 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 18
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		15 -20.0 -5.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, behind of left flank cavalry
	begin_block 19
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 0.0 -6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, behind of right flank cavalry
	begin_block 20
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		10 0.0 -6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


begin_formation phalanx_mixed_spearmen_attack_2_attack

	;;; purpose flags - attacking
	attack

	ai_priority				2.55

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, carthage, pontus

	; Screen of missile inf
	begin_block 0
		max_units				8
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; first phalanx line
	begin_block 1
		min_units				8
		unit_type				phalanx 1.0
		default_melee_state		defend	; Mac phalanx
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; non-phalanx left line
	begin_block 2
		min_units				1
		max_units				2
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -0.1 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; non-phalanx right line
	begin_block 3
		min_units				1
		max_units				2
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.1 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; precursor spearmen back line
	begin_block 4
		max_units				3
		unit_type				spearmen_pilum_infantry 1.0
		unit_type				non_phalanx_spear 0.1
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		1.5
		priority			0.8
	end_block

	;; archers behind the spearmen

	begin_block 5
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend	; was defend_and_skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 6
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		;unit_density			close
		block_formation			column
		block_relative_pos		2 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; right side
	begin_block 7
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		;unit_density			close
		block_formation			column
		block_relative_pos		3 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 8
		spans	1 2 3 4 5 6 7
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 9
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		8 -20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 10
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		8 20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 11
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		9 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 12
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		10 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; general at the back
	begin_block 13
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		8 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 14
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		13 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 15
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13 14
	end_dummy_block

	;; any behind
	begin_block 16
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		15 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 17
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		15 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 18
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		max_unit_width			30
		block_formation			line
		block_relative_pos		8 -30.0 20.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, infront of left flank cavalry
	begin_block 19
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 -5.0 6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, infront of right flank cavalry
	begin_block 20
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		10 5.0 6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


begin_formation phalanx_mixed_spearmen_attack_2_pursue

	;;; purpose flags - charging, pursue
	pursue

	ai_priority				2.55

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, carthage, pontus

	; Screen of missile inf
	begin_block 0
		max_units				8
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; first phalanx line
	begin_block 1
		min_units				8
		unit_type				phalanx 1.0
		default_melee_state		defend	; Mac phalanx
		unit_formation			phalanx
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; non-phalanx left line
	begin_block 2
		min_units				1
		max_units				2
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -0.1 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; non-phalanx right line
	begin_block 3
		min_units				1
		max_units				2
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.1 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; precursor spearmen back line
	begin_block 4
		max_units				3
		unit_type				spearmen_pilum_infantry 1.0
		unit_type				non_phalanx_spear 0.1
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		1.5
		priority			0.8
	end_block

	;; archers behind the spearmen

	begin_block 5
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend	; was defend_and_skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 6
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		;unit_density			close
		block_formation			line
		block_relative_pos		2 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; right side
	begin_block 7
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		;unit_density			close
		block_formation			line
		block_relative_pos		3 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 8
		spans	1 2 3 4 5 6 7
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 9
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		8 -20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 10
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		8 20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 11
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		9 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 12
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		10 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; general at the back
	begin_block 13
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		8 0.0 -30.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 14
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		13 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 15
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13 14
	end_dummy_block

	;; any behind
	begin_block 16
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		14 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 17
		unit_type				handler 1.0
		unit_type				siege 3.0
		max_unit_width			24
		block_formation			line
		block_relative_pos		8 0.0 -50.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 18
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		max_unit_width			30
		block_formation			line
		block_relative_pos		8 5.0 10.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, beside of left flank cavalry
	begin_block 19
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 5.0 -6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, beside of right flank cavalry
	begin_block 20
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		10 -5.0 -6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


begin_formation phalanx_mixed_spearmen_attack_2_approach

	;;; purpose flags - approaching
	defend
	attack

	ai_priority				2.55

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, carthage, pontus

	; Screen of missile inf
	begin_block 0
		max_units				8
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; first phalanx line
	begin_block 1
		min_units				8
		unit_type				phalanx 1.0
		default_melee_state		defend	; Mac phalanx
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; non-phalanx left line
	begin_block 2
		min_units				1
		max_units				2
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -0.1 -5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; non-phalanx right line
	begin_block 3
		min_units				1
		max_units				2
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.1 -5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; precursor spearmen back line
	begin_block 4
		max_units				3
		unit_type				spearmen_pilum_infantry 1.0
		unit_type				non_phalanx_spear 0.1
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		1.5
		priority			0.8
	end_block

	;; archers behind the spearmen

	begin_block 5
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 0.0 -30.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 6
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		2 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; right side
	begin_block 7
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		3 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 8
		spans	1 2 3 4 5 6 7
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 9
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		8 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 10
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		8 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 11
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		9 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 12
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		10 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; general at the back
	begin_block 13
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		8 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 14
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		13 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 15
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13 14
	end_dummy_block

	;; any behind
	begin_block 16
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		15 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 17
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		16 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 18
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		8 -20.0 1.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, infront of left flank cavalry
	begin_block 19
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, infront of right flank cavalry
	begin_block 20
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		10 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation



;********************************************************************************
; Civilized Phalanx single line attack formation, max 7 phalanx units (created by Sinuhet)
;********************************************************************************

begin_formation phalanx_attack_4_march

	;;; purpose flags - regrouping
	march

	ai_priority				2.50

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, carthage, pontus

	; Screen of missile inf
	begin_block 0
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		;default_melee_state		fire_at_will_and_skirmish
		;unit_density			close		; always deploy and defend as close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; phalanx line
	begin_block 1
		min_units				3
		max_units				7
		unit_type				phalanx 1.0
		;default_melee_state		defend	; Mac phalanx
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; archers behind the spearmen

	begin_block 2
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend
		max_unit_width			20
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 3
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.7
		unit_type				light infantry 0.8
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		1 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; right side
	begin_block 4
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.7
		unit_type				light infantry 0.8
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		1 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 5
		spans	1 2 3 4
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		1 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 7
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		1 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 8
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		6 -5.0 0.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 9
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		7 5.0 0.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		10 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;; any behind
	begin_block 13
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		12 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 14
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 15
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			column
		block_relative_pos		5 -20.0 1.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, infront of left flank cavalry
	begin_block 16
		not_general
		unit_type				elephants 3.0
		max_unit_width			20
		block_formation			column
		block_relative_pos		6 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, infront of right flank cavalry
	begin_block 17
		not_general
		unit_type				elephants 3.0
		max_unit_width			20
		block_formation			column
		block_relative_pos		7 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


begin_formation phalanx_attack_4_deploy

	;;; purpose flags - deploy, defending
	defend

	ai_priority				2.50

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, carthage, pontus

	; Screen of missile inf
	begin_block 0
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; phalanx line
	begin_block 1
		min_units				3
		max_units				7
		unit_type				phalanx 1.0
		default_melee_state		defend	; Mac phalanx
		unit_formation			phalanx
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; archers behind the spearmen

	begin_block 2
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -30.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 3
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.7
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		1 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; right side
	begin_block 4
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.7
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		1 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 5
		spans	1 2 3 4
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 7
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 8
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		6 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 9
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		7 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		10 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;; any behind
	begin_block 13
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		12 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 14
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 15
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		12 -20.0 -5.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, behind of left flank cavalry
	begin_block 16
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 0.0 -6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, behind of right flank cavalry
	begin_block 17
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		7 0.0 -6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


begin_formation phalanx_attack_4_attack

	;;; purpose flags - attacking
	attack

	ai_priority				2.50

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, carthage, pontus

	; Screen of missile inf
	begin_block 0
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; phalanx line
	begin_block 1
		min_units				3
		max_units				7
		unit_type				phalanx 1.0
		default_melee_state		defend	; Mac phalanx
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; archers behind the spearmen

	begin_block 2
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 3
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.7
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		1 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; right side
	begin_block 4
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.7
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		1 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 5
		spans	1 2 3 4
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 -20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 7
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 8
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		6 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 9
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		7 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		10 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;; any behind
	begin_block 13
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		12 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 14
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 15
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		max_unit_width			30
		block_formation			line
		block_relative_pos		5 -30.0 20.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, infront of left flank cavalry
	begin_block 16
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 -5.0 6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, infront of right flank cavalry
	begin_block 17
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		7 5.0 6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


begin_formation phalanx_attack_4_pursue

	;;; purpose flags - charging, pursue
	pursue

	ai_priority				2.50

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, carthage, pontus

	; Screen of missile inf
	begin_block 0
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; phalanx line
	begin_block 1
		min_units				3
		max_units				7
		unit_type				phalanx 1.0
		default_melee_state		defend	; Mac phalanx
		unit_formation			phalanx
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; archers behind the spearmen

	begin_block 2
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 3
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.7
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -1.5 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; right side
	begin_block 4
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.7
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 1.5 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	begin_dummy_block 5
		spans	1 2 3 4
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 -20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 7
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 8
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		6 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 9
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		7 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		5 0.0 -30.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		10 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;; any behind
	begin_block 13
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		12 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 14
		unit_type				handler 1.0
		unit_type				siege 3.0
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 15
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		max_unit_width			30
		block_formation			line
		block_relative_pos		5 5.0 10.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, beside of left flank cavalry
	begin_block 16
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 5.0 -6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, beside of right flank cavalry
	begin_block 17
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		7 -5.0 -6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


begin_formation phalanx_attack_4_approach

	;;; purpose flags - approaching
	defend
	attack

	ai_priority				2.50

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, carthage, pontus

	; Screen of missile inf
	begin_block 0
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; phalanx line
	begin_block 1
		min_units				3
		max_units				7
		unit_type				phalanx 1.0
		default_melee_state		defend	; Mac phalanx
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; archers behind the spearmen

	begin_block 2
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -30.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 3
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.7
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		1 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; right side
	begin_block 4
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.7
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		1 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 5
		spans	1 2 3 4
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 7
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 8
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		6 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 9
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		7 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; general at the back
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		10 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;; any behind
	begin_block 13
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		12 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 14
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 15
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		5 -20.0 1.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, infront of left flank cavalry
	begin_block 16
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, infront of right flank cavalry
	begin_block 17
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		7 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation



;*****************************************************************************************************
; Greek Theban formation. The famous angled greek formation that inspired all later phalanx formations
; (could not be transposed fully so the angle was prohibited)
; modified to use for hoplites in XC, min 8 non-phalanx spearmen
;*****************************************************************************************************

begin_formation ai_theban_line_march

	;;; purpose flags - regrouping
	march

	ai_priority				2.40

	supported_factions			greek_cities, pergamon, sparta, macedon, egypt, seleucid, thrace, pontus, slave

	;; Left powered line of infantry
	begin_block 0
		min_units				3
		not_general
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		0.0
		priority			0.7
	end_block

	;; The angled line that follows(1)
	begin_block 1
		min_units				2
		not_general
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		0 0.1 0.0
		inter_unit_spacing		0.0
		priority			0.6
	end_block

	;; The angled line that follows(2)
	begin_block 2
		min_units				1
		not_general
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		1 0.1 0.0
		inter_unit_spacing		0.0
		priority			0.5
	end_block

	;; The angled line that follows(3)
	begin_block 3
		min_units				1
		not_general
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		2 0.1 0.0
		inter_unit_spacing		0.0
		priority			0.4
	end_block

	;; The angled line that follows(4)
	begin_block 4
		min_units				1
		not_general
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		3 0.1 0.0
		inter_unit_spacing		0.0
		priority			0.3
	end_block

	;; The angled line that follows(5)
	begin_block 5
		not_general
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		4 0.1 0.0
		inter_unit_spacing		0.0
		priority			0.2
	end_block

	begin_dummy_block 6
		spans	0 1 2 3 4 5
	end_dummy_block

	;; support of phalanx left
	begin_block 7
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		;default_melee_state		defend
		;unit_formation			square
		max_unit_width			20
		block_formation			column
		block_relative_pos		6 -3.0 0.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	;; support of phalanx right
	begin_block 8
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		;default_melee_state		defend
		;unit_formation			square
		max_unit_width			20
		block_formation			column
		block_relative_pos		6 3.0 0.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	begin_dummy_block 9
		spans	0 1 2 3 4 5 6 7 8
	end_dummy_block

	;; reserves line - mostly precursor spearmen
	begin_block 10
		not_general
		unit_type				spearmen_pilum_infantry 1.0
		unit_type				light infantry 0.5
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		9 0.0 -10.0
		inter_unit_spacing		4.0
		priority			0.1
	end_block

	; Screen of missile inf
	begin_block 11
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		;default_melee_state		fire_at_will_and_skirmish
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		9 0.0 15.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; Archers behind
	begin_block 12
		max_units				5
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			20
		block_formation			line
		block_relative_pos		9 0.0 -20.0
		inter_unit_spacing		6.0
		priority			0.6
	end_block

	begin_dummy_block 13
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12
	end_dummy_block

	;; commander at the back
	begin_block 14
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		13 0.0 -20.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 15
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		14 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry on left flank
	begin_block 16
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.4
		max_unit_width			20
		block_formation			square
		block_relative_pos		9 -15.0 -50.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	;; cavalry on right flank
	begin_block 17
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.4
		max_unit_width			20
		block_formation			square
		block_relative_pos		9 15.0 -50.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	begin_dummy_block 18
		spans	13 14 15 16 17
	end_dummy_block

	;; left flank missile cav
	begin_block 19
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		18 -5.0 0.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 20
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		18 5.0 0.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; any behind
	begin_block 21
		max_units				0
		unit_type				any 0.001
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		18 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handlers at the back
	begin_block 22
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			15
		block_formation			line
		block_relative_pos		18 0.0 -20.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	; elephants, chariots, and skirmish cavalry
	begin_block 23
		not_general
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			20
		block_formation			column
		block_relative_pos		13 -20.0 1.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

end_formation


begin_formation ai_theban_line_deploy

	;;; purpose flags - deploy, defending
	defend

	ai_priority				2.40

	supported_factions			greek_cities, pergamon, sparta, macedon, egypt, seleucid, thrace, pontus, slave

	;; Left powered line of infantry
	begin_block 0
		min_units				3
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.0
		priority			0.7
	end_block

	;; The angled line that follows(1)
	begin_block 1
		min_units				2
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		0 0.1 0.0
		inter_unit_spacing		0.0
		priority			0.6
	end_block

	;; The angled line that follows(2)
	begin_block 2
		min_units				1
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		1 0.1 0.0
		inter_unit_spacing		0.0
		priority			0.5
	end_block

	;; The angled line that follows(3)
	begin_block 3
		min_units				1
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		2 0.1 0.0
		inter_unit_spacing		0.0
		priority			0.4
	end_block

	;; The angled line that follows(4)
	begin_block 4
		min_units				1
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		3 0.1 0.0
		inter_unit_spacing		0.0
		priority			0.3
	end_block

	;; The angled line that follows(5)
	begin_block 5
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		4 0.1 0.0
		inter_unit_spacing		0.0
		priority			0.2
	end_block

	begin_dummy_block 6
		spans	0 1 2 3 4 5
	end_dummy_block

	;; support of phalanx left
	begin_block 7
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		6 -1.0 0.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	;; support of phalanx right
	begin_block 8
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		6 1.0 0.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	begin_dummy_block 9
		spans	0 1 2 3 4 5 6 7 8
	end_dummy_block

	;; reserves line - mostly precursor spearmen
	begin_block 10
		not_general
		unit_type				spearmen_pilum_infantry 1.0
		unit_type				light infantry 0.5
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 0.0 -10.0
		inter_unit_spacing		4.0
		priority			0.1
	end_block

	; Screen of missile inf
	begin_block 11
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		;default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 0.0 15.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; Archers behind
	begin_block 12
		max_units				5
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 0.0 -30.0
		inter_unit_spacing		6.0
		priority			0.6
	end_block

	begin_dummy_block 13
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12
	end_dummy_block

	;; commander at the back
	begin_block 14
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		13 0.0 -20.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 15
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		14 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry on left flank
	begin_block 16
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.4
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		13 -5.0 -10.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	;; cavalry on right flank
	begin_block 17
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.4
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		13 5.0 -10.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	begin_dummy_block 18
		spans	13 14 15 16 17
	end_dummy_block

	;; left flank missile cav
	begin_block 19
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		18 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 20
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		18 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; any behind
	begin_block 21
		max_units				0
		unit_type				any 0.001
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		18 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handlers at the back
	begin_block 22
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		18 0.0 -20.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	; elephants, chariots, and skirmish cavalry
	begin_block 23
		not_general
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		18 -20.0 -5.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

end_formation


;the multirole swap of the formation will make light infantry to go ahead of the phalanx for skirmishing.Also will make the formation square.
begin_formation ai_theban_line_attack

	;;; purpose flags - attacking
	attack

	ai_priority				2.40

	supported_factions			greek_cities, pergamon, sparta, macedon, egypt, seleucid, thrace, pontus, slave

	;; Left powered line of infantry
	begin_block 0
		min_units				3
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			square
		;unit_density			close
		max_unit_width			40
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.0
		priority			0.7
	end_block

	;; The angled line that follows(1)
	begin_block 1
		min_units				2
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			square
		;unit_density			close
		max_unit_width			40
		block_formation			column
		block_relative_pos		0 0.1 0.0
		inter_unit_spacing		0.0
		priority			0.6
	end_block

	;; The angled line that follows(2)
	begin_block 2
		min_units				1
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			40
		block_formation			column
		block_relative_pos		1 0.1 0.0
		inter_unit_spacing		0.0
		priority			0.5
	end_block

	;; The angled line that follows(3)
	begin_block 3
		min_units				1
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			40
		block_formation			column
		block_relative_pos		2 0.1 0.0
		inter_unit_spacing		0.0
		priority			0.4
	end_block

	;; The angled line that follows(4)
	begin_block 4
		min_units				1
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			40
		block_formation			column
		block_relative_pos		2 0.1 0.0
		inter_unit_spacing		0.0
		priority			0.3
	end_block

	;; The angled line that follows(5)
	begin_block 5
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			40
		block_formation			column
		block_relative_pos		2 0.1 0.0
		inter_unit_spacing		0.0
		priority			0.2
	end_block

	begin_dummy_block 6
		spans	0 1 2 3 4 5
	end_dummy_block

	;; support of phalanx left
	begin_block 7
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		default_melee_state		defend
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 -3.0 0.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	;; support of phalanx right
	begin_block 8
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		default_melee_state		defend
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 3.0 0.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	begin_dummy_block 9
		spans	0 1 2 3 4 5 6 7 8
	end_dummy_block

	;; reserves line - mostly precursor spearmen
	begin_block 10
		not_general
		unit_type				spearmen_pilum_infantry 1.0
		unit_type				light infantry 0.5
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 0.0 -10.0
		inter_unit_spacing		4.0
		priority			0.1
	end_block

	; Screen of missile inf
	begin_block 11
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		;default_melee_state		fire_at_will_and_skirmish
		;unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 0.0 15.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; Archers behind
	begin_block 12
		max_units				5
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 0.0 -20.0
		inter_unit_spacing		6.0
		priority			0.6
	end_block

	begin_dummy_block 13
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12
	end_dummy_block

	;; commander at the back
	begin_block 14
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		13 0.0 -20.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 15
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		14 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry on left flank
	begin_block 16
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.4
		default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			24
		block_formation			square
		block_relative_pos		13 -5.0 -15.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	;; cavalry on right flank
	begin_block 17
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.4
		default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			24
		block_formation			square
		block_relative_pos		13 5.0 -15.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	begin_dummy_block 18
		spans	13 14 15 16 17
	end_dummy_block

	;; left flank missile cav
	begin_block 19
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		18 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 20
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		18 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; any behind
	begin_block 21
		max_units				0
		unit_type				any 0.001
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		18 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handlers at the back
	begin_block 22
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			24
		block_formation			line
		block_relative_pos		18 0.0 -20.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	; elephants, chariots, and skirmish cavalry
	begin_block 23
		not_general
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		13 -30.0 20.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

end_formation


begin_formation ai_theban_line_pursue

	;;; purpose flags - charging, pursue
	pursue

	ai_priority				2.40

	supported_factions			greek_cities, pergamon, sparta, macedon, egypt, seleucid, thrace, pontus, slave

	;; Left powered line of infantry
	begin_block 0
		min_units				3
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		0.0
		priority			0.7
	end_block

	;; The angled line that follows(1)
	begin_block 1
		min_units				2
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.1 0.0
		inter_unit_spacing		0.0
		priority			0.6
	end_block

	;; The angled line that follows(2)
	begin_block 2
		min_units				1
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.1 0.0
		inter_unit_spacing		0.0
		priority			0.5
	end_block

	;; The angled line that follows(3)
	begin_block 3
		min_units				1
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		2 0.1 0.0
		inter_unit_spacing		0.0
		priority			0.4
	end_block

	;; The angled line that follows(4)
	begin_block 4
		min_units				1
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			40
		block_formation			column
		block_relative_pos		3 0.1 0.0
		inter_unit_spacing		0.0
		priority			0.3
	end_block

	;; The angled line that follows(5)
	begin_block 5
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			40
		block_formation			column
		block_relative_pos		4 0.1 0.0
		inter_unit_spacing		0.0
		priority			0.2
	end_block

	begin_dummy_block 6
		spans	0 1 2 3 4 5
	end_dummy_block

	;; support of phalanx left
	begin_block 7
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		default_melee_state		defend
		unit_formation			shield_wall, square
		max_unit_width			60
		block_formation			column
		block_relative_pos		6 -3.0 0.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	;; support of phalanx right
	begin_block 8
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		default_melee_state		defend
		unit_formation			shield_wall, square
		max_unit_width			60
		block_formation			column
		block_relative_pos		6 3.0 0.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	begin_dummy_block 9
		spans	0 1 2 3 4 5 6 7 8
	end_dummy_block

	;; reserves line - mostly precursor spearmen
	begin_block 10
		not_general
		unit_type				spearmen_pilum_infantry 1.0
		unit_type				light infantry 0.5
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 0.0 -10.0
		inter_unit_spacing		4.0
		priority			0.1
	end_block

	; Screen of missile inf
	begin_block 11
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		;default_melee_state		fire_at_will_and_skirmish
		;unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 -10.0 10.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; Archers behind
	begin_block 12
		max_units				5
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 0.0 -20.0
		inter_unit_spacing		6.0
		priority			0.6
	end_block

	begin_dummy_block 13
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12
	end_dummy_block

	;; commander at the back
	begin_block 14
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		13 0.0 -30.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 15
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		14 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry on left flank
	begin_block 16
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.4
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			square
		block_relative_pos		13 -5.0 -20.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	;; cavalry on right flank
	begin_block 17
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.4
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			square
		block_relative_pos		13 5.0 -20.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	begin_dummy_block 18
		spans	13 14 15 16 17
	end_dummy_block

	;; left flank missile cav
	begin_block 19
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		18 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 20
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		18 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; any behind
	begin_block 21
		max_units				0
		unit_type				any 0.001
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		18 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handlers at the back
	begin_block 22
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			24
		block_formation			line
		block_relative_pos		18 0.0 -30.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	; elephants, chariots, and skirmish cavalry
	begin_block 23
		not_general
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		13 5.0 10.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

end_formation


;the formation attacks and the phalanx will slowly advance in cover from light infantry and cavalry.
begin_formation ai_theban_line_approach

	;;; purpose flags - approaching
	attack
	defend

	ai_priority				2.40

	supported_factions			greek_cities, pergamon, sparta, macedon, egypt, seleucid, thrace, pontus, slave

	;; Left powered line of infantry
	begin_block 0
		min_units				3
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			32
		block_formation			column
		block_relative_pos		0 0.0 25.0
		inter_unit_spacing		0.0
		priority			0.7
	end_block

	;; The angled line that follows(1)
	begin_block 1
		min_units				2
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		0 0.1 0.0
		inter_unit_spacing		0.0
		priority			0.6
	end_block

	;; The angled line that follows(2)
	begin_block 2
		min_units				1
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			54
		block_formation			column
		block_relative_pos		1 0.1 0.0
		inter_unit_spacing		0.0
		priority			0.5
	end_block

	;; The angled line that follows(3)
	begin_block 3
		min_units				1
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			54
		block_formation			column
		block_relative_pos		2 0.1 0.0
		inter_unit_spacing		0.0
		priority			0.4
	end_block

	;; The angled line that follows(4)
	begin_block 4
		min_units				1
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		3 0.1 0.0
		inter_unit_spacing		0.0
		priority			0.3
	end_block

	;; The angled line that follows(5)
	begin_block 5
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		4 0.1 0.0
		inter_unit_spacing		0.0
		priority			0.2
	end_block

	begin_dummy_block 6
		spans	0 1 2 3 4 5
	end_dummy_block

	;; support of phalanx left
	begin_block 7
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		default_melee_state		defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			60
		block_formation			column
		block_relative_pos		6 -3.0 0.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	;; support of phalanx right
	begin_block 8
		max_units				3
		unit_type				general_unit infantry 3.0
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		default_melee_state		defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			60
		block_formation			column
		block_relative_pos		6 3.0 0.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	begin_dummy_block 9
		spans	0 1 2 3 4 5 6 7 8
	end_dummy_block

	;; reserves line - mostly precursor spearmen
	begin_block 10
		not_general
		unit_type				spearmen_pilum_infantry 1.0
		unit_type				light infantry 0.5
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 0.0 -10.0
		inter_unit_spacing		4.0
		priority			0.1
	end_block

	; Screen of missile inf
	begin_block 11
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		;default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 0.0 15.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; Archers behind
	begin_block 12
		max_units				5
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 0.0 -30.0
		inter_unit_spacing		6.0
		priority			0.6
	end_block

	begin_dummy_block 13
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12
	end_dummy_block

	;; commander at the back
	begin_block 14
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		13 0.0 -20.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 15
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		14 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry on left flank
	begin_block 16
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.4
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		13 -15.0 -50.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	;; cavalry on right flank
	begin_block 17
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.4
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		13 15.0 -50.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	begin_dummy_block 18
		spans	13 14 15 16 17
	end_dummy_block

	;; left flank missile cav
	begin_block 19
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		18 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 20
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		18 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; any behind
	begin_block 21
		max_units				0
		unit_type				any 0.001
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		18 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handlers at the back
	begin_block 22
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		18 0.0 -20.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	; elephants, chariots, and skirmish cavalry
	begin_block 23
		not_general
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		13 -20.0 1.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

end_formation



;**********************************************************************************************
; RTW/M2TW Non-phalanx spearmen triple line formation, min 13 spearmen units (created by Sinuhet)
; Edited by Quinn Inuit to make it min 8 units and to move the rear 2 blocks to flanking positions
; Modified by Suppanut to make it min 13 units and has optional reserves line
;**********************************************************************************************

begin_formation nonphalanx_attack_1_march

	;;; purpose flags - regrouping
	march

	ai_priority				2.40

	supported_factions			carthage, armenia, parthia, slave

	; Screen of missile inf
	begin_block 0
		max_units				8
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_density			close		; always deploy and defend as close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; non-phalanx center line
	begin_block 1
		min_units				5
		max_units				6
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; non-phalanx left line
	begin_block 2
		min_units				4
		max_units				7
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		1 -0.1 -5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; non-phalanx right line
	begin_block 3
		min_units				4
		max_units				7
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		1 0.1 -5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; precursor spearmen back line
	begin_block 4
		max_units				7
		unit_type				spearmen_pilum_infantry 1.0
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		1.5
		priority			0.8
	end_block

	;; archers behind the spearmen

	begin_block 5
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend
		max_unit_width			20
		block_formation			line
		block_relative_pos		4 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 6
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		;default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		2 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; right side
	begin_block 7
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		;default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		3 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 8
		spans	1 2 3 4 5 6 7
	end_dummy_block

	;; general at the back
	begin_block 9
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		8 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 10
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		9 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 11
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		9 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 12
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		9 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	begin_dummy_block 13
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12
	end_dummy_block

	;; left flank missile cav
	begin_block 14
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		13 -5.0 0.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 15
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		13 5.0 0.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; any behind
	begin_block 16
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		13 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 17
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			line
		block_relative_pos		13 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 18
		not_general
		unit_type				heavy_chariots 3.0
		;default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			line
		block_relative_pos		8 -20.0 1.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, infront of left flank cavalry
	begin_block 19
		not_general
		unit_type				elephants 3.0
		max_unit_width			20
		block_formation			column
		block_relative_pos		9 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, infront of right flank cavalry
	begin_block 20
		not_general
		unit_type				elephants 3.0
		max_unit_width			20
		block_formation			column
		block_relative_pos		10 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


begin_formation nonphalanx_attack_1_deploy

	;;; purpose flags - deploy, defending
	defend

	ai_priority				2.40

	supported_factions			carthage, armenia, parthia, slave

	; Screen of missile inf
	begin_block 0
		max_units				8
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; non-phalanx center line
	begin_block 1
		min_units				5
		max_units				6
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; non-phalanx left line
	begin_block 2
		min_units				4
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -0.1 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; non-phalanx right line
	begin_block 3
		min_units				4
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.1 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; precursor spearmen back line
	begin_block 4
		max_units				7
		unit_type				spearmen_pilum_infantry 1.0
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		1.5
		priority			0.8
	end_block

	;; archers behind the spearmen

	begin_block 5
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 0.0 -30.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 6
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		2 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; right side
	begin_block 7
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		3 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 8
		spans	1 2 3 4 5 6 7
	end_dummy_block

	;; general at the back
	begin_block 9
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		8 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 10
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		9 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 11
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		8 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 12
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		8 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	begin_dummy_block 13
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12
	end_dummy_block

	;; left flank missile cav
	begin_block 14
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		13 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 15
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		13 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; any behind
	begin_block 16
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		13 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 17
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		13 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 18
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		13 -20.0 -5.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, behind of left flank cavalry
	begin_block 19
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 0.0 -6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, behind of right flank cavalry
	begin_block 20
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		10 0.0 -6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


begin_formation nonphalanx_attack_1_attack

	;;; purpose flags - attacking
	attack

	ai_priority				2.40

	supported_factions			carthage, armenia, parthia, slave

	; Screen of missile inf
	begin_block 0
		max_units				8
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; non-phalanx center line
	begin_block 1
		min_units				5
		max_units				6
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; non-phalanx left line
	begin_block 2
		min_units				4
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -0.1 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; non-phalanx right line
	begin_block 3
		min_units				4
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.1 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; precursor spearmen back line
	begin_block 4
		max_units				7
		unit_type				spearmen_pilum_infantry 1.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		1.5
		priority			0.8
	end_block

	;; archers behind the spearmen

	begin_block 5
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend	; was defend_and_skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 6
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		;unit_density			close
		block_formation			column
		block_relative_pos		2 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; right side
	begin_block 7
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		;unit_density			close
		block_formation			column
		block_relative_pos		3 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 8
		spans	1 2 3 4 5 6 7
	end_dummy_block

	;; general at the back
	begin_block 9
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		8 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 10
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		9 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 11
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		8 -20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 12
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		8 20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	begin_dummy_block 13
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12
	end_dummy_block

	;; left flank missile cav
	begin_block 14
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		13 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 15
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		13 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; any behind
	begin_block 16
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		13 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 17
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		13 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 18
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		max_unit_width			30
		block_formation			line
		block_relative_pos		8 -30.0 20.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, infront of left flank cavalry
	begin_block 19
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 -5.0 6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, infront of right flank cavalry
	begin_block 20
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		10 5.0 6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


begin_formation nonphalanx_attack_1_pursue

	;;; purpose flags - charging, pursue
	pursue

	ai_priority				2.40

	supported_factions			carthage, armenia, parthia, slave

	; Screen of missile inf
	begin_block 0
		max_units				8
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; non-phalanx center line
	begin_block 1
		min_units				5
		max_units				6
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; non-phalanx left line
	begin_block 2
		min_units				4
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -0.1 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; non-phalanx right line
	begin_block 3
		min_units				4
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.1 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; precursor spearmen back line
	begin_block 4
		max_units				7
		unit_type				spearmen_pilum_infantry 1.0
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		1.5
		priority			0.8
	end_block

	;; archers behind the spearmen

	begin_block 5
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend	; was defend_and_skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 6
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		;unit_density			close
		block_formation			line
		block_relative_pos		2 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; right side
	begin_block 7
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		;unit_density			close
		block_formation			line
		block_relative_pos		3 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 8
		spans	1 2 3 4 5 6 7
	end_dummy_block

	;; general at the back
	begin_block 9
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		8 0.0 -30.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 10
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		9 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 11
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		8 -20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 12
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		8 20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	begin_dummy_block 13
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12
	end_dummy_block

	;; left flank missile cav
	begin_block 14
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		13 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 15
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		13 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; any behind
	begin_block 16
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		13 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 17
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		13 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 18
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		max_unit_width			30
		block_formation			line
		block_relative_pos		8 5.0 10.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, beside of left flank cavalry
	begin_block 19
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 5.0 6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, beside of right flank cavalry
	begin_block 20
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		10 -5.0 6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


begin_formation nonphalanx_attack_1_approach

	;;; purpose flags - approaching
	defend
	attack

	ai_priority				2.40

	supported_factions			carthage, armenia, parthia, slave

	; Screen of missile inf
	begin_block 0
		max_units				8
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; non-phalanx center line
	begin_block 1
		min_units				5
		max_units				6
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; non-phalanx left line
	begin_block 2
		min_units				4
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -0.1 -5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; non-phalanx right line
	begin_block 3
		min_units				4
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.1 -5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; precursor spearmen back line
	begin_block 4
		max_units				7
		unit_type				spearmen_pilum_infantry 1.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		1.5
		priority			0.8
	end_block

	;; archers behind the spearmen

	begin_block 5
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 0.0 -30.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 6
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		2 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; right side
	begin_block 7
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		3 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 8
		spans	1 2 3 4 5 6 7
	end_dummy_block

	;; general at the back
	begin_block 9
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		8 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 10
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		9 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 11
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		8 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 12
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		8 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	begin_dummy_block 13
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12
	end_dummy_block

	;; left flank missile cav
	begin_block 14
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		13 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 15
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		13 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; any behind
	begin_block 16
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		13 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 17
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		13 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 18
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		8 -20.0 1.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, infront of left flank cavalry
	begin_block 19
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, infront of right flank cavalry
	begin_block 20
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		10 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation



;**********************************************************************************************
; RTW/M2TW Non-phalanx spearmen triple line formation, min 13 spearmen units (created by Sinuhet)
; Edited by Quinn Inuit to make it min 8 units and to move the rear 2 blocks to flanking positions
;**********************************************************************************************

begin_formation nonphalanx_attack_2_march

	;;; purpose flags - regrouping
	march

	ai_priority				2.30

	supported_factions			carthage, armenia, parthia, slave

	; Screen of missile inf
	begin_block 0
		max_units				8
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_density			close		; always deploy and defend as close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; non-phalanx center line
	begin_block 1
		min_units				4
		max_units				4
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; non-phalanx left line
	begin_block 2
		min_units				2
		max_units				4
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		1 -0.1 -5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; non-phalanx right line
	begin_block 3
		min_units				2
		max_units				4
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		1 0.1 -5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; archers behind the spearmen

	begin_block 4
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend
		max_unit_width			20
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 5
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		2 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; right side
	begin_block 6
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		3 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 7
		spans	1 2 3 4 5 6
	end_dummy_block

	;; general at the back
	begin_block 8
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		7 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 9
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		8 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 10
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		8 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 11
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		8 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;; left flank missile cav
	begin_block 13
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		12 -5.0 0.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 14
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		12 5.0 0.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; any behind
	begin_block 15
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		12 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 16
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 17
		not_general
		unit_type				heavy_chariots 3.0
		;default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			column
		block_relative_pos		7 -20.0 1.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, infront of left flank cavalry
	begin_block 18
		not_general
		unit_type				elephants 3.0
		max_unit_width			20
		block_formation			column
		block_relative_pos		8 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, infront of right flank cavalry
	begin_block 19
		not_general
		unit_type				elephants 3.0
		max_unit_width			20
		block_formation			column
		block_relative_pos		9 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


begin_formation nonphalanx_attack_2_deploy

	;;; purpose flags - deploy, defending
	defend

	ai_priority				2.30

	supported_factions			carthage, armenia, parthia, slave

	; Screen of missile inf
	begin_block 0
		max_units				8
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; non-phalanx center line
	begin_block 1
		min_units				4
		max_units				4
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; non-phalanx left line
	begin_block 2
		min_units				2
		max_units				4
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -0.1 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; non-phalanx right line
	begin_block 3
		min_units				2
		max_units				4
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.1 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; archers behind the spearmen

	begin_block 4
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -30.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 5
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		2 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; right side
	begin_block 6
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		3 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 7
		spans	1 2 3 4 5 6
	end_dummy_block

	;; general at the back
	begin_block 8
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		7 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 9
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		8 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 10
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		7 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 11
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		7 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;; left flank missile cav
	begin_block 13
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		12 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 14
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		12 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; any behind
	begin_block 15
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		12 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 16
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 17
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		12 -20.0 -5.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, behind of left flank cavalry
	begin_block 18
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		8 0.0 -6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, behind of right flank cavalry
	begin_block 19
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 0.0 -6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


begin_formation nonphalanx_attack_2_attack

	;;; purpose flags - attacking
	attack

	ai_priority				2.30

	supported_factions			carthage, armenia, parthia, slave

	; Screen of missile inf
	begin_block 0
		max_units				8
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; non-phalanx center line
	begin_block 1
		min_units				4
		max_units				4
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; non-phalanx left line
	begin_block 2
		min_units				2
		max_units				4
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -0.1 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; non-phalanx right line
	begin_block 3
		min_units				2
		max_units				4
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.1 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; archers behind the spearmen

	begin_block 4
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend	; was defend_and_skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		1.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 5
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		defend
		;unit_formation			shield_wall, square
		;unit_density			close
		block_formation			column
		block_relative_pos		2 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; right side
	begin_block 6
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		defend
		;unit_formation			shield_wall, square
		;unit_density			close
		block_formation			column
		block_relative_pos		3 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 7
		spans	1 2 3 4 5 6
	end_dummy_block

	;; general at the back
	begin_block 8
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		7 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 9
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		8 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 10
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		7 -20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 11
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		7 20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;; left flank missile cav
	begin_block 13
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		12 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 14
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		12 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; any behind
	begin_block 15
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		12 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 16
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 17
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		max_unit_width			30
		block_formation			line
		block_relative_pos		7 -30.0 20.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, infront of left flank cavalry
	begin_block 18
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		8 -5.0 6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, infront of right flank cavalry
	begin_block 19
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 5.0 6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


begin_formation nonphalanx_attack_2_pursue

	;;; purpose flags - charging, pursue
	pursue

	ai_priority				2.30

	supported_factions			carthage, armenia, parthia, slave

	; Screen of missile inf
	begin_block 0
		max_units				8
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; non-phalanx center line
	begin_block 1
		min_units				4
		max_units				4
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; non-phalanx left line
	begin_block 2
		min_units				2
		max_units				4
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -0.1 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; non-phalanx right line
	begin_block 3
		min_units				2
		max_units				4
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.1 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; archers behind the spearmen

	begin_block 4
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend	; was defend_and_skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 5
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		block_formation			line
		block_relative_pos		2 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; right side
	begin_block 6
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		block_formation			line
		block_relative_pos		3 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 7
		spans	1 2 3 4 5 6
	end_dummy_block

	;; general at the back
	begin_block 8
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		7 0.0 -30.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 9
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		8 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 10
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		7 -20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 11
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		7 20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;; left flank missile cav
	begin_block 13
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		12 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 14
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		12 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; any behind
	begin_block 15
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		12 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 16
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 17
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		max_unit_width			30
		block_formation			line
		block_relative_pos		7 5.0 10.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, beside of left flank cavalry
	begin_block 18
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		8 5.0 -6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, beside of right flank cavalry
	begin_block 19
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 -5.0 -6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


begin_formation nonphalanx_attack_2_approach

	;;; purpose flags - approaching
	defend
	attack

	ai_priority				2.30

	supported_factions			carthage, armenia, parthia, slave

	; Screen of missile inf
	begin_block 0
		max_units				8
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; non-phalanx center line
	begin_block 1
		min_units				4
		max_units				4
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; non-phalanx left line
	begin_block 2
		min_units				2
		max_units				4
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -0.1 -5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; non-phalanx right line
	begin_block 3
		min_units				2
		max_units				4
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.1 -5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; archers behind the spearmen

	begin_block 4
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -30.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 5
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		2 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; right side
	begin_block 6
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		3 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 7
		spans	1 2 3 4 5 6
	end_dummy_block

	;; general at the back
	begin_block 8
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		7 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 9
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		8 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 10
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		7 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 11
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		7 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;; left flank missile cav
	begin_block 13
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		12 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 14
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		12 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; any behind
	begin_block 15
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		12 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 16
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 17
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		7 -20.0 1.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, infront of left flank cavalry
	begin_block 18
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		8 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, infront of right flank cavalry
	begin_block 19
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation



;*********************************************************************************************
; Non-phalanx spearmen single line attack formation, max 7 spearmen units (created by Sinuhet)
;*********************************************************************************************

begin_formation nonphalanx_attack_3_march

	;;; purpose flags - regrouping
	march

	ai_priority				2.20

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, carthage, pontus, armenia, parthia, slave

	; Screen of missile inf
	begin_block 0
		max_units				8
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		;default_melee_state		fire_at_will_and_skirmish
		;unit_density			close		; always deploy and defend as close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; first spearmen line
	begin_block 1
		min_units				1
		max_units				7
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; archers behind the spearmen

	begin_block 2
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend	; was defend_and_skirmish
		max_unit_width			20
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 3
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		1 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; right side
	begin_block 4
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		1 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 5
		spans	1 2 3 4
	end_dummy_block

	;; general at the back
	begin_block 6
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 7
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		7 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 8
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		6 -10.0 -30.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 9
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		6 10.0 -30.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	begin_dummy_block 10
		spans	0 1 2 3 4 5 6 7 8 9
	end_dummy_block

	;; left flank missile cav
	begin_block 11
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		10 -5.0 0.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 12
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		10 5.0 0.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; any behind
	begin_block 13
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		10 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 14
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			line
		block_relative_pos		10 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 15
		not_general
		unit_type				heavy_chariots 3.0
		;default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			column
		block_relative_pos		5 -20.0 1.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, infront of left flank cavalry
	begin_block 16
		not_general
		unit_type				elephants 3.0
		max_unit_width			20
		block_formation			column
		block_relative_pos		6 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, infront of right flank cavalry
	begin_block 17
		not_general
		unit_type				elephants 3.0
		max_unit_width			20
		block_formation			column
		block_relative_pos		7 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


begin_formation nonphalanx_attack_3_deploy

	;;; purpose flags - deploy, defending
	defend

	ai_priority				2.20

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, carthage, pontus, armenia, parthia, slave

	; Screen of missile inf
	begin_block 0
		max_units				8
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; first spearmen line
	begin_block 1
		min_units				1
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; archers behind the spearmen

	begin_block 2
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -30.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 3
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		1 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; right side
	begin_block 4
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		1 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 5
		spans	1 2 3 4
	end_dummy_block

	;; general at the back
	begin_block 6
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 7
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		6 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 8
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 9
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	begin_dummy_block 10
		spans	0 1 2 3 4 5 6 7 8 9
	end_dummy_block

	;; left flank missile cav
	begin_block 11
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		10 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 12
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		10 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; any behind
	begin_block 13
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		10 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 14
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 15
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		10 -20.0 -5.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, behind of left flank cavalry
	begin_block 16
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 0.0 -6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, behind of right flank cavalry
	begin_block 17
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		7 0.0 -6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


begin_formation nonphalanx_attack_3_attack

	;;; purpose flags - attacking
	attack

	ai_priority				2.20

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, carthage, pontus, armenia, parthia, slave

	; Screen of missile inf
	begin_block 0
		max_units				8
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; first spearmen line
	begin_block 1
		min_units				1
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; archers behind the spearmen

	begin_block 2
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend	; was defend_and_skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 3
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		;unit_density			close
		block_formation			column
		block_relative_pos		1 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; right side
	begin_block 4
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		;unit_density			close
		block_formation			column
		block_relative_pos		1 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 5
		spans	1 2 3 4
	end_dummy_block

	;; general at the back
	begin_block 6
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 7
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		6 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 8
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 -20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 9
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	begin_dummy_block 10
		spans	0 1 2 3 4 5 6 7 8 9
	end_dummy_block

	;; left flank missile cav
	begin_block 11
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		10 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 12
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		10 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; any behind
	begin_block 13
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		10 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 14
		unit_type				handler 1.0
		unit_type				siege 3.0
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 15
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		max_unit_width			30
		block_formation			line
		block_relative_pos		5 -30.0 20.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, infront of left flank cavalry
	begin_block 16
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 -5.0 6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, infront of right flank cavalry
	begin_block 17
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		7 5.0 6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


begin_formation nonphalanx_attack_3_pursue

	;;; purpose flags - charging, pursue
	pursue

	ai_priority				2.20

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, carthage, pontus, armenia, parthia, slave

	; Screen of missile inf
	begin_block 0
		max_units				8
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; first spearmen line
	begin_block 1
		min_units				1
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; archers behind the spearmen

	begin_block 2
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend	; was defend_and_skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 3
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		;unit_density			close
		block_formation			line
		block_relative_pos		1 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; right side
	begin_block 4
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		;unit_density			close
		block_formation			line
		block_relative_pos		1 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 5
		spans	1 2 3 4
	end_dummy_block

	;; general at the back
	begin_block 6
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		5 0.0 -30.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 7
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		6 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 8
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 -20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 9
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	begin_dummy_block 10
		spans	0 1 2 3 4 5 6 7 8 9
	end_dummy_block

	;; left flank missile cav
	begin_block 11
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		10 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 12
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		10 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; any behind
	begin_block 13
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		10 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 14
		unit_type				handler 1.0
		unit_type				siege 3.0
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 15
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		max_unit_width			30
		block_formation			line
		block_relative_pos		5 5.0 10.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, beside of left flank cavalry
	begin_block 16
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 5.0 -6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, beside of right flank cavalry
	begin_block 17
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		7 -5.0 -6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


begin_formation nonphalanx_attack_3_approach

	;;; purpose flags - approaching
	defend
	attack

	ai_priority				2.20

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, carthage, pontus, armenia, parthia, slave

	; Screen of missile inf
	begin_block 0
		max_units				8
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; first spearmen line
	begin_block 1
		min_units				1
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; archers behind the spearmen

	begin_block 2
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -30.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 3
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		1 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; right side
	begin_block 4
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		1 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 5
		spans	1 2 3 4
	end_dummy_block

	;; general at the back
	begin_block 6
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 7
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		7 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 8
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 -10.0 -30.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 9
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 10.0 -30.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	begin_dummy_block 10
		spans	0 1 2 3 4 5 6 7 8 9
	end_dummy_block

	;; left flank missile cav
	begin_block 11
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		10 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 12
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		10 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; any behind
	begin_block 13
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		10 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 14
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 15
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		5 -20.0 1.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, infront of left flank cavalry
	begin_block 16
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, infront of right flank cavalry
	begin_block 17
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		7 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation



;****************************************************************
;Pseudoromans - Special formation for factions with non-precursor
;weapons, 2 lines of inf, cav on the wings (created by Sinuhet)
; modified by Suppanut by combined with Marcus Camillus's
; Eastern/Barbarian Generic Army Formation *ExRM Sinuhet
;****************************************************************

begin_formation ai_standard_line_1_march

	;;; purpose flags - regrouping
	march

	ai_priority				2.10

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, carthage, numidia, pontus, armenia, parthia, slave

	; Screen of missile inf
	begin_block 0
		max_units				4
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		;default_melee_state		fire_at_will_and_skirmish
		;unit_density			close		; always deploy and defend as close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; First line of heavy infantry
	begin_block 1
		max_units				8
		unit_type				heavy infantry 0.9
		unit_type				heavy_pilum_infantry 0.1
		;default_melee_state		fire_at_will
		;unit_formation			shield_wall, schiltrom, square
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 -7.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; second line of heavy infantry
	begin_block 2
		max_units				8
		unit_type				heavy_pilum_infantry 0.9
		unit_type				heavy infantry 0.1
		;default_melee_state		fire_at_will
		;unit_formation			shield_wall, schiltrom, square
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		1 0.0 -10.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; light infantry on the left outer flank
	begin_block 3
		unit_type				spearmen_pilum_infantry 1.0
		unit_type				light_pilum_infantry 0.9
		unit_type				light infantry 0.1
		;default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		1 -10.0 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; light infantry on the right outer flank
	begin_block 4
		unit_type				spearmen_pilum_infantry 1.0
		unit_type				light_pilum_infantry 0.9
		unit_type				light infantry 0.1
		;default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		1 10.0 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; dummy block
	begin_dummy_block 5
		spans	0 1 2 3 4
	end_dummy_block

	;; 3rd line of infantry, guard of archers
	begin_block 6
		unit_type				non_phalanx_spear 1.0
		unit_type				heavy infantry 0.6
		unit_type				light infantry 0.2
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		5 0.0 -10.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; Archers behind
	begin_block 7
		max_units				10
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend
		max_unit_width			20
		block_formation			line
		block_relative_pos		6 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; left side excess missile troops
	begin_block 8
		max_units				4
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.8
		;default_melee_state		fire_at_will_and_skirmish
		max_unit_width			20
		block_formation			line
		block_relative_pos		6 -10.0 0.0
		inter_unit_spacing		2.0
		priority			0.3
	end_block

	;; right side excess missile troops
	begin_block 9
		max_units				4
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.8
		;default_melee_state		fire_at_will_and_skirmish
		max_unit_width			20
		block_formation			line
		block_relative_pos		6 10.0 0.0
		inter_unit_spacing		2.0
		priority			0.3
	end_block

	;; infantry reserve on both flanks of the missile troops

	;; left flank infantry reserve
	begin_block 10
		max_units				2
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		7 -2.0 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; right flank infantry reserve
	begin_block 11
		max_units				2
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		7 2.0 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; dummy block
	begin_dummy_block 12
		spans	1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 13
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		5 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 14
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		5 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 15
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		13 -5.0 0.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 16
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		14 5.0 0.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; general at the back
	begin_block 17
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 18
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		17 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 19
		spans	0 12 13 14 15 16 17 18
	end_dummy_block

	;; any behind
	begin_block 20
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		19 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 21
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			line
		block_relative_pos		19 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 22
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			column
		block_relative_pos		12 -20.0 1.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, infront of cavalry wing
	begin_block 23
		not_general
		unit_type				elephants 3.0
		;default_melee_state		fire_at_will
		max_unit_width			20
		block_formation			column
		block_relative_pos		13 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, infront of cavalry wing
	begin_block 24
		not_general
		unit_type				elephants 3.0
		;default_melee_state		fire_at_will
		max_unit_width			20
		block_formation			column
		block_relative_pos		14 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


begin_formation ai_standard_line_1_deploy

	;;; purpose flags - deploy, defending
	defend

	ai_priority				2.10

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, carthage, numidia, pontus, armenia, parthia, slave

	; Screen of missile inf
	begin_block 0
		max_units				4
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; First line of heavy infantry
	begin_block 1
		max_units				8
		unit_type				heavy infantry 0.9
		unit_type				heavy_pilum_infantry 0.1
		default_melee_state		fire_at_will
		unit_formation			shield_wall, schiltrom, square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		0 0.0 -7.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; second line of heavy infantry
	begin_block 2
		max_units				8
		unit_type				heavy_pilum_infantry 0.9
		unit_type				heavy infantry 0.1
		default_melee_state		fire_at_will
		unit_formation			shield_wall, schiltrom, square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		1 0.0 -10.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; light infantry on the left outer flank
	begin_block 3
		unit_type				spearmen_pilum_infantry 1.0
		unit_type				light_pilum_infantry 0.9
		unit_type				light infantry 0.1
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -10.0 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; light infantry on the right outer flank
	begin_block 4
		unit_type				spearmen_pilum_infantry 1.0
		unit_type				light_pilum_infantry 0.9
		unit_type				light infantry 0.1
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 10.0 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; dummy block
	begin_dummy_block 5
		spans	0 1 2 3 4
	end_dummy_block

	;; 3rd line of infantry, guard of archers
	begin_block 6
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 0.0 -10.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; Archers behind
	begin_block 7
		max_units				10
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 0.0 -30.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; left side excess missile troops
	begin_block 8
		max_units				4
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 -10.0 0.0
		inter_unit_spacing		2.0
		priority			0.3
	end_block

	;; right side excess missile troops
	begin_block 9
		max_units				4
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 10.0 0.0
		inter_unit_spacing		2.0
		priority			0.3
	end_block

	;; infantry reserve on both flanks of the missile troops

	;; left flank infantry reserve
	begin_block 10
		max_units				2
		unit_type				light infantry 1.0
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		7 -2.0 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; right flank infantry reserve
	begin_block 11
		max_units				2
		unit_type				light infantry 1.0
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		7 2.0 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; dummy block
	begin_dummy_block 12
		spans	1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 13
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		12 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 14
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		12 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 15
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		13 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 16
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		14 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; general at the back
	begin_block 17
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 18
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		17 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 19
		spans	12 13 14 15 16 17 18
	end_dummy_block

	;; any behind
	begin_block 20
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		19 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 21
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		19 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 22
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		21 0.0 -20.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, behind cavalry wing
	begin_block 23
		not_general
		unit_type				elephants 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		19 -20.0 -5.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, behind cavalry wing
	begin_block 24
		not_general
		unit_type				elephants 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		14 0.0 -6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


begin_formation ai_standard_line_1_attack

	;;; purpose flags
	attack

	ai_priority				2.10

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, carthage, numidia, pontus, armenia, parthia, slave

	; Screen of missile inf
	begin_block 0
		max_units				4
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; First line of heavy infantry
	begin_block 1
		max_units				8
		unit_type				heavy infantry 0.9
		unit_type				heavy_pilum_infantry 0.1
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, schiltrom, square
		;unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 -7.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; second line of heavy infantry
	begin_block 2
		max_units				8
		unit_type				heavy_pilum_infantry 0.9
		unit_type				heavy infantry 0.1
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, schiltrom, square
		;unit_density			close
		block_formation			line
		block_relative_pos		1 0.0 -10.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; light infantry on the left outer flank
	begin_block 3
		unit_type				spearmen_pilum_infantry 1.0
		unit_type				light_pilum_infantry 0.9
		unit_type				light infantry 0.1
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -10.0 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; light infantry on the right outer flank
	begin_block 4
		unit_type				spearmen_pilum_infantry 1.0
		unit_type				light_pilum_infantry 0.9
		unit_type				light infantry 0.1
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 10.0 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; dummy block
	begin_dummy_block 5
		spans	0 1 2 3 4
	end_dummy_block

	;; 3rd line of infantry, guard of archers
	begin_block 6
		unit_type				non_phalanx_spear 1.0
		unit_type				heavy infantry 0.6
		unit_type				light infantry 0.2
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 0.0 -10.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; Archers behind
	begin_block 7
		max_units				10
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; left side excess missile troops
	begin_block 8
		max_units				4
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 -10.0 0.0
		inter_unit_spacing		2.0
		priority			0.3
	end_block

	;; right side excess missile troops
	begin_block 9
		max_units				4
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 10.0 0.0
		inter_unit_spacing		2.0
		priority			0.3
	end_block

	;; infantry reserve on both flanks of the missile troops

	;; left flank infantry reserve
	begin_block 10
		max_units				2
		unit_type				light infantry 1.0
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		;unit_density			close
		block_formation			line
		block_relative_pos		7 -2.0 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; right flank infantry reserve
	begin_block 11
		max_units				2
		unit_type				light infantry 1.0
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		;unit_density			close
		block_formation			line
		block_relative_pos		7 2.0 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; dummy block
	begin_dummy_block 12
		spans	1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 13
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		12 -20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 14
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		12 20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 15
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		13 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 16
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		14 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; general at the back
	begin_block 17
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 18
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		17 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 19
		spans	0 12 13 14 15 16 17 18
	end_dummy_block

	;; any behind
	begin_block 20
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		19 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 21
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		19 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 22
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		max_unit_width			30
		block_formation			line
		block_relative_pos		19 -30.0 20.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, infront of cavalry wing
	begin_block 23
		not_general
		unit_type				elephants 3.0
		default_melee_state		fire_at_will
		max_unit_width			40
		block_formation			line
		block_relative_pos		13 -5.0 6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, infront of cavalry wing
	begin_block 24
		not_general
		unit_type				elephants 3.0
		default_melee_state		fire_at_will
		max_unit_width			40
		block_formation			line
		block_relative_pos		14 5.0 6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


begin_formation ai_standard_line_1_pursue

	;;; purpose flags - charging, pursue
	pursue

	ai_priority				2.10

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, carthage, numidia, pontus, armenia, parthia, slave

	; Screen of missile inf
	begin_block 0
		max_units				4
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; First line of heavy infantry
	begin_block 1
		max_units				8
		unit_type				heavy infantry 0.9
		unit_type				heavy_pilum_infantry 0.1
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 -7.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; second line of heavy infantry
	begin_block 2
		max_units				8
		unit_type				heavy_pilum_infantry 0.9
		unit_type				heavy infantry 0.1
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close
		block_formation			line
		block_relative_pos		1 0.0 -10.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; light infantry on the left outer flank
	begin_block 3
		unit_type				spearmen_pilum_infantry 1.0
		unit_type				light_pilum_infantry 0.9
		unit_type				light infantry 0.1
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -10.0 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; light infantry on the right outer flank
	begin_block 4
		unit_type				spearmen_pilum_infantry 1.0
		unit_type				light_pilum_infantry 0.9
		unit_type				light infantry 0.1
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 10.0 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; dummy block
	begin_dummy_block 5
		spans	0 1 2 3 4
	end_dummy_block

	;; 3rd line of infantry, guard of archers
	begin_block 6
		unit_type				non_phalanx_spear 1.0
		unit_type				heavy infantry 0.6
		unit_type				light infantry 0.2
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 0.0 -10.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; Archers behind
	begin_block 7
		max_units				10
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; left side excess missile troops
	begin_block 8
		max_units				4
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 -10.0 0.0
		inter_unit_spacing		2.0
		priority			0.3
	end_block

	;; right side excess missile troops
	begin_block 9
		max_units				4
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 10.0 0.0
		inter_unit_spacing		2.0
		priority			0.3
	end_block

	;; infantry reserve on both flanks of the missile troops

	;; left flank infantry reserve
	begin_block 10
		max_units				2
		unit_type				light infantry 1.0
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close
		block_formation			line
		block_relative_pos		7 -2.0 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; right flank infantry reserve
	begin_block 11
		max_units				2
		unit_type				light infantry 1.0
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close
		block_formation			line
		block_relative_pos		7 2.0 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; dummy block
	begin_dummy_block 12
		spans	1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 13
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		12 -20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 14
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		12 20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 15
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		13 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 16
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		14 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; general at the back
	begin_block 17
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		12 0.0 -30.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 18
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		17 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 19
		spans	12 13 14 15 16 17 18
	end_dummy_block

	;; any behind
	begin_block 20
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		19 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 21
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 22
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		max_unit_width			30
		block_formation			line
		block_relative_pos		12 5.0 10.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, beside cavalry wing
	begin_block 23
		not_general
		unit_type				elephants 3.0
		default_melee_state		fire_at_will
		max_unit_width			40
		block_formation			line
		block_relative_pos		13 5.0 -6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, beside cavalry wing
	begin_block 24
		not_general
		unit_type				elephants 3.0
		default_melee_state		fire_at_will
		max_unit_width			40
		block_formation			line
		block_relative_pos		14 -5.0 -6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation


begin_formation ai_standard_line_1_approach

	;;; purpose flags - approaching
	defend
	attack

	ai_priority				2.10

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, carthage, numidia, pontus, armenia, parthia, slave

	; Screen of missile inf
	begin_block 0
		max_units				4
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; First line of heavy infantry
	begin_block 1
		max_units				8
		unit_type				heavy infantry 0.9
		unit_type				heavy_pilum_infantry 0.1
		;default_melee_state		fire_at_will
		;unit_formation			shield_wall, schiltrom, square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		0 0.0 -7.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; second line of heavy infantry
	begin_block 2
		max_units				8
		unit_type				heavy_pilum_infantry 0.9
		unit_type				heavy infantry 0.1
		;default_melee_state		fire_at_will
		;unit_formation			shield_wall, schiltrom, square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		1 0.0 -10.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; light infantry on the left outer flank
	begin_block 3
		unit_type				spearmen_pilum_infantry 1.0
		unit_type				light_pilum_infantry 0.9
		unit_type				light infantry 0.1
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -10.0 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; light infantry on the right outer flank
	begin_block 4
		unit_type				spearmen_pilum_infantry 1.0
		unit_type				light_pilum_infantry 0.9
		unit_type				light infantry 0.1
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 10.0 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; dummy block
	begin_dummy_block 5
		spans	0 1 2 3 4
	end_dummy_block

	;; 3rd line of infantry, guard of archers
	begin_block 6
		unit_type				non_phalanx_spear 1.0
		unit_type				heavy infantry 0.6
		unit_type				light infantry 0.2
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 0.0 -10.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; Archers behind
	begin_block 7
		max_units				10
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 0.0 -30.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; left side excess missile troops
	begin_block 8
		max_units				4
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 -10.0 0.0
		inter_unit_spacing		2.0
		priority			0.3
	end_block

	;; right side excess missile troops
	begin_block 9
		max_units				4
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 10.0 0.0
		inter_unit_spacing		2.0
		priority			0.3
	end_block

	;; infantry reserve on both flanks of the missile troops

	;; left flank infantry reserve
	begin_block 10
		max_units				2
		unit_type				light infantry 1.0
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		7 -2.0 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; right flank infantry reserve
	begin_block 11
		max_units				2
		unit_type				light infantry 1.0
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		7 2.0 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; dummy block
	begin_dummy_block 12
		spans	1 2 3 4 5 6 7 8 9 10 11
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 13
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		12 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 14
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		12 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 15
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		13 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 16
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		14 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; general at the back
	begin_block 17
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 18
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		17 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 19
		spans	0 12 13 14 15 16 17 18
	end_dummy_block

	;; any behind
	begin_block 20
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		19 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 21
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		19 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 22
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		12 -20.0 1.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; left flank elephants, infront of cavalry wing
	begin_block 23
		not_general
		unit_type				elephants 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		13 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank elephants, infront of cavalry wing
	begin_block 24
		not_general
		unit_type				elephants 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		14 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

end_formation



;****************************************************************
;****************************************************************
; Special missile formations section
;****************************************************************
;****************************************************************

;****************************************************************
; Caligula Caesars' Mauryan Elephants Attack Formation from Fortuna Orbis
; Modified by Suppanut to complete into full set of formations
;****************************************************************

begin_formation elephant_attack_1_march

	;;; purpose flags - regrouping
	march

	ai_priority				5.00

        supported_factions			parthia, seleucid

	;; screen of missile
	begin_block 0
		max_units				4
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; screen of skirmish cavalry - left (also place for raging bull and smaller elephants)
	begin_block 1
		max_units				3
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 2.0	;; (raging bull and smaller elephants here)
;;;		unit_type				chariots 2.0
		;default_melee_state		fire_at_will_and_skirmish
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 -24.0 1.0
		inter_unit_spacing		0.2
		priority			0.9
	end_block

	;; screen of skirmish cavalry - right (also place for raging bull and smaller elephants)
	begin_block 2
		max_units				3
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 2.0	;; (raging bull and smaller elephants here)
;;;		unit_type				chariots 2.0
		;default_melee_state		fire_at_will_and_skirmish
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 24.0 1.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; primary line of elephants and heavy chariots
	begin_block 3
		min_units				3
		max_units				7
		not_general
		unit_type				elephants 4.0
		unit_type				heavy_chariots 3.0
		;default_melee_state		fire_at_will
		max_unit_width			20
		block_formation			column
		block_relative_pos		0 0.0 40.0
		inter_unit_spacing		4.0
		priority			1.5
	end_block

	;; front heavy chariots line
	begin_block 4
		max_units				6
		not_general
		unit_type				heavy_chariots 4.0
		;default_melee_state		fire_at_will_and_skirmish
		max_unit_width			15
		block_formation			column
		block_relative_pos		3 0.0 10.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; Second line of elephants
	begin_block 5
		max_units				6
		not_general
		unit_type				elephants 3.0
		;default_melee_state		fire_at_will_and_skirmish
		max_unit_width			20
		block_formation			column
		block_relative_pos		0 0.0 30.0
		inter_unit_spacing		4.0
		priority			0.3
	end_block

	;; archer form the line (primary line of the formation)
	begin_block 6
		min_units				5
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -50.0
		inter_unit_spacing		2.0
		priority			1.5
	end_block

	;; second archer form the line
	begin_block 7
		max_units				3
		unit_type				ranged_missile_infantry 2.0
		;default_melee_state		defend
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 0.0 -10.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; light infantry protect archer's left flank
	begin_block 8
		max_units				1
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		;default_melee_state		defend
		;unit_formation			shield_wall, schiltrom, square
		max_unit_width			20
		block_formation			line
		block_relative_pos		6 -2.0 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; light infantry protect archer's right flank
	begin_block 9
		max_units				1
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		;default_melee_state		defend
		;unit_formation			shield_wall, schiltrom, square
		max_unit_width			20
		block_formation			line
		block_relative_pos		6 2.0 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; spearmen and other infantry line form single line protect main archer line
	;; phalanx line-up in the center
	begin_block 10
		max_units				7
		unit_type				phalanx 1.0
		;default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		6 0.0 20.0
		inter_unit_spacing		0.0
		priority			0.7
	end_block

	;; spearmen line - left
	begin_block 11
		max_units				5
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		10 -1.0 0.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; spearmen line - right
	begin_block 12
		max_units				5
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		10 1.0 0.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; heavy infantry protect spearmen's left flank
	begin_block 13
		max_units				4
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		;default_melee_state		defend
		;unit_formation			shield_wall, schiltrom, square
		max_unit_width			20
		block_formation			line
		block_relative_pos		11 -1.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; heavy infantry protect spearmen's right flank
	begin_block 14
		max_units				4
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		;default_melee_state		defend
		;unit_formation			shield_wall, schiltrom, square
		max_unit_width			20
		block_formation			line
		block_relative_pos		12 1.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; holymen and others
	begin_block 15
		unit_type				chanting_screeching 3.0
		;default_melee_state		defend
		;unit_formation			square
		max_unit_width			20
		block_formation			line
		block_relative_pos		7 0.0 -5.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	begin_dummy_block 16
		spans	6 7 8 9 10 11 12 13 14 15
	end_dummy_block

	;; general at the back
	begin_block 17
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		16 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 18
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		17 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry guards the general - left
	begin_block 19
		max_units				5
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.5
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			square
		block_relative_pos		17 -10.0 0.0
		inter_unit_spacing		4.0
		priority			0.3
	end_block

	;; cavalry guards the general - right
	begin_block 20
		max_units				5
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.5
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			square
		block_relative_pos		17 10.0 0.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; reserves heavy chariots and elephants - left
	begin_block 21
		min_units				1
		max_units				3
		not_general
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		;default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			column
		block_relative_pos		16 -20.0 1.0
		inter_unit_spacing		4.0
		priority			0.9
	end_block

	;; reserves heavy chariots and elephants - right
	begin_block 22
		min_units				1
		max_units				3
		not_general
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		;default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			column
		block_relative_pos		16 20.0 1.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	begin_dummy_block 23
		spans	6 7 8 9 10 11 12 13 14 15 16 17 18
	end_dummy_block

	;; artillery and handler behind
	begin_block 24
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			line
		block_relative_pos		23 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; any behind
	begin_block 25
		max_units				0
		unit_type				any 0.001
		unit_density			close
		block_formation			line
		block_relative_pos		23 0.0 -5.0
		inter_unit_spacing		1.0
		priority			0.01
	end_block

	;; missile cavalry - left
	begin_block 26
		max_units				2
		not_general
		unit_type				missile cavalry 0.9
		unit_type				skirmish cavalry 0.1
		;default_melee_state		fire_at_will_and_skirmish
		max_unit_width			20
		block_formation			column
		block_relative_pos		23 -10.0 0.0
		inter_unit_spacing		0.2
		priority			0.2
	end_block

	;; missile cavalry - right
	begin_block 27
		max_units				2
		not_general
		unit_type				missile cavalry 0.9
		unit_type				skirmish cavalry 0.1
		;default_melee_state		fire_at_will_and_skirmish
		max_unit_width			20
		block_formation			column
		block_relative_pos		23 10.0 0.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block

end_formation


begin_formation elephant_attack_1_deploy

	;;; purpose flags - deploy, defending
	defend

	ai_priority				5.00

        supported_factions			parthia, seleucid

	;; screen of missile
	begin_block 0
		max_units				4
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; screen of skirmish cavalry - left (also place for raging bull and smaller elephants)
	begin_block 1
		max_units				3
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 2.0	;; (raging bull and smaller elephants here)
;;;		unit_type				chariots 2.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 -20.0 1.0
		inter_unit_spacing		10.0
		priority			0.9
	end_block

	;; screen of skirmish cavalry - right (also place for raging bull and smaller elephants)
	begin_block 2
		max_units				3
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 2.0	;; (raging bull and smaller elephants here)
;;;		unit_type				chariots 2.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 20.0 1.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; primary line of elephants and heavy chariots
	begin_block 3
		min_units				3
		max_units				7
		not_general
		unit_type				elephants 4.0
		unit_type				heavy_chariots 3.0
		;default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 40.0
		inter_unit_spacing		4.0
		priority			1.5
	end_block

	;; front heavy chariots line
	begin_block 4
		max_units				6
		not_general
		unit_type				heavy_chariots 4.0
		;default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		3 0.0 10.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; Second line of elephants
	begin_block 5
		max_units				6
		not_general
		unit_type				elephants 3.0
		;default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 30.0
		inter_unit_spacing		4.0
		priority			0.3
	end_block

	;; archer form the line (primary line of the formation)
	begin_block 6
		min_units				5
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		default_melee_state		defend
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -50.0
		inter_unit_spacing		2.0
		priority			1.5
	end_block

	;; second archer form the line
	begin_block 7
		max_units				3
		unit_type				ranged_missile_infantry 2.0
		default_melee_state		defend
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 0.0 -5.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; light infantry protect archer's left flank
	begin_block 8
		max_units				1
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		default_melee_state		defend
		unit_formation			shield_wall, schiltrom, square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		6 -2.0 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; light infantry protect archer's right flank
	begin_block 9
		max_units				1
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		default_melee_state		defend
		unit_formation			shield_wall, schiltrom, square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		6 2.0 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; spearmen and other infantry line form single line protect main archer line
	;; phalanx line-up in the center
	begin_block 10
		max_units				7
		unit_type				phalanx 1.0
		default_melee_state		defend
		unit_formation			phalanx
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 0.0 20.0
		inter_unit_spacing		0.0
		priority			0.7
	end_block

	;; spearmen line - left
	begin_block 11
		max_units				5
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 -1.0 0.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; spearmen line - right
	begin_block 12
		max_units				5
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 1.0 0.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; heavy infantry protect spearmen's left flank
	begin_block 13
		max_units				4
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		default_melee_state		defend
		unit_formation			shield_wall, schiltrom, square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		11 -1.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; heavy infantry protect spearmen's right flank
	begin_block 14
		max_units				4
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		default_melee_state		defend
		unit_formation			shield_wall, schiltrom, square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		12 1.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; holymen and others
	begin_block 15
		unit_type				chanting_screeching 3.0
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		7 0.0 -5.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	begin_dummy_block 16
		spans	6 7 8 9 10 11 12 13 14 15
	end_dummy_block

	;; general at the back
	begin_block 17
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		16 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 18
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		17 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry guards the general - left
	begin_block 19
		max_units				5
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.5
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		16 -10.0 0.0
		inter_unit_spacing		4.0
		priority			0.3
	end_block

	;; cavalry guards the general - right
	begin_block 20
		max_units				5
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.5
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		16 10.0 0.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; reserves heavy chariots and elephants - left
	begin_block 21
		min_units				1
		max_units				3
		not_general
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		16 -20.0 -1.0
		inter_unit_spacing		4.0
		priority			0.9
	end_block

	;; reserves heavy chariots and elephants - right
	begin_block 22
		min_units				1
		max_units				3
		not_general
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		16 20.0 -1.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	begin_dummy_block 23
		spans	0 6 7 8 9 10 11 12 13 14 15 16 17 18
	end_dummy_block

	;; artillery and handler behind
	begin_block 24
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		23 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; any behind
	begin_block 25
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		23 0.0 -5.0
		inter_unit_spacing		1.0
		priority			0.01
	end_block

	;; missile cavalry - left
	begin_block 26
		max_units				2
		not_general
		unit_type				missile cavalry 0.9
		unit_type				skirmish cavalry 0.1
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		23 -10.0 -1.0
		inter_unit_spacing		10.0
		priority			0.2
	end_block

	;; missile cavalry - right
	begin_block 27
		max_units				2
		not_general
		unit_type				missile cavalry 0.9
		unit_type				skirmish cavalry 0.1
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		23 10.0 -1.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

end_formation


begin_formation elephant_attack_1_attack

	;;; purpose flags - attacking
	attack

	ai_priority				5.00

        supported_factions			parthia, seleucid

	;; screen of missile
	begin_block 0
		max_units				4
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; screen of skirmish cavalry - left (also place for raging bull and smaller elephants)
	begin_block 1
		max_units				3
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 2.0	;; (raging bull and smaller elephants here)
;;;		unit_type				chariots 2.0
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 -34.0 20.0
		inter_unit_spacing		10.0
		priority			0.9
	end_block

	;; screen of skirmish cavalry - right (also place for raging bull and smaller elephants)
	begin_block 2
		max_units				3
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 2.0	;; (raging bull and smaller elephants here)
;;;		unit_type				chariots 2.0
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 34.0 20.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; primary line of elephants and heavy chariots
	begin_block 3
		min_units				3
		max_units				7
		not_general
		unit_type				elephants 4.0
		unit_type				heavy_chariots 3.0
		;default_melee_state		fire_at_will
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 40.0
		inter_unit_spacing		4.0
		priority			1.5
	end_block

	;; front heavy chariots line
	begin_block 4
		max_units				6
		not_general
		unit_type				heavy_chariots 4.0
		;default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			line
		block_relative_pos		3 0.0 10.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; Second line of elephants
	begin_block 5
		max_units				6
		not_general
		unit_type				elephants 3.0
		;default_melee_state		fire_at_will_and_skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 30.0
		inter_unit_spacing		4.0
		priority			0.3
	end_block

	;; archer form the line (primary line of the formation)
	begin_block 6
		min_units				5
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.1
		default_melee_state		defend
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -50.0
		inter_unit_spacing		2.0
		priority			1.5
	end_block

	;; second archer form the line
	begin_block 7
		max_units				3
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.1
		default_melee_state		defend
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 0.0 -5.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; light infantry protect archer's left flank
	begin_block 8
		max_units				1
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		default_melee_state		defend
		;unit_formation			shield_wall, schiltrom, square
		block_formation			line
		block_relative_pos		6 -2.0 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; light infantry protect archer's right flank
	begin_block 9
		max_units				1
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		default_melee_state		defend
		;unit_formation			shield_wall, schiltrom, square
		block_formation			line
		block_relative_pos		6 2.0 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; spearmen and other infantry line form single line protect main archer line
	;; phalanx line-up in the center
	begin_block 10
		max_units				7
		unit_type				phalanx 1.0
		default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 0.0 20.0
		inter_unit_spacing		0.0
		priority			0.7
	end_block

	;; spearmen line - left
	begin_block 11
		max_units				5
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 -1.0 0.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; spearmen line - right
	begin_block 12
		max_units				5
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 1.0 0.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; heavy infantry protect spearmen's left flank
	begin_block 13
		max_units				4
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		default_melee_state		defend
		;unit_formation			shield_wall, schiltrom, square
		block_formation			line
		block_relative_pos		11 -1.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; heavy infantry protect spearmen's right flank
	begin_block 14
		max_units				4
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		default_melee_state		defend
		;unit_formation			shield_wall, schiltrom, square
		block_formation			line
		block_relative_pos		12 1.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; holymen and others
	begin_block 15
		unit_type				chanting_screeching 3.0
		;default_melee_state		defend
		;unit_formation			square
		block_formation			line
		block_relative_pos		7 0.0 -5.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	begin_dummy_block 16
		spans	6 7 8 9 10 11 12 13 14 15
	end_dummy_block

	;; general at the back
	begin_block 17
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		16 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 18
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		17 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry left to the main body
	begin_block 19
		max_units				5
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.5
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		16 -25.0 1.0
		inter_unit_spacing		4.0
		priority			0.3
	end_block

	;; cavalry right to the main body
	begin_block 20
		max_units				5
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.5
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		16 25.0 1.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; reserves heavy chariots and elephants - left
	begin_block 21
		min_units				1
		max_units				3
		not_general
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		max_unit_width			40
		block_formation			line
		block_relative_pos		16 -35.0 10.0
		inter_unit_spacing		4.0
		priority			0.9
	end_block

	;; reserves heavy chariots and elephants - right
	begin_block 22
		min_units				1
		max_units				3
		not_general
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		max_unit_width			40
		block_formation			line
		block_relative_pos		16 35.0 10.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	begin_dummy_block 23
		spans	6 7 8 9 10 11 12 13 14 15 16 17 18
	end_dummy_block

	;; artillery and handler behind
	begin_block 24
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		23 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; any behind
	begin_block 25
		max_units				0
		unit_type				any 0.001
		unit_density			close
		block_formation			line
		block_relative_pos		23 0.0 -5.0
		inter_unit_spacing		1.0
		priority			0.01
	end_block

	;; missile cavalry - left
	begin_block 26
		max_units				2
		not_general
		unit_type				missile cavalry 0.9
		unit_type				skirmish cavalry 0.1
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			column
		block_relative_pos		23 -10.0 1.0
		inter_unit_spacing		10.0
		priority			0.2
	end_block

	;; missile cavalry - right
	begin_block 27
		max_units				2
		not_general
		unit_type				missile cavalry 0.9
		unit_type				skirmish cavalry 0.1
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			column
		block_relative_pos		23 10.0 1.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

end_formation


begin_formation elephant_attack_1_pursue

	;;; purpose flags - charging, pursue
	pursue

	ai_priority				5.00

        supported_factions			parthia, seleucid

	;; screen of missile
	begin_block 0
		max_units				4
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; screen of skirmish cavalry - left (also place for raging bull and smaller elephants)
	begin_block 1
		max_units				3
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 2.0	;; (raging bull and smaller elephants here)
;;;		unit_type				chariots 2.0
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 -24.0 -10.0
		inter_unit_spacing		10.0
		priority			0.9
	end_block

	;; screen of skirmish cavalry - right (also place for raging bull and smaller elephants)
	begin_block 2
		max_units				3
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 2.0	;; (raging bull and smaller elephants here)
;;;		unit_type				chariots 2.0
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 24.0 -10.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; primary line of elephants and heavy chariots
	begin_block 3
		min_units				3
		max_units				7
		not_general
		unit_type				elephants 4.0
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 0.0 60.0
		inter_unit_spacing		4.0
		priority			1.5
	end_block

	;; front heavy chariots line
	begin_block 4
		max_units				6
		not_general
		unit_type				heavy_chariots 4.0
		;default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			line
		block_relative_pos		4 0.0 20.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; Second line of elephants
	begin_block 5
		max_units				6
		not_general
		unit_type				elephants 3.0
		;default_melee_state		fire_at_will_and_skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		5 0.0 50.0
		inter_unit_spacing		4.0
		priority			0.3
	end_block

	;; archer form the line (primary line of the formation)
	begin_block 6
		min_units				5
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -50.0
		inter_unit_spacing		2.0
		priority			1.5
	end_block

	;; second archer form the line
	begin_block 7
		max_units				3
		unit_type				ranged_missile_infantry 2.0
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 0.0 -5.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; light infantry protect archer's left flank
	begin_block 8
		max_units				1
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		;default_melee_state		defend
		unit_formation			shield_wall, square
		block_formation			line
		block_relative_pos		6 -2.0 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; light infantry protect archer's right flank
	begin_block 9
		max_units				1
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		;default_melee_state		defend
		unit_formation			shield_wall, square
		block_formation			line
		block_relative_pos		6 2.0 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; spearmen and other infantry line form single line protect main archer line
	;; phalanx line-up in the center
	begin_block 10
		max_units				7
		unit_type				phalanx 1.0
		default_melee_state		defend
		unit_formation			phalanx
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 0.0 30.0
		inter_unit_spacing		0.0
		priority			0.7
	end_block

	;; spearmen line - left
	begin_block 11
		max_units				5
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 -1.0 0.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; spearmen line - right
	begin_block 12
		max_units				5
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 1.0 0.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; heavy infantry protect spearmen's left flank
	begin_block 13
		max_units				4
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		default_melee_state		defend
		unit_formation			shield_wall, schiltrom, square
		block_formation			line
		block_relative_pos		11 -1.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; heavy infantry protect spearmen's right flank
	begin_block 14
		max_units				4
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		default_melee_state		defend
		unit_formation			shield_wall, schiltrom, square
		block_formation			line
		block_relative_pos		12 1.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; holymen and others
	begin_block 15
		unit_type				chanting_screeching 3.0
		;default_melee_state		defend
		;unit_formation			square
		block_formation			line
		block_relative_pos		7 0.0 -5.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	begin_dummy_block 16
		spans	6 7 8 9 10 11 12 13 14 15
	end_dummy_block

	;; general at the back
	begin_block 17
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		16 0.0 -30.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 18
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		17 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry left to the main body
	begin_block 19
		max_units				5
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.5
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		16 -30.0 20.0
		inter_unit_spacing		4.0
		priority			0.3
	end_block

	;; cavalry right to the main body
	begin_block 20
		max_units				5
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.5
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		16 20.0 20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; reserves heavy chariots and elephants - left
	begin_block 21
		min_units				1
		max_units				3
		not_general
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		max_unit_width			40
		block_formation			line
		block_relative_pos		16 -20.0 15.0
		inter_unit_spacing		4.0
		priority			0.9
	end_block

	;; reserves heavy chariots and elephants - right
	begin_block 22
		min_units				1
		max_units				3
		not_general
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		max_unit_width			40
		block_formation			line
		block_relative_pos		16 20.0 15.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	begin_dummy_block 23
		spans	6 7 8 9 10 11 12 13 14 15 16 17 18
	end_dummy_block

	;; artillery and handler behind
	begin_block 24
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		23 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; any behind
	begin_block 25
		max_units				0
		unit_type				any 0.001
		unit_density			close
		block_formation			line
		block_relative_pos		23 0.0 -5.0
		inter_unit_spacing		1.0
		priority			0.01
	end_block

	;; missile cavalry - left
	begin_block 26
		max_units				2
		not_general
		unit_type				missile cavalry 0.9
		unit_type				skirmish cavalry 0.1
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			column
		block_relative_pos		23 -15.0 0.0
		inter_unit_spacing		10.0
		priority			0.2
	end_block

	;; missile cavalry - right
	begin_block 27
		max_units				2
		not_general
		unit_type				missile cavalry 0.9
		unit_type				skirmish cavalry 0.1
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			column
		block_relative_pos		23 15.0 0.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

end_formation


begin_formation elephant_attack_1_approach

	;;; purpose flags - approaching
	attack
	defend

	ai_priority				5.00

        supported_factions			parthia, seleucid

	;; screen of missile
	begin_block 0
		max_units				4
		not_general
		unit_type				ranged_missile_infantry 2.0
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; screen of skirmish cavalry - left (also place for raging bull and smaller elephants)
	begin_block 1
		max_units				3
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 2.0	;; (raging bull and smaller elephants here)
;;;		unit_type				chariots 2.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 -24.0 1.0
		inter_unit_spacing		10.0
		priority			0.9
	end_block

	;; screen of skirmish cavalry - right (also place for raging bull and smaller elephants)
	begin_block 2
		max_units				3
		not_general
		unit_type				missile cavalry 0.5
		unit_type				skirmish cavalry 2.0	;; (raging bull and smaller elephants here)
;;;		unit_type				chariots 2.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 24.0 1.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; primary line of elephants and heavy chariots
	begin_block 3
		min_units				3
		max_units				7
		not_general
		unit_type				elephants 4.0
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 40.0
		inter_unit_spacing		4.0
		priority			1.5
	end_block

	;; front heavy chariots line
	begin_block 4
		max_units				6
		not_general
		unit_type				heavy_chariots 4.0
		;default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		3 0.0 10.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; Second line of elephants
	begin_block 5
		max_units				6
		not_general
		unit_type				elephants 3.0
		;default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 30.0
		inter_unit_spacing		4.0
		priority			0.3
	end_block

	;; archer form the line (primary line of the formation)
	begin_block 6
		min_units				5
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -50.0
		inter_unit_spacing		2.0
		priority			1.5
	end_block

	;; second archer form the line
	begin_block 7
		max_units				3
		unit_type				ranged_missile_infantry 2.0
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 0.0 -10.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; light infantry protect archer's left flank
	begin_block 8
		max_units				1
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		default_melee_state		defend
		;unit_formation			shield_wall, schiltrom, square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		6 -2.0 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; light infantry protect archer's right flank
	begin_block 9
		max_units				1
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		default_melee_state		defend
		;unit_formation			shield_wall, schiltrom, square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		6 2.0 0.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; spearmen and other infantry line form single line protect main archer line
	;; phalanx line-up in the center
	begin_block 10
		max_units				7
		unit_type				phalanx 1.0
		default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 0.0 20.0
		inter_unit_spacing		0.0
		priority			0.7
	end_block

	;; spearmen line - left
	begin_block 11
		max_units				5
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 -1.0 0.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; spearmen line - right
	begin_block 12
		max_units				5
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 1.0 0.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; heavy infantry protect spearmen's left flank
	begin_block 13
		max_units				4
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		default_melee_state		defend
		;unit_formation			shield_wall, schiltrom, square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		11 -1.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; heavy infantry protect spearmen's right flank
	begin_block 14
		max_units				4
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		default_melee_state		defend
		;unit_formation			shield_wall, schiltrom, square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		12 1.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; holymen and others
	begin_block 15
		unit_type				chanting_screeching 3.0
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		7 0.0 -5.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	begin_dummy_block 16
		spans	6 7 8 9 10 11 12 13 14 15
	end_dummy_block

	;; general at the back
	begin_block 17
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		16 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 18
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		17 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry guards the general - left
	begin_block 19
		max_units				5
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.5
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		16 -10.0 0.0
		inter_unit_spacing		4.0
		priority			0.3
	end_block

	;; cavalry guards the general - right
	begin_block 20
		max_units				5
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.5
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		16 10.0 0.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; reserves heavy chariots and elephants - left
	begin_block 21
		min_units				1
		max_units				3
		not_general
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		16 -20.0 1.0
		inter_unit_spacing		4.0
		priority			0.9
	end_block

	;; reserves heavy chariots and elephants - right
	begin_block 22
		min_units				1
		max_units				3
		not_general
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		16 20.0 1.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	begin_dummy_block 23
		spans	6 7 8 9 10 11 12 13 14 15 16 17 18
	end_dummy_block

	;; artillery and handler behind
	begin_block 24
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		23 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; any behind
	begin_block 25
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		23 0.0 -5.0
		inter_unit_spacing		1.0
		priority			0.01
	end_block

	;; missile cavalry - left
	begin_block 26
		max_units				2
		not_general
		unit_type				missile cavalry 0.9
		unit_type				skirmish cavalry 0.1
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		23 -10.0 0.0
		inter_unit_spacing		10.0
		priority			0.2
	end_block

	;; missile cavalry - right
	begin_block 27
		max_units				2
		not_general
		unit_type				missile cavalry 0.9
		unit_type				skirmish cavalry 0.1
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		23 10.0 0.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

end_formation



;****************************************************************
; Missile troops without infantry formation (created by Sinuhet)
;****************************************************************

begin_formation missile_and_cavalry_army_march

	;;; purpose flags - regrouping
	march

	ai_priority				3.30

	supported_factions			carthage, numidia, scythia, pontus, armenia, parthia

	;; first missile units group
	begin_block 0
		max_units				4
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.86
	end_block

	;; second missile units group
	begin_block 1
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.87
	end_block

	;; third missile units group
	begin_block 2
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		1 -2.0 -20.0
		inter_unit_spacing		2.0
		priority			0.88
	end_block

	begin_block 3
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		1 2.0 -20.0
		inter_unit_spacing		2.0
		priority			0.88
	end_block

	;; 4th missile units group
	begin_block 4
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		2 -2.0 -20.0
		inter_unit_spacing		2.0
		priority			0.89
	end_block

	begin_block 5
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		3 2.0 -20.0
		inter_unit_spacing		2.0
		priority			0.89
	end_block

	;; 5th missile units group
	begin_block 6
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		4 -2.0 -20.0
		inter_unit_spacing		2.0
		priority			0.9
	end_block

	begin_block 7
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		5 2.0 -20.0
		inter_unit_spacing		2.0
		priority			0.9
	end_block

	begin_dummy_block 8
		spans	0 1 2 3 4 5 6 7
	end_dummy_block

	; Screen of missile cavalry
	begin_block 9
		not_general
		unit_type				missile cavalry 0.7
		unit_type				skirmish cavalry 0.3
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		max_unit_width			15
		block_formation			line
		block_relative_pos		8 0.0 20.0
		inter_unit_spacing		0.2
		priority			0.7
	end_block

	;; spearmen line
	begin_block 10
		max_units				0
		unit_type				phalanx 0.70
		;default_melee_state		defend ; Mac phalanx
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		8 0.0 -20.0
		inter_unit_spacing		0.0
		priority			0.70
	end_block

	begin_block 11
		max_units				0
		unit_type				non_phalanx_spear 0.70
		;unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		10 -0.3 0.0
		inter_unit_spacing		0.1
		priority			0.70
	end_block

	begin_block 12
		max_units				0
		unit_type				non_phalanx_spear 0.70
		;unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		10 0.3 0.0
		inter_unit_spacing		0.1
		priority			0.70
	end_block

	;; missile troops behind the spearmen
	begin_block 13
		max_units				2
		unit_type				ranged_missile_infantry 2.0
		;default_melee_state		fire_at_will_and_defend
		max_unit_width			20
		block_formation			line
		block_relative_pos		10 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 14
		max_units				0
		unit_type				heavy infantry 0.70
		;default_melee_state		fire_at_will
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		11 -0.3 0.0
		inter_unit_spacing		0.3
		priority			0.70
	end_block

	;; right side
	begin_block 15
		max_units				0
		unit_type				heavy infantry 0.70
		;default_melee_state		fire_at_will
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		12 0.3 0.0
		inter_unit_spacing		0.3
		priority			0.70
	end_block

	;; left side
	begin_block 16
		max_units				0
		unit_type				light infantry 0.70
		;default_melee_state		fire_at_will
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		14 -0.3 0.0
		inter_unit_spacing		0.3
		priority			0.70
	end_block

	;; right side
	begin_block 17
		max_units				0
		unit_type				light infantry 0.70
		;default_melee_state		fire_at_will
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		15 0.3 0.0
		inter_unit_spacing		0.3
		priority			0.70
	end_block

	begin_dummy_block 18
		spans	8 10 11 12 13 14 15 16 17
	end_dummy_block

	;; general at the back
	begin_block 19
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		18 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 20
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		19 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry on the flanks

	;; left flank
	begin_block 21
		unit_type				heavy cavalry 0.5
		unit_type				light cavalry 0.5
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		19 -15.0 0.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 22
		unit_type				heavy cavalry 0.5
		unit_type				light cavalry 0.5
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		19 15.0 0.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	begin_dummy_block 23
		spans	8 13 18 19 20
	end_dummy_block

	;; artillery and handler behind
	begin_block 24
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			line
		block_relative_pos		23 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; back line of other units
	begin_block 25
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		23 0.0 -10.0
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation


begin_formation missile_and_cavalry_army_attack

	;;; purpose flags - attacking
	attack
	march

	ai_priority				3.30

	supported_factions			carthage, numidia, scythia, pontus, armenia, parthia

	;; first missile units group
	begin_block 0
		max_units				4
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		;unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.86
	end_block

	;; second missile units group
	begin_block 1
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		;unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.87
	end_block

	;; third missile units group
	begin_block 2
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		;unit_density			close
		max_unit_width			40
		block_formation			column
		block_relative_pos		1 -2.0 -20.0
		inter_unit_spacing		2.0
		priority			0.88
	end_block

	begin_block 3
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		;unit_density			close
		max_unit_width			40
		block_formation			column
		block_relative_pos		1 2.0 -20.0
		inter_unit_spacing		2.0
		priority			0.88
	end_block

	;; 4th missile units group
	begin_block 4
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		;unit_density			close
		max_unit_width			40
		block_formation			column
		block_relative_pos		2 -2.0 -20.0
		inter_unit_spacing		2.0
		priority			0.89
	end_block

	begin_block 5
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		;unit_density			close
		max_unit_width			40
		block_formation			column
		block_relative_pos		3 2.0 -20.0
		inter_unit_spacing		2.0
		priority			0.89
	end_block

	;; 5th missile units group
	begin_block 6
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		;unit_density			close
		max_unit_width			40
		block_formation			column
		block_relative_pos		4 -2.0 -20.0
		inter_unit_spacing		2.0
		priority			0.9
	end_block

	begin_block 7
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		;unit_density			close
		max_unit_width			40
		block_formation			column
		block_relative_pos		5 2.0 -20.0
		inter_unit_spacing		2.0
		priority			0.9
	end_block

	begin_dummy_block 8
		spans	0 1 2 3 4 5 6 7
	end_dummy_block

	; Screen of missile cavalry
	begin_block 9
		not_general
		unit_type				missile cavalry 0.7
		unit_type				skirmish cavalry 0.3
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			line
		block_relative_pos		8 0.0 20.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; spearmen line
	begin_block 10
		max_units				0
		unit_type				phalanx 0.70
		default_melee_state		defend ; Mac phalanx
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		8 0.0 -20.0
		inter_unit_spacing		0.0
		priority			0.70
	end_block

	begin_block 11
		max_units				0
		unit_type				non_phalanx_spear 0.70
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 -0.3 0.0
		inter_unit_spacing		0.1
		priority			0.70
	end_block

	begin_block 12
		max_units				0
		unit_type				non_phalanx_spear 0.70
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 0.3 0.0
		inter_unit_spacing		0.1
		priority			0.70
	end_block

	;; missile troops behind the spearmen
	begin_block 13
		max_units				2
		unit_type				ranged_missile_infantry 2.0
		default_melee_state		fire_at_will_and_defend
		max_unit_width			40
		block_formation			line
		block_relative_pos		10 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 14
		max_units				0
		unit_type				heavy infantry 0.70
		default_melee_state		fire_at_will
		;unit_density			close
		block_formation			line
		block_relative_pos		11 -0.3 0.0
		inter_unit_spacing		0.3
		priority			0.70
	end_block

	;; right side
	begin_block 15
		max_units				0
		unit_type				heavy infantry 0.70
		default_melee_state		fire_at_will
		;unit_density			close
		block_formation			line
		block_relative_pos		12 0.3 0.0
		inter_unit_spacing		0.3
		priority			0.70
	end_block

	;; left side
	begin_block 16
		max_units				0
		unit_type				light infantry 0.70
		default_melee_state		fire_at_will
		;unit_density			close
		block_formation			line
		block_relative_pos		14 -0.3 0.0
		inter_unit_spacing		0.3
		priority			0.70
	end_block

	;; right side
	begin_block 17
		max_units				0
		unit_type				light infantry 0.70
		default_melee_state		fire_at_will
		;unit_density			close
		block_formation			line
		block_relative_pos		15 0.3 0.0
		inter_unit_spacing		0.3
		priority			0.70
	end_block

	begin_dummy_block 18
		spans	8 10 11 12 13 14 15 16 17
	end_dummy_block

	;; general at the back
	begin_block 19
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		18 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 20
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		19 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry on the flanks

	;; left flank
	begin_block 21
		unit_type				heavy cavalry 0.5
		unit_type				light cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		19 -15.0 0.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 22
		unit_type				heavy cavalry 0.5
		unit_type				light cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		19 15.0 0.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	begin_dummy_block 23
		spans	8 13 18 19 20
	end_dummy_block

	;; artillery and handler behind
	begin_block 24
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		max_unit_width			24
		block_formation			line
		block_relative_pos		23 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; back line of other units
	begin_block 25
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		23 0.0 -10.0
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation


begin_formation missile_and_cavalry_army_pursue

	;;; purpose flags - charging, pursue
	pursue
	march

	ai_priority				3.30

	supported_factions			carthage, numidia, scythia, pontus, armenia, parthia

	;; first missile units group
	begin_block 0
		max_units				4
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		;unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.86
	end_block

	;; second missile units group
	begin_block 1
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		;unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.87
	end_block

	;; third missile units group
	begin_block 2
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		;unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 -2.0 -20.0
		inter_unit_spacing		2.0
		priority			0.88
	end_block

	begin_block 3
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		;unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 2.0 -20.0
		inter_unit_spacing		2.0
		priority			0.88
	end_block

	;; 4th missile units group
	begin_block 4
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		;unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		2 -2.0 -20.0
		inter_unit_spacing		2.0
		priority			0.89
	end_block

	begin_block 5
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		;unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 2.0 -20.0
		inter_unit_spacing		2.0
		priority			0.89
	end_block

	;; 5th missile units group
	begin_block 6
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		;unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 -2.0 -20.0
		inter_unit_spacing		2.0
		priority			0.9
	end_block

	begin_block 7
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		;unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 2.0 -20.0
		inter_unit_spacing		2.0
		priority			0.9
	end_block

	begin_dummy_block 8
		spans	0 1 2 3 4 5 6 7
	end_dummy_block

	; Screen of missile cavalry
	begin_block 9
		not_general
		unit_type				missile cavalry 0.7
		unit_type				skirmish cavalry 0.3
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			line
		block_relative_pos		8 0.0 20.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; spearmen line
	begin_block 10
		max_units				0
		unit_type				phalanx 0.70
		default_melee_state		defend ; Mac phalanx
		unit_formation			phalanx
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		8 0.0 -20.0
		inter_unit_spacing		0.0
		priority			0.70
	end_block

	begin_block 11
		max_units				0
		unit_type				non_phalanx_spear 0.70
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 -0.3 0.0
		inter_unit_spacing		0.1
		priority			0.70
	end_block

	begin_block 12
		max_units				0
		unit_type				non_phalanx_spear 0.70
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 0.3 0.0
		inter_unit_spacing		0.1
		priority			0.70
	end_block

	;; missile troops behind the spearmen
	begin_block 13
		max_units				2
		unit_type				ranged_missile_infantry 2.0
		default_melee_state		fire_at_will_and_defend
		max_unit_width			40
		block_formation			line
		block_relative_pos		10 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 14
		max_units				0
		unit_type				heavy infantry 0.70
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		;unit_density			close
		block_formation			line
		block_relative_pos		11 -0.3 0.0
		inter_unit_spacing		0.3
		priority			0.70
	end_block

	;; right side
	begin_block 15
		max_units				0
		unit_type				heavy infantry 0.70
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		;unit_density			close
		block_formation			line
		block_relative_pos		12 0.3 0.0
		inter_unit_spacing		0.3
		priority			0.70
	end_block

	;; left side
	begin_block 16
		max_units				0
		unit_type				light infantry 0.70
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		;unit_density			close
		block_formation			line
		block_relative_pos		14 -0.3 0.0
		inter_unit_spacing		0.3
		priority			0.70
	end_block

	;; right side
	begin_block 17
		max_units				0
		unit_type				light infantry 0.70
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		;unit_density			close
		block_formation			line
		block_relative_pos		15 0.3 0.0
		inter_unit_spacing		0.3
		priority			0.70
	end_block

	begin_dummy_block 18
		spans	8 10 11 12 13 14 15 16 17
	end_dummy_block

	;; general at the back
	begin_block 19
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		18 0.0 -30.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 20
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		19 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry on the flanks

	;; left flank
	begin_block 21
		unit_type				heavy cavalry 0.5
		unit_type				light cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		19 -15.0 0.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 22
		unit_type				heavy cavalry 0.5
		unit_type				light cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		19 15.0 0.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	begin_dummy_block 23
		spans	8 13 18 19 20
	end_dummy_block

	;; artillery and handler behind
	begin_block 24
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		max_unit_width			24
		block_formation			line
		block_relative_pos		23 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; back line of other units
	begin_block 25
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		23 0.0 -10.0
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation


begin_formation missile_and_cavalry_army_approach

	;;; purpose flags - deploy, approaching
	defend
	attack

	ai_priority				3.30

	supported_factions			carthage, numidia, scythia, pontus, armenia, parthia

	;; first missile units group
	begin_block 0
		max_units				4
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.86
	end_block

	;; second missile units group
	begin_block 1
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		2.0
		priority			0.87
	end_block

	;; third missile units group
	begin_block 2
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		1 -2.0 -10.0
		inter_unit_spacing		2.0
		priority			0.88
	end_block

	begin_block 3
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		1 2.0 -10.0
		inter_unit_spacing		2.0
		priority			0.88
	end_block

	;; 4th missile units group
	begin_block 4
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		2 -2.0 -10.0
		inter_unit_spacing		2.0
		priority			0.89
	end_block

	begin_block 5
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		3 2.0 -10.0
		inter_unit_spacing		2.0
		priority			0.89
	end_block

	;; 5th missile units group
	begin_block 6
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		4 -2.0 -10.0
		inter_unit_spacing		2.0
		priority			0.9
	end_block

	begin_block 7
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		5 2.0 -10.0
		inter_unit_spacing		2.0
		priority			0.9
	end_block

	begin_dummy_block 8
		spans	0 1 2 3 4 5 6 7
	end_dummy_block

	; Screen of missile cavalry
	begin_block 9
		not_general
		unit_type				missile cavalry 0.7
		unit_type				skirmish cavalry 0.3
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		8 0.0 10.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; spearmen line
	begin_block 10
		max_units				0
		unit_type				phalanx 0.70
		default_melee_state		defend ; Mac phalanx
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		8 0.0 -20.0
		inter_unit_spacing		0.0
		priority			0.70
	end_block

	begin_block 11
		max_units				0
		unit_type				non_phalanx_spear 0.70
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 -0.3 0.0
		inter_unit_spacing		0.1
		priority			0.70
	end_block

	begin_block 12
		max_units				0
		unit_type				non_phalanx_spear 0.70
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 0.3 0.0
		inter_unit_spacing		0.1
		priority			0.70
	end_block

	;; missile troops behind the spearmen
	begin_block 13
		max_units				2
		unit_type				ranged_missile_infantry 2.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		10 0.0 -30.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 14
		max_units				0
		unit_type				heavy infantry 0.70
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		11 -0.3 0.0
		inter_unit_spacing		0.3
		priority			0.70
	end_block

	;; right side
	begin_block 15
		max_units				0
		unit_type				heavy infantry 0.70
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		12 0.3 0.0
		inter_unit_spacing		0.3
		priority			0.70
	end_block

	;; left side
	begin_block 16
		max_units				0
		unit_type				light infantry 0.70
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		14 -0.3 0.0
		inter_unit_spacing		0.3
		priority			0.70
	end_block

	;; right side
	begin_block 17
		max_units				0
		unit_type				light infantry 0.70
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		15 0.3 0.0
		inter_unit_spacing		0.3
		priority			0.70
	end_block

	begin_dummy_block 18
		spans	8 10 11 12 13 14 15 16 17
	end_dummy_block

	;; general at the back
	begin_block 19
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		18 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 20
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		19 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry on the flanks

	;; left flank
	begin_block 21
		unit_type				heavy cavalry 0.5
		unit_type				light cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		19 -15.0 0.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 22
		unit_type				heavy cavalry 0.5
		unit_type				light cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		19 15.0 0.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	begin_dummy_block 23
		spans	8 13 18 19 20
	end_dummy_block

	;; artillery and handler behind
	begin_block 24
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		23 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; back line of other units
	begin_block 25
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		23 0.0 -10.0
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation



;****************************************************************
; Missile troops army defensive formation (created by Sinuhet)
;****************************************************************

begin_formation missile_defend_1_march

	;;; purpose flags - regrouping
	march

	ai_priority				3.20


	; Screen of missile cavalry
	begin_block 0
		not_general
		unit_type				missile cavalry 0.7
		unit_type				skirmish cavalry 0.3
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.2
		priority			0.7
	end_block

	;; first missile units group
	begin_block 1
		min_units				2
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.86
	end_block

	;; second missile units group
	begin_block 2
		min_units				3
		max_units				3
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.87
	end_block

	;; third missile units group
	begin_block 3
		min_units				2
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		2 -2.0 -20.0
		inter_unit_spacing		2.0
		priority			0.88
	end_block

	begin_block 4
		min_units				2
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		2 2.0 -20.0
		inter_unit_spacing		2.0
		priority			0.88
	end_block

	;; 4th missile units group
	begin_block 5
		min_units				1
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		3 -2.0 -20.0
		inter_unit_spacing		2.0
		priority			0.89
	end_block

	begin_block 6
		min_units				1
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		4 2.0 -20.0
		inter_unit_spacing		2.0
		priority			0.89
	end_block

	;; 5th missile units group
	begin_block 7
		min_units				1
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		5 -2.0 -20.0
		inter_unit_spacing		2.0
		priority			0.9
	end_block

	begin_block 8
		min_units				1
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		6 2.0 -20.0
		inter_unit_spacing		2.0
		priority			0.9
	end_block

	begin_dummy_block 9
		spans	1 2 3 4 5 6 7 8
	end_dummy_block

	;; spearmen line
	begin_block 10
		unit_type				phalanx 0.70
		;default_melee_state		defend	; Mac phalanx
		;unit_formation			phalanx
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		9 0.0 -20.0
		inter_unit_spacing		0.0
		priority			0.70
	end_block

	begin_block 11
		unit_type				non_phalanx_spear 0.70
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		10 -0.3 0.0
		inter_unit_spacing		0.1
		priority			0.70
	end_block

	begin_block 12
		unit_type				non_phalanx_spear 0.70
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		10 0.3 0.0
		inter_unit_spacing		0.1
		priority			0.70
	end_block

	;; missile troops behind the spearmen
	begin_block 13
		min_units				2
		max_units				4
		unit_type				ranged_missile_infantry 2.0
		;default_melee_state		fire_at_will_and_defend
		max_unit_width			20
		block_formation			line
		block_relative_pos		10 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 14
		unit_type				heavy infantry 0.70
		;default_melee_state		fire_at_will
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		11 -0.3 0.0
		inter_unit_spacing		0.3
		priority			0.70
	end_block

	;; right side
	begin_block 15
		unit_type				heavy infantry 0.70
		;default_melee_state		fire_at_will
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		12 0.3 0.0
		inter_unit_spacing		0.3
		priority			0.70
	end_block

	;; left side
	begin_block 16
		unit_type				light infantry 0.70
		;default_melee_state		fire_at_will
		;unit_density			close
		block_formation			line
		block_relative_pos		14 -0.3 0.0
		inter_unit_spacing		0.3
		priority			0.70
	end_block

	;; right side
	begin_block 17
		unit_type				light infantry 0.70
		;default_melee_state		fire_at_will
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		15 0.3 0.0
		inter_unit_spacing		0.3
		priority			0.70
	end_block

	begin_dummy_block 18
		spans	9 10 11 12 13 14 15 16 17
	end_dummy_block

	;; general at the back
	begin_block 19
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		18 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 20
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		19 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry on the flanks

	;; left flank
	begin_block 21
		unit_type				heavy cavalry 0.5
		unit_type				light cavalry 0.5
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		19 -15.0 0.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 22
		unit_type				heavy cavalry 0.5
		unit_type				light cavalry 0.5
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		19 15.0 0.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	begin_dummy_block 23
		spans	9 13 18 19 20
	end_dummy_block

	;; artillery and handler behind
	begin_block 24
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			line
		block_relative_pos		23 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; back line of other units
	begin_block 25
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		23 0.0 -10.0
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation


begin_formation missile_defend_1_deploy

	;;; purpose flags - deploy, defending
	defend
	march

	ai_priority				3.20


	; Screen of missile cavalry
	begin_block 0
		not_general
		unit_type				missile cavalry 0.7
		unit_type				skirmish cavalry 0.3
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; first missile units group
	begin_block 1
		min_units				2
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		2.0
		priority			0.86
	end_block

	;; second missile units group
	begin_block 2
		min_units				3
		max_units				3
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -10.0
		inter_unit_spacing		2.0
		priority			0.87
	end_block

	;; third missile units group
	begin_block 3
		min_units				2
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		2 -2.0 -10.0
		inter_unit_spacing		2.0
		priority			0.88
	end_block

	begin_block 4
		min_units				2
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		2 2.0 -10.0
		inter_unit_spacing		2.0
		priority			0.88
	end_block

	;; 4th missile units group
	begin_block 5
		min_units				1
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		3 -2.0 -10.0
		inter_unit_spacing		2.0
		priority			0.89
	end_block

	begin_block 6
		min_units				1
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		4 2.0 -10.0
		inter_unit_spacing		2.0
		priority			0.89
	end_block

	;; 5th missile units group
	begin_block 7
		min_units				1
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		5 -2.0 -10.0
		inter_unit_spacing		2.0
		priority			0.9
	end_block

	begin_block 8
		min_units				1
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		6 2.0 -10.0
		inter_unit_spacing		2.0
		priority			0.9
	end_block

	begin_dummy_block 9
		spans	1 2 3 4 5 6 7 8
	end_dummy_block

	;; spearmen line
	begin_block 10
		unit_type				phalanx 0.70
		default_melee_state		defend	; Mac phalanx
		unit_formation			phalanx
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 0.0 -20.0
		inter_unit_spacing		0.0
		priority			0.70
	end_block

	begin_block 11
		unit_type				non_phalanx_spear 0.70
		;default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 -0.3 0.0
		inter_unit_spacing		0.1
		priority			0.70
	end_block

	begin_block 12
		unit_type				non_phalanx_spear 0.70
		;default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 0.3 0.0
		inter_unit_spacing		0.1
		priority			0.70
	end_block

	;; missile troops behind the spearmen
	begin_block 13
		min_units				2
		max_units				4
		unit_type				ranged_missile_infantry 2.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		10 0.0 -30.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 14
		unit_type				heavy infantry 0.70
		;default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		11 -0.3 0.0
		inter_unit_spacing		0.3
		priority			0.70
	end_block

	;; right side
	begin_block 15
		unit_type				heavy infantry 0.70
		;default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		12 0.3 0.0
		inter_unit_spacing		0.3
		priority			0.70
	end_block

	;; left side
	begin_block 16
		unit_type				light infantry 0.70
		;default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		14 -0.3 0.0
		inter_unit_spacing		0.3
		priority			0.70
	end_block

	;; right side
	begin_block 17
		unit_type				light infantry 0.70
		;default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		15 0.3 0.0
		inter_unit_spacing		0.3
		priority			0.70
	end_block

	begin_dummy_block 18
		spans	9 10 11 12 13 14 15 16 17
	end_dummy_block

	;; general at the back
	begin_block 19
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		18 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 20
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		19 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry on the flanks

	;; left flank
	begin_block 21
		unit_type				heavy cavalry 0.5
		unit_type				light cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		19 -15.0 0.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 22
		unit_type				heavy cavalry 0.5
		unit_type				light cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		19 15.0 0.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	begin_dummy_block 23
		spans	9 13 18 19 20
	end_dummy_block

	;; artillery and handler behind
	begin_block 24
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		23 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; back line of other units
	begin_block 25
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		23 0.0 -10.0
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation


;****************************************************************
; Missile troops army attack formation (created by Sinuhet)
;****************************************************************

begin_formation missile_attack_1_attack

	;;; purpose flags - attacking
	attack
	march

	ai_priority				3.20


	; Screen of missile cavalry
	begin_block 0
		not_general
		unit_type				missile cavalry 0.7
		unit_type				skirmish cavalry 0.3
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; first missile units group
	begin_block 1
		min_units				2
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 -75.0 -20.0
		inter_unit_spacing		2.0
		priority			0.9
	end_block

	begin_block 2
		min_units				2
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 75.0 -20.0
		inter_unit_spacing		2.0
		priority			0.9
	end_block

	;; second missile units group
	begin_block 3
		min_units				1
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -10.0
		inter_unit_spacing		2.0
		priority			0.89
	end_block

	begin_block 4
		min_units				1
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		2 0.0 -10.0
		inter_unit_spacing		2.0
		priority			0.89
	end_block

	;; third missile units group
	begin_block 5
		min_units				1
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.88
	end_block

	begin_block 6
		min_units				1
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.88
	end_block

	;; 4th missile units group
	begin_block 7
		min_units				2
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -80.0
		inter_unit_spacing		2.0
		priority			0.86
	end_block

	;; 5th missile units group
	begin_block 8
		min_units				3
		max_units				3
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		7 0.0 -10.0
		inter_unit_spacing		2.0
		priority			0.87
	end_block

	begin_dummy_block 9
		spans	1 2 3 4 5 6 7 8
	end_dummy_block

	;; spearmen line
	begin_block 10
		unit_type				phalanx 0.70
		default_melee_state		defend	; Mac phalanx
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 0.0 -20.0
		inter_unit_spacing		0.0
		priority			0.70
	end_block

	begin_block 11
		unit_type				non_phalanx_spear 0.70
		;default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 -0.3 0.0
		inter_unit_spacing		0.1
		priority			0.70
	end_block

	begin_block 12
		unit_type				non_phalanx_spear 0.70
		;default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 0.3 0.0
		inter_unit_spacing		0.1
		priority			0.70
	end_block

	;; missile troops behind the spearmen
	begin_block 13
		min_units				2
		unit_type				ranged_missile_infantry 2.0
		default_melee_state		fire_at_will_and_defend
		max_unit_width			40
		block_formation			line
		block_relative_pos		10 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 14
		unit_type				heavy infantry 0.70
		default_melee_state		fire_at_will
		;unit_density			close
		block_formation			line
		block_relative_pos		11 -0.3 0.0
		inter_unit_spacing		0.3
		priority			0.70
	end_block

	;; right side
	begin_block 15
		unit_type				heavy infantry 0.70
		default_melee_state		fire_at_will
		;unit_density			close
		block_formation			line
		block_relative_pos		12 0.3 0.0
		inter_unit_spacing		0.3
		priority			0.70
	end_block

	;; left side
	begin_block 16
		unit_type				light infantry 0.70
		default_melee_state		fire_at_will
		;unit_density			close
		block_formation			line
		block_relative_pos		14 -0.3 0.0
		inter_unit_spacing		0.3
		priority			0.70
	end_block

	;; right side
	begin_block 17
		unit_type				light infantry 0.70
		default_melee_state		fire_at_will
		;unit_density			close
		block_formation			line
		block_relative_pos		15 0.3 0.0
		inter_unit_spacing		0.3
		priority			0.70
	end_block

	begin_dummy_block 18
		spans	9 10 11 12 13 14 15 16 17
	end_dummy_block

	;; general at the back
	begin_block 19
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		18 0.0 -40.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 20
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		19 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry on the flanks

	;; left flank
	begin_block 21
		unit_type				heavy cavalry 0.5
		unit_type				light cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		19 -15.0 0.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 22
		unit_type				heavy cavalry 0.5
		unit_type				light cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		19 15.0 0.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	begin_dummy_block 23
		spans	9 13 18 19 20
	end_dummy_block

	;; artillery and handler behind
	begin_block 24
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		23 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; back line of other units
	begin_block 25
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		23 0.0 -10.0
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation


begin_formation missile_pursue_1_pursue

	;;; purpose flags - charging, pursue
	pursue
	march

	ai_priority				3.20


	; Screen of missile cavalry
	begin_block 0
		not_general
		unit_type				missile cavalry 0.7
		unit_type				skirmish cavalry 0.3
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	;; first missile units group
	begin_block 1
		min_units				2
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 -75.0 -20.0
		inter_unit_spacing		2.0
		priority			0.9
	end_block

	begin_block 2
		min_units				2
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 75.0 -20.0
		inter_unit_spacing		2.0
		priority			0.9
	end_block

	;; second missile units group
	begin_block 3
		min_units				1
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -10.0
		inter_unit_spacing		2.0
		priority			0.89
	end_block

	begin_block 4
		min_units				1
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		2 0.0 -10.0
		inter_unit_spacing		2.0
		priority			0.89
	end_block

	;; third missile units group
	begin_block 5
		min_units				1
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.88
	end_block

	begin_block 6
		min_units				1
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.88
	end_block

	;; 4th missile units group
	begin_block 7
		min_units				2
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -80.0
		inter_unit_spacing		2.0
		priority			0.86
	end_block

	;; 5th missile units group
	begin_block 8
		min_units				3
		max_units				3
		unit_type				skirmish infantry 1.0
		unit_type				chanting_screeching 3.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		7 0.0 -10.0
		inter_unit_spacing		2.0
		priority			0.87
	end_block

	begin_dummy_block 9
		spans	1 2 3 4 5 6 7 8
	end_dummy_block

	;; spearmen line
	begin_block 10
		unit_type				phalanx 0.70
		default_melee_state		defend	; Mac phalanx
		unit_formation			phalanx
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 0.0 -20.0
		inter_unit_spacing		0.0
		priority			0.70
	end_block

	begin_block 11
		unit_type				non_phalanx_spear 0.70
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 -0.3 0.0
		inter_unit_spacing		0.1
		priority			0.70
	end_block

	begin_block 12
		unit_type				non_phalanx_spear 0.70
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 0.3 0.0
		inter_unit_spacing		0.1
		priority			0.70
	end_block

	;; missile troops behind the spearmen
	begin_block 13
		min_units				2
		unit_type				ranged_missile_infantry 2.0
		default_melee_state		fire_at_will_and_defend
		max_unit_width			40
		block_formation			line
		block_relative_pos		10 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 14
		unit_type				heavy infantry 0.70
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		;unit_density			close
		block_formation			line
		block_relative_pos		11 -0.3 0.0
		inter_unit_spacing		0.3
		priority			0.70
	end_block

	;; right side
	begin_block 15
		unit_type				heavy infantry 0.70
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		;unit_density			close
		block_formation			line
		block_relative_pos		12 0.3 0.0
		inter_unit_spacing		0.3
		priority			0.70
	end_block

	;; left side
	begin_block 16
		unit_type				light infantry 0.70
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		;unit_density			close
		block_formation			line
		block_relative_pos		14 -0.3 0.0
		inter_unit_spacing		0.3
		priority			0.70
	end_block

	;; right side
	begin_block 17
		unit_type				light infantry 0.70
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		;unit_density			close
		block_formation			line
		block_relative_pos		15 0.3 0.0
		inter_unit_spacing		0.3
		priority			0.70
	end_block

	begin_dummy_block 18
		spans	9 10 11 12 13 14 15 16 17
	end_dummy_block

	;; general at the back
	begin_block 19
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		18 0.0 -50.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 20
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		19 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry on the flanks

	;; left flank
	begin_block 21
		unit_type				heavy cavalry 0.5
		unit_type				light cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		19 -15.0 0.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 22
		unit_type				heavy cavalry 0.5
		unit_type				light cavalry 0.5
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		19 15.0 0.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	begin_dummy_block 23
		spans	9 13 18 19 20
	end_dummy_block

	;; artillery and handler behind
	begin_block 24
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		23 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; back line of other units
	begin_block 25
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		23 0.0 -10.0
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation



;****************************************************************
;****************************************************************
; Cavalry with Infantry support formations section
;****************************************************************
;****************************************************************

;****************************************************************
; Pax Barbaricia's new formation (D.). Cavalry wedge in front of infantry component
; modified by Suppanut to have basic restrict structure of Sinuhet's
; Mixed Cavalry and Infantry armies formations
;****************************************************************

begin_formation ai_pax_barbaricia_heavy_cavalry_attack

	;;; purpose flags
	attack
	pursue
	march

	ai_priority				4.00

	supported_factions			armenia, parthia, pontus, scythia

	;;; main line of the heavy cavalry
	begin_block 0
		min_units				2
		max_units				2
		unit_type				elephants 3.0
		unit_type				heavy cavalry 1.0
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;;; front wedge - the heavy cavalry
	begin_block 1
		min_units				1
		max_units				1
		unit_type				elephants 3.5
		unit_type				heavy cavalry 0.9
		unit_formation			wedge, square
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 5.0
		inter_unit_spacing		2.0
		priority			0.9
	end_block

	;;; second line of the heavy cavalry
	begin_block 2
		min_units				3
		max_units				3
		unit_type				elephants 2.5
		unit_type				heavy cavalry 1.0
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 -3.0
		inter_unit_spacing		2.0
		priority			0.7
	end_block

	;;; third line of the heavy cavalry
	begin_block 3
		max_units				4
		unit_type				elephants 2.0
		unit_type				heavy cavalry 1.0
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		2 0.0 -3.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;;; forth line of the heavy cavalry
	begin_block 4
		max_units				5
		unit_type				elephants 1.5
		unit_type				heavy cavalry 1.0
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		3 0.0 -3.0
		inter_unit_spacing		2.0
		priority			0.3
	end_block

	;;; fifth line of the heavy cavalry
	begin_block 5
		max_units				5
		unit_type				elephants 1.5
		unit_type				heavy cavalry 1.0
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		4 0.0 -3.0
		inter_unit_spacing		2.0
		priority			0.1
	end_block

	begin_dummy_block 6
		spans	0 1 2 3 4 5
	end_dummy_block

	;; left_flank missile cav
	begin_block 7
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			loose
		max_unit_width			30
		block_formation			column
		block_relative_pos		6 -10.0 30.0
		inter_unit_spacing		10.0
		priority			0.9
	end_block

	;; right flank missile cav
	begin_block 8
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			loose
		max_unit_width			30
		block_formation			column
		block_relative_pos		6 10.0 30.0
		inter_unit_spacing		10.0
		priority			0.9
	end_block

	;; spearmen line
	begin_block 9
		max_units				2
		unit_type				phalanx 1.0
		default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 0.0 -20.0
		inter_unit_spacing		0.0
		priority			0.90
	end_block

	begin_block 10
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 0.0 -5.0
		inter_unit_spacing		0.1
		priority			0.90
	end_block

	;; heavy and other infantry

	;; left of infantry centre
	begin_block 11
		max_units				3
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		unit_density			close
		block_formation			line
		block_relative_pos		9 -5.0 0.0
		inter_unit_spacing		0.1
		priority			0.9
	end_block

	;; right of infantry centre
	begin_block 12
		max_units				3
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		unit_density			close
		block_formation			line
		block_relative_pos		9 5.0 0.0
		inter_unit_spacing		0.1
		priority			0.9
	end_block

	;; missile troops behind the spearmen and other infantry
	begin_block 13
		max_units				6
		unit_type				chanting_screeching 3.0
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.8
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		10 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	begin_block 14
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.2
		unit_type				skirmish infantry 0.1
		default_melee_state		fire_at_will_and_defend
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		13 0.0 -5.0
		inter_unit_spacing		1.0
		priority			1.0
	end_block

	begin_dummy_block 15
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13 14
	end_dummy_block

	;; general at the back
	begin_block 16
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		15 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 17
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		16 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; left flank light cav
	begin_block 18
		unit_type				light cavalry 1.0
		block_formation			square
		block_relative_pos		15 -10.0 -5.0
		inter_unit_spacing		3.0
		priority			0.7
	end_block

	;; right flank light cav
	begin_block 19
		unit_type				light cavalry 1.0
		block_formation			square
		block_relative_pos		15 10.0 -5.0
		inter_unit_spacing		3.0
		priority			0.7
	end_block

	begin_dummy_block 20
		spans	15 16 17 18 19
	end_dummy_block

	;; artillery and handler behind
	begin_block 21
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		20 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 22
		max_units				0
		not_general
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		20 0.0 -10.0
		inter_unit_spacing		0.3
		priority			1.0
	end_block

	begin_block 23
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		15 -30.0 -20.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

end_formation



;*******************************************************************************
; Formation for chariots and mixed missile cavalry armies - created by Sinuhet
;*******************************************************************************

begin_formation ai_chariots_march

	;;; purpose flags - regrouping
	march

	ai_priority				3.95

	supported_factions			gauls, galatians,, britons, egypt, seleucid, carthage, pontus, numidia, slave

	; screen
	begin_block 0
		min_units				3
		;max_units				3
		not_general
		unit_type				heavy_chariots 3.0
		;default_melee_state		fire_at_will
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; light cav on either wing

	;; left side
	begin_block 1
		max_units				2
		not_general
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		;default_melee_state		fire_at_will
		max_unit_width			20
		block_formation			column
		block_relative_pos		0 -5.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

	;; right side
	begin_block 2
		max_units				2
		not_general
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		;default_melee_state		fire_at_will
		max_unit_width			20
		block_formation			column
		block_relative_pos		0 5.0 -5.0
		inter_unit_spacing		3.0
		priority			0.6
	end_block

	;; Light cav reserves for either wing
	;; left side
	begin_block 3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		0 -20.0 -20.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;; right side
	begin_block 4
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		0 20.0 -20.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;; cav behind centre
	begin_block 5
		unit_type				heavy cavalry 0.7
		unit_type				light cavalry 0.7
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		3 -5.0 0.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 6
		unit_type				heavy cavalry 0.7
		unit_type				light cavalry 0.7
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		4 5.0 0.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; Cavalry centre
	begin_block 7
		min_units				1
		max_units				6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.8
		unit_type				heavy_chariots 0.01
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; spearmen line
	begin_block 8
		max_units				2
		unit_type				phalanx 1.0
		;default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		7 0.0 -20.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	begin_block 9
		max_units				7
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		8 0.0 -5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; heavy and other infantry

	;; heavy infantry
	begin_block 10
		max_units				6
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		9 0.0 -5.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; missile troops behind the spearmen and other infantry
	begin_block 11
		max_units				6
		unit_type				ranged_missile_infantry 0.5
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.8
		;default_melee_state		fire_at_will
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		10 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	begin_block 12
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.2
		unit_type				skirmish infantry 0.1
		;default_melee_state		fire_at_will_and_defend
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		11 0.0 -5.0
		inter_unit_spacing		1.0
		priority			1.0
	end_block

	begin_dummy_block 13
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12
	end_dummy_block

	;; general at the back
	begin_block 14
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		13 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 15
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		14 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 16
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15
	end_dummy_block

	;; artillery and handler behind
	begin_block 17
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			line
		block_relative_pos		16 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 18
		max_units				0
		not_general
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		16 0.0 -10.0
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation


begin_formation ai_chariots_attack

	;;; purpose flags - attacking
	attack
	march

	ai_priority				3.95

	supported_factions			gauls, galatians,, britons, egypt, seleucid, carthage, pontus, numidia, slave

	; screen
	begin_block 0
		min_units				3
		;max_units				3
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; light cav on either wing

	;; left side
	begin_block 1
		max_units				2
		not_general
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		max_unit_width			40
		block_formation			column
		block_relative_pos		0 -5.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

	;; right side
	begin_block 2
		max_units				2
		not_general
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		max_unit_width			40
		block_formation			column
		block_relative_pos		0 5.0 -5.0
		inter_unit_spacing		3.0
		priority			0.6
	end_block

	;; Light cav reserves for either wing
	;; left side
	begin_block 3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 -20.0 -20.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; right side
	begin_block 4
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 20.0 -20.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; cav behind centre
	begin_block 5
		unit_type				heavy cavalry 0.7
		unit_type				light cavalry 0.7
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		3 -5.0 0.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 6
		unit_type				heavy cavalry 0.7
		unit_type				light cavalry 0.7
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		4 5.0 0.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; Cavalry centre
	begin_block 7
		min_units				1
		max_units				6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.8
		unit_type				heavy_chariots 0.01
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; spearmen line
	begin_block 8
		max_units				2
		unit_type				phalanx 1.0
		default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		7 0.0 -30.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	begin_block 9
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		8 0.0 -5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; heavy and other infantry

	;; heavy infantry
	begin_block 10
		max_units				6
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		default_melee_state		fire_at_will
		;unit_density			close
		block_formation			line
		block_relative_pos		9 0.0 -5.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; missile troops behind the spearmen and other infantry
	begin_block 11
		max_units				6
		unit_type				ranged_missile_infantry 0.5
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		10 0.0 -5.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	begin_block 12
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.2
		unit_type				skirmish infantry 0.1
		default_melee_state		fire_at_will_and_defend
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		1.0
		priority			1.0
	end_block

	begin_dummy_block 13
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12
	end_dummy_block

	;; general at the back
	begin_block 14
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		13 0.0 -30.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 15
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		8 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 16
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15
	end_dummy_block

	;; artillery and handler behind
	begin_block 17
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		16 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 18
		max_units				0
		not_general
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		16 0.0 -10.0
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation


begin_formation ai_chariots_pursue

	;;; purpose flags - charging, pursue
	pursue
	march

	ai_priority				3.95

	supported_factions			gauls, galatians,, britons, egypt, seleucid, carthage, pontus, numidia, slave

	; screen
	begin_block 0
		min_units				3
		;max_units				3
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; light cav on either wing

	;; left side
	begin_block 1
		max_units				2
		not_general
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 -5.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

	;; right side
	begin_block 2
		max_units				2
		not_general
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 5.0 -5.0
		inter_unit_spacing		3.0
		priority			0.6
	end_block

	;; Light cav reserves for either wing
	;; left side
	begin_block 3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 -20.0 -20.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; right side
	begin_block 4
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 20.0 -20.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; cav behind centre
	begin_block 5
		unit_type				heavy cavalry 0.7
		unit_type				light cavalry 0.7
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		3 -5.0 0.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 6
		unit_type				heavy cavalry 0.7
		unit_type				light cavalry 0.7
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		4 5.0 0.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; Cavalry centre
	begin_block 7
		min_units				1
		max_units				6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.8
		unit_type				heavy_chariots 0.01
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; spearmen line
	begin_block 8
		max_units				2
		unit_type				phalanx 1.0
		default_melee_state		defend
		unit_formation			phalanx
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		7 0.0 -20.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	begin_block 9
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		8 0.0 -5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; heavy and other infantry

	;; heavy infantry
	begin_block 10
		max_units				6
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		;unit_density			close
		block_formation			line
		block_relative_pos		9 0.0 -5.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; missile troops behind the spearmen and other infantry
	begin_block 11
		max_units				6
		unit_type				ranged_missile_infantry 0.5
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.8
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		10 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	begin_block 12
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.2
		unit_type				skirmish infantry 0.1
		default_melee_state		fire_at_will_and_defend
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		11 0.0 -5.0
		inter_unit_spacing		1.0
		priority			1.0
	end_block

	begin_dummy_block 13
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12
	end_dummy_block

	;; general at the back
	begin_block 14
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		13 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 15
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		14 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 16
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15
	end_dummy_block

	;; artillery and handler behind
	begin_block 17
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		16 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 18
		max_units				0
		not_general
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		16 0.0 -10.0
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation


begin_formation ai_chariots_approach

	;;; purpose flags - deploy, approaching
	attack
	defend
	march

	ai_priority				3.95

	supported_factions			gauls, galatians,, britons, egypt, seleucid, carthage, pontus, numidia, slave

	; screen
	begin_block 0
		min_units				3
		;max_units				3
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; light cav on either wing

	;; left side
	begin_block 1
		max_units				2
		not_general
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		0 -5.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

	;; right side
	begin_block 2
		max_units				2
		not_general
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		0 5.0 -5.0
		inter_unit_spacing		3.0
		priority			0.6
	end_block

	;; Light cav reserves for either wing
	;; left side
	begin_block 3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 -20.0 -20.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; right side
	begin_block 4
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 20.0 -20.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; cav behind centre
	begin_block 5
		unit_type				heavy cavalry 0.7
		unit_type				light cavalry 0.7
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		3 -5.0 0.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 6
		unit_type				heavy cavalry 0.7
		unit_type				light cavalry 0.7
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		4 5.0 0.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; Cavalry centre
	begin_block 7
		min_units				1
		max_units				6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.8
		unit_type				heavy_chariots 0.01
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;; spearmen line
	begin_block 8
		max_units				2
		unit_type				phalanx 1.0
		default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		7 0.0 -20.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	begin_block 9
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		8 0.0 -5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; heavy and other infantry

	;; heavy infantry
	begin_block 10
		max_units				6
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		9 0.0 -5.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; missile troops behind the spearmen and other infantry
	begin_block 11
		max_units				6
		unit_type				ranged_missile_infantry 0.5
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.8
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		10 0.0 -30.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	begin_block 12
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.2
		unit_type				skirmish infantry 0.1
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		11 0.0 -5.0
		inter_unit_spacing		1.0
		priority			1.0
	end_block

	begin_dummy_block 13
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12
	end_dummy_block

	;; general at the back
	begin_block 14
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		13 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 15
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		14 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 16
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15
	end_dummy_block

	;; artillery and handler behind
	begin_block 17
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		16 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 18
		max_units				0
		not_general
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		16 0.0 -10.0
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation



;****************************************************************
; Crescent Formation - created by Sinuhet
;****************************************************************

begin_formation ai_crescent_march

	;;; purpose flags - regrouping
	march

	ai_priority				3.90

	supported_factions			numidia, scythia, carthage, pontus, armenia, parthia

	;; Screen of missile infantry
	begin_block 0
		max_units				4
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		;default_melee_state		fire_at_will_and_skirmish
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; first infantry line
	begin_block 1
		max_units				2
		unit_type				phalanx 1.0
		;default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; second infantry line
	begin_block 2
		min_units				2
		max_units				7
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		1 0.0 -5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; archers behind the spearmen

	begin_block 3
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend
		max_unit_width			20
		block_formation			line
		block_relative_pos		2 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 4
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		;default_melee_state		fire_at_will
		max_unit_width			20
		block_formation			column
		block_relative_pos		1 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; right side
	begin_block 5
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		;default_melee_state		fire_at_will
		max_unit_width			20
		block_formation			column
		block_relative_pos		1 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 6
		spans	0 1 2 3 4 5
	end_dummy_block

	;; cavalry on the flanks

	;; left flank
	begin_block 7
		min_units				2
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		6 -5.0 2.0
		inter_unit_spacing		4.0
		priority			0.9
	end_block

	;; right flank
	begin_block 8
		min_units				2
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		6 5.0 2.0
		inter_unit_spacing		4.0
		priority			0.9
	end_block

	;; left flank missile cav
	begin_block 9
		min_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		;unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		7 -5.0 20.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; right flank missile cav
	begin_block 10
		min_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		8 5.0 20.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; general at the back
	begin_block 11
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		6 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 12
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		11 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry on the general flanks

	;; left flank
	begin_block 13
		max_units				2
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square, wedge
		;unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		11 -5.0 -0.0
		inter_unit_spacing		4.0
		priority			0.8
	end_block

	;; right flank
	begin_block 14
		max_units				2
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square, wedge
		;unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		11 5.0 -0.0
		inter_unit_spacing		4.0
		priority			0.8
	end_block

	begin_dummy_block 15
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13 14
	end_dummy_block

	;; any behind
	begin_block 16
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		15 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 17
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			line
		block_relative_pos		15 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; missile cavalry in centre (new block - D.)
	begin_block 18
		min_units				1
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		;default_melee_state		fire_at_will_and_skirmish
		;unit_density			close		; always deploy and defend as close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 50.0
		inter_unit_spacing		0.2
		priority			0.9
	end_block

end_formation


begin_formation ai_crescent_line_deploy

	;;; purpose flags - deploy, defending
	defend
	march

	ai_priority				3.90

	supported_factions			numidia, scythia, carthage, pontus, armenia, parthia

	;; Screen of missile infantry
	begin_block 0
		max_units				4
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; first infantry line
	begin_block 1
		max_units				2
		unit_type				phalanx 1.0
		default_melee_state		defend
		unit_formation			phalanx
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; second infantry line
	begin_block 2
		min_units				2
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; archers behind the spearmen

	begin_block 3
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		2 0.0 -30.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 4
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		1 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; right side
	begin_block 5
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		1 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 6
		spans	0 1 2 3 4 5
	end_dummy_block

	;; cavalry on the flanks

	;; left flank
	begin_block 7
		min_units				2
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		1 -10.0 -3.0
		inter_unit_spacing		4.0
		priority			0.9
	end_block

	;; right flank
	begin_block 8
		min_units				2
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		1 10.0 -3.0
		inter_unit_spacing		4.0
		priority			0.9
	end_block

	;; left flank missile cav
	begin_block 9
		min_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		7 -10.0 20.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; right flank missile cav
	begin_block 10
		min_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		8 10.0 20.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block


	;; general at the back
	begin_block 11
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		6 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 12
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		11 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry on the general flanks

	;; left flank
	begin_block 13
		max_units				2
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		11 -5.0 -0.0
		inter_unit_spacing		4.0
		priority			0.8
	end_block

	;; right flank
	begin_block 14
		max_units				2
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		11 5.0 -0.0
		inter_unit_spacing		4.0
		priority			0.8
	end_block

	begin_dummy_block 15
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13 14
	end_dummy_block

	;; any behind
	begin_block 16
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		15 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 17
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		15 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; missile cavalry in centre (new block - D.)
	begin_block 18
		min_units				1
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 50.0
		inter_unit_spacing		10.0
		priority			0.9
	end_block

end_formation


begin_formation ai_crescent_attack

	;;; purpose flags - attacking
	attack
	march

	ai_priority				3.90

	supported_factions			numidia, scythia, carthage, pontus, armenia, parthia

	;; Screen of missile infantry
	begin_block 0
		max_units				4
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; first infantry line
	begin_block 1
		max_units				2
		unit_type				phalanx 1.0
		default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; second infantry line
	begin_block 2
		min_units				2
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -3.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; archers behind the spearmen

	begin_block 3
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		max_unit_width			40
		block_formation			line
		block_relative_pos		2 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 4
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		block_formation			column
		block_relative_pos		1 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; right side
	begin_block 5
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		block_formation			column
		block_relative_pos		1 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 6
		spans	0 1 2 3 4 5
	end_dummy_block

	;; cavalry on the flanks

	;; left flank
	begin_block 7
		min_units				2
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		6 -3.0 20.0
		inter_unit_spacing		4.0
		priority			0.9
	end_block

	;; right flank
	begin_block 8
		min_units				2
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		6 3.0 20.0
		inter_unit_spacing		4.0
		priority			0.9
	end_block

	;; left flank missile cav
	begin_block 9
		min_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		7 -5.0 35.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; right flank missile cav
	begin_block 10
		min_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		8 5.0 35.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block


	;; general at the back
	begin_block 11
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		6 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 12
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		11 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry on the general flanks

	;; left flank
	begin_block 13
		max_units				2
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		11 -5.0 -0.0
		inter_unit_spacing		4.0
		priority			0.8
	end_block

	;; right flank
	begin_block 14
		max_units				2
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		11 5.0 -0.0
		inter_unit_spacing		4.0
		priority			0.8
	end_block

	begin_dummy_block 15
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13 14
	end_dummy_block

	;; any behind
	begin_block 16
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		15 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 17
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		15 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; missile cavalry in centre (new block - D.)
	begin_block 18
		min_units				1
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			loose
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 50.0
		inter_unit_spacing		10.0
		priority			0.9
	end_block

end_formation


begin_formation ai_crescent_pursue

	;;; purpose flags - charging, pursue
	pursue
	march

	ai_priority				3.90

	supported_factions			numidia, scythia, carthage, pontus, armenia, parthia

	;; Screen of missile infantry
	begin_block 0
		max_units				4
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; first infantry line
	begin_block 1
		max_units				2
		unit_type				phalanx 1.0
		default_melee_state		defend
		unit_formation			phalanx
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; second infantry line
	begin_block 2
		min_units				2
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -3.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; archers behind the spearmen

	begin_block 3
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		max_unit_width			40
		block_formation			line
		block_relative_pos		2 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 4
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		block_formation			line
		block_relative_pos		1 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; right side
	begin_block 5
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		block_formation			line
		block_relative_pos		1 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 6
		spans	0 1 2 3 4 5
	end_dummy_block

	;; cavalry on the flanks

	;; left flank
	begin_block 7
		min_units				2
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 -5.0 20.0
		inter_unit_spacing		4.0
		priority			0.9
	end_block

	;; right flank
	begin_block 8
		min_units				2
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 5.0 20.0
		inter_unit_spacing		4.0
		priority			0.9
	end_block

	;; left flank missile cav
	begin_block 9
		min_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		7 -5.0 5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; right flank missile cav
	begin_block 10
		min_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		8 5.0 5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block


	;; general at the back
	begin_block 11
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		6 0.0 -30.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 12
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		11 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry on the general flanks

	;; left flank
	begin_block 13
		max_units				2
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		11 -5.0 -0.0
		inter_unit_spacing		4.0
		priority			0.8
	end_block

	;; right flank
	begin_block 14
		max_units				2
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		11 5.0 -0.0
		inter_unit_spacing		4.0
		priority			0.8
	end_block

	begin_dummy_block 15
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13 14
	end_dummy_block

	;; any behind
	begin_block 16
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		15 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 17
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		15 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; missile cavalry in centre (new block - D.)
	begin_block 18
		min_units				1
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			loose
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 50.0
		inter_unit_spacing		10.0
		priority			0.9
	end_block

end_formation


begin_formation ai_crescent_approach

	;;; purpose flags - approaching
	attack
	defend

	ai_priority				3.90

	supported_factions			numidia, scythia, carthage, pontus, armenia, parthia

	;; Screen of missile infantry
	begin_block 0
		max_units				4
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; first infantry line
	begin_block 1
		max_units				2
		unit_type				phalanx 1.0
		default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; second infantry line
	begin_block 2
		min_units				2
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; archers behind the spearmen

	begin_block 3
		max_units				5
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		2 0.0 -30.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side
	begin_block 4
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		1 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	;; right side
	begin_block 5
		max_units				3
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.8
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		1 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_dummy_block 6
		spans	0 1 2 3 4 5
	end_dummy_block

	;; cavalry on the flanks

	;; left flank
	begin_block 7
		min_units				2
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		6 -5.0 2.0
		inter_unit_spacing		4.0
		priority			0.9
	end_block

	;; right flank
	begin_block 8
		min_units				2
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		6 5.0 2.0
		inter_unit_spacing		4.0
		priority			0.9
	end_block

	;; left flank missile cav
	begin_block 9
		min_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		7 -5.0 20.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; right flank missile cav
	begin_block 10
		min_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		8 5.0 20.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; general at the back
	begin_block 11
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		6 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 12
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		11 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry on the general flanks

	;; left flank
	begin_block 13
		max_units				2
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		11 -5.0 -0.0
		inter_unit_spacing		4.0
		priority			0.8
	end_block

	;; right flank
	begin_block 14
		max_units				2
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		11 5.0 -0.0
		inter_unit_spacing		4.0
		priority			0.8
	end_block

	begin_dummy_block 15
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13 14
	end_dummy_block

	;; any behind
	begin_block 16
		max_units				0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		15 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 17
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		15 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; missile cavalry in centre (new block - D.)
	begin_block 18
		min_units				1
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 50.0
		inter_unit_spacing		10.0
		priority			0.9
	end_block

end_formation



;****************************************************************
; Formation for mixed missile cavalry armies - created by Sinuhet
;****************************************************************

begin_formation ai_mixed_missile_cavalry_march

	;;; purpose flags - regrouping
	march

	ai_priority				3.85

	supported_factions			egypt, seleucid, carthage, numidia, pontus, armenia, parthia

	; screen
	begin_block 0
		min_units				3
		max_units				3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; light cav on either wing

	;; left side
	begin_block 1
		max_units				2
		not_general
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		;default_melee_state		fire_at_will
		max_unit_width			20
		block_formation			column
		block_relative_pos		0 -5.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

	;; right side
	begin_block 2
		max_units				2
		not_general
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		;default_melee_state		fire_at_will
		max_unit_width			20
		block_formation			column
		block_relative_pos		0 5.0 -5.0
		inter_unit_spacing		3.0
		priority			0.6
	end_block

	;; Light cav reserves for either wing
	;; left side
	begin_block 3
		min_units				1
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		;unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		0 -20.0 -20.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;; right side
	begin_block 4
		min_units				1
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		;unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		0 20.0 -20.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;; cav behind centre
	begin_block 5
		unit_type				heavy cavalry 0.7
		unit_type				light cavalry 0.7
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		3 -5.0 0.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 6
		unit_type				heavy cavalry 0.7
		unit_type				light cavalry 0.7
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		4 5.0 0.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; Cavalry centre
	begin_block 7
		min_units				3
		max_units				6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.8
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	begin_dummy_block 8
		spans	0 1 2 3 4 5 6 7
	end_dummy_block

	;; spearmen line
	begin_block 9
		max_units				2
		unit_type				phalanx 1.0
		;default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		8 0.0 -20.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	begin_block 10
		max_units				3
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		9 -1.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	begin_block 11
		max_units				4
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		9 1.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; heavy and other infantry

	;; heavy infantry
	begin_block 12
		max_units				6
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		9 0.0 -5.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; missile troops behind the spearmen and other infantry
	begin_block 13
		max_units				6
		unit_type				ranged_missile_infantry 0.5
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.8
		;default_melee_state		fire_at_will
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	begin_block 14
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.2
		unit_type				skirmish infantry 0.1
		;default_melee_state		fire_at_will_and_defend
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		13 0.0 -5.0
		inter_unit_spacing		1.0
		priority			1.0
	end_block

	begin_dummy_block 15
		spans	9 10 11 12 13 14
	end_dummy_block

	;; general at the back
	begin_block 16
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		15 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 17
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		16 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 18
		spans	15 16 17
	end_dummy_block

	;; artillery and handler behind
	begin_block 19
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			line
		block_relative_pos		18 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 20
		max_units				0
		not_general
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		19 0.0 -0.5
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation


begin_formation ai_mixed_missile_cavalry_attack

	;;; purpose flags - attacking
	attack
	march

	ai_priority				3.85

	supported_factions			egypt, seleucid, carthage, numidia, pontus, armenia, parthia

	; screen
	begin_block 0
		min_units				3
		max_units				3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; light cav on either wing

	;; left side
	begin_block 1
		max_units				2
		not_general
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		max_unit_width			40
		block_formation			column
		block_relative_pos		0 -5.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

	;; right side
	begin_block 2
		max_units				2
		not_general
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		max_unit_width			40
		block_formation			column
		block_relative_pos		0 5.0 -5.0
		inter_unit_spacing		3.0
		priority			0.6
	end_block

	;; Light cav reserves for either wing
	;; left side
	begin_block 3
		min_units				1
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 -20.0 -20.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; right side
	begin_block 4
		min_units				1
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 20.0 -20.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; cav behind centre
	begin_block 5
		unit_type				heavy cavalry 0.7
		unit_type				light cavalry 0.7
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		3 -5.0 0.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 6
		unit_type				heavy cavalry 0.7
		unit_type				light cavalry 0.7
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		4 5.0 0.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; Cavalry centre
	begin_block 7
		min_units				3
		max_units				6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	begin_dummy_block 8
		spans	0 1 2 3 4 5 6 7
	end_dummy_block

	;; spearmen line
	begin_block 9
		max_units				2
		unit_type				phalanx 1.0
		default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		7 0.0 -20.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	begin_block 10
		max_units				3
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 -1.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	begin_block 11
		max_units				4
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 1.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; heavy and other infantry

	;; heavy infantry
	begin_block 12
		max_units				6
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		default_melee_state		fire_at_will
		;unit_density			close
		block_formation			line
		block_relative_pos		9 0.0 -5.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; missile troops behind the spearmen and other infantry
	begin_block 13
		max_units				6
		unit_type				ranged_missile_infantry 0.5
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	begin_block 14
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.2
		unit_type				skirmish infantry 0.1
		default_melee_state		fire_at_will_and_defend
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		13 0.0 -5.0
		inter_unit_spacing		1.0
		priority			1.0
	end_block

	begin_dummy_block 15
		spans	9 10 11 12 13 14
	end_dummy_block

	;; general at the back
	begin_block 16
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		15 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 17
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		15 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 18
		spans	15 16 17
	end_dummy_block

	;; artillery and handler behind
	begin_block 19
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		18 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 20
		max_units				0
		not_general
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		19 0.0 -0.5
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation


begin_formation ai_mixed_missile_cavalry_pursue

	;;; purpose flags - charging, pursue
	pursue
	march

	ai_priority				3.85

	supported_factions			egypt, seleucid, carthage, numidia, pontus, armenia, parthia

	; screen
	begin_block 0
		min_units				3
		max_units				3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; light cav on either wing

	;; left side
	begin_block 1
		max_units				2
		not_general
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 -5.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

	;; right side
	begin_block 2
		max_units				2
		not_general
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 5.0 -5.0
		inter_unit_spacing		3.0
		priority			0.6
	end_block

	;; Light cav reserves for either wing
	;; left side
	begin_block 3
		min_units				1
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 -20.0 -20.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; right side
	begin_block 4
		min_units				1
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 20.0 -20.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; cav behind centre
	begin_block 5
		unit_type				heavy cavalry 0.7
		unit_type				light cavalry 0.7
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		3 -5.0 0.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 6
		unit_type				heavy cavalry 0.7
		unit_type				light cavalry 0.7
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		4 5.0 0.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; Cavalry centre
	begin_block 7
		min_units				3
		max_units				6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	begin_dummy_block 8
		spans	0 1 2 3 4 5 6 7
	end_dummy_block

	;; spearmen line
	begin_block 9
		max_units				2
		unit_type				phalanx 1.0
		default_melee_state		defend
		unit_formation			phalanx
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		8 0.0 -20.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	begin_block 10
		max_units				3
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 -1.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	begin_block 11
		max_units				4
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 1.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; heavy and other infantry

	;; heavy infantry
	begin_block 12
		max_units				6
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		;unit_density			close
		block_formation			line
		block_relative_pos		9 0.0 -5.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; missile troops behind the spearmen and other infantry
	begin_block 13
		max_units				6
		unit_type				ranged_missile_infantry 0.5
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.8
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	begin_block 14
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.2
		unit_type				skirmish infantry 0.1
		default_melee_state		fire_at_will_and_defend
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		13 0.0 -5.0
		inter_unit_spacing		1.0
		priority			1.0
	end_block

	begin_dummy_block 15
		spans	9 10 11 12 13 14
	end_dummy_block

	;; general at the back
	begin_block 16
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		15 0.0 -30.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 17
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		16 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 18
		spans	15 16 17
	end_dummy_block

	;; artillery and handler behind
	begin_block 19
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		18 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 20
		max_units				0
		not_general
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		19 0.0 -0.5
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation


begin_formation ai_mixed_missile_cavalry_approach

	;;; purpose flags - deploy, approaching
	attack
	defend
	march

	ai_priority				3.85

	supported_factions			egypt, seleucid, carthage, numidia, pontus, armenia, parthia

	; screen
	begin_block 0
		min_units				3
		max_units				3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; light cav on either wing

	;; left side
	begin_block 1
		max_units				2
		not_general
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		;default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		0 -5.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

	;; right side
	begin_block 2
		max_units				2
		not_general
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		;default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			column
		block_relative_pos		0 5.0 -5.0
		inter_unit_spacing		3.0
		priority			0.6
	end_block

	;; Light cav reserves for either wing
	;; left side
	begin_block 3
		min_units				1
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 -20.0 -20.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; right side
	begin_block 4
		min_units				1
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 20.0 -20.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; cav behind centre
	begin_block 5
		unit_type				heavy cavalry 0.7
		unit_type				light cavalry 0.7
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		3 -5.0 0.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 6
		unit_type				heavy cavalry 0.7
		unit_type				light cavalry 0.7
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		4 5.0 0.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; Cavalry centre
	begin_block 7
		min_units				3
		max_units				6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	begin_dummy_block 8
		spans	0 1 2 3 4 5 6 7
	end_dummy_block

	;; spearmen line
	begin_block 9
		max_units				2
		unit_type				phalanx 1.0
		default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		8 0.0 -20.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	begin_block 10
		max_units				3
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 -1.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	begin_block 11
		max_units				4
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 1.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; heavy and other infantry

	;; heavy infantry
	begin_block 12
		max_units				6
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		9 0.0 -5.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; missile troops behind the spearmen and other infantry
	begin_block 13
		max_units				6
		unit_type				ranged_missile_infantry 0.5
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.8
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		12 0.0 -30.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	begin_block 14
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.2
		unit_type				skirmish infantry 0.1
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		13 0.0 -5.0
		inter_unit_spacing		1.0
		priority			1.0
	end_block

	begin_dummy_block 15
		spans	9 10 11 12 13 14
	end_dummy_block

	;; general at the back
	begin_block 16
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		15 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 17
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		16 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 18
		spans	15 16 17
	end_dummy_block

	;; artillery and handler behind
	begin_block 19
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		18 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 20
		max_units				0
		not_general
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		19 0.0 -0.5
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation



;***********************************************************************************************************************************************************************
; Darth's BI Arab formation(may be used by vandals) as modified for ATW. The main infantry will form a simple mob in the center. The cavalry will pick the left side to predate far from it.
; The generalwill be behind of the mob. Behind from all will be the missile units. The AI army will attack into 2 groups, the cavalry and the infantry.
; A really akward but effective formation.
; Modified by Suppanut to have characteristic of Sinuhet's mixed cavalry-infantry formation structure
;***********************************************************************************************************************************************************************

;The defense will be depended from mass of infantry in the center.
begin_formation ai_arab_line_march

	;;; purpose flags - regrouping
	march

	ai_priority				3.80

	supported_factions			carthage, numidia, dacia, gauls, galatians,, germans

	;; The vanguard
	begin_block 0
		max_units				6
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		;default_melee_state		skirmish
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; The vanguard(double line)
	begin_block 1
		max_units				2
		not_general
		unit_type				phalanx 1.0
		;default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 0.0 -2.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; left non-phalanx spear
	begin_block 2
		max_units				2
		not_general
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		1 -1.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; right non-phalanx spear
	begin_block 3
		max_units				2
		not_general
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		1 1.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	begin_dummy_block 4
		spans	1 2 3
	end_dummy_block

	;; reserve spearmen (triple line)
	begin_block 5
		max_units				3
		not_general
		unit_type				non_phalanx_spear 1.0
		unit_type				spearmen_pilum_infantry 2.0
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		1 0.0 -2.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; missile troops behind the spearmen and other infantry
	begin_block 6
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		unit_type				missile infantry 0.2
		unit_type				skirmish infantry 0.1
		;default_melee_state		fire_at_will_and_defend
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	begin_dummy_block 7
		spans	0 1 2 3 4 5 6
	end_dummy_block

	;; screen of missile - left
	begin_block 8
		max_units				3
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		;default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		7 -1.0 5.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; screen of missile - right
	begin_block 9
		max_units				3
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		;default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		7 1.0 5.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; general back to add spirit to troops
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		7 0.0 -5.0
		inter_unit_spacing		0.2
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		10 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 10 11
	end_dummy_block

	;; missile support behind (together with siege)
	begin_block 13
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		fire_at_will
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		12 0.0 -10.0
		inter_unit_spacing		6.0
		priority			0.1
	end_block

	begin_dummy_block 14
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13
	end_dummy_block

	;; cavalry will wait in the back of army
	begin_block 15
		min_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			15
		block_formation			square
		block_relative_pos		14 -25.0 -10.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;; cavalry will wait in the back of army
	begin_block 16
		min_units				3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			15
		block_formation			square
		block_relative_pos		15 0.0 -6.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;; cavalry will wait in the back of army
	begin_block 17
		max_units				2
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.8
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			square
		block_relative_pos		16 -2.0 0.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	begin_dummy_block 18
		spans	14 15 16 17
	end_dummy_block

	begin_block 19
		max_units				4
		not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			20
		block_formation			column
		block_relative_pos		12 -20.0 1.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_block 20
		max_units				0
		not_general
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		18 0.0 -0.5
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation


;the formation attacks and makes cavalry to perform an envelop attack to the left.
begin_formation ai_arab_line_attack

	;;; purpose flags - attacking
	attack
	march

	ai_priority				3.80

	supported_factions			carthage, numidia, dacia, gauls, galatians,, germans

	;; The vanguard
	begin_block 0
		max_units				6
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		;default_melee_state		skirmish
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			36
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; The vanguard(double line)
	begin_block 1
		max_units				2
		not_general
		unit_type				phalanx 1.0
		default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -2.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; left non-phalanx spear
	begin_block 2
		max_units				2
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -1.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; right non-phalanx spear
	begin_block 3
		max_units				2
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 1.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	begin_dummy_block 4
		spans	1 2 3
	end_dummy_block

	;; reserve spearmen (triple line)
	begin_block 5
		max_units				3
		not_general
		unit_type				non_phalanx_spear 1.0
		unit_type				spearmen_pilum_infantry 2.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -5.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; missile troops behind the spearmen and other infantry
	begin_block 6
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		unit_type				missile infantry 0.2
		unit_type				skirmish infantry 0.1
		default_melee_state		fire_at_will_and_defend
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	begin_dummy_block 7
		spans	0 1 2 3 4 5 6
	end_dummy_block

	;; screen of missile - left
	begin_block 8
		max_units				3
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		7 -1.0 5.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; screen of missile - right
	begin_block 9
		max_units				3
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		7 1.0 5.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; general back to add spirit to troops
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		7 0.0 -20.0
		inter_unit_spacing		0.2
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		10 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 10 11
	end_dummy_block

	;; missile support behind (together with siege)
	begin_block 13
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		;unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		6.0
		priority			0.1
	end_block

	begin_dummy_block 14
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13
	end_dummy_block

	;; cavalry will predate in the left flank of army
	begin_block 15
		max_units				2
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.8
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		14 -45.0 -5.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; cavalry will predate in the left flank of army
	begin_block 16
		min_units				3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		15 0.0 -6.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; cavalry will predate in the left flank of army
	begin_block 17
		min_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		16 -2.0 0.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	begin_dummy_block 18
		spans	14 15 16 17
	end_dummy_block

	begin_block 19
		max_units				4
		not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		12 -30.0 20.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_block 20
		max_units				0
		not_general
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		18 0.0 -0.5
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation


begin_formation ai_arab_line_pursue

	;;; purpose flags - charging, pursue
	pursue
	march

	ai_priority				3.80

	supported_factions			carthage, numidia, dacia, gauls, galatians,, germans

	;; The vanguard
	begin_block 0
		max_units				6
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		;default_melee_state		skirmish
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; The vanguard(double line)
	begin_block 1
		max_units				2
		not_general
		unit_type				phalanx 1.0
		default_melee_state		defend
		unit_formation			phalanx
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -2.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; left non-phalanx spear
	begin_block 2
		max_units				2
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -1.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; right non-phalanx spear
	begin_block 3
		max_units				2
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 1.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	begin_dummy_block 4
		spans	1 2 3
	end_dummy_block

	;; reserve spearmen (triple line)
	begin_block 5
		max_units				3
		not_general
		unit_type				non_phalanx_spear 1.0
		unit_type				spearmen_pilum_infantry 2.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -5.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; missile troops behind the spearmen and other infantry
	begin_block 6
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		unit_type				missile infantry 0.2
		unit_type				skirmish infantry 0.1
		default_melee_state		fire_at_will_and_defend
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	begin_dummy_block 7
		spans	0 1 2 3 4 5 6
	end_dummy_block

	;; screen of missile - left
	begin_block 8
		max_units				3
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		7 -1.0 -5.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; screen of missile - right
	begin_block 9
		max_units				3
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		7 1.0 -5.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; general back to add spirit to troops
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		7 0.0 -30.0
		inter_unit_spacing		0.2
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		10 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 10 11
	end_dummy_block

	;; missile support behind (together with siege)
	begin_block 13
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		fire_at_will
		;unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		6.0
		priority			0.1
	end_block

	begin_dummy_block 14
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13
	end_dummy_block

	;; cavalry will predate in the left flank of army
	begin_block 15
		max_units				2
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		14 -35.0 -5.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; cavalry will predate in the left flank of army
	begin_block 16
		min_units				3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		15 0.0 -6.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; cavalry will predate in the left flank of army
	begin_block 17
		min_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		16 -2.0 0.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	begin_dummy_block 18
		spans	14 15 16 17
	end_dummy_block

	begin_block 19
		max_units				4
		not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			40
		block_formation			line
		block_relative_pos		12 5.0 10.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_block 20
		max_units				0
		not_general
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		18 0.0 -0.5
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation


;the multirole swap of the formation will make cavalry to go back of the formation and wait for enemy movements.The general will be amongst them.
begin_formation ai_arab_line_approach_march

	;;; purpose flags - deploy, approaching
	attack
	defend
	march

	ai_priority				3.80

	supported_factions			carthage, numidia, dacia, gauls, galatians,, germans

	;; The vanguard
	begin_block 0
		max_units				6
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		;default_melee_state		skirmish
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; The vanguard(double line)
	begin_block 1
		max_units				2
		not_general
		unit_type				phalanx 1.0
		default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -2.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; left non-phalanx spear
	begin_block 2
		max_units				2
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -1.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; right non-phalanx spear
	begin_block 3
		max_units				2
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 1.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	begin_dummy_block 4
		spans	1 2 3
	end_dummy_block

	;; reserve spearmen (triple line)
	begin_block 5
		max_units				3
		not_general
		unit_type				non_phalanx_spear 1.0
		unit_type				spearmen_pilum_infantry 2.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -5.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; missile troops behind the spearmen and other infantry
	begin_block 6
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		unit_type				missile infantry 0.2
		unit_type				skirmish infantry 0.1
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		5 0.0 -30.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	begin_dummy_block 7
		spans	0 1 2 3 4 5 6
	end_dummy_block

	;; screen of missile - left
	begin_block 8
		max_units				3
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		7 -1.0 5.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; screen of missile - right
	begin_block 9
		max_units				3
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		7 1.0 5.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; general back to add spirit to troops
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		7 0.0 -20.0
		inter_unit_spacing		0.2
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		10 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 10 11
	end_dummy_block

	;; missile support behind (together with siege)
	begin_block 13
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		6.0
		priority			0.1
	end_block

	begin_dummy_block 14
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13
	end_dummy_block

	;; cavalry will wait in the front of army
	begin_block 15
		max_units				2
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.8
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		14 0.0 18.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	;; left flank cavalry will preprare for harrasing enemy on the front
	begin_block 16
		min_units				3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		15 -2.0 6.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; right flank cavalry will preprare for harrasing enemy on the front
	begin_block 17
		min_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		15 2.0 6.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	begin_dummy_block 18
		spans	14 15 16 17
	end_dummy_block

	begin_block 19
		max_units				4
		not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		12 -20.0 1.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_block 20
		max_units				0
		not_general
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		18 0.0 -0.5
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation


;The defense will be depended from mass of infantry in the center.
begin_formation ai_arab_line_defend

	;;; purpose flags - defending
	defend
	march

	ai_priority				3.80

	supported_factions			carthage, numidia, dacia, gauls, galatians,, germans

	;; The vanguard
	begin_block 0
		max_units				6
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		;default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; The vanguard(double line)
	begin_block 1
		max_units				2
		not_general
		unit_type				phalanx 1.0
		default_melee_state		defend
		unit_formation			phalanx
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -2.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; left non-phalanx spear
	begin_block 2
		max_units				2
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -1.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; right non-phalanx spear
	begin_block 3
		max_units				2
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 1.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	begin_dummy_block 4
		spans	1 2 3
	end_dummy_block

	;; reserve spearmen (triple line)
	begin_block 5
		max_units				3
		not_general
		unit_type				non_phalanx_spear 1.0
		unit_type				spearmen_pilum_infantry 2.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -2.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	;; missile troops behind the spearmen and other infantry
	begin_block 6
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		unit_type				missile infantry 0.2
		unit_type				skirmish infantry 0.1
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		5 0.0 -30.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	begin_dummy_block 7
		spans	0 1 2 3 4 5 6
	end_dummy_block

	;; screen of missile - left
	begin_block 8
		max_units				3
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		7 -1.0 5.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; screen of missile - right
	begin_block 9
		max_units				3
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		7 1.0 5.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; general back to add spirit to troops
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		7 0.0 -20.0
		inter_unit_spacing		0.2
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		10 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 12
		spans	0 1 2 3 4 5 6 7 10 11
	end_dummy_block

	;; missile support behind (together with siege)
	begin_block 13
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		6.0
		priority			0.1
	end_block

	begin_dummy_block 14
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12 13
	end_dummy_block

	;; cavalry will predate in the left flank of army
	begin_block 15
		min_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		14 -25.0 -10.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; cavalry will predate in the left flank of army
	begin_block 16
		min_units				3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		15 0.0 -6.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; cavalry will predate in the left flank of army
	begin_block 17
		max_units				2
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.8
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		16 -2.0 0.0
		inter_unit_spacing		0.2
		priority			0.5
	end_block

	begin_dummy_block 18
		spans	14 15 16 17
	end_dummy_block

	begin_block 19
		max_units				4
		not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		18 -20.0 -5.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_block 20
		max_units				0
		not_general
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		18 0.0 -0.5
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation



;****************************************************************
; Formation for horse archers armies - created by Sinuhet
;****************************************************************

begin_formation ai_horse_archers_march

	;;; purpose flags - regrouping
	march

	ai_priority				3.75

	supported_factions			parthia, scythia

	; screen
	begin_block 0
		min_units				3
		max_units				3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; light cav on either wing

	;; left side
	begin_block 1
		min_units				1
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		0 -5.0 -5.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; right side
	begin_block 2
		min_units				1
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		0 5.0 -5.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; Light cav reserves for either wing
	;; left side
	begin_block 3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;; right side
	begin_block 4
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		2 0.0 -20.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;; cav behind centre
	begin_block 5
		unit_type				heavy cavalry 0.7
		unit_type				light cavalry 0.7
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		3 -5.0 0.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 6
		unit_type				heavy cavalry 0.7
		unit_type				light cavalry 0.7
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		4 5.0 0.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; Cavalry centre
	begin_block 7
		min_units				1
		max_units				6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.8
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	begin_dummy_block 8
		spans	0 1 2 3 4 5 6 7
	end_dummy_block

	;; spearmen line
	begin_block 9
		max_units				2
		unit_type				phalanx 1.0
		;default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		8 0.0 -20.0
		inter_unit_spacing		0.0
		priority			0.90
	end_block

	begin_block 10
		max_units				3
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		9 -1.0 0.0
		inter_unit_spacing		0.1
		priority			0.90
	end_block

	begin_block 11
		max_units				4
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		9 1.0 0.0
		inter_unit_spacing		0.1
		priority			0.90
	end_block

	;; heavy and other infantry

	;; heavy infantry
	begin_block 12
		max_units				6
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		9 0.0 -5.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; missile troops behind the spearmen and other infantry
	begin_block 13
		max_units				6
		unit_type				ranged_missile_infantry 0.5
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.8
		;default_melee_state		fire_at_will
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	begin_block 14
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.2
		unit_type				skirmish infantry 0.1
		;default_melee_state		fire_at_will_and_defend
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		13 0.0 -5.0
		inter_unit_spacing		1.0
		priority			0.90
	end_block

	begin_dummy_block 15
		spans	9 10 11 12 13 14
	end_dummy_block

	;; general at the back
	begin_block 16
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		15 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 17
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		16 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 18
		spans	15 16 17
	end_dummy_block

	;; artillery and handler behind
	begin_block 19
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			line
		block_relative_pos		18 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 20
		max_units				0
		not_general
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		19 0.0 -0.5
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation


begin_formation ai_horse_archers_attack

	;;; purpose flags - attacking
	attack
	march

	ai_priority				3.75

	supported_factions			parthia, scythia

	; screen
	begin_block 0
		min_units				3
		max_units				3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; light cav on either wing

	;; left side
	begin_block 1
		min_units				1
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 -5.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; right side
	begin_block 2
		min_units				1
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 5.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; Light cav reserves for either wing
	;; left side
	begin_block 3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; right side
	begin_block 4
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		2 0.0 -20.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; cav behind centre
	begin_block 5
		unit_type				heavy cavalry 0.7
		unit_type				light cavalry 0.7
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		3 -5.0 0.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 6
		unit_type				heavy cavalry 0.7
		unit_type				light cavalry 0.7
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		4 5.0 0.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; Cavalry centre
	begin_block 7
		min_units				1
		max_units				6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	begin_dummy_block 8
		spans	0 1 2 3 4 5 6 7
	end_dummy_block

	;; spearmen line
	begin_block 9
		max_units				2
		unit_type				phalanx 1.0
		default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		7 0.0 -20.0
		inter_unit_spacing		0.0
		priority			0.90
	end_block

	begin_block 10
		max_units				3
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		8 0.0 -5.0
		inter_unit_spacing		0.1
		priority			0.90
	end_block

	begin_block 11
		max_units				4
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		8 0.0 -5.0
		inter_unit_spacing		0.1
		priority			0.90
	end_block

	;; heavy and other infantry

	;; heavy infantry
	begin_block 12
		max_units				6
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		default_melee_state		fire_at_will
		;unit_density			close
		block_formation			line
		block_relative_pos		9 0.0 -5.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; missile troops behind the spearmen and other infantry
	begin_block 13
		max_units				6
		unit_type				ranged_missile_infantry 0.5
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	begin_block 14
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.2
		unit_type				skirmish infantry 0.1
		default_melee_state		fire_at_will_and_defend
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		13 0.0 -5.0
		inter_unit_spacing		1.0
		priority			0.90
	end_block

	begin_dummy_block 15
		spans	9 10 11 12 13 14
	end_dummy_block

	;; general at the back
	begin_block 16
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		15 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 17
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		15 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 18
		spans	15 16 17
	end_dummy_block

	;; artillery and handler behind
	begin_block 19
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		18 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 20
		max_units				0
		not_general
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		19 0.0 -0.5
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation


begin_formation ai_horse_archers_pursue

	;;; purpose flags - charging, pursue
	pursue
	march

	ai_priority				3.75

	supported_factions			parthia, scythia

	; screen
	begin_block 0
		min_units				3
		max_units				3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; light cav on either wing

	;; left side
	begin_block 1
		min_units				1
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 -5.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; right side
	begin_block 2
		min_units				1
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 5.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; Light cav reserves for either wing
	;; left side
	begin_block 3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; right side
	begin_block 4
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		2 0.0 -20.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; cav behind centre
	begin_block 5
		unit_type				heavy cavalry 0.7
		unit_type				light cavalry 0.7
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		3 -5.0 0.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 6
		unit_type				heavy cavalry 0.7
		unit_type				light cavalry 0.7
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		4 5.0 0.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; Cavalry centre
	begin_block 7
		min_units				1
		max_units				6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	begin_dummy_block 8
		spans	0 1 2 3 4 5 6 7
	end_dummy_block

	;; spearmen line
	begin_block 9
		max_units				2
		unit_type				phalanx 1.0
		default_melee_state		defend
		unit_formation			phalanx
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		8 0.0 -20.0
		inter_unit_spacing		0.0
		priority			0.90
	end_block

	begin_block 10
		max_units				3
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 -1.0 0.0
		inter_unit_spacing		0.1
		priority			0.90
	end_block

	begin_block 11
		max_units				4
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 1.0 0.0
		inter_unit_spacing		0.1
		priority			0.90
	end_block

	;; heavy and other infantry

	;; heavy infantry
	begin_block 12
		max_units				6
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		;unit_density			close
		block_formation			line
		block_relative_pos		9 0.0 -5.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; missile troops behind the spearmen and other infantry
	begin_block 13
		max_units				6
		unit_type				ranged_missile_infantry 0.5
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.8
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		12 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	begin_block 14
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.2
		unit_type				skirmish infantry 0.1
		default_melee_state		fire_at_will_and_defend
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		13 0.0 -5.0
		inter_unit_spacing		1.0
		priority			0.90
	end_block

	begin_dummy_block 15
		spans	9 10 11 12 13 14
	end_dummy_block

	;; general at the back
	begin_block 16
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		15 0.0 -30.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 17
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		16 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 18
		spans	15 16 17
	end_dummy_block

	;; artillery and handler behind
	begin_block 19
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		18 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 20
		max_units				0
		not_general
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		19 0.0 -0.5
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation


begin_formation ai_horse_archers_defense

	;;; purpose flags - deploy, approaching
	attack
	defend
	march

	ai_priority				3.75

	supported_factions			parthia, scythia

	; screen
	begin_block 0
		min_units				3
		max_units				3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; light cav on either wing

	;; left side
	begin_block 1
		min_units				1
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 -5.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; right side
	begin_block 2
		min_units				1
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 5.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; Light cav reserves for either wing
	;; left side
	begin_block 3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; right side
	begin_block 4
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		2 0.0 -20.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; cav behind centre
	begin_block 5
		unit_type				heavy cavalry 0.7
		unit_type				light cavalry 0.7
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		3 -5.0 0.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 6
		unit_type				heavy cavalry 0.7
		unit_type				light cavalry 0.7
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		4 5.0 0.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; Cavalry centre
	begin_block 7
		min_units				1
		max_units				6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	begin_dummy_block 8
		spans	0 1 2 3 4 5 6 7
	end_dummy_block

	;; spearmen line
	begin_block 9
		max_units				2
		unit_type				phalanx 1.0
		default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		8 0.0 -20.0
		inter_unit_spacing		0.0
		priority			0.90
	end_block

	begin_block 10
		max_units				3
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 -1.0 0.0
		inter_unit_spacing		0.1
		priority			0.90
	end_block

	begin_block 11
		max_units				4
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 1.0 0.0
		inter_unit_spacing		0.1
		priority			0.90
	end_block

	;; heavy and other infantry

	;; heavy infantry
	begin_block 12
		max_units				6
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		9 0.0 -5.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; missile troops behind the spearmen and other infantry
	begin_block 13
		max_units				6
		unit_type				ranged_missile_infantry 0.5
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.8
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		12 0.0 -30.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	begin_block 14
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.2
		unit_type				skirmish infantry 0.1
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		13 0.0 -5.0
		inter_unit_spacing		1.0
		priority			0.90
	end_block

	begin_dummy_block 15
		spans	9 10 11 12 13 14
	end_dummy_block

	;; general at the back
	begin_block 16
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		15 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 17
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		16 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 18
		spans	15 16 17
	end_dummy_block

	;; artillery and handler behind
	begin_block 19
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		18 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 20
		max_units				0
		not_general
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		19 0.0 -0.5
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation



;****************************************************************
;****************************************************************
; Cavalry only formation section
;****************************************************************
;****************************************************************

;****************************************************************
; Formation for missile cav armies - created by Sinuhet
;****************************************************************

begin_formation ai_missile_cavalry_march

	;;; purpose flags - regrouping
	march

	ai_priority				3.70

	supported_factions			egypt, seleucid, carthage, pontus, armenia, parthia, scythia, numidia

	; screen
	begin_block 0
		min_units				1
		max_units				3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; light cav on either wing

	;; left side
	begin_block 1
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		0 -5.0 -10.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right side
	begin_block 2
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 5.0 -10.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; Light cav reserves for either wing
	;; left side
	begin_block 3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		1 0.0 -60.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;; right side
	begin_block 4
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		2 0.0 -60.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;; cav behind centre
	begin_block 5
		unit_type				heavy cavalry 0.7
		unit_type				light cavalry 0.7
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		3 -5.0 0.0
		inter_unit_spacing		4.0
		priority			0.1
	end_block

	begin_block 6
		unit_type				heavy cavalry 0.7
		unit_type				light cavalry 0.7
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		4 5.0 0.0
		inter_unit_spacing		4.0
		priority			0.1
	end_block

	;; Cavalry centre
	begin_block 7
		max_units				6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 0.0 -65.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	begin_dummy_block 8
		spans	0 1 2 3 4 5 6 7
	end_dummy_block

	;; general at the back
	begin_block 9
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		8 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 10
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		9 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 11
		spans	0 1 2 3 4 5 6 7 8 9 10
	end_dummy_block

	;; artillery and handler behind
	begin_block 12
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 13
		max_units				0
		not_general
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		11 0.0 -10.0
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation


begin_formation ai_missile_cavalry_attack

	;;; purpose flags - attacking
	attack
	march

	ai_priority				3.70

	supported_factions			egypt, seleucid, carthage, pontus, armenia, parthia, scythia, numidia

	; screen
	begin_block 0
		min_units				1
		max_units				3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; light cav on either wing

	;; left side
	begin_block 1
		max_units				2
		not_general
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			40
		block_formation			column
		block_relative_pos		0 -5.0 -10.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right side
	begin_block 2
		max_units				2
		not_general
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			40
		block_formation			column
		block_relative_pos		0 5.0 -10.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; Light cav reserves for either wing
	;; left side
	begin_block 3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		1 0.0 -60.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; right side
	begin_block 4
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		2 0.0 -60.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; cav behind centre
	begin_block 5
		unit_type				heavy cavalry 0.7
		unit_type				light cavalry 0.7
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		3 -5.0 0.0
		inter_unit_spacing		4.0
		priority			0.1
	end_block

	begin_block 6
		unit_type				heavy cavalry 0.7
		unit_type				light cavalry 0.7
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		4 5.0 0.0
		inter_unit_spacing		4.0
		priority			0.1
	end_block

	;; Cavalry centre
	begin_block 7
		max_units				6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -65.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	begin_dummy_block 8
		spans	0 1 2 3 4 5 6 7
	end_dummy_block

	;; general at the back
	begin_block 9
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		8 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 10
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		9 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 11
		spans	0 1 2 3 4 5 6 7 8 9 10
	end_dummy_block

	;; artillery and handler behind
	begin_block 12
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 13
		max_units				0
		not_general
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		11 0.0 -10.0
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation


begin_formation ai_missile_cavalry_pursue

	;;; purpose flags - charging, pursue
	pursue
	march

	ai_priority				3.70

	supported_factions			egypt, seleucid, carthage, pontus, armenia, parthia, scythia, numidia

	; screen
	begin_block 0
		min_units				1
		max_units				3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; light cav on either wing

	;; left side
	begin_block 1
		max_units				2
		not_general
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 -5.0 -10.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right side
	begin_block 2
		max_units				2
		not_general
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 5.0 -10.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; Light cav reserves for either wing
	;; left side
	begin_block 3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		1 0.0 -60.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; right side
	begin_block 4
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		2 0.0 -60.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; cav behind centre
	begin_block 5
		unit_type				heavy cavalry 0.7
		unit_type				light cavalry 0.7
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		3 -5.0 0.0
		inter_unit_spacing		4.0
		priority			0.1
	end_block

	begin_block 6
		unit_type				heavy cavalry 0.7
		unit_type				light cavalry 0.7
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		4 5.0 0.0
		inter_unit_spacing		4.0
		priority			0.1
	end_block

	;; Cavalry centre
	begin_block 7
		max_units				6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -65.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	begin_dummy_block 8
		spans	0 1 2 3 4 5 6 7
	end_dummy_block

	;; general at the back
	begin_block 9
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		8 0.0 -30.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 10
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		9 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 11
		spans	0 1 2 3 4 5 6 7 8 9 10
	end_dummy_block

	;; artillery and handler behind
	begin_block 12
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 13
		max_units				0
		not_general
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		11 0.0 -10.0
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation


begin_formation ai_missile_cavalry_approach

	;;; purpose flags - deploy, approaching, defending
	attack
	defend
	march

	ai_priority				3.70

	supported_factions			egypt, seleucid, carthage, pontus, armenia, parthia, scythia, numidia

	; screen
	begin_block 0
		min_units				1
		max_units				3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; light cav on either wing

	;; left side
	begin_block 1
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 -5.0 -10.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right side
	begin_block 2
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 5.0 -10.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; Light cav reserves for either wing
	;; left side
	begin_block 3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		1 0.0 -60.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; right side
	begin_block 4
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		2 0.0 -60.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; cav behind centre
	begin_block 5
		unit_type				heavy cavalry 0.7
		unit_type				light cavalry 0.7
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		3 -5.0 0.0
		inter_unit_spacing		4.0
		priority			0.1
	end_block

	begin_block 6
		unit_type				heavy cavalry 0.7
		unit_type				light cavalry 0.7
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		4 5.0 0.0
		inter_unit_spacing		4.0
		priority			0.1
	end_block

	;; Cavalry centre
	begin_block 7
		max_units				6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -65.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	begin_dummy_block 8
		spans	0 1 2 3 4 5 6 7
	end_dummy_block

	;; general at the back
	begin_block 9
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		8 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 10
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		9 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 11
		spans	0 1 2 3 4 5 6 7 8 9 10
	end_dummy_block

	;; artillery and handler behind
	begin_block 12
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 13
		max_units				0
		not_general
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		11 0.0 -10.0
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation



;****************************************************************
; Formation for generic missile cavalry armies - created by Sinuhet
;****************************************************************

begin_formation ai_generic_missile_cavalry_march

	;;; purpose flags - regrouping
	march

	ai_priority				3.60

	; screen
	begin_block 0
		min_units				3
		max_units				3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; light cav on either wing

	;; left side
	begin_block 1
		min_units				1
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		0 -20.0 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; right side
	begin_block 2
		min_units				1
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		0 20.0 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; Light cav reserves for either wing
	;; left side
	begin_block 3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		1 -10.0 -22.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;; right side
	begin_block 4
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		2 10.0 -22.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;; cav behind centre
	begin_block 5
		unit_type				light cavalry 0.7
		unit_type				heavy cavalry 0.3
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		1 0.0 -40.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	begin_block 6
		unit_type				light cavalry 0.7
		unit_type				heavy cavalry 0.3
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		2 0.0 -40.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; Cavalry centre
	begin_block 7
		min_units				1
		max_units				6
		unit_type				light cavalry 0.3
		unit_type				heavy cavalry 0.7
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; general at the back
	begin_block 8
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		7 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 9
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		8 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 10
		spans	0 1 2 3 4 5 6 7 8 9
	end_dummy_block

	;; artillery and handler behind
	begin_block 11
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			line
		block_relative_pos		10 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 12
		max_units				0
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		10 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.5
	end_block

end_formation


begin_formation ai_generic_missile_cavalry_attack

	;;; purpose flags - attacking
	attack
	march

	ai_priority				3.60

	; screen
	begin_block 0
		min_units				3
		max_units				3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; light cav on either wing

	;; left side
	begin_block 1
		min_units				1
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 -20.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; right side
	begin_block 2
		min_units				1
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 20.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; Light cav reserves for either wing
	;; left side
	begin_block 3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		1 -10.0 -22.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; right side
	begin_block 4
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		2 10.0 -22.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; cav behind centre
	begin_block 5
		unit_type				light cavalry 0.7
		unit_type				heavy cavalry 0.3
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		1 0.0 -40.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	begin_block 6
		unit_type				light cavalry 0.7
		unit_type				heavy cavalry 0.3
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		2 0.0 -40.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; Cavalry centre
	begin_block 7
		min_units				1
		max_units				6
		unit_type				light cavalry 0.3
		unit_type				heavy cavalry 0.7
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; general at the back
	begin_block 8
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		7 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 9
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		8 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 10
		spans	0 1 2 3 4 5 6 7 8 9
	end_dummy_block

	;; artillery and handler behind
	begin_block 11
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 12
		max_units				0
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		10 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.5
	end_block

end_formation


begin_formation ai_generic_missile_cavalry_pursue

	;;; purpose flags - charging, pursue
	pursue
	march

	ai_priority				3.60

	; screen
	begin_block 0
		min_units				3
		max_units				3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; light cav on either wing

	;; left side
	begin_block 1
		min_units				1
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 -20.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; right side
	begin_block 2
		min_units				1
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 20.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; Light cav reserves for either wing
	;; left side
	begin_block 3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		1 -10.0 -22.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; right side
	begin_block 4
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		2 10.0 -22.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; cav behind centre
	begin_block 5
		unit_type				light cavalry 0.7
		unit_type				heavy cavalry 0.3
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -40.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	begin_block 6
		unit_type				light cavalry 0.7
		unit_type				heavy cavalry 0.3
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		2 0.0 -40.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; Cavalry centre
	begin_block 7
		min_units				1
		max_units				6
		unit_type				light cavalry 0.3
		unit_type				heavy cavalry 0.7
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; general at the back
	begin_block 8
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		7 0.0 -30.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 9
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		8 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 10
		spans	0 1 2 3 4 5 6 7 8 9
	end_dummy_block

	;; artillery and handler behind
	begin_block 11
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 12
		max_units				0
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		10 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.5
	end_block

end_formation


begin_formation ai_generic_missile_cavalry_approach

	;;; purpose flags - deploy, approaching, defending
	attack
	defend
	march

	ai_priority				3.60

	; screen
	begin_block 0
		min_units				3
		max_units				3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; light cav on either wing

	;; left side
	begin_block 1
		min_units				1
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 -20.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; right side
	begin_block 2
		min_units				1
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 20.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; Light cav reserves for either wing
	;; left side
	begin_block 3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		1 -10.0 -22.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; right side
	begin_block 4
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		2 10.0 -22.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; cav behind centre
	begin_block 5
		unit_type				light cavalry 0.7
		unit_type				heavy cavalry 0.3
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		1 0.0 -40.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	begin_block 6
		unit_type				light cavalry 0.7
		unit_type				heavy cavalry 0.3
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		2 0.0 -40.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; Cavalry centre
	begin_block 7
		min_units				1
		max_units				6
		unit_type				light cavalry 0.3
		unit_type				heavy cavalry 0.7
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; general at the back
	begin_block 8
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		7 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 9
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		8 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 10
		spans	0 1 2 3 4 5 6 7 8 9
	end_dummy_block

	;; artillery and handler behind
	begin_block 11
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 12
		max_units				0
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		10 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.5
	end_block

end_formation



;****************************************************************
; Formation for cavalry armies - created by Sinuhet
;****************************************************************

begin_formation ai_cavalry_march

	;;; purpose flags - regrouping
	march

	ai_priority				3.50


	;; Cavalry centre
	begin_block 0
		min_units				1
		max_units				6
		unit_type				heavy cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	; screen
	begin_block 1
		max_units				4
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		;default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 0.0 50.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block


	;; light cav on either wing

	;; left side
	begin_block 2
		max_units				2
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		1 -20.0 0.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; right side
	begin_block 3
		max_units				2
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		1 20.0 0.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; general at the back
	begin_block 4
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 5
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		4 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; heavy cav behind centre
	begin_block 6
		unit_type				heavy cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		5 -10.0 0.0
		inter_unit_spacing		4.0
		priority			0.2
	end_block

	begin_block 7
		unit_type				heavy cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		5 10.0 0.0
		inter_unit_spacing		4.0
		priority			0.2
	end_block

	;; Light cav reserves for either wing
	;; left side
	begin_block 8
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		0 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.3
	end_block

	;; right side
	begin_block 9
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		0 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.3
	end_block

	begin_dummy_block 10
		spans	0 1 2 3 4 5 6 7 8 9
	end_dummy_block

	;; artillery and handler behind
	begin_block 11
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			line
		block_relative_pos		10 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 12
		max_units				0
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		10 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.5
	end_block

end_formation


begin_formation ai_cavalry_attack

	;;; purpose flags - attacking
	attack
	march

	ai_priority				3.50


	;; Cavalry centre
	begin_block 0
		min_units				1
		max_units				6
		unit_type				heavy cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	; screen
	begin_block 1
		max_units				4
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 50.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block


	;; light cav on either wing

	;; left side
	begin_block 2
		max_units				2
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		block_formation			column
		block_relative_pos		1 -20.0 0.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; right side
	begin_block 3
		max_units				2
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		block_formation			column
		block_relative_pos		1 20.0 0.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; general at the back
	begin_block 4
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 5
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		4 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; heavy cav behind centre
	begin_block 6
		unit_type				heavy cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 -10.0 0.0
		inter_unit_spacing		4.0
		priority			0.2
	end_block

	begin_block 7
		unit_type				heavy cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 10.0 0.0
		inter_unit_spacing		4.0
		priority			0.2
	end_block

	;; Light cav reserves for either wing
	;; left side
	begin_block 8
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		block_formation			column
		block_relative_pos		0 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.3
	end_block

	;; right side
	begin_block 9
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		block_formation			column
		block_relative_pos		0 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.3
	end_block

	begin_dummy_block 10
		spans	0 1 2 3 4 5 6 7 8 9
	end_dummy_block

	;; artillery and handler behind
	begin_block 11
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 12
		max_units				0
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		10 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.5
	end_block

end_formation


begin_formation ai_cavalry_pursue

	;;; purpose flags - charging, pursue
	pursue
	march

	ai_priority				3.50


	;; Cavalry centre
	begin_block 0
		min_units				1
		max_units				6
		unit_type				heavy cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	; screen
	begin_block 1
		max_units				4
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 50.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block


	;; light cav on either wing

	;; left side
	begin_block 2
		max_units				2
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		block_formation			line
		block_relative_pos		1 -20.0 0.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; right side
	begin_block 3
		max_units				2
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		block_formation			line
		block_relative_pos		1 20.0 0.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; general at the back
	begin_block 4
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 -30.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 5
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		4 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; heavy cav behind centre
	begin_block 6
		unit_type				heavy cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 -10.0 0.0
		inter_unit_spacing		4.0
		priority			0.2
	end_block

	begin_block 7
		unit_type				heavy cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 10.0 0.0
		inter_unit_spacing		4.0
		priority			0.2
	end_block

	;; Light cav reserves for either wing
	;; left side
	begin_block 8
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		block_formation			line
		block_relative_pos		0 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.3
	end_block

	;; right side
	begin_block 9
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		block_formation			line
		block_relative_pos		0 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.3
	end_block

	begin_dummy_block 10
		spans	0 1 2 3 4 5 6 7 8 9
	end_dummy_block

	;; artillery and handler behind
	begin_block 11
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 12
		max_units				0
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		10 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.5
	end_block

end_formation


begin_formation ai_cavalry_approach

	;;; purpose flags - deploy, approaching, defending
	attack
	defend
	march

	ai_priority				3.50


	;; Cavalry centre
	begin_block 0
		min_units				1
		max_units				6
		unit_type				heavy cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	; screen
	begin_block 1
		max_units				4
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 50.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block


	;; light cav on either wing

	;; left side
	begin_block 2
		max_units				2
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		1 -20.0 0.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; right side
	begin_block 3
		max_units				2
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		1 20.0 0.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	;; general at the back
	begin_block 4
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 5
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		4 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; heavy cav behind centre
	begin_block 6
		unit_type				heavy cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 -10.0 0.0
		inter_unit_spacing		4.0
		priority			0.2
	end_block

	begin_block 7
		unit_type				heavy cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 10.0 0.0
		inter_unit_spacing		4.0
		priority			0.2
	end_block

	;; Light cav reserves for either wing
	;; left side
	begin_block 8
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		0 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.3
	end_block

	;; right side
	begin_block 9
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		0 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.3
	end_block

	begin_dummy_block 10
		spans	0 1 2 3 4 5 6 7 8 9
	end_dummy_block

	;; artillery and handler behind
	begin_block 11
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 12
		max_units				0
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		10 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.5
	end_block

end_formation



;****************************************************************
; Formation for light cavalry armies - created by Sinuhet
; take some elements from Pax Barbaricia/Barbarian Revenge's
; light cavalry formations
;****************************************************************

begin_formation ai_light_cavalry_march

	;;; purpose flags - regrouping
	march

	ai_priority				3.50

	;; Cavalry centre
	begin_block 0
		min_units				1
		max_units				6
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	; screen
	begin_block 1
		max_units				4
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		0 0.0 50.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block


	;; light cav on either wing

	;; left side
	begin_block 2
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		1 -20.0 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; right side
	begin_block 3
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		1 20.0 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; general at the back
	begin_block 4
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 5
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		4 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; light cav behind centre
	begin_block 6
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		5 -10.0 0.0
		inter_unit_spacing		4.0
		priority			0.2
	end_block

	begin_block 7
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		5 10.0 0.0
		inter_unit_spacing		4.0
		priority			0.2
	end_block

	;; Light cav reserves for either wing
	;; left side
	begin_block 8
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		0 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.3
	end_block

	;; right side
	begin_block 9
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		0 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.3
	end_block

	begin_dummy_block 10
		spans	0 1 2 3 4 5 6 7 8 9
	end_dummy_block

	;; artillery and handler behind
	begin_block 11
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			line
		block_relative_pos		10 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 12
		max_units				0
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		10 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.5
	end_block

end_formation


begin_formation ai_light_cavalry_attack

	;;; purpose flags - attacking
	attack
	march

	ai_priority				3.50

	;; Cavalry centre
	begin_block 0
		min_units				1
		max_units				6
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	; screen
	begin_block 1
		max_units				4
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 50.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block


	;; light cav on either wing

	;; left side
	begin_block 2
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		1 -20.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; right side
	begin_block 3
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		1 20.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; general at the back
	begin_block 4
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 5
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		4 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; light cav behind centre
	begin_block 6
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		block_formation			column
		block_relative_pos		5 -10.0 0.0
		inter_unit_spacing		4.0
		priority			0.2
	end_block

	begin_block 7
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		block_formation			column
		block_relative_pos		5 10.0 0.0
		inter_unit_spacing		4.0
		priority			0.2
	end_block

	;; Light cav reserves for either wing
	;; left side
	begin_block 8
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		block_formation			column
		block_relative_pos		0 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.3
	end_block

	;; right side
	begin_block 9
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		block_formation			column
		block_relative_pos		0 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.3
	end_block

	begin_dummy_block 10
		spans	0 1 2 3 4 5 6 7 8 9
	end_dummy_block

	;; artillery and handler behind
	begin_block 11
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 12
		max_units				0
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		10 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.5
	end_block

end_formation


begin_formation ai_light_cavalry_pursue

	;;; purpose flags - charging, pursue
	pursue
	march

	ai_priority				3.50

	;; Cavalry centre
	begin_block 0
		min_units				1
		max_units				6
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	; screen
	begin_block 1
		max_units				4
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 50.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block


	;; light cav on either wing

	;; left side
	begin_block 2
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		1 -20.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; right side
	begin_block 3
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		1 20.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; general at the back
	begin_block 4
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 -30.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 5
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		4 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; light cav behind centre
	begin_block 6
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		block_formation			line
		block_relative_pos		5 -10.0 0.0
		inter_unit_spacing		4.0
		priority			0.2
	end_block

	begin_block 7
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		block_formation			line
		block_relative_pos		5 10.0 0.0
		inter_unit_spacing		4.0
		priority			0.2
	end_block

	;; Light cav reserves for either wing
	;; left side
	begin_block 8
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		block_formation			line
		block_relative_pos		0 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.3
	end_block

	;; right side
	begin_block 9
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		block_formation			line
		block_relative_pos		0 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.3
	end_block

	begin_dummy_block 10
		spans	0 1 2 3 4 5 6 7 8 9
	end_dummy_block

	;; artillery and handler behind
	begin_block 11
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 12
		max_units				0
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		10 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.5
	end_block

end_formation


begin_formation ai_light_cavalry_approach

	;;; purpose flags - deploy, approaching, defending
	attack
	defend
	march

	ai_priority				3.50

	;; Cavalry centre
	begin_block 0
		min_units				1
		max_units				6
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

	; screen
	begin_block 1
		max_units				4
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 50.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block


	;; light cav on either wing

	;; left side
	begin_block 2
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		1 -20.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; right side
	begin_block 3
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		1 20.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; general at the back
	begin_block 4
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 5
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		4 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; light cav behind centre
	begin_block 6
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		5 -10.0 0.0
		inter_unit_spacing		4.0
		priority			0.2
	end_block

	begin_block 7
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		5 10.0 0.0
		inter_unit_spacing		4.0
		priority			0.2
	end_block

	;; Light cav reserves for either wing
	;; left side
	begin_block 8
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		0 -10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.3
	end_block

	;; right side
	begin_block 9
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		0 10.0 -20.0
		inter_unit_spacing		4.0
		priority			0.3
	end_block

	begin_dummy_block 10
		spans	0 1 2 3 4 5 6 7 8 9
	end_dummy_block

	;; artillery and handler behind
	begin_block 11
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	begin_block 12
		max_units				0
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		10 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.5
	end_block

end_formation



;****************************************************************
;****************************************************************
; Horse cultures' last resort formations
;****************************************************************
;****************************************************************

;**************************************************************************************************************************************
; Nomad formation (RTW). A really punishing formation for armies that use horse archery. Constant skirmishing and movement is main AI purpose.
; Modified by Suppanut by integrate element from DTW's and Sinuhet's infantry restriction to serve as generic last resort for Sarmatia and Parthia
;**************************************************************************************************************************************

begin_formation ai_nomadic_rtw_line_march

	;;; purpose flags - regrouping
	march

	ai_priority				2.15

	supported_factions			scythia

	;; the support cavalry (change to skirmish due to ai have problem of charge for no proper reason)
	begin_block 0
		not_general
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; melee cavalry
	begin_block 1
		max_units				4
		unit_type				heavy cavalry 1.0
;;		unit_type				spear cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 0.0 -30.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 2
		spans	0 1
	end_dummy_block

	;; horse archers left
	begin_block 3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			20
		block_formation			line
		block_relative_pos		2 -6.0 0.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	;; horse archers right
	begin_block 4
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			20
		block_formation			line
		block_relative_pos		2 6.0 0.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	begin_dummy_block 5
		spacer 50.0 50.0 50 50
	end_dummy_block

	;; The center will consist infantry in mixed formations
	begin_block 6
		max_units				2
		unit_type				phalanx 1.0
		;default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		5 0.0 -6.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; heavy and other infantry

	;; heavy infantry - left
	begin_block 7
		max_units				3
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		6 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; heavy infantry - right
	begin_block 8
		max_units				3
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		6 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; missile troops behind the spearmen and other infantry
	begin_block 9
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.9
		unit_type				skirmish infantry 0.4
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		6 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	begin_block 10
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.2
		unit_type				skirmish infantry 0.1
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		9 0.0 -5.0
		inter_unit_spacing		1.0
		priority			1.0
	end_block

	begin_dummy_block 11
		spans	5 6 7 8 9 10
	end_dummy_block

	;; commander at the back
	begin_block 12
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		11 0.0 -7.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 13
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		;unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		12 -10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 14
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		;unit_formation			square
		max_unit_width			15
		block_formation			line
		block_relative_pos		12 5.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_dummy_block 15
		spans	6 7 8 9 10 12 13 14
	end_dummy_block

	;; The center will consist infantry in mixed formations (2)
	begin_block 16
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		max_unit_width			15
		block_formation			line
		block_relative_pos		15 0.0 -3.0
		inter_unit_spacing		0.1
		priority			0.90
	end_block

	;; Cavalry ambush left
	begin_block 17
		not_general
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			15
		block_formation			line
		block_relative_pos		5 -25.0 0.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; support cavalry behind
	begin_block 18
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;unit_formation			square
		max_unit_width			15
		block_formation			square
		block_relative_pos		17 0.0 -3.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; Cavalry ambush right
	begin_block 19
		not_general
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			15
		block_formation			line
		block_relative_pos		5 25.0 0.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; support cavalry behind
	begin_block 20
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;unit_formation			square
		max_unit_width			15
		block_formation			line
		block_relative_pos		19 0.0 -3.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	begin_dummy_block 21
		spans	0 1 2 3 4 5 15 16 17 18 19 20
	end_dummy_block

	begin_block 22
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;unit_formation			square
		;default_melee_state		skirmish
		max_unit_width			20
		block_formation			column
		block_relative_pos		15 -20.0 1.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_block 23
		max_units				0
		not_general
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		21 0.0 -0.5
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation


begin_formation ai_nomadic_rtw_line_deploy

	;;; purpose flags - deploy, defending
	defend
	march

	ai_priority				2.15

	supported_factions			scythia

	;; the support cavalry (change to skirmish due to ai have problem of charge for no proper reason)
	begin_block 0
		not_general
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		20.0
		priority			1.0
	end_block

	;; melee cavalry
	begin_block 1
		max_units				4
		unit_type				heavy cavalry 1.0
;;		unit_type				spear cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 2
		spans	0 1
	end_dummy_block

	;; horse archers left
	begin_block 3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		2 -6.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; horse archers right
	begin_block 4
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		2 6.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 5
		spacer 50.0 50.0 50 50
	end_dummy_block

	;; The center will consist infantry in mixed formations
	begin_block 6
		max_units				2
		unit_type				phalanx 1.0
		default_melee_state		defend
		unit_formation			phalanx
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 0.0 -6.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; heavy and other infantry

	;; heavy infantry - left
	begin_block 7
		max_units				3
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		6 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; heavy infantry - right
	begin_block 8
		max_units				3
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		6 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; missile troops behind the spearmen and other infantry
	begin_block 9
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.9
		unit_type				skirmish infantry 0.4
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 0.0 -30.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	begin_block 10
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.2
		unit_type				skirmish infantry 0.1
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 0.0 -5.0
		inter_unit_spacing		1.0
		priority			1.0
	end_block

	begin_dummy_block 11
		spans	5 6 7 8 9 10
	end_dummy_block

	;; commander at the back
	begin_block 12
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 13
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		12 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 14
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		13 5.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_dummy_block 15
		spans	6 7 8 9 10 11 12 13 14
	end_dummy_block

	;; The center will consist infantry in mixed formations (2)
	begin_block 16
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		15 0.0 -3.0
		inter_unit_spacing		0.1
		priority			0.90
	end_block

	;; Cavalry ambush left
	begin_block 17
		not_general
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		5 -25.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; support cavalry behind
	begin_block 18
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		17 0.0 -3.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; Cavalry ambush right
	begin_block 19
		not_general
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		5 25.0 0.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; support cavalry behind
	begin_block 20
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		19 0.0 -3.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	begin_dummy_block 21
		spans	0 1 2 3 4 5 15 16 17 18 19 20
	end_dummy_block

	begin_block 22
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		21 -20.0 -5.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_block 23
		max_units				0
		not_general
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		21 0.0 -0.5
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation


;The formation will not change. Same strategy will be used also.Just for AI purposes it is produced(included some offsets for more cautious AI attack).The AI will curse human army with endless missile rain and pointless chase.
begin_formation ai_nomadic_rtw_line_attack

	;;; purpose flags - attacking
	attack
	march

	ai_priority				2.15

	supported_factions			scythia

	;; the support cavalry (change to skirmish due to ai have problem of charge for no proper reason)
	begin_block 0
		not_general
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		30.0
		priority			1.0
	end_block

	;; melee cavalry
	begin_block 1
		max_units				4
		unit_type				heavy cavalry 1.0
;;		unit_type				spear cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -30.0
		inter_unit_spacing		30.0
		priority			1.0
	end_block

	begin_dummy_block 2
		spans	0 1
	end_dummy_block

	;; horse archers left
	begin_block 3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			line
		block_relative_pos		2 -6.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; horse archers right
	begin_block 4
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			line
		block_relative_pos		2 6.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 5
		spacer 50.0 50.0 50 50
	end_dummy_block

	;; The center will consist infantry in mixed formations
	begin_block 6
		max_units				2
		unit_type				phalanx 1.0
		default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 0.0 -6.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; heavy and other infantry

	;; heavy infantry - left
	begin_block 7
		max_units				3
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		;unit_density			close
		block_formation			line
		block_relative_pos		6 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; heavy infantry - right
	begin_block 8
		max_units				3
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		;unit_density			close
		block_formation			line
		block_relative_pos		6 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; missile troops behind the spearmen and other infantry
	begin_block 9
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.9
		unit_type				skirmish infantry 0.4
		default_melee_state		fire_at_will_and_defend
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	begin_block 10
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.2
		unit_type				skirmish infantry 0.1
		default_melee_state		fire_at_will_and_defend
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		7 0.0 -5.0
		inter_unit_spacing		1.0
		priority			1.0
	end_block

	begin_dummy_block 11
		spans	5 6 7 8 9 10
	end_dummy_block

	;; commander at the back
	begin_block 12
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 13
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		12 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 14
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		;unit_formation			square
		max_unit_width			24
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_dummy_block 15
		spans	6 7 8 9 10 11 12 13 14
	end_dummy_block

	;; The center will consist infantry in mixed formations (2)
	begin_block 16
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		max_unit_width			24
		block_formation			line
		block_relative_pos		15 0.0 -3.0
		inter_unit_spacing		0.1
		priority			0.90
	end_block

	;; Cavalry ambush left
	begin_block 17
		not_general
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			line
		block_relative_pos		5 -25.0 -25.0
		inter_unit_spacing		20.0
		priority			0.5
	end_block

	;; support cavalry behind
	begin_block 18
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			line
		block_relative_pos		17 0.0 -3.0
		inter_unit_spacing		15.0
		priority			0.5
	end_block

	;; Cavalry ambush right
	begin_block 19
		not_general
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			line
		block_relative_pos		5 25.0 -25.0
		inter_unit_spacing		20.0
		priority			0.5
	end_block

	;; support cavalry behind
	begin_block 20
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			line
		block_relative_pos		19 0.0 -3.0
		inter_unit_spacing		15.0
		priority			0.5
	end_block

	begin_dummy_block 21
		spans	0 1 2 3 4 5 15 16 17 18 19 20
	end_dummy_block

	begin_block 22
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;unit_formation			square
		;default_melee_state		skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		15 -30.0 20.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_block 23
		max_units				0
		not_general
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		21 0.0 -0.5
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation


begin_formation ai_nomadic_rtw_line_pursue

	;;; purpose flags - charging, pursue
	pursue
	march

	ai_priority				2.15

	supported_factions			scythia

	;; the support cavalry (ready to charge where is needed)
	begin_block 0
		not_general
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		30.0
		priority			1.0
	end_block

	;; melee cavalry
	begin_block 1
		max_units				4
		unit_type				heavy cavalry 1.0
;;		unit_type				spear cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -30.0
		inter_unit_spacing		30.0
		priority			1.0
	end_block

	begin_dummy_block 2
		spans	0 1
	end_dummy_block

	;; horse archers left
	begin_block 3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			line
		block_relative_pos		2 -6.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; horse archers right
	begin_block 4
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			line
		block_relative_pos		2 6.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 5
		spacer 50.0 50.0 50 50
	end_dummy_block

	;; The center will consist infantry in mixed formations
	begin_block 6
		max_units				2
		unit_type				phalanx 1.0
		default_melee_state		defend
		unit_formation			phalanx
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 0.0 -6.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; heavy and other infantry

	;; heavy infantry - left
	begin_block 7
		max_units				3
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		;unit_density			close
		block_formation			line
		block_relative_pos		6 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; heavy infantry - right
	begin_block 8
		max_units				3
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		;unit_density			close
		block_formation			line
		block_relative_pos		6 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; missile troops behind the spearmen and other infantry
	begin_block 9
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.9
		unit_type				skirmish infantry 0.4
		default_melee_state		fire_at_will_and_defend
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	begin_block 10
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.2
		unit_type				skirmish infantry 0.1
		default_melee_state		fire_at_will_and_defend
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 0.0 -5.0
		inter_unit_spacing		1.0
		priority			1.0
	end_block

	begin_dummy_block 11
		spans	5 6 7 8 9 10
	end_dummy_block

	;; general at the center
	begin_block 12
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		11 0.0 -30.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 13
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		12 -10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 14
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		;unit_formation			square
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 5.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_dummy_block 15
		spans	6 7 8 9 10 12 13 14
	end_dummy_block

	;; The center will consist infantry in mixed formations (2)
	begin_block 16
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		max_unit_width			24
		block_formation			line
		block_relative_pos		15 0.0 -3.0
		inter_unit_spacing		0.2
		priority			0.90
	end_block

	;; Cavalry ambush left
	begin_block 17
		not_general
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			line
		block_relative_pos		5 -25.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; support cavalry behind
	begin_block 18
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			line
		block_relative_pos		17 0.0 -3.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; Cavalry ambush right
	begin_block 19
		not_general
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			line
		block_relative_pos		5 25.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; support cavalry behind
	begin_block 20
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			line
		block_relative_pos		19 0.0 -3.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	begin_dummy_block 21
		spans	0 1 2 3 4 5 15 16 17 18 19 20
	end_dummy_block

	begin_block 22
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;unit_formation			square
		;default_melee_state		skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		15 5.0 10.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_block 23
		max_units				0
		not_general
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		21 0.0 -0.5
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation


begin_formation ai_nomadic_rtw_line_approach

	;;; purpose flags - approaching
	attack
	defend
	march

	ai_priority				2.15

	supported_factions			scythia

	;; the support cavalry (change to skirmish due to ai have problem of charge for no proper reason)
	begin_block 0
		not_general
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		20.0
		priority			1.0
	end_block

	;; melee cavalry
	begin_block 1
		max_units				4
		unit_type				heavy cavalry 1.0
;;		unit_type				spear cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		20.0
		priority			1.0
	end_block

	begin_dummy_block 2
		spans	0 1
	end_dummy_block

	;; horse archers left
	begin_block 3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		2 -6.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; horse archers right
	begin_block 4
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		2 6.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 5
		spacer 50.0 50.0 50 50
	end_dummy_block

	;; The center will consist infantry in mixed formations
	begin_block 6
		max_units				2
		unit_type				phalanx 1.0
		default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 0.0 -6.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; heavy and other infantry

	;; heavy infantry - left
	begin_block 7
		max_units				3
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		6 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; heavy infantry - right
	begin_block 8
		max_units				3
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		6 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; missile troops behind the spearmen and other infantry
	begin_block 9
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.9
		unit_type				skirmish infantry 0.4
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 0.0 -30.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	begin_block 10
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.2
		unit_type				skirmish infantry 0.1
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 0.0 -5.0
		inter_unit_spacing		1.0
		priority			1.0
	end_block

	begin_dummy_block 11
		spans	5 6 7 8 9 10
	end_dummy_block

	;; commander at the back
	begin_block 12
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 13
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		12 -10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 14
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 5.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_dummy_block 15
		spans	6 7 8 9 10 12 13 14
	end_dummy_block

	;; The center will consist infantry in mixed formations (2)
	begin_block 16
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		15 0.0 -3.0
		inter_unit_spacing		0.2
		priority			0.90
	end_block

	;; Cavalry ambush left
	begin_block 17
		not_general
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		5 -25.0 0.0
		inter_unit_spacing		20.0
		priority			0.5
	end_block

	;; support cavalry behind
	begin_block 18
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		17 0.0 -3.0
		inter_unit_spacing		20.0
		priority			0.5
	end_block

	;; Cavalry ambush right
	begin_block 19
		not_general
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		5 25.0 0.0
		inter_unit_spacing		20.0
		priority			0.5
	end_block

	;; support cavalry behind
	begin_block 20
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		19 0.0 -3.0
		inter_unit_spacing		20.0
		priority			0.5
	end_block

	begin_dummy_block 21
		spans	0 1 2 3 4 5 15 16 17 18 19 20
	end_dummy_block

	begin_block 22
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;unit_formation			square
		;default_melee_state		skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		15 -20.0 1.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_block 23
		max_units				0
		not_general
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		21 0.0 -0.5
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation



;**************************************************************************************************************************************
; Nomad formation (BI). A really punishing formation for armies that use horse archery. Constant skirmishing and movement is main AI purpose.
; Modified by Suppanut by integrate element from DTW's and Sinuhet's infantry restriction to serve as generic last resort for Tukhara
;**************************************************************************************************************************************

begin_formation ai_nomadic_bi_line_march

	;;; purpose flags - regrouping
	march

	ai_priority				2.15

	supported_factions			parthia

	;; the support cavalry (change to skirmish due to ai have problem of charge for no proper reason)
	begin_block 0
		not_general
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 1.0
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; melee cavalry
	begin_block 1
		max_units				4
		unit_type				heavy cavalry 1.0
;;		unit_type				spear cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			15
		block_formation			line
		block_relative_pos		0 0.0 -30.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 2
		spans	0 1
	end_dummy_block

	;; horse archers left
	begin_block 3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			20
		block_formation			line
		block_relative_pos		2 -6.0 0.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	;; horse archers right
	begin_block 4
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			20
		block_formation			line
		block_relative_pos		2 6.0 0.0
		inter_unit_spacing		6.0
		priority			1.0
	end_block

	begin_dummy_block 5
		spacer 50.0 50.0 50 50
	end_dummy_block

	;; The center will consist infantry in mixed formations
	begin_block 6
		max_units				2
		unit_type				phalanx 1.0
		;default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		5 0.0 -6.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; heavy and other infantry

	;; heavy infantry - left
	begin_block 7
		max_units				3
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		6 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; heavy infantry - right
	begin_block 8
		max_units				3
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		6 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; missile troops behind the spearmen and other infantry
	begin_block 9
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.9
		unit_type				skirmish infantry 0.4
		default_melee_state		fire_at_will_and_defend
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		6 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	begin_block 10
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.2
		unit_type				skirmish infantry 0.1
		default_melee_state		fire_at_will_and_defend
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		9 0.0 -5.0
		inter_unit_spacing		1.0
		priority			1.0
	end_block

	begin_dummy_block 11
		spans	5 6 7 8 9 10
	end_dummy_block

	;; commander at the back
	begin_block 12
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		11 0.0 -7.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 13
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		12 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 14
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		;unit_formation			square
		max_unit_width			15
		block_formation			line
		block_relative_pos		13 5.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_dummy_block 15
		spans	6 7 8 9 10 12 13 14
	end_dummy_block

	;; The center will consist infantry in mixed formations (2)
	begin_block 16
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		max_unit_width			24
		block_formation			line
		block_relative_pos		15 0.0 -3.0
		inter_unit_spacing		0.1
		priority			0.90
	end_block

	;; Cavalry ambush left
	begin_block 17
		not_general
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			15
		block_formation			line
		block_relative_pos		5 -25.0 0.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; support cavalry behind
	begin_block 18
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;unit_formation			square, wedge
		max_unit_width			15
		block_formation			line
		block_relative_pos		17 0.0 -3.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; Cavalry ambush right
	begin_block 19
		not_general
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			15
		block_formation			line
		block_relative_pos		5 25.0 0.0
		inter_unit_spacing		20.0
		priority			0.5
	end_block

	;; support cavalry behind
	begin_block 20
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;unit_formation			square, wedge
		max_unit_width			15
		block_formation			line
		block_relative_pos		19 0.0 -3.0
		inter_unit_spacing		20.0
		priority			0.5
	end_block

	begin_dummy_block 21
		spans	0 1 2 3 4 5 15 16 17 18 19 20
	end_dummy_block

	begin_block 22
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;unit_formation			square
		;default_melee_state		skirmish
		max_unit_width			20
		block_formation			column
		block_relative_pos		15 -20.0 1.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_block 23
		max_units				0
		not_general
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		21 0.0 -0.5
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation


begin_formation ai_nomadic_bi_line_deploy

	;;; purpose flags - deploy, defending
	defend
	march

	ai_priority				2.15

	supported_factions			parthia

	;; the support cavalry (change to skirmish due to ai have problem of charge for no proper reason)
	begin_block 0
		not_general
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		20.0
		priority			1.0
	end_block

	;; melee cavalry
	begin_block 1
		max_units				4
		unit_type				heavy cavalry 1.0
;;		unit_type				spear cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 2
		spans	0 1
	end_dummy_block

	;; horse archers left
	begin_block 3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		2 -6.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; horse archers right
	begin_block 4
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		2 6.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 5
		spacer 50.0 50.0 50 50
	end_dummy_block

	;; The center will consist infantry in mixed formations
	begin_block 6
		max_units				2
		unit_type				phalanx 1.0
		default_melee_state		defend
		unit_formation			phalanx
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 0.0 -6.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; heavy and other infantry

	;; heavy infantry - left
	begin_block 7
		max_units				3
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		6 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; heavy infantry - right
	begin_block 8
		max_units				3
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		6 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; missile troops behind the spearmen and other infantry
	begin_block 9
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.9
		unit_type				skirmish infantry 0.4
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 0.0 -30.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	begin_block 10
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.2
		unit_type				skirmish infantry 0.1
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 0.0 -5.0
		inter_unit_spacing		1.0
		priority			1.0
	end_block

	begin_dummy_block 11
		spans	5 6 7 8 9 10
	end_dummy_block

	;; commander at the back
	begin_block 12
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 13
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		12 0.0 -10.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 14
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		13 5.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_dummy_block 15
		spans	6 7 8 9 10 12 13 14
	end_dummy_block

	;; The center will consist infantry in mixed formations (2)
	begin_block 16
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		15 0.0 -3.0
		inter_unit_spacing		0.1
		priority			0.90
	end_block

	;; Cavalry ambush left
	begin_block 17
		not_general
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		5 -25.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; support cavalry behind
	begin_block 18
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		17 0.0 -3.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; Cavalry ambush right
	begin_block 19
		not_general
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		5 25.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; support cavalry behind
	begin_block 20
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		19 0.0 -3.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	begin_dummy_block 21
		spans	0 1 2 3 4 5 15 16 17 18 19 20
	end_dummy_block

	begin_block 22
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;unit_formation			square
		;default_melee_state		skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		21 -20.0 -5.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_block 23
		max_units				0
		not_general
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		21 0.0 -0.5
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation


;The formation will not change. Same strategy will be used also.Just for AI purposes it is produced(included some offsets for more cautious AI attack).The AI will curse human army with endless missile rain and pointless chase.
begin_formation ai_nomadic_bi_line_attack

	;;; purpose flags - attacking
	attack
	march

	ai_priority				2.15

	supported_factions			parthia

	;; the support cavalry (change to skirmish due to ai have problem of charge for no proper reason)
	begin_block 0
		not_general
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		30.0
		priority			1.0
	end_block

	;; melee cavalry
	begin_block 1
		max_units				4
		unit_type				heavy cavalry 1.0
;;		unit_type				spear cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 30.0
		inter_unit_spacing		30.0
		priority			1.0
	end_block

	begin_dummy_block 2
		spans	0 1
	end_dummy_block

	;; horse archers left
	begin_block 3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			line
		block_relative_pos		2 -6.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; horse archers right
	begin_block 4
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			line
		block_relative_pos		2 6.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 5
		spacer 50.0 50.0 50 50
	end_dummy_block

	;; The center will consist infantry in mixed formations
	begin_block 6
		max_units				2
		unit_type				phalanx 1.0
		default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 0.0 -6.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; heavy and other infantry

	;; heavy infantry - left
	begin_block 7
		max_units				3
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		;unit_density			close
		block_formation			line
		block_relative_pos		6 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; heavy infantry - right
	begin_block 8
		max_units				3
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		;unit_density			close
		block_formation			line
		block_relative_pos		6 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; missile troops behind the spearmen and other infantry
	begin_block 9
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.9
		unit_type				skirmish infantry 0.4
		default_melee_state		fire_at_will_and_defend
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	begin_block 10
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.2
		unit_type				skirmish infantry 0.1
		default_melee_state		fire_at_will_and_defend
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		7 0.0 -5.0
		inter_unit_spacing		1.0
		priority			1.0
	end_block

	begin_dummy_block 11
		spans	5 6 7 8 9 10
	end_dummy_block

	;; commander at the back
	begin_block 12
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 13
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		12 -10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 14
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		;unit_formation			square
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 5.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_dummy_block 15
		spans	6 7 8 9 10 12 13 14
	end_dummy_block

	;; The center will consist infantry in mixed formations (2)
	begin_block 16
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		max_unit_width			24
		block_formation			line
		block_relative_pos		15 0.0 -3.0
		inter_unit_spacing		0.1
		priority			0.90
	end_block

	;; Cavalry ambush left
	begin_block 17
		not_general
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			line
		block_relative_pos		5 -45.0 -25.0
		inter_unit_spacing		20.0
		priority			0.5
	end_block

	;; support cavalry behind
	begin_block 18
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			line
		block_relative_pos		17 0.0 -3.0
		inter_unit_spacing		15.0
		priority			0.5
	end_block

	;; Cavalry ambush right
	begin_block 19
		not_general
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			line
		block_relative_pos		5 45.0 -25.0
		inter_unit_spacing		20.0
		priority			0.5
	end_block

	;; support cavalry behind
	begin_block 20
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			line
		block_relative_pos		19 0.0 -3.0
		inter_unit_spacing		15.0
		priority			0.5
	end_block

	begin_dummy_block 21
		spans	0 1 2 3 4 5 15 16 17 18 19 20
	end_dummy_block

	begin_block 22
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;unit_formation			square
		;default_melee_state		skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		15 -30.0 20.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_block 23
		max_units				0
		not_general
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		21 0.0 -0.5
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation


begin_formation ai_nomadic_bi_line_pursue

	;;; purpose flags - charging, pursue
	pursue

	ai_priority				2.15

	supported_factions			parthia

	;; the support cavalry (ready to charge where is needed)
	begin_block 0
		not_general
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		30.0
		priority			1.0
	end_block

	;; melee cavalry
	begin_block 1
		max_units				4
		unit_type				heavy cavalry 1.0
;;		unit_type				spear cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		30.0
		priority			1.0
	end_block

	begin_dummy_block 2
		spans	0 1
	end_dummy_block

	;; horse archers left
	begin_block 3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			line
		block_relative_pos		2 -6.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; horse archers right
	begin_block 4
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			line
		block_relative_pos		2 6.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 5
		spacer 50.0 50.0 50 50
	end_dummy_block

	;; The center will consist infantry in mixed formations
	begin_block 6
		max_units				2
		unit_type				phalanx 1.0
		default_melee_state		defend
		unit_formation			phalanx
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 0.0 -6.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; heavy and other infantry

	;; heavy infantry - left
	begin_block 7
		max_units				3
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		;unit_density			close
		block_formation			line
		block_relative_pos		6 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; heavy infantry - right
	begin_block 8
		max_units				3
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		;unit_density			close
		block_formation			line
		block_relative_pos		6 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; missile troops behind the spearmen and other infantry
	begin_block 9
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.9
		unit_type				skirmish infantry 0.4
		default_melee_state		fire_at_will_and_defend
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	begin_block 10
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.2
		unit_type				skirmish infantry 0.1
		default_melee_state		fire_at_will_and_defend
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 0.0 -5.0
		inter_unit_spacing		1.0
		priority			1.0
	end_block

	begin_dummy_block 11
		spans	5 6 7 8 9 10
	end_dummy_block

	;; general at the center
	begin_block 12
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		11 0.0 -30.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 13
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		12 -10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 14
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		;unit_formation			square
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 5.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_dummy_block 15
		spans	6 7 8 9 10 12 13 14
	end_dummy_block

	;; The center will consist infantry in mixed formations (2)
	begin_block 16
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		max_unit_width			24
		block_formation			line
		block_relative_pos		15 0.0 -3.0
		inter_unit_spacing		0.2
		priority			0.90
	end_block

	;; Cavalry ambush left
	begin_block 17
		not_general
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			line
		block_relative_pos		5 -35.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; support cavalry behind
	begin_block 18
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			line
		block_relative_pos		17 0.0 -3.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	;; Cavalry ambush right
	begin_block 19
		not_general
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			line
		block_relative_pos		5 35.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; support cavalry behind
	begin_block 20
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			line
		block_relative_pos		19 0.0 -3.0
		inter_unit_spacing		6.0
		priority			0.5
	end_block

	begin_dummy_block 21
		spans	0 1 2 3 4 5 15 16 17 18 19 20
	end_dummy_block

	begin_block 22
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;unit_formation			square
		;default_melee_state		skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		15 5.0 10.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_block 23
		max_units				0
		not_general
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		21 0.0 -0.5
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation


begin_formation ai_nomadic_bi_line_approach

	;;; purpose flags - approaching
	attack
	defend

	ai_priority				2.15

	supported_factions			parthia

	;; the support cavalry (change to skirmish due to ai have problem of charge for no proper reason)
	begin_block 0
		not_general
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		20.0
		priority			1.0
	end_block

	;; melee cavalry
	begin_block 1
		max_units				4
		unit_type				heavy cavalry 1.0
;;		unit_type				spear cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 10.0
		inter_unit_spacing		20.0
		priority			1.0
	end_block

	begin_dummy_block 2
		spans	0 1
	end_dummy_block

	;; horse archers left
	begin_block 3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		2 -6.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; horse archers right
	begin_block 4
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		2 6.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 5
		spacer 50.0 50.0 50 50
	end_dummy_block

	;; The center will consist infantry in mixed formations
	begin_block 6
		max_units				2
		unit_type				phalanx 1.0
		default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 0.0 -6.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; heavy and other infantry

	;; heavy infantry - left
	begin_block 7
		max_units				3
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		6 -1.5 0.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; heavy infantry - right
	begin_block 8
		max_units				3
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		6 1.5 0.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	;; missile troops behind the spearmen and other infantry
	begin_block 9
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.9
		unit_type				skirmish infantry 0.4
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 0.0 -30.0
		inter_unit_spacing		2.0
		priority			0.90
	end_block

	begin_block 10
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 0.2
		unit_type				skirmish infantry 0.1
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 0.0 -5.0
		inter_unit_spacing		1.0
		priority			1.0
	end_block

	begin_dummy_block 11
		spans	5 6 7 8 9 10
	end_dummy_block

	;; commander at the back
	begin_block 12
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 13
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		12 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 14
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		13 5.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_dummy_block 15
		spans	6 7 8 9 10 12 13 14
	end_dummy_block

	;; The center will consist infantry in mixed formations (2)
	begin_block 16
		max_units				7
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		15 0.0 -3.0
		inter_unit_spacing		0.2
		priority			0.90
	end_block

	;; Cavalry ambush left
	begin_block 17
		not_general
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		5 -35.0 0.0
		inter_unit_spacing		20.0
		priority			0.5
	end_block

	;; support cavalry behind
	begin_block 18
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		17 0.0 -3.0
		inter_unit_spacing		20.0
		priority			0.5
	end_block

	;; Cavalry ambush right
	begin_block 19
		not_general
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		5 35.0 0.0
		inter_unit_spacing		20.0
		priority			0.5
	end_block

	;; support cavalry behind
	begin_block 20
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		19 0.0 -3.0
		inter_unit_spacing		20.0
		priority			0.5
	end_block

	begin_dummy_block 21
		spans	0 1 2 3 4 5 15 16 17 18 19 20
	end_dummy_block

	begin_block 22
		;not_general
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;unit_formation			square
		;default_melee_state		skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		15 -20.0 1.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	begin_block 23
		max_units				0
		not_general
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		21 0.0 -0.5
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation



;****************************************************************
;****************************************************************
; Standard formation section, All last resorts are here
;****************************************************************
;****************************************************************

;****************************************************************
;Standard formation. Infantry line in front, missiles behind
;cav on the wings (modified by Sinuhet)
;****************************************************************

begin_formation ai_standard_line_2_march

	;;; purpose flags - regrouping
	march

	;; decreased AI priority - Sinuhet
	ai_priority				1.90

	;; center - main phalanx battleline
	begin_block 0
		min_units				1
		not_general
		unit_type				phalanx 1.0
		;default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; center - main reserve
	begin_block 1
		unit_type				general_unit infantry 3.0
		unit_type				spearmen_pilum_infantry 1.0
		unit_type				light_pilum_infantry 1.0
		unit_type				light infantry 0.1
		;default_melee_state		fire_at_will
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 -7.0
		inter_unit_spacing		12.0
		priority			0.9
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side - heavy infantry in close to phalanx
	begin_block 2
		not_general
		unit_type				heavy infantry 0.7
		;default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		0 -0.5 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; right side - heavy infantry in close to phalanx
	begin_block 3
		not_general
		unit_type				heavy infantry 0.7
		;default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		;unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		0 0.5 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; left side - spearmen on the flank
	begin_block 4
		not_general
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		max_unit_width			20
		block_formation			line
		block_relative_pos		2 -2.0 0.0
		inter_unit_spacing		0.1
		priority			0.65
	end_block

	;; right side - spearmen on the flank
	begin_block 5
		not_general
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		max_unit_width			20
		block_formation			line
		block_relative_pos		3 2.0 0.0
		inter_unit_spacing		0.1
		priority			0.6
	end_block

	;; light infantry behind left flank
	begin_block 6
		not_general
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		max_unit_width			20
		block_formation			column
		block_relative_pos		2 0.0 -8.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; light infantry behind right flank
	begin_block 7
		not_general
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will
		max_unit_width			20
		block_formation			column
		block_relative_pos		3 0.0 -8.0
		inter_unit_spacing		2.0
		priority			0.65
	end_block

	begin_dummy_block 8
		spans	0 1 2 3 4 5 6 7
	end_dummy_block

	;; missile screen in front of the phalanx line
	begin_block 9
		max_units				5
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		;default_melee_state		fire_at_will
		;unit_density			close		; always deploy and defend as close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 10.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; missile troops behind the centre
	begin_block 10
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_defend
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	begin_dummy_block 11
		spans	0 1 2 3 4 5 6 7 8 9 10
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 12
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			square
		block_relative_pos		11 -5.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 13
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			square
		block_relative_pos		11 5.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav and chariots
	begin_block 14
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		12 -5.0 0.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank elephants, infront of left flank cavalry
	begin_block 15
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		12 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank missile cav and chariots
	begin_block 16
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		13 5.0 0.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; right flank elephants, infront of right flank cavalry
	begin_block 17
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		13 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; general behind left flank cavalry
	begin_block 18
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 19
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		18 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 20
		spans	0 1 2 3 4 5 6 7 8 9 10 18 19
	end_dummy_block

	;; any behind
	begin_block 21
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		20 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 22
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			line
		block_relative_pos		20 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 23
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			column
		block_relative_pos		8 -20.0 1.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

end_formation


begin_formation ai_standard_line_2_attack

	;;; purpose flags - attacking
	attack

	;; decreased AI priority - Sinuhet
	ai_priority				1.90

	;; center - main phalanx battleline
	begin_block 0
		min_units				1
		not_general
		unit_type				phalanx 1.0
		default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; center - main reserve
	begin_block 1
		unit_type				general_unit infantry 3.0
		unit_type				spearmen_pilum_infantry 1.0
		unit_type				light_pilum_infantry 1.0
		unit_type				light infantry 0.1
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -7.0
		inter_unit_spacing		12.0
		priority			0.9
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side - heavy infantry in close to phalanx
	begin_block 2
		not_general
		unit_type				heavy infantry 0.7
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		;unit_density			close
		block_formation			line
		block_relative_pos		0 -0.3 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; right side - heavy infantry in close to phalanx
	begin_block 3
		not_general
		unit_type				heavy infantry 0.7
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		;unit_density			close
		block_formation			line
		block_relative_pos		0 0.3 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; left side - spearmen on the flank
	begin_block 4
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		max_unit_width			24
		block_formation			line
		block_relative_pos		2 -2.0 0.0
		inter_unit_spacing		0.1
		priority			0.65
	end_block

	;; right side - spearmen on the flank
	begin_block 5
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		max_unit_width			24
		block_formation			line
		block_relative_pos		3 2.0 0.0
		inter_unit_spacing		0.1
		priority			0.6
	end_block

	;; light infantry behind left flank
	begin_block 6
		not_general
		unit_type				light infantry 1.0
		default_melee_state		fire_at_will
		block_formation			line
		block_relative_pos		2 0.0 -8.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; light infantry behind right flank
	begin_block 7
		not_general
		unit_type				light infantry 1.0
		default_melee_state		fire_at_will
		block_formation			line
		block_relative_pos		3 0.0 -8.0
		inter_unit_spacing		2.0
		priority			0.65
	end_block

	begin_dummy_block 8
		spans	0 1 2 3 4 5 6 7
	end_dummy_block

	;; missile screen in front of the phalanx line
	begin_block 9
		max_units				5
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 10.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; missile troops behind the centre
	begin_block 10
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.4
	end_block

	begin_dummy_block 11
		spans	0 1 2 3 4 5 6 7 8 9 10
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 12
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		11 -20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 13
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		11 20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav and chariots
	begin_block 14
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		12 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; left flank elephants, infront of left flank cavalry
	begin_block 15
		not_general
		unit_type				elephants 3.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			40
		block_formation			line
		block_relative_pos		12 -5.0 6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank missile cav and chariots
	begin_block 16
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		13 5.0 6.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank elephants, infront of right flank cavalry
	begin_block 17
		not_general
		unit_type				elephants 3.0
		max_unit_width			40
		block_formation			line
		block_relative_pos		13 5.0 0.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; general behind left flank cavalry
	begin_block 18
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 19
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		18 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 20
		spans	0 1 2 3 4 5 6 7 8 9 10 18 19
	end_dummy_block

	;; any behind
	begin_block 21
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		20 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 22
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		20 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 23
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		max_unit_width			30
		block_formation			line
		block_relative_pos		11 -30.0 20.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

end_formation


begin_formation ai_standard_line_2_pursue

	;;; purpose flags - charging, pursue
	pursue

	;;; decreased AI priority - Sinuhet
	ai_priority				1.90

	;; center - main phalanx battleline
	begin_block 0
		min_units				1
		not_general
		unit_type				phalanx 1.0
		default_melee_state		defend
		unit_formation			phalanx
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; center - main reserve
	begin_block 1
		unit_type				general_unit infantry 3.0
		unit_type				spearmen_pilum_infantry 1.0
		unit_type				light_pilum_infantry 1.0
		unit_type				light infantry 0.1
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -7.0
		inter_unit_spacing		12.0
		priority			0.9
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side - heavy infantry in close to phalanx
	begin_block 2
		not_general
		unit_type				heavy infantry 0.7
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		block_formation			line
		block_relative_pos		0 -0.5 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; right side - heavy infantry in close to phalanx
	begin_block 3
		not_general
		unit_type				heavy infantry 0.7
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		block_formation			line
		block_relative_pos		0 0.5 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; left side - spearmen on the flank
	begin_block 4
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		max_unit_width			24
		block_formation			line
		block_relative_pos		2 -2.0 0.0
		inter_unit_spacing		0.1
		priority			0.65
	end_block

	;; right side - spearmen on the flank
	begin_block 5
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		max_unit_width			24
		block_formation			line
		block_relative_pos		3 2.0 0.0
		inter_unit_spacing		0.1
		priority			0.6
	end_block

	;; light infantry behind left flank
	begin_block 6
		not_general
		unit_type				light infantry 1.0
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		block_formation			line
		block_relative_pos		2 0.0 -8.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; light infantry behind right flank
	begin_block 7
		not_general
		unit_type				light infantry 1.0
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		block_formation			line
		block_relative_pos		3 0.0 -8.0
		inter_unit_spacing		2.0
		priority			0.65
	end_block

	begin_dummy_block 8
		spans	0 1 2 3 4 5 6 7
	end_dummy_block

	;; missile screen in front of the phalanx line
	begin_block 9
		max_units				5
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		;default_melee_state		fire_at_will
		;unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		2.0
		priority			0.4
	end_block

	;; missile troops behind the centre
	begin_block 10
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.4
	end_block

	begin_dummy_block 11
		spans	0 1 2 3 4 5 6 7 8 9 10
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 12
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		11 -20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 13
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		11 20.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav and chariots
	begin_block 14
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		12 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; left flank elephants, beside of left flank cavalry
	begin_block 15
		not_general
		unit_type				elephants 3.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			40
		block_formation			line
		block_relative_pos		12 5.0 -6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank missile cav and chariots
	begin_block 16
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		13 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank elephants, beside of right flank cavalry
	begin_block 17
		not_general
		unit_type				elephants 3.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			40
		block_formation			line
		block_relative_pos		13 -5.0 -6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; general behind left flank cavalry
	begin_block 18
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		11 0.0 -30.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 19
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		18 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 20
		spans	0 1 2 3 4 5 6 7 8 9 10 18 19
	end_dummy_block

	;; any behind
	begin_block 21
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		20 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 22
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		20 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 23
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		max_unit_width			30
		block_formation			line
		block_relative_pos		8 5.0 10.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

end_formation


begin_formation ai_standard_line_2_approach

	;;; purpose flags - deploy, approaching
	attack
	defend

	;; decreased AI priority - Sinuhet
	ai_priority				1.90

	;; center - main phalanx battleline
	begin_block 0
		min_units				1
		not_general
		unit_type				phalanx 1.0
		default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; center - main reserve
	begin_block 1
		unit_type				general_unit infantry 3.0
		unit_type				spearmen_pilum_infantry 1.0
		unit_type				light_pilum_infantry 1.0
		unit_type				light infantry 0.1
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -7.0
		inter_unit_spacing		12.0
		priority			0.9
	end_block

	;; heavy and light infantry either side of the spearmen

	;; left side - heavy infantry in close to phalanx
	begin_block 2
		not_general
		unit_type				heavy infantry 0.7
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		0 -0.5 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; right side - heavy infantry in close to phalanx
	begin_block 3
		not_general
		unit_type				heavy infantry 0.7
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		0 0.5 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; left side - spearmen on the flank
	begin_block 4
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		2 -2.0 0.0
		inter_unit_spacing		0.1
		priority			0.65
	end_block

	;; right side - spearmen on the flank
	begin_block 5
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		3 2.0 0.0
		inter_unit_spacing		0.1
		priority			0.6
	end_block

	;; light infantry behind left flank
	begin_block 6
		not_general
		unit_type				light infantry 1.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		2 0.0 -8.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	;; light infantry behind right flank
	begin_block 7
		not_general
		unit_type				light infantry 1.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		3 0.0 -8.0
		inter_unit_spacing		2.0
		priority			0.65
	end_block

	begin_dummy_block 8
		spans	0 1 2 3 4 5 6 7
	end_dummy_block

	;; missile screen in front of the phalanx line
	begin_block 9
		max_units				5
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 10.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; missile troops behind the centre
	begin_block 10
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -30.0
		inter_unit_spacing		0.2
		priority			0.4
	end_block

	begin_dummy_block 11
		spans	0 1 2 3 4 5 6 7 8 9 10
	end_dummy_block

	;; cavalry on the flanks and back a bit

	;; left flank
	begin_block 12
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		11 -5.0 -20.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 13
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		11 5.0 -20.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav and chariots
	begin_block 14
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		12 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; left flank elephants, infront of left flank cavalry
	begin_block 15
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		12 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank missile cav and chariots
	begin_block 16
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		13 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank elephants, infront of right flank cavalry
	begin_block 17
		not_general
		unit_type				elephants 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		13 0.0 6.0
		inter_unit_spacing		4.0
		priority			0.6
	end_block

	;; general behind left flank cavalry
	begin_block 18
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		11 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 19
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		18 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 20
		spans	0 1 2 3 4 5 6 7 8 9 10 18 19
	end_dummy_block

	;; any behind
	begin_block 21
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		20 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.1
	end_block

	;; artillery and handler behind
	begin_block 22
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		20 0.0 -20.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

	;; chariots in front of skirmish line
	begin_block 23
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		8 -20.0 1.0
		inter_unit_spacing		4.0
		priority			1.0
	end_block

end_formation



;****************************************************************
; A single line, but with the units ordered with heavy infantry in the centre
; lighter infantry on the flanks, and cavalry on the wings *ExRM Sinuhet & Darth M2TW's
;****************************************************************

begin_formation ai_ordered_single_line

	;;; purpose flags			; - offensive single line
	attack						; can use this for anything
	defend

	ai_priority				0.1

	;; centre block
	begin_block 0
		min_units				1
		unit_type				spearmen infantry 1.0
		unit_type				heavy infantry 0.8
		unit_type				light infantry 0.6
		unit_type				skirmish infantry 0.4
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; right flank of front line
	begin_block 1
		unit_type				missile infantry 1.0
		unit_type				light infantry 1.0
		unit_type				skirmish infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 3.0 0.0
		inter_unit_spacing		3.0
		priority			0.9
	end_block

	;; left flank of front line
	begin_block 2
		unit_type				missile infantry 1.0
		unit_type				light infantry 1.0
		unit_type				skirmish infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 -3.0 0.0
		inter_unit_spacing		3.0
		priority			0.9
	end_block

	;; right wing cavalry
	begin_block 3
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		1 3.0 0.0
		inter_unit_spacing		3.0
		priority			0.9
	end_block

	;; left wing cavalry
	begin_block 4
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		2 -3.0 0.0
		inter_unit_spacing		3.0
		priority			0.9
	end_block

	begin_dummy_block 5
		spans	0 1 2 3 4
	end_dummy_block

	;; general behind the center of the group
	begin_block 6
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 7
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		6 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_dummy_block 8
		spans	0 1 2 3 4 5 6 7
	end_dummy_block

	;; artillery and handlers behind the general
	begin_block 9
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		8 0.0 -5.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	;; right wing missile cavalry
	begin_block 10
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		5 2.0 0.0
		inter_unit_spacing		10.0
		priority			0.9
	end_block

	;; left wing missile cavalry
	begin_block 11
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		5 -2.0 0.0
		inter_unit_spacing		10.0
		priority			0.9
	end_block

end_formation



;****************************************************************
; Double Line set create by mixing Darth's and Sinuhet's based on vanilla
;****************************************************************

;****************************************************************
; Double Line. Spearmen and heavy infantry in front,
; anything else behind. Single unit screen in front
;****************************************************************

begin_formation ai_double_assault_infantry_in_front

	;;; purpose flags
	defend

	ai_priority				0.20

	;;; The screen
	begin_block 0
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	;;; The assault units
	begin_block 1
		min_units				6
		unit_type				heavy pilum_infantry 1.0
		unit_type				light pilum_infantry 0.3
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		0 0.0 -3.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	;;; A heavy unit on the end of the line
	begin_block 2
		max_units				1
		unit_type				heavy infantry 1.0
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		1 2.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	;;; A heavy unit on the end of the line
	begin_block 3
		max_units				1
		unit_type				heavy infantry 1.0
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		1 -2.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_dummy_block 4
		spans 0 1 2 3
	end_dummy_block

	;;; centre slot of rear row
	begin_block 5
		unit_type				missile 1.0
		unit_type				infantry 0.5
		;unit_formation			square, schiltrom
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		4 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.6
	end_block

	;;; right slot of rear row
	begin_block 6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		5 3.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	;;; left slot of rear row
	begin_block 7
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		5 -3.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	;;; dummy slot spanning second line
	begin_dummy_block 8
		spans 5 6 7
	end_dummy_block

	;;; special general block
	begin_block 9
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		4 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 10
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		9 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; put the artillery and handlers behind everyone
	begin_dummy_block 11
		spans	0 1 2 3 4 5 6 7 8 9 10
	end_dummy_block

	begin_block 12
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		11 0.0 -5.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

end_formation



;****************************************************************
; Double Line. Cavalry in front
; infantry behind
;****************************************************************

begin_formation ai_double_cavalry_infantry

	;;; purpose flags
	attack

	ai_priority				0.20

	;;; The center cavalry
	begin_block 0
		min_units				6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		unit_type				heavy_chariots 3.0
		unit_type				elephants 3.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	;;; right missile cavalry
	begin_block 1
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 3.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;;; left missile cavalry
	begin_block 2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 -3.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;;; The infantry
	begin_block 3
		unit_type				infantry 1.0
		;unit_formation			square, schiltrom
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 -3.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	;; put the artillery and handlers behind everyone
	begin_block 4
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		unit_type				any 0.001
		max_unit_width			24
		block_formation			line
		block_relative_pos		3 0.0 -5.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	;;; special general block
	begin_block 5
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 6
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		5 10.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

end_formation



;****************************************************************
; Double Line. Missile troops in front, anything else behind
;****************************************************************

begin_formation ai_double_missiles_in_front

	;;; purpose flags
	attack

	ai_priority				0.20

	;;; The missile units
	begin_block 0
		min_units				6
		unit_type				missile 1.0
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	;;; Centre slot of rear row
	begin_block 1
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		unit_type				skirmish infantry 1.0
		unit_type				spearmen infantry 1.0
		unit_type				heavy cavalry 0.0
		unit_type				light cavalry 0.0
		unit_type				skirmish cavalry 0.0
		unit_type				spearmen cavalry 0.0
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, schiltrom, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -3.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	;;; Right slot of rear row
	begin_block 2
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		unit_type				skirmish cavalry 1.0
		unit_type				spearmen cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 3.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	;;; left slot of rear row
	begin_block 3
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		unit_type				skirmish cavalry 1.0
		unit_type				spearmen cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 -3.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	;; put the artillery and handlers behind everyone
	begin_dummy_block 4
		spans	0 1 2 3
	end_dummy_block

	begin_block 5
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		unit_type				any 0.001
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		4 0.0 -5.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_dummy_block 6
		spans	0 1 2 3 4 5
	end_dummy_block

	;;; special general block
	begin_block 7
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		6 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 8
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		7 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; put the artillery and handlers behind everyone
	begin_dummy_block 9
		spans	0 1 2 3 4 5 6 7 8
	end_dummy_block

	begin_block 10
		unit_type				handler 1.0
		unit_type				siege 3.0
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 0.0 -5.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

end_formation



;****************************************************************
; Double Line. Spearmen and heavy infantry in front,
; DARTH RTW/M2TW's Double Line. (replacing sinuhet version)
; Non missile infantry in front
; Missile troops and general behind
; Melee Cavalry split between wings
;****************************************************************

begin_formation ai_double_heavy_infantry_in_front


	;;; purpose flags			; defensive double line
	attack
	defend

	ai_priority				0.20

	;; front block
	begin_block 0
		min_units				6
		unit_type				spearmen infantry 1.0
		unit_type				heavy infantry 1.0
		;default_melee_state		defend
		;unit_formation			phalanx, shield_wall, square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; Centre slot of rear row
	begin_block 1
		unit_type				missile infantry 1.0
		unit_type				light infantry 1.0
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -3.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	;; Right slot of rear row
	begin_block 2
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		1 3.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; left slot of rear row
	begin_block 3
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		1 -3.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; dummy block
	begin_dummy_block 4
		spans	0 1 2 3
	end_dummy_block

	;; right wing cavalry
	begin_block 5
		unit_type				heavy cavalry 0.6
		unit_type				light cavalry 0.6
		unit_type				spearmen cavalry 0.1
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		4 3.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	;; left wing cavalry
	begin_block 6
		unit_type				heavy cavalry 0.6
		unit_type				light cavalry 0.6
		unit_type				spearmen cavalry 0.1
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		4 -3.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	;; put put commander in the back
	begin_dummy_block 7
		spans	0 1 2 3 4 5 6
	end_dummy_block

	;; Commander at the back
	begin_block 8
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		7 0.0 -20.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 9
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		8 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; put the artillery and handlers behind everyone
	begin_dummy_block 10
		spans	0 1 2 3 4 5 6 7 8 9
	end_dummy_block

	begin_block 11
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				any 0.001
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 0.0 -5.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

end_formation



;****************************************************************
; Sinuhet's Triple Line. Missile troops in front, foot, in second
; row, mounted in third row - modified by Sinuhet (min 6 missile/skirmish infantry, min 3 light/heavy/spearmen infantry)
;****************************************************************

begin_formation sinuhets_ai_triple_missiles_in_front

	;;; purpose flags - attacking
	attack
	defend

	ai_priority				0.40

	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
	;;; the missile units
	begin_block 0
		min_units				4
		max_units				6
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_block 1
		min_units				2
		max_units				6
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -2.0
		inter_unit_spacing		3.0
		priority			0.9
	end_block

	begin_block 2
		max_units				6
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -2.0
		inter_unit_spacing		3.0
		priority			0.8
	end_block

	begin_block 3
		max_units				6
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		2 0.0 -2.0
		inter_unit_spacing		3.0
		priority			0.7
	end_block

	begin_dummy_block 4
		spans	0 1 2 3
	end_dummy_block

	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
	;;; the infantry units
	begin_block 5
		max_units				10
		unit_type				light infantry 1.0
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, schiltrom, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			20
		block_formation			line
		block_relative_pos		4 0.0 -5.0
		inter_unit_spacing		1.0
		priority			1.0
	end_block

	begin_block 6
		max_units				10
		unit_type				heavy infantry 1.0
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, schiltrom, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			20
		block_formation			line
		block_relative_pos		5 0.0 -2.5
		inter_unit_spacing		1.0
		priority			0.9
	end_block

	begin_block 7
		max_units				10
		unit_type				phalanx 0.9
		default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 0.0 -1.5
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	begin_block 8
		min_units				3
		max_units				10
		unit_type				heavy infantry 1.0
		unit_type				non_phalanx_spear 0.9
		unit_type				spearmen_pilum_infantry 0.9
		unit_type				light infantry 0.7
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, schiltrom, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		7 0.0 -1.0
		inter_unit_spacing		0.0
		priority			0.7
	end_block

	begin_dummy_block 9
		spans	5 6 7 8
	end_dummy_block

	begin_dummy_block 10
		spans	4 9
	end_dummy_block

	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
	;;; missile cavalry

	begin_block 11
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		10 20.0 -10.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 12
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		10 -20.0 -10.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
	;;; cavalry

	begin_block 13
		max_units				6
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.1
		unit_type				light cavalry 0.7
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		10 0.0 -2.5
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_block 14
		max_units				6
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.1
		unit_type				light cavalry 0.7
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		13 0.0 -1.0
		inter_unit_spacing		3.0
		priority			0.9
	end_block

	begin_block 15
		max_units				6
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.1
		unit_type				light cavalry 0.7
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		14 0.0 -1.0
		inter_unit_spacing		3.0
		priority			0.8
	end_block

	begin_block 16
		max_units				6
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.1
		unit_type				light cavalry 0.7
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		15 0.0 -1.0
		inter_unit_spacing		3.0
		priority			0.7
	end_block

	begin_dummy_block 17
		spans	13 14 15 16
	end_dummy_block

	begin_dummy_block 18
		spans	10 17
	end_dummy_block

	;;; special general block
	begin_block 19
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		18 0.0 -20.0
		inter_unit_spacing		1.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 20
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		19 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

	;; put the artillery and handlers behind everyone

	begin_block 21
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				any 0.001
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		20 0.0 -5.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

end_formation



;****************************************************************
; Universal Attack formation - created by Sinuhet as fail-safe in case AI is completely clueless
;****************************************************************

begin_formation open_battle_defend

	;;; purpose flags
	defend

	ai_priority				1.2


; skirmishing missile units part
;****************************************************************

	; Screen of missile cavalry
	begin_block 0
		max_units				3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; first missile units group
	begin_block 1
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		10.0
		priority			0.56
	end_block

	;; second missile units group
	begin_block 2
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -2.0
		inter_unit_spacing		2.0
		priority			0.57
	end_block

	;; third missile units group
	begin_block 3
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		2 -2.0 -2.0
		inter_unit_spacing		2.0
		priority			0.58
	end_block

	begin_block 4
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		2 2.0 -2.0
		inter_unit_spacing		2.0
		priority			0.58
	end_block

	;; 4th missile units group
	begin_block 5
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 -2.0 -2.0
		inter_unit_spacing		2.0
		priority			0.59
	end_block

	begin_block 6
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 2.0 -2.0
		inter_unit_spacing		2.0
		priority			0.59
	end_block

	;; 5th missile units group
	begin_block 7
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		5 -2.0 -2.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	begin_block 8
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 2.0 -2.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	begin_dummy_block 9
		spans	1 2 3 4 5 6 7 8
	end_dummy_block

	; Row of skirmish/missile inf
	begin_block 10
		;max_units				5
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 0.0 -2.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	begin_dummy_block 11
		spans	0 9 10
	end_dummy_block

; cavalry units part
;****************************************************************

	;; light cav on either wing

	;; left side
	begin_block 12
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		11 -0.1 -2.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; right side
	begin_block 13
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		11 0.1 -2.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; Missile cavalry centre
	begin_block 14
		max_units				6
		not_general
		unit_type				skirmish cavalry 0.4
		unit_type				missile cavalry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		11 0.0 -30.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	begin_dummy_block 15
		spans	11 12 13 14
	end_dummy_block

; heavy and light infantry before the spearmen
;****************************************************************

	;; First line of infantry
	begin_block 16
		unit_type				light infantry 0.6
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		15 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.6
	end_block

	;; second line of infantry
	begin_block 17
		unit_type				heavy infantry 0.6
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		16 0.0 -2.0
		inter_unit_spacing		3.0
		priority			0.6
	end_block

	;; 3rd line of infantry
	;; heavy centre
	begin_block 18
		max_units				8
		unit_type				heavy infantry 1.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		17 0.0 -2.0
		inter_unit_spacing		0.3
		priority			1.0
	end_block

	;; light left side
	begin_block 19
		max_units				4
		unit_type				light infantry 1.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		18 -0.3 0.0
		inter_unit_spacing		0.3
		priority			1.0
	end_block

	;; light right side
	begin_block 20
		max_units				4
		unit_type				light infantry 1.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		18 0.3 0.0
		inter_unit_spacing		0.3
		priority			1.0
	end_block

	begin_dummy_block 21
		spans	15 16 17 18 19 20
	end_dummy_block

; non-phalanx spearmen part
;****************************************************************

	;; first spearmen line
	begin_block 22
		unit_type				non_phalanx_spear 0.2
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		21 0.0 -2.0
		inter_unit_spacing		0.1
		priority			0.2
	end_block

	;; second spearmen line
	begin_block 23
		max_units				7
		unit_type				non_phalanx_spear 0.6
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		22 0.0 -2.0
		inter_unit_spacing		0.1
		priority			0.6
	end_block

	;; third spearmen line
	begin_block 24
		max_units				6
		unit_type				non_phalanx_spear 1.0
		default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		23 0.0 -2.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	begin_dummy_block 25
		spans	21 22 23 24
	end_dummy_block

; phalanx-spearmen part
;****************************************************************

	;; first spearmen line
	begin_block 26
		;max_units				10
		unit_type				phalanx 0.6
		default_melee_state		defend
		unit_formation			phalanx
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		25 0.0 -2.0
		inter_unit_spacing		0.0
		priority			0.6
	end_block

	;; second spearmen line
	begin_block 27
		max_units				10
		unit_type				phalanx 1.0
		default_melee_state		defend
		unit_formation			phalanx
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		26 0.0 -2.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	begin_dummy_block 28
		spans	25 26 27
	end_dummy_block

; archers behind the spearmen
;****************************************************************

	begin_block 29
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		28 0.0 -30.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	begin_dummy_block 30
		spans	28 29
	end_dummy_block

	;; cavalry center
	begin_block 31
		max_units				6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		30 0.0 -5.0
		inter_unit_spacing		4.0
		priority			0.8
	end_block

	;; artillery and handler behind
	begin_block 32
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		31 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

; cavalry on the flanks and back a bit
;****************************************************************

	;; left flank
	begin_block 33
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		32 -10.0 -2.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; right flank
	begin_block 34
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		32 10.0 -2.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 35
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		33 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

	;; right flank missile cav
	begin_block 36
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		34 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

; general unit
;****************************************************************

	;; general at the back
	begin_block 37
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		31 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 38
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		37 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

; handler, siege and units in the back
;****************************************************************

	;; any behind
	begin_block 39
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		38 0.0 -5.0
		inter_unit_spacing		1.0
		priority			0.01
	end_block

end_formation


begin_formation open_battle_attack

	;;; purpose flags
	attack

	ai_priority				1.2


; skirmishing missile units part
;****************************************************************

	; Screen of missile cavalry
	begin_block 0
		max_units				3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; first missile units group
	begin_block 1
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		2.0
		priority			0.56
	end_block

	;; second missile units group
	begin_block 2
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -2.0
		inter_unit_spacing		2.0
		priority			0.57
	end_block

	;; third missile units group
	begin_block 3
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		2 -2.0 -2.0
		inter_unit_spacing		2.0
		priority			0.58
	end_block

	begin_block 4
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		2 2.0 -2.0
		inter_unit_spacing		2.0
		priority			0.58
	end_block

	;; 4th missile units group
	begin_block 5
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 -2.0 -2.0
		inter_unit_spacing		2.0
		priority			0.59
	end_block

	begin_block 6
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 2.0 -2.0
		inter_unit_spacing		2.0
		priority			0.59
	end_block

	;; 5th missile units group
	begin_block 7
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		5 -2.0 -2.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	begin_block 8
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 2.0 -2.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	begin_dummy_block 9
		spans	1 2 3 4 5 6 7 8
	end_dummy_block

	; Row of skirmish/missile inf
	begin_block 10
		;max_units				5
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 0.0 -2.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	begin_dummy_block 11
		spans	0 9 10
	end_dummy_block

; cavalry units part
;****************************************************************

	;; light cav on either wing

	;; left side
	begin_block 12
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			column
		block_relative_pos		11 -0.1 -2.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; right side
	begin_block 13
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			column
		block_relative_pos		11 0.1 -2.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; Missile cavalry centre
	begin_block 14
		max_units				6
		not_general
		unit_type				skirmish cavalry 0.4
		unit_type				missile cavalry 0.8
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			line
		block_relative_pos		11 0.0 -30.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	begin_dummy_block 15
		spans	11 12 13 14
	end_dummy_block

; heavy and light infantry before the spearmen
;****************************************************************

	;; First line of infantry
	begin_block 16
		unit_type				light infantry 0.6
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		block_formation			line
		block_relative_pos		15 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.6
	end_block

	;; second line of infantry
	begin_block 17
		unit_type				heavy infantry 0.6
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		block_formation			line
		block_relative_pos		16 0.0 -2.0
		inter_unit_spacing		3.0
		priority			0.6
	end_block

	;; 3rd line of infantry
	;; heavy centre
	begin_block 18
		max_units				8
		unit_type				heavy infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		block_formation			line
		block_relative_pos		17 0.0 -2.0
		inter_unit_spacing		0.3
		priority			1.0
	end_block

	;; light left side
	begin_block 19
		max_units				4
		unit_type				light infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		block_formation			line
		block_relative_pos		18 -0.3 0.0
		inter_unit_spacing		0.3
		priority			1.0
	end_block

	;; light right side
	begin_block 20
		max_units				4
		unit_type				light infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		block_formation			line
		block_relative_pos		18 0.3 0.0
		inter_unit_spacing		0.3
		priority			1.0
	end_block

	begin_dummy_block 21
		spans	15 16 17 18 19 20
	end_dummy_block

; non-phalanx spearmen part
;****************************************************************

	;; first spearmen line
	begin_block 22
		unit_type				non_phalanx_spear 0.2
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		21 0.0 -2.0
		inter_unit_spacing		0.1
		priority			0.2
	end_block

	;; second spearmen line
	begin_block 23
		max_units				7
		unit_type				non_phalanx_spear 0.6
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		22 0.0 -2.0
		inter_unit_spacing		0.1
		priority			0.6
	end_block

	;; third spearmen line
	begin_block 24
		max_units				6
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		23 0.0 -2.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	begin_dummy_block 25
		spans	21 22 23 24
	end_dummy_block

; phalanx-spearmen part
;****************************************************************

	;; first spearmen line
	begin_block 26
		;max_units				10
		unit_type				phalanx 0.6
		default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		25 0.0 -2.0
		inter_unit_spacing		0.0
		priority			0.6
	end_block

	;; second spearmen line
	begin_block 27
		max_units				10
		unit_type				phalanx 1.0
		default_melee_state		defend
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		26 0.0 -2.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	begin_dummy_block 28
		spans	25 26 27
	end_dummy_block

; archers behind the spearmen
;****************************************************************

	begin_block 29
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		28 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	begin_dummy_block 30
		spans	28 29
	end_dummy_block

	;; cavalry center
	begin_block 31
		max_units				6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		30 0.0 -5.0
		inter_unit_spacing		4.0
		priority			0.8
	end_block

	;; artillery and handler behind
	begin_block 32
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		31 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

; cavalry on the flanks and back a bit
;****************************************************************

	;; left flank
	begin_block 33
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			30
		block_formation			square
		block_relative_pos		32 -10.0 -2.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 34
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			30
		block_formation			square
		block_relative_pos		32 10.0 -2.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 35
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		33 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 36
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		34 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

; general unit
;****************************************************************

	;; general at the back
	begin_block 37
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		29 0.0 -20.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 38
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		37 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

; handler, siege and units in the back
;****************************************************************

	;; any behind
	begin_block 39
		unit_type				any 0.001
		unit_density			close
		block_formation			line
		block_relative_pos		38 0.0 -5.0
		inter_unit_spacing		1.0
		priority			0.01
	end_block

end_formation


begin_formation open_battle_pursue

	;;; purpose flags
	pursue

	ai_priority				1.2


; skirmishing missile units part
;****************************************************************

	; Screen of missile cavalry
	begin_block 0
		max_units				3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; first missile units group
	begin_block 1
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		2.0
		priority			0.56
	end_block

	;; second missile units group
	begin_block 2
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -2.0
		inter_unit_spacing		2.0
		priority			0.57
	end_block

	;; third missile units group
	begin_block 3
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		2 -2.0 -2.0
		inter_unit_spacing		2.0
		priority			0.58
	end_block

	begin_block 4
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		2 2.0 -2.0
		inter_unit_spacing		2.0
		priority			0.58
	end_block

	;; 4th missile units group
	begin_block 5
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 -2.0 -2.0
		inter_unit_spacing		2.0
		priority			0.59
	end_block

	begin_block 6
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 2.0 -2.0
		inter_unit_spacing		2.0
		priority			0.59
	end_block

	;; 5th missile units group
	begin_block 7
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		5 -2.0 -2.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	begin_block 8
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 2.0 -2.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	begin_dummy_block 9
		spans	1 2 3 4 5 6 7 8
	end_dummy_block

	; Row of skirmish/missile inf
	begin_block 10
		;max_units				5
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 0.0 -2.0
		inter_unit_spacing		2.0
		priority			0.6
	end_block

	begin_dummy_block 11
		spans	0 9 10
	end_dummy_block

; cavalry units part
;****************************************************************

	;; light cav on either wing

	;; left side
	begin_block 12
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			column
		block_relative_pos		11 -0.1 -2.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; right side
	begin_block 13
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			column
		block_relative_pos		11 0.1 -2.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; Missile cavalry centre
	begin_block 14
		max_units				6
		not_general
		unit_type				skirmish cavalry 0.4
		unit_type				missile cavalry 0.8
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			line
		block_relative_pos		11 0.0 -30.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	begin_dummy_block 15
		spans	11 12 13 14
	end_dummy_block

; heavy and light infantry before the spearmen
;****************************************************************

	;; First line of infantry
	begin_block 16
		unit_type				light infantry 0.6
		;default_melee_state		fire_at_will_and_skirmish
		unit_formation			shield_wall, square
		unit_density			close
		block_formation			line
		block_relative_pos		15 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.6
	end_block

	;; second line of infantry
	begin_block 17
		unit_type				heavy infantry 0.6
		;default_melee_state		fire_at_will_and_skirmish
		unit_formation			shield_wall, square
		unit_density			close
		block_formation			line
		block_relative_pos		16 0.0 -2.0
		inter_unit_spacing		3.0
		priority			0.6
	end_block

	;; 3rd line of infantry
	;; heavy centre
	begin_block 18
		max_units				8
		unit_type				heavy infantry 1.0
		;default_melee_state		fire_at_will_and_skirmish
		unit_formation			shield_wall, square
		unit_density			close
		block_formation			line
		block_relative_pos		17 0.0 -2.0
		inter_unit_spacing		0.3
		priority			1.0
	end_block

	;; light left side
	begin_block 19
		max_units				4
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will_and_skirmish
		unit_formation			shield_wall, square
		unit_density			close
		block_formation			line
		block_relative_pos		18 -0.3 0.0
		inter_unit_spacing		0.3
		priority			1.0
	end_block

	;; light right side
	begin_block 20
		max_units				4
		unit_type				light infantry 1.0
		;default_melee_state		fire_at_will_and_skirmish
		unit_formation			shield_wall, square
		unit_density			close
		block_formation			line
		block_relative_pos		18 0.3 0.0
		inter_unit_spacing		0.3
		priority			1.0
	end_block

	begin_dummy_block 21
		spans	15 16 17 18 19 20
	end_dummy_block

; non-phalanx spearmen part
;****************************************************************

	;; first spearmen line
	begin_block 22
		unit_type				non_phalanx_spear 0.2
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		21 0.0 -2.0
		inter_unit_spacing		0.1
		priority			0.2
	end_block

	;; second spearmen line
	begin_block 23
		max_units				7
		unit_type				non_phalanx_spear 0.6
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		22 0.0 -2.0
		inter_unit_spacing		0.1
		priority			0.6
	end_block

	;; third spearmen line
	begin_block 24
		max_units				6
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		23 0.0 -2.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	begin_dummy_block 25
		spans	21 22 23 24
	end_dummy_block

; phalanx-spearmen part
;****************************************************************

	;; first spearmen line
	begin_block 26
		;max_units				10
		unit_type				phalanx 0.6
		default_melee_state		defend
		unit_formation			phalanx
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		25 0.0 -2.0
		inter_unit_spacing		0.0
		priority			0.6
	end_block

	;; second spearmen line
	begin_block 27
		max_units				10
		unit_type				phalanx 1.0
		default_melee_state		defend
		unit_formation			phalanx
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		26 0.0 -2.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	begin_dummy_block 28
		spans	25 26 27
	end_dummy_block

; archers behind the spearmen
;****************************************************************

	begin_block 29
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		fire_at_will_and_skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		28 0.0 -20.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	begin_dummy_block 30
		spans	28 29
	end_dummy_block

	;; cavalry center
	begin_block 31
		max_units				6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		30 0.0 -5.0
		inter_unit_spacing		4.0
		priority			0.8
	end_block

	;; artillery and handler behind
	begin_block 32
		unit_type				handler 1.0
		unit_type				siege 3.0
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		31 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.1
	end_block

; cavalry on the flanks and back a bit
;****************************************************************

	;; left flank
	begin_block 33
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			30
		block_formation			square
		block_relative_pos		32 -10.0 -2.0
		inter_unit_spacing		4.0
		priority			0.4
	end_block

	;; right flank
	begin_block 34
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		unit_type				elephants 3.0
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			30
		block_formation			square
		block_relative_pos		32 10.0 -2.0
		inter_unit_spacing		4.0
		priority			0.5
	end_block

	;; left flank missile cav
	begin_block 35
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		33 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; right flank missile cav
	begin_block 36
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		34 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.6
	end_block

; general unit
;****************************************************************

	;; general at the back
	begin_block 37
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		30 0.0 -30.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 38
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		37 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

; handler, siege and units in the back
;****************************************************************

	;; any behind
	begin_block 39
		unit_type				any 0.001
		unit_density			close
		block_formation			line
		block_relative_pos		38 0.0 -5.0
		inter_unit_spacing		1.0
		priority			0.01
	end_block

end_formation



;*******************************************************************************
; Darth-M2TW's cavalry on the front formations set (min 6 light/heavy cavalry)
;*******************************************************************************

begin_formation ai_darth_cavalry_in_front_approach

	;;; purpose flags
	defend					; can use this for anything
	attack

	ai_priority				1.50

	supported_factions			macedon, seleucid, pontus, armenia, parthia, scythia, gauls, galatians,, britons, spain, thrace

	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
	;;; the cavalry units
	begin_block 0
		unit_type				heavy_chariots 3.0
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	begin_block 1
		min_units				1
		max_units				6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.7
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -2.0
		inter_unit_spacing		0.0
		priority			0.9
	end_block

	begin_block 2
		min_units				2
		max_units				6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.7
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -2.0
		inter_unit_spacing		0.0
		priority			0.8
	end_block

	begin_block 3
		min_units				3
		max_units				6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.7
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		2 0.0 -6.0
		inter_unit_spacing		0.0
		priority			0.7
	end_block

	begin_dummy_block 4
		spans	0 1 2 3
	end_dummy_block

	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
	;;; the infantry units
	begin_block 5
		;max_units				6
		not_general
		unit_type				phalanx 1.0
		;unit_formation			phalanx		; during march let's ai decide
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		4 0.0 -6.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	begin_block 6
		;max_units				6
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 0.0 -2.5
		inter_unit_spacing		0.0
		priority			0.9
	end_block

	begin_block 7
		max_units				12
		not_general
		unit_type				heavy infantry 1.0
		unit_type				skirmish infantry 0.8
		unit_type				light infantry 0.7
		;unit_formation			shield_wall, schiltrom, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 0.0 -1.5
		inter_unit_spacing		0.0
		priority			0.8
	end_block

	begin_block 8
		max_units				12
		unit_type				heavy infantry 1.0
		unit_type				skirmish infantry 0.8
		unit_type				light infantry 0.7
		;unit_formation			shield_wall, schiltrom, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		7 0.0 -1.0
		inter_unit_spacing		0.0
		priority			0.7
	end_block

	begin_dummy_block 9
		spans	5 6 7 8
	end_dummy_block

	begin_dummy_block 10
		spans	4 9
	end_dummy_block

	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
	;;; missile cavalry

	begin_block 11
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		10 100.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 12
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		10 -100.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
	;;; missile

	begin_block 13
		max_units				6
		unit_type				missile infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		10 0.0 -2.5
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_block 14
		max_units				6
		unit_type				missile infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		13 0.0 -1.0
		inter_unit_spacing		3.0
		priority			0.9
	end_block

	begin_block 15
		max_units				6
		unit_type				missile infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		14 0.0 -1.0
		inter_unit_spacing		3.0
		priority			0.8
	end_block

	begin_block 16
		max_units				6
		unit_type				missile infantry 1.0
		unit_type				any 0.001
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		15 0.0 -1.0
		inter_unit_spacing		3.0
		priority			0.7
	end_block

	begin_dummy_block 17
		spans	13 14 15 16
	end_dummy_block

	begin_dummy_block 18
		spans	10 17
	end_dummy_block

	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
	;; put the artillery and handlers behind everyone

	begin_block 19
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		18 0.0 -20.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;;; special general block
	begin_block 20
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		19 0.0 -20.0
		inter_unit_spacing		30.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 21
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		20 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

end_formation



begin_formation ai_darth_cavalry_in_front_pursue

	;;; purpose flags
	pursue					; all-out action for generals

	ai_priority				1.50

	supported_factions			macedon, seleucid, pontus, armenia, parthia, scythia, gauls, galatians,, britons, spain, thrace

	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
	;;; the cavalry units
	begin_block 0
		unit_type				heavy_chariots 3.0
		;unit_formation			square, wedge
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	begin_block 1
		min_units				1
		max_units				6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.7
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -2.0
		inter_unit_spacing		0.0
		priority			0.9
	end_block

	begin_block 2
		min_units				2
		max_units				6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.7
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -2.0
		inter_unit_spacing		0.0
		priority			0.8
	end_block

	begin_block 3
		min_units				3
		max_units				6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.7
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			line
		block_relative_pos		2 0.0 -2.0
		inter_unit_spacing		0.0
		priority			0.7
	end_block

	begin_dummy_block 4
		spans	0 1 2 3
	end_dummy_block

	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
	;;; the infantry units
	begin_block 5
		;max_units				6
		not_general
		unit_type				phalanx 1.0
		default_melee_state		defend
		unit_formation			phalanx
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		4 0.0 -5.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	begin_block 6
		;max_units				6
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will_and_defend
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 0.0 -2.5
		inter_unit_spacing		0.0
		priority			0.9
	end_block

	begin_block 7
		max_units				12
		not_general
		unit_type				heavy infantry 1.0
		unit_type				skirmish infantry 0.8
		unit_type				light infantry 0.7
		unit_formation			shield_wall, schiltrom, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 0.0 -1.5
		inter_unit_spacing		0.0
		priority			0.8
	end_block

	begin_block 8
		max_units				12
		unit_type				heavy infantry 1.0
		unit_type				skirmish infantry 0.8
		unit_type				light infantry 0.7
		unit_formation			shield_wall, schiltrom, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		7 0.0 -1.0
		inter_unit_spacing		0.0
		priority			0.7
	end_block

	begin_dummy_block 9
		spans	5 6 7 8
	end_dummy_block

	begin_dummy_block 10
		spans	4 9
	end_dummy_block

	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
	;;; missile cavalry

	begin_block 11
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		10 100.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 12
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		10 -100.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
	;;; missile

	begin_block 13
		max_units				6
		unit_type				missile infantry 1.0
		default_melee_state		fire_at_will
		max_unit_width			40
		block_formation			line
		block_relative_pos		10 0.0 -2.5
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_block 14
		max_units				6
		unit_type				missile infantry 1.0
		default_melee_state		fire_at_will
		max_unit_width			40
		block_formation			line
		block_relative_pos		13 0.0 -1.0
		inter_unit_spacing		3.0
		priority			0.9
	end_block

	begin_block 15
		max_units				6
		unit_type				missile infantry 1.0
		default_melee_state		fire_at_will
		max_unit_width			40
		block_formation			line
		block_relative_pos		14 0.0 -1.0
		inter_unit_spacing		3.0
		priority			0.8
	end_block

	begin_block 16
		max_units				6
		unit_type				missile infantry 1.0
		unit_type				any 0.001
		default_melee_state		fire_at_will
		max_unit_width			40
		block_formation			line
		block_relative_pos		15 0.0 -1.0
		inter_unit_spacing		3.0
		priority			0.7
	end_block

	begin_dummy_block 17
		spans	13 14 15 16
	end_dummy_block

	begin_dummy_block 18
		spans	10 17
	end_dummy_block

	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
	;; put the artillery and handlers behind everyone

	begin_block 19
		unit_type				handler 1.0
		unit_type				siege 3.0
		max_unit_width			24
		block_formation			line
		block_relative_pos		18 0.0 -10.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;;; special general block
	begin_block 20
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		18 15.0 -30.0
		inter_unit_spacing		30.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 21
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		20 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

end_formation



;****************************************************************
; Germanicu5 & Sinuhet & Darth M2TW's Triple Line swap set. (modified by Suppanut)
; Triple-line formations set, exist as reserves formations
;*******************************************************************************

;****************************************************************
; Germanicu5 Triple_missiles_in_front - condensed * by Germanicu5 for ReallyBadAI
; Missile Infantry
; Non Missile Infantry
; Cavalry
;****************************************************************

begin_formation ai_triple_line_missile_first_approach

	;;; purpose flags - attacking
	attack
	defend

	ai_priority				0.30

	begin_block 0
		max_units				5
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.9
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		1.0
		priority			1.0
	end_block

	begin_block 1
		max_units				5
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.9
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -1.0
		inter_unit_spacing		1.0
		priority			0.9
	end_block

	begin_block 2
		max_units				5
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.9
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -1.0
		inter_unit_spacing		1.0
		priority			0.8
	end_block

	begin_dummy_block 3
		spans	0 1 2
	end_dummy_block

	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
	;;; the infantry units

	begin_dummy_block 4
		spans	0 1 2 3
	end_dummy_block

	begin_block 5
		max_units				2
		unit_type				phalanx 1.0
		unit_type				non_phalanx_spear 0.5
		unit_type				heavy infantry 0.8
		unit_type				light infantry 0.7
		default_melee_state		defend
		;unit_formation			phalanx, shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		4 0.0 -1.0
		inter_unit_spacing		0.0
		priority			0.9
	end_block

	begin_block 6
		max_units				1
		unit_type				phalanx 0.9
		unit_type				non_phalanx_spear 0.6
		unit_type				heavy infantry 0.8
		unit_type				light infantry 0.7
		default_melee_state		defend
		;unit_formation			phalanx, shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 -0.1 0.0
		inter_unit_spacing		0.0
		priority			0.8
	end_block

	begin_block 7
		max_units				1
		unit_type				phalanx 0.9
		unit_type				non_phalanx_spear 0.6
		unit_type				heavy infantry 0.8
		unit_type				light infantry 0.7
		default_melee_state		defend
		;unit_formation			phalanx, shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 0.1 0.0
		inter_unit_spacing		0.0
		priority			0.8
	end_block

	begin_block 8
		max_units				1
		unit_type				phalanx 0.8
		unit_type				non_phalanx_spear 0.7
		unit_type				heavy infantry 0.8
		unit_type				light infantry 0.7
		default_melee_state		defend
		;unit_formation			phalanx, shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 -0.1 0.0
		inter_unit_spacing		0.0
		priority			0.7
	end_block

	begin_block 9
		max_units				1
		unit_type				phalanx 0.8
		unit_type				non_phalanx_spear 0.7
		unit_type				heavy infantry 0.8
		unit_type				light infantry 0.7
		default_melee_state		defend
		;unit_formation			phalanx, shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		7 0.1 0.0
		inter_unit_spacing		0.0
		priority			0.7
	end_block

	begin_block 10
		max_units				1
		unit_type				phalanx 0.7
		unit_type				non_phalanx_spear 0.8
		unit_type				heavy infantry 0.8
		unit_type				light infantry 0.7
		default_melee_state		defend
		;unit_formation			phalanx, shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		8 -0.1 0.0
		inter_unit_spacing		0.0
		priority			0.6
	end_block

	begin_block 11
		max_units				1
		unit_type				phalanx 0.7
		unit_type				non_phalanx_spear 0.8
		unit_type				heavy infantry 0.8
		unit_type				light infantry 0.7
		default_melee_state		defend
		;unit_formation			phalanx, shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 0.1 0.0
		inter_unit_spacing		0.0
		priority			0.6
	end_block

	begin_dummy_block 12
		spans	5 6 7 8 9 10 11
	end_dummy_block

	begin_block 13
		max_units				6
		unit_type				phalanx 0.6
		unit_type				non_phalanx_spear 0.9
		unit_type				heavy infantry 0.8
		unit_type				light infantry 0.7
		;unit_formation			phalanx, shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 0.0 -10.0
		inter_unit_spacing		0.0
		priority			0.4
	end_block

	begin_block 14
		max_units				6
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.9
		;unit_formation			square, schiltrom
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		13 0.0 -5.0
		inter_unit_spacing		10.0
		priority			0.7
	end_block

	begin_block 15
		max_units				6
		unit_type				infantry 0.0
		;unit_formation			square, schiltrom
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		14 0.0 -2.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	begin_block 16
		max_units				6
		unit_type				infantry 0.0
		;unit_formation			square, schiltrom
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		15 0.0 -2.0
		inter_unit_spacing		10.0
		priority			0.2
	end_block

	begin_dummy_block 17
		spans	4 12 13 14 15 16
	end_dummy_block

	begin_dummy_block 18
		spans	3 17
	end_dummy_block

	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
	;;; missile cavalry

	begin_block 19
		max_units				3
		not_general
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 0.9
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		18 -10.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 20
		max_units				3
		not_general
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 0.9
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		18 10.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
	;;; cavalry

	begin_block 21
		max_units				1
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		20 0.0 -10.0
		inter_unit_spacing		1.0
		priority			0.9
	end_block

	begin_block 22
		max_units				1
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		19 0.0 -10.0
		inter_unit_spacing		1
		priority			0.9
	end_block

	begin_block 23
		max_units				1
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		21 -2.0 0.0
		inter_unit_spacing		1
		priority			0.7
	end_block

	begin_block 24
		max_units				1
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		22 2.0 0.0
		inter_unit_spacing		1
		priority			0.7
	end_block

	begin_block 25
		max_units				1
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		23 -2.0 0.0
		inter_unit_spacing		1
		priority			0.6
	end_block

	begin_block 26
		max_units				1
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		24 2.0 0.0
		inter_unit_spacing		1
		priority			0.6
	end_block

	begin_block 27
		max_units				1
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		21 0.0 -5.0
		inter_unit_spacing		1
		priority			0.5
	end_block

	begin_block 28
		max_units				1
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		22 0.0 -5.0
		inter_unit_spacing		1
		priority			0.5
	end_block
	begin_block 29
		max_units				1
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		27 -2.0 0.0
		inter_unit_spacing		1
		priority			0.4
	end_block

	begin_block 30
		max_units				1
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		28 2.0 0.0
		inter_unit_spacing		1
		priority			0.4
	end_block

	begin_block 31
		max_units				1
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		29 -2.0 0.0
		inter_unit_spacing		1
		priority			0.3
	end_block

	begin_block 32
		max_units				1
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		30 2.0 0.0
		inter_unit_spacing		1
		priority			0.3
	end_block

	begin_block 33
		max_units				3
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		29 0.0 -5.0
		inter_unit_spacing		1
		priority			0.2
	end_block

	begin_block 34
		max_units				3
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		30 0.0 -5.0
		inter_unit_spacing		2
		priority			0.2
	end_block

	begin_dummy_block 35
		spans	19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34
	end_dummy_block

	begin_dummy_block 36
		spans	18 35
	end_dummy_block

	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
	;; put the artillery and handlers behind everyone

	begin_block 37
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		36 0.0 -5.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;;; special general block
	begin_block 38
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		37 0.0 -20.0
		inter_unit_spacing		20.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 39
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		38 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

end_formation



;****************************************************************
; G5 Triple missiles in front plus infantry on flanks * by Germanicu5 for ReallyBadAI (min 6 missile/skirmish infantry, min 3 light/heavy/spearmen infantry)
;****************************************************************

begin_formation ai_infantry_on_flanks_attack
	;;; purpose flags			alternative triple lines attack
	attack

	ai_priority				0.30

	begin_block 0
		min_units				3
		max_units				4
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.9
		default_melee_state		fire_at_will_and_skirmish
		;unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		1.0
		priority			1.0
	end_block

	begin_block 1
		min_units				2
		max_units				4
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.9
		default_melee_state		fire_at_will_and_skirmish
		;unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -0.5
		inter_unit_spacing		1.0
		priority			0.9
	end_block

	begin_block 2
		min_units				1
		max_units				4
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.9
		default_melee_state		fire_at_will_and_skirmish
		;unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -0.5
		inter_unit_spacing		1.0
		priority			0.8
	end_block

	begin_dummy_block 3
		spans	0 1 2
	end_dummy_block

	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
	;;; the infantry units

	begin_dummy_block 4
		spans	0 1 2 3
	end_dummy_block

	begin_block 5
		min_units				1
		max_units				2
		unit_type				phalanx 1.0
		unit_type				non_phalanx_spear 0.9
		unit_type				heavy infantry 0.8
		unit_type				light infantry 0.7
		default_melee_state		defend
		;unit_formation			phalanx, shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		4 0.0 -1.0
		inter_unit_spacing		0.0
		priority			0.9
	end_block

	begin_block 6
		min_units				1
		max_units				1
		unit_type				phalanx 0.9
		unit_type				non_phalanx_spear 0.6
		unit_type				heavy infantry 0.8
		unit_type				light infantry 0.7
		default_melee_state		defend
		;unit_formation			phalanx, shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 -0.1 0.0
		inter_unit_spacing		0.0
		priority			0.8
	end_block

	begin_block 7
		min_units				1
		max_units				1
		unit_type				phalanx 0.9
		unit_type				non_phalanx_spear 0.6
		unit_type				heavy infantry 0.8
		unit_type				light infantry 0.7
		default_melee_state		defend
		;unit_formation			phalanx, shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 0.1 0.0
		inter_unit_spacing		0.0
		priority			0.8
	end_block

	begin_block 8
		max_units				1
		unit_type				phalanx 0.8
		unit_type				non_phalanx_spear 0.7
		unit_type				heavy infantry 0.8
		unit_type				light infantry 0.7
		default_melee_state		defend
		;unit_formation			phalanx, shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 -0.1 0.0
		inter_unit_spacing		0.0
		priority			0.7
	end_block

	begin_block 9
		max_units				1
		unit_type				phalanx 0.8
		unit_type				non_phalanx_spear 0.7
		unit_type				heavy infantry 0.8
		unit_type				light infantry 0.7
		default_melee_state		defend
		;unit_formation			phalanx, shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		7 0.1 0.0
		inter_unit_spacing		0.0
		priority			0.7
	end_block

	;;;;;;; flanks
	begin_block 10
		min_units				1
		max_units				1
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.9
		unit_type				non_phalanx_spear 0.8
		unit_type				phalanx 0.7
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		8 0.0 -15.0
		inter_unit_spacing		0.0
		priority			0.6
	end_block

	begin_block 11
		min_units				1
		max_units				1
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.9
		unit_type				non_phalanx_spear 0.8
		unit_type				phalanx 0.7
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 0.0 -15.0
		inter_unit_spacing		0.0
		priority			0.6
	end_block

	;;;;;;; flanks 2
	begin_block 12
		max_units				1
		unit_type				phalanx 0.6
		unit_type				non_phalanx_spear 0.9
		unit_type				heavy infantry 0.8
		unit_type				light infantry 0.7
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 -0.1 0.0
		inter_unit_spacing		0.0
		priority			0.5
	end_block

	begin_block 13
		max_units				1
		unit_type				phalanx 0.6
		unit_type				non_phalanx_spear 0.9
		unit_type				heavy infantry 0.8
		unit_type				light infantry 0.7
		default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		11 0.1 0.0
		inter_unit_spacing		0.0
		priority			0.5
	end_block

	begin_dummy_block 14
		spans	5 6 7 8 9
	end_dummy_block

	;;;;;;; 2nd line
	begin_block 15
		max_units				2
		unit_type				phalanx 0.5
		unit_type				non_phalanx_spear 1.0
		unit_type				heavy infantry 0.8
		unit_type				light infantry 0.7
		unit_type				skirmish infantry 0.6
		unit_type				missile infantry 0.5
		;unit_formation			phalanx, shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		14 0.0 -15.0
		inter_unit_spacing		0.0
		priority			0.4
	end_block

	;;;;;;;flanks 3
	begin_block 16
		max_units				1
		unit_type				non_phalanx_spear 1.0
		unit_type				light infantry 0.9
		unit_type				heavy infantry 0.8
		unit_type				phalanx 0.5
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 -0.1 -1.0
		inter_unit_spacing		0.0
		priority			0.3
	end_block

	begin_block 17
		max_units				1
		unit_type				non_phalanx_spear 1.0
		unit_type				light infantry 0.9
		unit_type				heavy infantry 0.8
		unit_type				phalanx 0.5
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		13 0.1 -1.0
		inter_unit_spacing		0.0
		priority			0.3
	end_block

	;;;;;; other infantry
	begin_block 18
		max_units				4
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.9
		;unit_formation			square, schiltrom
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		15 0.0 -5.0
		inter_unit_spacing		0.0
		priority			0.2
	end_block

	begin_block 19
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.9
		;unit_formation			square, schiltrom
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		18 0.0 -2.0
		inter_unit_spacing		0.0
		priority			0.1
	end_block

	begin_block 20
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.9
		;unit_formation			square, schiltrom
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		19 0.0 -2.0
		inter_unit_spacing		0.0
		priority			0.1
	end_block

	begin_dummy_block 21
		spans	4 10 11 15
	end_dummy_block

	begin_dummy_block 22
		spans	3 21
	end_dummy_block

	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
	;;; missile cavalry

	begin_block 23
		max_units				3
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 0.9
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		22 -20.0 -15.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block
	begin_block 24
		max_units				3
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 0.9
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		22 20.0 -15.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
	;;; cavalry

	begin_block 25
		max_units				1
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		24 0.0 -10.0
		inter_unit_spacing		2
		priority			0.9
	end_block

	begin_block 26
		max_units				1
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		23 0.0 -10.0
		inter_unit_spacing		2
		priority			0.9
	end_block

	begin_block 27
		max_units				1
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		25 2.0 0.0
		inter_unit_spacing		2
		priority			0.7
	end_block

	begin_block 28
		max_units				1
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		26 -2.0 0.0
		inter_unit_spacing		2
		priority			0.7
	end_block

	begin_block 29
		max_units				1
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		27 2.0 0.0
		inter_unit_spacing		2
		priority			0.6
	end_block

	begin_block 30
		max_units				1
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		28 -2.0 0.0
		inter_unit_spacing		2
		priority			0.6
	end_block

	begin_block 31
		max_units				1
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		25 0.0 -5.0
		inter_unit_spacing		2
		priority			0.5
	end_block

	begin_block 32
		max_units				1
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		26 0.0 -5.0
		inter_unit_spacing		2
		priority			0.5
	end_block

	begin_block 33
		max_units				1
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		31 2.0 0.0
		inter_unit_spacing		2
		priority			0.4
	end_block

	begin_block 34
		max_units				1
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		32 -2.0 0.0
		inter_unit_spacing		2
		priority			0.4
	end_block

	begin_block 35
		max_units				1
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		31 2.0 0.0
		inter_unit_spacing		2
		priority			0.3
	end_block

	begin_block 36
		max_units				1
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		34 -2.0 0.0
		inter_unit_spacing		2
		priority			0.3
	end_block

	begin_block 37
		max_units				3
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		33 0.0 -5.0
		inter_unit_spacing		2
		priority			0.2
	end_block

	begin_block 38
		max_units				3
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		34 0.0 -5.0
		inter_unit_spacing		2
		priority			0.2
	end_block

	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
	;; put the artillery and handlers behind everyone

	begin_block 39
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				any 0.001
		default_melee_state		fire_at_will
		max_unit_width			24
		block_formation			line
		block_relative_pos		21 0.0 -10.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;;; special general block
	begin_block 40
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		21 0.0 -20.0
		inter_unit_spacing		20.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 41
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		40 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

end_formation


begin_formation ai_infantry_on_flanks_pursue
	;;; purpose flags			alternative triple lines pursue
	pursue

	ai_priority				0.30

	begin_block 0
		min_units				4
		max_units				4
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.9
		default_melee_state		fire_at_will_and_skirmish
		;unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		1.0
		priority			1.0
	end_block

	begin_block 1
		min_units				2
		max_units				4
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.9
		default_melee_state		fire_at_will_and_skirmish
		;unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -0.5
		inter_unit_spacing		1.0
		priority			0.9
	end_block

	begin_block 2
		max_units				4
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.9
		default_melee_state		fire_at_will_and_skirmish
		;unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -0.5
		inter_unit_spacing		1.0
		priority			0.8
	end_block

	begin_dummy_block 3
		spans	0 1 2
	end_dummy_block

	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
	;;; the infantry units

	begin_dummy_block 4
		spans	0 1 2 3
	end_dummy_block

	begin_block 5
		min_units				1
		max_units				2
		unit_type				phalanx 1.0
		unit_type				non_phalanx_spear 0.5
		unit_type				heavy infantry 0.8
		unit_type				light infantry 0.7
		default_melee_state		defend
		unit_formation			phalanx, shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		4 0.0 -1.0
		inter_unit_spacing		0.0
		priority			0.9
	end_block

	begin_block 6
		min_units				1
		max_units				1
		unit_type				phalanx 0.9
		unit_type				non_phalanx_spear 0.6
		unit_type				heavy infantry 0.8
		unit_type				light infantry 0.7
		default_melee_state		defend
		unit_formation			phalanx, shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 -0.1 0.0
		inter_unit_spacing		0.0
		priority			0.8
	end_block

	begin_block 7
		min_units				1
		max_units				1
		unit_type				phalanx 0.9
		unit_type				non_phalanx_spear 0.6
		unit_type				heavy infantry 0.8
		unit_type				light infantry 0.7
		default_melee_state		defend
		unit_formation			phalanx, shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		5 0.1 0.0
		inter_unit_spacing		0.0
		priority			0.8
	end_block

	begin_block 8
		max_units				1
		unit_type				phalanx 0.8
		unit_type				non_phalanx_spear 0.7
		unit_type				heavy infantry 0.8
		unit_type				light infantry 0.7
		default_melee_state		defend
		unit_formation			phalanx, shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 -0.1 0.0
		inter_unit_spacing		0.0
		priority			0.7
	end_block

	begin_block 9
		max_units				1
		unit_type				phalanx 0.8
		unit_type				non_phalanx_spear 0.7
		unit_type				heavy infantry 0.8
		unit_type				light infantry 0.7
		default_melee_state		defend
		unit_formation			phalanx, shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		7 0.1 0.0
		inter_unit_spacing		0.0
		priority			0.7
	end_block

	;;;;;;; flanks
	begin_block 10
		min_units				1
		max_units				1
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.9
		unit_type				phalanx 0.7
		unit_type				non_phalanx_spear 0.8
		unit_formation			phalanx, shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		8 0.0 -15.0
		inter_unit_spacing		0.0
		priority			0.6
	end_block

	begin_block 11
		min_units				1
		max_units				1
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.9
		unit_type				phalanx 0.7
		unit_type				non_phalanx_spear 0.8
		unit_formation			phalanx, shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 0.0 -15.0
		inter_unit_spacing		0.0
		priority			0.6
	end_block

	;;;;;;; flanks 2
	begin_block 12
		max_units				1
		unit_type				phalanx 0.6
		unit_type				non_phalanx_spear 0.9
		unit_type				heavy infantry 0.8
		unit_type				light infantry 0.7
		default_melee_state		defend
		unit_formation			phalanx, shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		10 -0.1 0.0
		inter_unit_spacing		0.0
		priority			0.5
	end_block

	begin_block 13
		max_units				1
		unit_type				phalanx 0.6
		unit_type				non_phalanx_spear 0.9
		unit_type				heavy infantry 0.8
		unit_type				light infantry 0.7
		default_melee_state		defend
		unit_formation			phalanx, shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		11 0.1 0.0
		inter_unit_spacing		0.0
		priority			0.5
	end_block

	begin_dummy_block 14
		spans	5 6 7 8 9
	end_dummy_block

	;;;;;;; 2nd line
	begin_block 15
		max_units				2
		unit_type				phalanx 0.5
		unit_type				non_phalanx_spear 1.0
		unit_type				heavy infantry 0.8
		unit_type				light infantry 0.7
		unit_type				skirmish infantry 0.6
		unit_type				missile infantry 0.5
		unit_formation			phalanx, shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		14 0.0 -15.0
		inter_unit_spacing		0.0
		priority			0.4
	end_block

	;;;;;;;flanks 3
	begin_block 16
		max_units				1
		unit_type				phalanx 0.5
		unit_type				non_phalanx_spear 1.0
		unit_type				light infantry 0.9
		unit_type				heavy infantry 0.8
		unit_formation			phalanx, shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		12 -0.1 -1.0
		inter_unit_spacing		0.0
		priority			0.3
	end_block

	begin_block 17
		max_units				1
		unit_type				phalanx 0.5
		unit_type				non_phalanx_spear 1.0
		unit_type				light infantry 0.9
		unit_type				heavy infantry 0.8
		unit_formation			phalanx, shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		13 0.1 -1.0
		inter_unit_spacing		0.0
		priority			0.3
	end_block

	;;;;;; other infantry
	begin_block 18
		max_units				4
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.9
		;unit_formation			square, schiltrom
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		15 0.0 -5.0
		inter_unit_spacing		0.0
		priority			0.2
	end_block

	begin_block 19
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.9
		;unit_formation			square, schiltrom
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		18 0.0 -2.0
		inter_unit_spacing		0.0
		priority			0.1
	end_block

	begin_block 20
		max_units				4
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.9
		;unit_formation			square, schiltrom
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		19 0.0 -2.0
		inter_unit_spacing		0.0
		priority			0.1
	end_block

	begin_dummy_block 21
		spans	4 10 11 15
	end_dummy_block

	begin_dummy_block 22
		spans	3 21
	end_dummy_block

	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
	;;; missile cavalry

	begin_block 23
		max_units				3
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 0.9
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		22 -20.0 -15.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block
	begin_block 24
		max_units				3
		unit_type				skirmish cavalry 1.0
		unit_type				missile cavalry 0.9
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		22 20.0 -15.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
	;;; cavalry

	begin_block 25
		max_units				1
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		24 0.0 -10.0
		inter_unit_spacing		2
		priority			0.9
	end_block

	begin_block 26
		max_units				1
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		23 0.0 -10.0
		inter_unit_spacing		2
		priority			0.9
	end_block

	begin_block 27
		max_units				1
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		25 2.0 0.0
		inter_unit_spacing		2
		priority			0.7
	end_block

	begin_block 28
		max_units				1
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		26 -2.0 0.0
		inter_unit_spacing		2
		priority			0.7
	end_block

	begin_block 29
		max_units				1
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		27 2.0 0.0
		inter_unit_spacing		2
		priority			0.6
	end_block

	begin_block 30
		max_units				1
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		28 -2.0 0.0
		inter_unit_spacing		2
		priority			0.6
	end_block

	begin_block 31
		max_units				1
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		25 0.0 -5.0
		inter_unit_spacing		2
		priority			0.5
	end_block

	begin_block 32
		max_units				1
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		26 0.0 -5.0
		inter_unit_spacing		2
		priority			0.5
	end_block

	begin_block 33
		max_units				1
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		31 2.0 0.0
		inter_unit_spacing		2
		priority			0.4
	end_block

	begin_block 34
		max_units				1
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		32 -2.0 0.0
		inter_unit_spacing		2
		priority			0.4
	end_block

	begin_block 35
		max_units				1
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		31 2.0 0.0
		inter_unit_spacing		2
		priority			0.3
	end_block

	begin_block 36
		max_units				1
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		34 -2.0 0.0
		inter_unit_spacing		2
		priority			0.3
	end_block

	begin_block 37
		max_units				3
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		33 0.0 -5.0
		inter_unit_spacing		2
		priority			0.2
	end_block

	begin_block 38
		max_units				3
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.9
		unit_type				light cavalry 0.8
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		34 0.0 -5.0
		inter_unit_spacing		2
		priority			0.2
	end_block

	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
	;; put the artillery and handlers behind everyone

	begin_block 39
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				any 0.001
		max_unit_width			24
		block_formation			line
		block_relative_pos		21 0.0 -10.0
		inter_unit_spacing		5.0
		priority			1.0
	end_block

	;;; special general block
	begin_block 40
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		21 0.0 -30.0
		inter_unit_spacing		20.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 41
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		40 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

end_formation



;****************************************************************
; Darth-M2TW's Cavalry
; (min 2 light/heavy cavalry or heavy chariot, min 4 missile/skirmish cavalry or light chariot)
; Missile Infantry
; Non Missile Infantry
;****************************************************************

begin_formation ai_triple_line_cavalry_first

	;;; purpose flags - attacking
	attack

	ai_priority			0.30

	;; front block
	begin_block 0
		min_units				2
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		unit_type				heavy_chariots 3.0
		;unit_formation			square, wedge
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; front block - skirmish cavalry
	begin_block 1
		min_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.8
	end_block

	;; front block - skirmish cavalry
	begin_block 2
		min_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.8
	end_block

	;; middle block
	begin_block 3
		unit_type				missile infantry 1.0
		default_melee_state		fire_at_will
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; middle-right block - foot skirmish
	begin_block 4
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 5.0 0.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; middle-left block - foot skirmish
	begin_block 5
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 -5.0 0.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; rear block
	begin_block 6
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		unit_type				skirmish infantry 1.0
		unit_type				spearmen infantry 1.0
		max_unit_width			24
		block_formation			line
		block_relative_pos		3 0.0 -15.0
		inter_unit_spacing		0.0
		priority			0.8
	end_block

	;; Commander at the back
	begin_block 7
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 -45.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 8
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		7 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; put the artillery and handlers behind everyone
	begin_dummy_block 9
		spans	0 1 2 3 4 5 6 7 8
	end_dummy_block

	begin_block 10
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				any 0.001
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 0.0 -15.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

end_formation


;****************************************************************
; Pursue all-out assault (min 2 light/heavy cavalry or heavy chariot, min 4 missile/skirmish cavalry or light chariot)
;****************************************************************

begin_formation ai_triple_line_pursue

	;;; purpose flags - attacking
	pursue

	ai_priority			0.30

	;; front block
	begin_block 0
		min_units				2
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		unit_type				heavy_chariots 3.0
		;unit_formation			square, wedge
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; front block - skirmish cavalry
	begin_block 1
		min_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.8
	end_block

	;; front block - skirmish cavalry
	begin_block 2
		min_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.8
	end_block

	;; middle block
	begin_block 3
		unit_type				missile infantry 1.0
		default_melee_state		fire_at_will
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; middle-right block - foot skirmish
	begin_block 4
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 5.0 0.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; middle-left block - foot skirmish
	begin_block 5
		unit_type				skirmish infantry 1.0
		default_melee_state		fire_at_will
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 -5.0 0.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; rear block
	begin_block 6
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		unit_type				skirmish infantry 1.0
		unit_type				spearmen infantry 1.0
		unit_formation			shield_wall, square
		max_unit_width			24
		block_formation			line
		block_relative_pos		3 0.0 -15.0
		inter_unit_spacing		0.0
		priority			0.8
	end_block

	;; Commander at the back
	begin_block 7
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 -45.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 8
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		7 10.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; put the artillery and handlers behind everyone
	begin_dummy_block 9
		spans	0 1 2 3 4 5 6 7 8
	end_dummy_block

	begin_block 10
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				any 0.001
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 0.0 -15.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

end_formation


;****************************************************************
; Non Missile Infantry (min 4 light/heavy/skirmish/spearmen infantry, min 2 light/heavy/skirmish infantry)
; Missile troops
; Non Missile Cavalry
;****************************************************************

begin_formation ai_triple_line_infantry_first

	;;; purpose flags - attacking
	defend

	ai_priority			0.30

	;; front block
	begin_block 0
		min_units				4
		unit_type				spearmen infantry 0.7
		unit_type				heavy infantry 0.5
		unit_type				light infantry 0.2
		unit_type				skirmish infantry 0.1
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; front-right block
	begin_block 1
		min_units				1
		unit_type				skirmish infantry 1.0
		unit_type				light infantry 0.7
		unit_type				heavy infantry 0.5
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 -0.2 0.0
		inter_unit_spacing		0.0
		priority			0.5
	end_block

	;; front-left block
	begin_block 2
		min_units				1
		unit_type				skirmish infantry 1.0
		unit_type				light infantry 0.7
		unit_type				heavy infantry 0.5
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.2 0.0
		inter_unit_spacing		0.0
		priority			0.5
	end_block

	;; middle block
	begin_block 3
		unit_type				missile infantry 1.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;; middle-right block - skirmish cavalry
	begin_block 4
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		3 5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; middle-left block - skirmish cavalry
	begin_block 5
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		3 -5.0 0.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; rear block
	begin_block 6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		unit_type				heavy_chariots 3.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			line
		block_relative_pos		3 0.0 -15.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	;; Commander at the back
	begin_block 7
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		0 0.0 -60.0
		inter_unit_spacing		10.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 8
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		7 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; put the artillery and handlers behind everyone
	begin_dummy_block 9
		spans	0 1 2 3 4 5 6 7 8
	end_dummy_block

	begin_block 10
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		9 0.0 -15.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

end_formation



;****************************************************************
;****************************************************************
; Small formations section
;****************************************************************
;****************************************************************

;****************************************************************
;The special small formation - a dirty trick
;****************************************************************


begin_formation	ai_triple_missiles_in_front

	begin_block 0
		min_units				1
		max_units				1
		not_general
		unit_type				missile cavalry 1.0
		unit_type				ranged_missile_infantry 2.0
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


;****************************************************************
;The special small formation for light cavalry pursuing
;****************************************************************


begin_formation	ai_small_light_cavalry_in_pursue_1

	;;; purpose flags
	pursue

	ai_priority				4.10

	supported_factions			gauls, galatians,, britons, dacia, germans, spain, thrace, scythia, numidia, carthage, pontus, armenia, parthia, macedon, egypt, seleucid

	begin_block 0
		min_units				1
		max_units				2
		not_general
		unit_type				light cavalry 2.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority			1.1
	end_block

	begin_block 1
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


begin_formation	ai_small_light_cavalry_in_pursue_2

	;;; purpose flags
	pursue

	ai_priority				4.1

	begin_block 0
		min_units				1
		max_units				1
		not_general
		unit_type				light cavalry 2.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority			1.1
	end_block

	begin_block 1
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation



;****************************************************************
;The special small formation for missile cavalry pursuing
;****************************************************************


begin_formation	ai_small_missile_cavalry_in_pursue_1

	;;; purpose flags
	pursue

	ai_priority				1.00

	supported_factions			gauls, galatians,, britons, dacia, germans, spain, thrace, scythia, numidia, carthage, pontus, armenia, parthia, macedon, egypt, seleucid

	begin_block 0
		min_units				1
		max_units				2
		not_general
		unit_type				missile cavalry 0.6
		unit_type				skirmish cavalry 0.6
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


begin_formation	ai_small_missile_cavalry_in_pursue_2

	;;; purpose flags
	pursue

	ai_priority				1.0

	begin_block 0
		min_units				1
		max_units				1
		not_general
		unit_type				missile cavalry 0.6
		unit_type				skirmish cavalry 0.6
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


;****************************************************************
;The special small formation for cavalry pursuing
;****************************************************************


begin_formation	ai_small_cavalry_in_pursue_1

	;;; purpose flags
	pursue

	ai_priority				0.98

	supported_factions			gauls, galatians,, britons, dacia, germans, spain, thrace, scythia, numidia, carthage, pontus, armenia, parthia, macedon, egypt, seleucid

	begin_block 0
		min_units				1
		max_units				2
		unit_type				light cavalry 1.0
		unit_type				heavy cavalry 0.1
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


begin_formation	ai_small_cavalry_in_pursue_2

	;;; purpose flags
	pursue

	ai_priority				0.98

	begin_block 0
		min_units				1
		max_units				1
		unit_type				light cavalry 1.0
		unit_type				heavy cavalry 0.1
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		max_unit_width			24
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


;****************************************************************
;The special small formation for missile infantry pursuing
;****************************************************************


begin_formation	ai_small_missile_infantry_in_pursue_1

	;;; purpose flags
	pursue

	ai_priority				0.96

	supported_factions			gauls, galatians,, britons, dacia, germans, spain, thrace, scythia, numidia, carthage, pontus, armenia, parthia

	begin_block 0
		min_units				1
		max_units				2
		not_general
		unit_type				missile infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


begin_formation	ai_small_missile_infantry_in_pursue_2

	;;; purpose flags
	pursue

	ai_priority				0.96

	begin_block 0
		min_units				1
		max_units				1
		not_general
		unit_type				missile infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


;****************************************************************
;The special small formation for infantry pursuing
;****************************************************************


begin_formation	ai_small_infantry_in_pursue_1

	;;; purpose flags
	pursue

	ai_priority				0.95

	supported_factions			gauls, galatians,, britons, dacia, germans, spain, thrace

	begin_block 0
		min_units				2
		max_units				2
		not_general
		unit_type				light infantry 0.1
		unit_type				heavy infantry 0.0
		unit_type				spearmen infantry 0.0
		default_melee_state		fire_at_will
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


begin_formation	ai_small_infantry_in_pursue_2

	;;; purpose flags
	pursue

	ai_priority				0.95

	supported_factions			gauls, galatians,, britons, dacia, germans, spain, thrace, scythia, numidia, carthage, pontus, armenia, parthia

	begin_block 0
		min_units				1
		max_units				1
		not_general
		unit_type				light infantry 0.1
		unit_type				heavy infantry 0.0
		unit_type				spearmen infantry 0.0
		default_melee_state		fire_at_will
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	begin_block 1
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


;****************************************************************
;The special small formation for elephants attacks
;****************************************************************


begin_formation	ai_small_elephants_in_attack

	;;; purpose flags
	attack

	ai_priority				10.0

	begin_block 0
		min_units				1
		max_units				1
		not_general
		unit_type				elephants 3.0
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation

begin_formation	ai_small_elephants_in_defense

	;;; purpose flags
	defend

	ai_priority				10.0

	begin_block 0
		min_units				1
		max_units				1
		not_general
		unit_type				elephants 3.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation

;****************************************************************
;The special small formation for heavy chariots
;****************************************************************


begin_formation	ai_small_heavy_chariots_in_attack_1

	;;; purpose flags
	attack

	ai_priority				10.0

	begin_block 0
		min_units				1
		max_units				1
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation

begin_formation	ai_small_heavy_chariots_in_defense_1

	;;; purpose flags
	defend

	ai_priority				10.0

	begin_block 0
		min_units				1
		max_units				1
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


begin_formation	ai_small_heavy_chariots_in_attack_2

	;;; purpose flags
	attack

	ai_priority				1.00

	supported_factions			gauls, galatians,, britons, pontus, armenia, egypt, seleucid, numidia, slave

	begin_block 0
		min_units				1
		max_units				2
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation

begin_formation	ai_small_heavy_chariots_in_defense_2

	;;; purpose flags
	defend

	ai_priority				1.00

	supported_factions			gauls, galatians,, britons, pontus, armenia, egypt, seleucid, numidia, slave

	begin_block 0
		min_units				1
		max_units				2
		not_general
		unit_type				heavy_chariots 3.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation

;****************************************************************
;The special small formation for missile cavalry attacks
;****************************************************************


begin_formation	ai_small_missile_cavalry_in_attack_1

	;;; purpose flags
	attack

	ai_priority				10.0

	begin_block 0
		min_units				1
		max_units				1
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation

begin_formation	ai_small_missile_cavalry_in_defense_1

	;;; purpose flags
	defend

	ai_priority				10.0

	begin_block 0
		min_units				1
		max_units				1
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


begin_formation	ai_small_missile_cavalry_in_attack_2a

	;;; purpose flags
	attack

	ai_priority				10.0

	supported_factions			scythia

	begin_block 0
		min_units				1
		max_units				3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation

begin_formation	ai_small_missile_cavalry_in_defense_2a

	;;; purpose flags
	defend

	ai_priority				10.0

	supported_factions			scythia

	begin_block 0
		min_units				1
		max_units				3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


begin_formation	ai_small_missile_cavalry_in_attack_2b

	;;; purpose flags
	attack

	ai_priority				10.0

	supported_factions			scythia, numidia, parthia, pontus, armenia, germans

	begin_block 0
		min_units				1
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation

begin_formation	ai_small_missile_cavalry_in_defense_2b

	;;; purpose flags
	defend

	ai_priority				10.0

	supported_factions			scythia, numidia, parthia, pontus, armenia, germans

	begin_block 0
		min_units				1
		max_units				2
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


;****************************************************************
;The special small formation for heavy and light cavalry attacks
;****************************************************************


begin_formation	ai_small_heavy_cavalry_in_attack_1

	;;; purpose flags
	attack

	ai_priority				4.0

	supported_factions			macedon

	begin_block 0
		min_units				1
		max_units				1
		unit_type				heavy cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_block 1
		min_units				2
		max_units				2
		unit_type				heavy cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_block 2
		min_units				1
		max_units				2
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.1
		default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -5.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block


	begin_block 3
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		2 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


begin_formation	ai_small_heavy_cavalry_in_attack_2

	;;; purpose flags
	attack
	defend

	ai_priority				10.0

	begin_block 0
		min_units				1
		max_units				1
		unit_type				heavy cavalry 1.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


begin_formation	ai_small_heavy_cavalry_in_attack_3a

	;;; purpose flags
	attack
	defend

	ai_priority				10.0

	supported_factions			gauls, galatians,, britons, dacia, germans, spain, thrace, scythia, carthage, pontus, armenia, parthia, macedon, egypt, seleucid

	begin_block 0
		min_units				1
		max_units				2
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.1
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


begin_formation	ai_small_heavy_cavalry_in_attack_3b

	;;; purpose flags
	attack
	defend

	ai_priority				10.0

	supported_factions			romans_julii,

	begin_block 0
		min_units				1
		max_units				2
		unit_type				heavy cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


begin_formation	ai_small_heavy_cavalry_in_attack_4

	;;; purpose flags
	attack
	defend

	ai_priority				10.0

	supported_factions			carthage, parthia, macedon

	begin_block 0
		min_units				1
		max_units				3
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.1
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


;****************************************************************
;The special small formation for light only cavalry attacks
;****************************************************************


begin_formation	ai_small_light_cavalry_in_attack_1

	;;; purpose flags
	attack
	defend

	ai_priority				9.5

	begin_block 0
		min_units				1
		max_units				1
		not_general
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


begin_formation	ai_small_light_cavalry_in_attack_2

	;;; purpose flags
	attack
	defend

	ai_priority				9.5

	supported_factions			gauls, galatians,, britons, dacia, germans, spain, thrace, scythia, carthage, pontus, armenia, parthia, macedon, egypt, seleucid

	begin_block 0
		min_units				1
		max_units				2
		not_general
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


begin_formation	ai_small_light_cavalry_in_attack_3

	;;; purpose flags
	attack
	defend

	ai_priority				9.5

	supported_factions			carthage, parthia, macedon

	begin_block 0
		min_units				1
		max_units				3
		not_general
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


;****************************************************************
;The special small formation for skirmishers
;****************************************************************


begin_formation	ai_small_skirmishers_in_attack_1

	;;; purpose flags
	attack

	ai_priority				10.0

	begin_block 0
		min_units				1
		max_units				1
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.1
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation

begin_formation	ai_small_skirmishers_in_defense_1

	;;; purpose flags
	defend

	ai_priority				10.0

	begin_block 0
		min_units				1
		max_units				1
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.1
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


begin_formation	ai_small_skirmishers_in_attack_2

	;;; purpose flags
	attack

	ai_priority				10.0

	supported_factions			gauls, galatians,, britons, dacia, germans, spain, thrace, scythia, numidia, carthage, pontus, armenia

	begin_block 0
		min_units				1
		max_units				2
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.1
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			40
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


begin_formation	ai_small_skirmishers_in_defense_2

	;;; purpose flags
	defend

	ai_priority				10.0

	supported_factions			gauls, galatians,, britons, dacia, germans, spain, thrace, scythia, numidia, carthage, pontus, armenia

	begin_block 0
		min_units				1
		max_units				2
		not_general
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.1
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


;****************************************************************
;The special small formation for ranged-missiles
;****************************************************************


begin_formation	ai_small_ranged-missiles_in_attack_1

	;;; purpose flags
	attack

	ai_priority				1.0

	begin_block 0
		min_units				1
		max_units				1
		not_general
		unit_type				ranged_missile_infantry 2.0
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation

begin_formation	ai_small_ranged-missiles_in_defense_1

	;;; purpose flags
	defend

	ai_priority				1.0

	begin_block 0
		min_units				1
		max_units				1
		not_general
		unit_type				ranged_missile_infantry 2.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


begin_formation	ai_small_ranged-missiles_in_attack_2

	;;; purpose flags
	attack

	ai_priority				1.0

	supported_factions			gauls, galatians,, britons, dacia, germans, spain, thrace, scythia, numidia, carthage, pontus, armenia

	begin_block 0
		min_units				1
		max_units				2
		not_general
		unit_type				ranged_missile_infantry 2.0
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			40
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


begin_formation	ai_small_ranged-missiles_in_defense_2

	;;; purpose flags
	defend

	ai_priority				1.0

	supported_factions			gauls, galatians,, britons, dacia, germans, spain, thrace, scythia, numidia, carthage, pontus, armenia

	begin_block 0
		min_units				1
		max_units				2
		not_general
		unit_type				ranged_missile_infantry 2.0
		default_melee_state		fire_at_will_and_skirmish	; was defend_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


;****************************************************************
;The special small formation for phalanges
;****************************************************************

begin_formation	ai_small_phalanx_in_attack_1a

	;;; purpose flags
	attack

	ai_priority				10.0

	supported_factions			thrace, dacia, carthage, pontus, armenia, greek_cities, pergamon, macedon, egypt, seleucid

	begin_block 0
		min_units				4
		max_units				6
		not_general
		unit_type				phalanx	1.0
		default_melee_state		defend	; Mac phalanx
		;unit_formation			phalanx		; when march let's ai decide
		;unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


begin_formation	ai_small_phalanx_in_pursue_1a

	;;; purpose flags
	pursue

	ai_priority				10.0

	supported_factions			thrace, dacia, carthage, pontus, armenia, greek_cities, pergamon, macedon, egypt, seleucid

	begin_block 0
		min_units				4
		max_units				6
		not_general
		unit_type				phalanx	1.0
		default_melee_state		defend	; Mac phalanx
		unit_formation			phalanx		; when march let's ai decide
		;unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


begin_formation	ai_small_phalanx_in_defense_1a

	;;; purpose flags
	defend

	ai_priority				10.0

	supported_factions			thrace, dacia, carthage, pontus, armenia, greek_cities, pergamon, macedon, egypt, seleucid

	begin_block 0
		min_units				4
		max_units				6
		not_general
		unit_type				phalanx	1.0
		default_melee_state		defend	; Mac phalanx
		unit_formation			phalanx
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


begin_formation	ai_small_phalanx_in_attack_1b

	;;; purpose flags
	attack

	ai_priority				10.0

	begin_block 0
		min_units				3
		max_units				3
		not_general
		unit_type				phalanx	1.0
		default_melee_state		defend	; Mac phalanx
		;unit_formation			phalanx		; when march let's ai decide
		;unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


begin_formation	ai_small_phalanx_in_pursue_1b

	;;; purpose flags
	pursue

	ai_priority				10.0

	begin_block 0
		min_units				3
		max_units				3
		not_general
		unit_type				phalanx	1.0
		default_melee_state		defend	; Mac phalanx
		unit_formation			phalanx		; when march let's ai decide
		;unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


begin_formation	ai_small_phalanx_in_defense_1b

	;;; purpose flags
	defend

	ai_priority				10.0

	begin_block 0
		min_units				3
		max_units				3
		not_general
		unit_type				phalanx	1.0
		default_melee_state		defend	; Mac phalanx
		unit_formation			phalanx
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


begin_formation	ai_small_phalanx_in_attack_2

	;;; purpose flags
	attack

	ai_priority				10.0

	begin_block 0
		min_units				2
		max_units				2
		not_general
		unit_type				phalanx	4.0
		default_melee_state		defend	; Mac phalanx
		;unit_formation			phalanx		; when march let's ai decide
		;unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


begin_formation	ai_small_phalanx_in_pursue_2

	;;; purpose flags
	pursue

	ai_priority				10.0

	begin_block 0
		min_units				2
		max_units				2
		not_general
		unit_type				phalanx	4.0
		default_melee_state		defend	; Mac phalanx
		unit_formation			phalanx		; when march let's ai decide
		;unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


begin_formation	ai_small_phalanx_in_defense_2

	;;; purpose flags
	defend

	ai_priority				10.0

	begin_block 0
		min_units				2
		max_units				2
		not_general
		unit_type				phalanx	4.0
		default_melee_state		defend	; Mac phalanx
		unit_formation			phalanx
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


begin_formation	ai_small_phalanx_in_attack_3

	;;; purpose flags
	attack

	ai_priority				10.0

	begin_block 0
		min_units				1
		max_units				1
		not_general
		unit_type				phalanx	4.0
		default_melee_state		defend	; Mac phalanx
		;unit_formation			phalanx		; when march let's ai decide
		;unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


begin_formation	ai_small_phalanx_in_pursue_3

	;;; purpose flags
	pursue

	ai_priority				10.0

	begin_block 0
		min_units				1
		max_units				1
		not_general
		unit_type				phalanx	4.0
		default_melee_state		defend	; Mac phalanx
		unit_formation			phalanx		; when march let's ai decide
		;unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


begin_formation	ai_small_phalanx_in_defense_3

	;;; purpose flags
	defend

	ai_priority				10.0

	begin_block 0
		min_units				1
		max_units				1
		not_general
		unit_type				phalanx	4.0
		default_melee_state		defend	; Mac phalanx
		unit_formation			phalanx
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


;****************************************************************
;The special small formation for non_phalanx_spear
;****************************************************************

begin_formation	ai_small_non_phalanx_spear_in_attack_1a

	;;; purpose flags			- for hoplites and thorakitai
	attack
	pursue

	ai_priority				10.0

	supported_factions			thrace, numidia, carthage, pontus, armenia, parthia, greek_cities, pergamon, macedon, egypt, seleucid

	begin_block 0
		min_units				3
		max_units				6
		not_general
		unit_type				non_phalanx_spear 1.0
		;unit_formation			shield_wall, square
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


begin_formation	ai_small_non_phalanx_spear_in_defense_1a

	;;; purpose flags			- for hoplites and thorakitai
	defend

	ai_priority				10.0

	supported_factions			thrace, numidia, carthage, pontus, armenia, parthia, greek_cities, pergamon, macedon, egypt, seleucid

	begin_block 0
		min_units				3
		max_units				6
		not_general
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


begin_formation	ai_small_non_phalanx_spear_in_attack_1b

	;;; purpose flags
	attack
	pursue

	ai_priority				10.0

	supported_factions			gauls, galatians,, britons, dacia, germans, spain, scythia, romans_julii, slave

	begin_block 0
		min_units				3
		max_units				6
		not_general
		unit_type				non_phalanx_spear 1.0
		default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


begin_formation	ai_small_non_phalanx_spear_in_defense_1b

	;;; purpose flags
	defend

	ai_priority				10.0

	supported_factions			gauls, galatians,, britons, dacia, germans, spain, scythia, romans_julii, slave

	begin_block 0
		min_units				3
		max_units				6
		not_general
		unit_type				non_phalanx_spear 1.0
		;unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


begin_formation	ai_small_non_phalanx_spear_in_attack_2

	;;; purpose flags
	attack

	ai_priority				10.0

	begin_block 0
		min_units				2
		max_units				2
		not_general
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		fire_at_will
		;unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation

begin_formation	ai_small_non_phalanx_spear_in_defense_2

	;;; purpose flags
	defend

	ai_priority				10.0

	begin_block 0
		min_units				2
		max_units				2
		not_general
		unit_type				non_phalanx_spear 1.0
		;default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation

;****************************************************************
;The special small formation for non-spear infantry
;****************************************************************

begin_formation	ai_small_infantry_in_attack_1a

	;;; purpose flags
	attack
	pursue

	ai_priority				10.0

	supported_factions			romans_julii,

	begin_block 0
		min_units				2
		max_units				5
		not_general
		unit_type				heavy infantry 1.0
		default_melee_state		fire_at_will
		;unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		20.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


begin_formation	ai_small_infantry_in_attack_1b

	;;; purpose flags
	attack
	pursue

	ai_priority				10.0

	supported_factions			romans_julii,

	begin_block 0
		min_units				2
		max_units				5
		not_general
		unit_type				light infantry 1.0
		default_melee_state		fire_at_will
		;unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


begin_formation	ai_small_infantry_in_attack_2

	;;; purpose flags
	attack

	ai_priority				10.0

	supported_factions			gauls, galatians,, britons, dacia, germans, spain, thrace, scythia

	begin_block 0
		min_units				1
		max_units				2
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		default_melee_state		fire_at_will
		;unit_density			close
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


begin_formation	ai_small_infantry_in_attack_3

	;;; purpose flags
	attack

	ai_priority				10.0

	supported_factions			numidia, carthage, pontus, armenia, parthia, greek_cities, pergamon, macedon, egypt, seleucid, slave

	begin_block 0
		min_units				1
		max_units				1
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		default_melee_state		fire_at_will
		;unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


begin_formation	ai_small_infantry_in_defense

	;;; purpose flags
	defend

	ai_priority				10.0

	supported_factions			gauls, galatians,, britons, dacia, germans, spain, thrace, scythia

	begin_block 0
		min_units				1
		max_units				1
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


;****************************************************************
;The special small formation for alone general unit
;****************************************************************


begin_formation	ai_small_general_defend

	;;; purpose flags
	defend

	ai_priority				10.0

	begin_block 0
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			shield_wall, schiltrom, square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			2.0
	end_block

	begin_block 1
		max_units				0
		not_general
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation

begin_formation	ai_small_general_attack

	;;; purpose flags
	attack

	ai_priority				1.0

	begin_block 0
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			2.0
	end_block

	begin_block 1
		max_units				0
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority			0.5
	end_block

end_formation


;***************************************************
;***************************************************
; Sinuhet's marching column formations
;***************************************************
;***************************************************

;****************************************************************
; Sinuhet's Triple Line. Missile troops in front, foot, in second
; row, mounted in third row - modified for marching
;****************************************************************

begin_formation ai_triple_missiles_in_front_easy_march

	;;; purpose flags
	march						; can use this for anything

	ai_priority				0.60

	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
	;;; the missile units
	begin_block 0
		max_units				10
		unit_type				missile infantry 1.0
		;default_melee_state		fire_at_will_and_skirmish
		;unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	begin_block 1
		max_units				10
		unit_type				missile infantry 1.0
		;default_melee_state		fire_at_will_and_skirmish
		;unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 -2.0
		inter_unit_spacing		0.1
		priority			0.9
	end_block

	begin_block 2
		max_units				10
		unit_type				missile infantry 1.0
		;default_melee_state		fire_at_will_and_skirmish
		;unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		1 0.0 -2.0
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	begin_block 3
		max_units				10
		unit_type				missile infantry 1.0
		;default_melee_state		fire_at_will_and_skirmish
		;unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		2 0.0 -2.0
		inter_unit_spacing		0.1
		priority			0.7
	end_block

	begin_dummy_block 4
		spans	0 1 2 3
	end_dummy_block

	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
	;;; the infantry units
	begin_block 5
		max_units				10
		unit_type				heavy infantry 1.0
		unit_type				spearmen infantry 0.9
		unit_type				skirmish infantry 0.8
		unit_type				light infantry 0.7
		;unit_formation			phalanx, shield_wall, schiltrom, square
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		4 0.0 -5.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	begin_block 6
		max_units				10
		unit_type				heavy infantry 1.0
		unit_type				spearmen infantry 0.9
		unit_type				skirmish infantry 0.8
		unit_type				light infantry 0.7
		;unit_formation			phalanx, shield_wall, schiltrom, square
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		5 0.0 -2.5
		inter_unit_spacing		0.1
		priority			0.9
	end_block

	begin_block 7
		max_units				10
		unit_type				heavy infantry 1.0
		unit_type				spearmen infantry 0.9
		unit_type				skirmish infantry 0.8
		unit_type				light infantry 0.7
		;unit_formation			phalanx, shield_wall, schiltrom, square
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		6 0.0 -1.5
		inter_unit_spacing		0.1
		priority			0.8
	end_block

	begin_block 8
		max_units				10
		unit_type				heavy infantry 1.0
		unit_type				spearmen infantry 0.9
		unit_type				skirmish infantry 0.8
		unit_type				light infantry 0.7
		;unit_formation			phalanx, shield_wall, schiltrom, square
		;unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		7 0.0 -1.0
		inter_unit_spacing		0.1
		priority			0.7
	end_block

	begin_dummy_block 9
		spans	5 6 7 8
	end_dummy_block

	begin_dummy_block 10
		spans	4 9
	end_dummy_block

	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
	;;; missile cavalry

	begin_block 11
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish
		;unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		10 20.0 0.0
		inter_unit_spacing		0.3
		priority			1.0
	end_block

	begin_block 12
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		;default_melee_state		fire_at_will_and_skirmish
		;unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		10 -20.0 0.0
		inter_unit_spacing		0.3
		priority			1.0
	end_block

	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
	;;; cavalry

	begin_block 13
		max_units				10
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.1
		unit_type				light cavalry 0.7
		;default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		10 0.0 -2.5
		inter_unit_spacing		0.3
		priority			1.0
	end_block

	begin_block 14
		max_units				10
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.1
		unit_type				light cavalry 0.7
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		13 0.0 -1.0
		inter_unit_spacing		0.3
		priority			0.9
	end_block

	begin_block 15
		max_units				10
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.1
		unit_type				light cavalry 0.7
		;default_melee_state		fire_at_will
		;unit_formation			square, wedge
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		14 0.0 -1.0
		inter_unit_spacing		0.3
		priority			0.8
	end_block

	begin_block 16
		max_units				10
		unit_type				heavy cavalry 1.0
		unit_type				spearmen cavalry 0.1
		unit_type				light cavalry 0.7
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		15 0.0 -1.0
		inter_unit_spacing		0.3
		priority			0.7
	end_block

	begin_dummy_block 17
		spans	13 14 15 16
	end_dummy_block

	begin_dummy_block 18
		spans	10 17
	end_dummy_block

	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

	;; put the artillery and handlers behind everyone

	begin_block 19
		unit_type				handler 1.0
		unit_type				siege 3.0
		;default_melee_state		fire_at_will
		max_unit_width			15
		block_formation			line
		block_relative_pos		18 0.0 -5.0
		inter_unit_spacing		1.0
		priority			1.0
	end_block

	;;; special general block
	begin_block 20
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		19 0.0 -15.0
		inter_unit_spacing		0.3
		priority			2.0
	end_block

	;; VIP is here
	begin_block 21
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		20 0.0 -5.0
		inter_unit_spacing		0.3
		priority			1.0
	end_block

end_formation




;****************************************************************
; A single column with infantry units in front, followed by
; missile troops followed by cavalry
;****************************************************************

begin_formation ai_single_column_infantry_in_front

	;;; purpose flags
	march

	ai_priority				0.60

	;;; infantry front block
	begin_block 0
		min_units				2
		max_units				3
		not_general
		unit_type				spearmen infantry 1.0
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.1
		;default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	;;; infantry behind
	begin_block 1
		min_units				3
		not_general
		unit_type				missile infantry 1.0
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		0.2
		priority			0.9
	end_block

	;;; cavalry behind
	begin_block 2
		min_units				2
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		1 0.0 -10.0
		inter_unit_spacing		1.0
		priority			0.8
	end_block

	;;; cavalry behind
	begin_block 3
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		2 0.0 -10.0
		inter_unit_spacing		1.0
		priority			0.8
	end_block

	begin_dummy_block 4
		spans	0 1 2 3
	end_dummy_block

	;; artillery and handlers behind everyone
	begin_block 5
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				any 0.001
		max_unit_width			24
		block_formation			column
		block_relative_pos		4 0.0 -5.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	begin_dummy_block 6
		spans	0 1 2 3 4 5
	end_dummy_block

	;; general at the back
	begin_block 7
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		6 0.0 -18.0
		inter_unit_spacing		0.2
		priority			2.0
	end_block

	;; VIP is here
	begin_block 8
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		7 0.0 -5.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

end_formation


;****************************************************************
; A single column with cavalry units in front, followed by
; missile troops followed by infantry
;****************************************************************

begin_formation ai_single_column_cavalry_in_front

	;;; purpose flags
	march

	ai_priority				0.60

	;;; cavalry in front
	begin_block 0
		min_units				2
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		;default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		1.0
		priority			1.0
	end_block

	;;; cavalry in front
	begin_block 1
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 1.0
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		1.0
		priority			1.0
	end_block

	;;; missile units behind
	begin_block 2
		min_units				3
		not_general
		unit_type				missile infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		1 0.0 -15.0
		inter_unit_spacing		0.2
		priority			0.9
	end_block

	;;; infantry front block
	begin_block 3
		min_units				2
		max_units				3
		not_general
		unit_type				spearmen infantry 1.0
		unit_type				heavy infantry 0.9
		unit_type				light infantry 0.0
		unit_type				missile infantry 0.0
		;default_melee_state		fire_at_will
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		2 0.0 -5.0
		inter_unit_spacing		0.2
		priority			0.9
	end_block

	;;; infantry further behind
	begin_block 4
		min_units				3
		not_general
		unit_type				spearmen infantry 1.0
		unit_type				heavy infantry 1.0
		unit_type				light infantry 1.0
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		3 0.0 -5.0
		inter_unit_spacing		0.2
		priority			0.8
	end_block

	begin_dummy_block 5
		spans	0 1 2 3 4
	end_dummy_block

	;; artillery and handlers behind everyone
	begin_block 6
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				any 0.001
		max_unit_width			24
		block_formation			column
		block_relative_pos		5 0.0 -5.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	begin_dummy_block 7
		spans	0 1 2 3 4 5 6
	end_dummy_block

	;; general at the back
	begin_block 8
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			15
		block_formation			column
		block_relative_pos		7 0.0 -18.0
		inter_unit_spacing		0.2
		priority			2.0
	end_block

	;; VIP is here
	begin_block 9
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			15
		block_formation			line
		block_relative_pos		8 0.0 -5.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

end_formation



;****************************************************************
; Bridge assault column
;****************************************************************


begin_formation ai_crossing_assault_force

	;;; purpose flags
	crossing_assault_force
	ai_priority					0.1								;; priority low, so we only choose if the flag is set

	;;; front block
	begin_block 0
		min_units				1
		not_general
		unit_type				heavy infantry		1.0
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority				0.9
	end_block

	;;; behind
	begin_block	1
		max_units				2
		unit_type				heavy infantry		1.0
		unit_type				light infantry		0.9
		unit_type				heavy cavalry		0.7
		unit_type				light cavalry		0.7
		unit_type				skirmish cavalry	0.7
		unit_type				heavy infantry		0.6
		unit_type				light infantry		0.6
		unit_type				skirmish infantry	0.6
		unit_type				any					0.1
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		0 0.0 -2.0
		inter_unit_spacing		2.0
		priority				0.8

	end_block

	;;; further behind
	begin_block 2
		max_units				3
		unit_type				light infantry		0.9
		unit_type				heavy cavalry		0.7
		unit_type				light cavalry		0.7
		unit_type				skirmish cavalry	0.7
		unit_type				missile cavalry		0.7
		unit_type				heavy infantry		0.6
		unit_type				light infantry		0.6
		unit_type				skirmish infantry	0.6
		unit_type				any					0.1
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		1 0.0 -2.0
		inter_unit_spacing		2.0
		priority				0.6
	end_block

	;;; main body of units (everything else)
	begin_block 3
		unit_type				any					1.0
		unit_density			close
		block_formation			column
		block_relative_pos		2 0.0 -8.0
		inter_unit_spacing		2.0
		priority				0.4
	end_block

	;;; if we have any swimming units put them on the flanks so they can swim over
	;;; and increase our attacking bandwidth
	begin_dummy_block 4
		spans 0 1 2 3
	end_dummy_block

	begin_block 5
		;;; at the moment all swimming units have to swim	max_units				2
		unit_type				swimming			1.0
		unit_density			close
		block_formation			line
		block_relative_pos		4 -10.0 0
		inter_unit_spacing		2.0
		priority				1.0
	end_block
	
	begin_block 6
		;;;max_units				2
		unit_type				swimming			1.0
		unit_density			close
		block_formation			line
		block_relative_pos		4 10.0 0
		inter_unit_spacing		2.0
		priority				1.0
	end_block

end_formation




;****************************************************************
; Bridge assault cover force
;****************************************************************

begin_formation ai_crossing_assault_cover

	crossing_assault_cover
	ai_priority					0.1								;; priority low, so we only choose if the flag is set

	begin_dummy_block 0											;; centre slot left empty for assault column to pass through
		spacer 0.0 0.0 35 20
	end_dummy_block

	begin_block 1												;; left front shooting position
		unit_type				missile infantry	1
		unit_type				missile cavalry		0.9
		unit_type				any					0.1
		unit_density			close
		block_formation			line
		block_relative_pos		0 -1.0 0.0
		inter_unit_spacing		2.0
		priority				1.0
	end_block

	begin_block 2												;; right front shooting position
		unit_type				missile infantry	1
		unit_type				missile cavalry		0.9
		unit_type				any					0.1
		unit_density			close
		block_formation			line
		block_relative_pos		0 1.0 0.0
		inter_unit_spacing		2.0
		priority				1.0
	end_block

	begin_block 3												;; left rear shooting position
		max_units				2
		unit_type				missile infantry	1
		unit_type				missile cavalry		0.9
		unit_density			close
		block_formation			line
		block_relative_pos		1 0.0 -3.0
		inter_unit_spacing		2.0
		priority				0.1
	end_block

	begin_block 4												;; right rear shooting position
		max_units				2
		unit_type				missile infantry	1
		unit_type				missile cavalry		0.9
		unit_density			close
		block_formation			line
		block_relative_pos		2 0.0 -3.0
		inter_unit_spacing		2.0
		priority				0.1
	end_block

	begin_block 5
		unit_type				siege				1			;; left artillery shooting position
		unit_density			close
		block_formation			line
		block_relative_pos		3 0.0 -60.0
		inter_unit_spacing		2.0
		priority				0.7
	end_block

	begin_block 6
		unit_type				siege				1			;; right artillery shooting position
		unit_density			close
		block_formation			line
		block_relative_pos		4 0.0 -60.0
		inter_unit_spacing		2.0
		priority				0.7
	end_block

end_formation


;****************************************************************
; Crossing Block
; For mixed missile and infantry forces
; defending close by a crossing
;****************************************************************

begin_formation ai_crossing_block
	
	crossing_block
	ai_priority					0.1								;; priority low, so we only choose if the flag is set

	;;; in front of bridge blocking crossing
	begin_block 0
		min_units				1
		max_units				1
		unit_type				heavy infantry			1
		unit_type				light infantry			0.5
		unit_type				skirmish infantry		0.5
		unit_type				any						0.0
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority				1.0
	end_block

	;;; left support of block 0
	begin_block 1
		max_units				1
		unit_type				heavy infantry			1
		unit_type				light infantry			0.8
		unit_type				skirmish infantry		0.8
		unit_type				heavy cavalry			0.1
		unit_type				light cavalry			0.1
		unit_type				skirmish cavalry		0.1
		unit_density			close
		block_formation			line
		block_relative_pos		0 -8.0 -1.0						;; to the left and slightly behind the back of block 0
		inter_unit_spacing		2.0
		priority				0.9
	end_block

	;;; right support of block 0
	begin_block 2
		max_units				1
		unit_type				heavy infantry			1
		unit_type				light infantry			0.8
		unit_type				skirmish infantry		0.8
		unit_type				heavy cavalry			0.1
		unit_type				light cavalry			0.1
		unit_type				skirmish cavalry		0.1
		unit_density			close
		block_formation			line
		block_relative_pos		0 8.0 -1.0						;; to the right and slightly behind the back of block 0
		inter_unit_spacing		2.0
		priority				0.9
	end_block

	;;; missile troops behind
	begin_block 3
		unit_type				missile infantry		1.0
		unit_type				missile cavalry			1.0
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		2.0
		priority				0.9
	end_block

	;;; final line for other troops
	begin_block 4
		unit_type				heavy infantry			1.0
		unit_type				light infantry			1.0
		unit_type				skirmish infantry		1.0
		unit_type				heavy cavalry			1.0
		unit_type				light cavalry			1.0
		unit_type				skirmish cavalry		1.0
		unit_type				any						0.1
		unit_density			close
		block_formation			line
		block_relative_pos		3 0.0 -10.0
		inter_unit_spacing		2.0
		priority				0.1
	end_block

end_formation




;****************************************************************
; Crossing Defend
; For mixed missile and infantry forces
; conducting a standoff defence of a bridge
;****************************************************************


begin_formation ai_crossing_defend

	crossing_defend
	ai_priority					0.1								;; priority low, so we only choose if the flag is set

	;;; missile units in the centre
	begin_block 0
		min_units				1
		max_units				2
		unit_type				missile infantry				1.0
		unit_type				missile cavalry					0.8
		unit_type				heavy infantry					0.7
		unit_type				any								0.0
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority				1
	end_block

	;;; melee troops to left of flank shooters
	begin_block 1
		min_units				0
		max_units				2
		unit_type				heavy infantry					1.0
		unit_type				light infantry					0.7
		unit_type				skirmish infantry				0.7
		unit_type				heavy cavalry					0.7
		unit_type				light cavalry					0.7
		unit_type				skirmish cavalry				0.7
		unit_type				any								0.0
		block_formation			line
		block_relative_pos		0 -5.0 0.0
		inter_unit_spacing		2.0
		priority				0.9
	end_block

	;;; melee troops to left of flank shooters
	begin_block 2
		min_units				0
		max_units				2
		unit_type				heavy infantry					1.0
		unit_type				light infantry					0.7
		unit_type				skirmish infantry				0.7
		unit_type				heavy cavalry					0.7
		unit_type				light cavalry					0.7
		unit_type				skirmish cavalry				0.7
		unit_type				any								0.0
		block_formation			line
		block_relative_pos		0 5.0 0.0
		inter_unit_spacing		2.0
		priority				0.9
	end_block

	;;; everyone else in the second line
	begin_block 3
		unit_type				any								1.0
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		2.0
		priority				0.5
	end_block

end_formation




;****************************************************************
; Wall Assault Variation
; Siege engine in the centre, covering troops on the flanks
; other units in a column behind, waiting to go up the siege tower
; modified by Sinuhet
;****************************************************************

;****************************************************************
; Wall Assault*EAST CULTURE*
; Siege engine in the centre, covering troops on the flanks
; other units in a column behind, waiting to go up the siege tower
;****************************************************************

begin_formation ai_wall_assault_eastern

	wall_assault_force

	ai_priority				1.0	;; M2TW level of priority

	supported_factions			carthage, numidia, parthia, pontus, armenia

	;;; gap for siege engines in the centre
	begin_dummy_block 0			;; centre slot left empty for assault column to pass through
		spacer 0.0 0.0 35 20
	end_dummy_block

	;;; Infantry to the rear of siege engine
	begin_block 1
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		;unit_type				phalanx 0.3
		unit_type				any 0.001
		;default_melee_state		skirmish
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		0 0.0 -35.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block


	;;; all other units behind the siege engine
	begin_block 2
		not_general
		unit_type				non_phalanx_spear 1.0
		unit_type				heavy infantry 0.5
		unit_type				phalanx 0.5
		unit_type				any 0.001
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		1 5.0 0.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;;; all other units behind the siege engine
	begin_block 3
		not_general
		unit_type				non_phalanx_spear 1.0
		unit_type				heavy infantry 0.5
		unit_type				phalanx 0.5
		unit_type				any 0.001
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		1 -5.0 0.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block


	begin_dummy_block 4
		spans	1 2 3
	end_dummy_block

	;;; special general block
	begin_block 5
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		4 0.0 -10.0
		inter_unit_spacing		0.2
		priority			2.0
	end_block

	;; VIP is here
	begin_block 6
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		5 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

end_formation



;****************************************************************
; Wall Assault*BARBARIAN CULTURE*
; Siege engine in the centre, covering troops on the flanks
; other units in a column behind, waiting to go up the siege tower
;****************************************************************

begin_formation ai_wall_assault_barbarian

	wall_assault_force

	ai_priority				1.0	;; M2TW level of priority

	supported_factions			gauls, galatians,, britons, dacia, germans, spain, scythia, slave

	;;; gap for siege engines in the centre
	begin_dummy_block 0			;; centre slot left empty for assault column to pass through
		spacer 0.0 0.0 35 20
	end_dummy_block

	;;; archers to the rear of siege engine
	begin_block 1
		max_units				1
		not_general
		unit_type				missile infantry 1.0
		unit_type				missile cavalry 0.3
		unit_type				skirmish cavalry 0.3
		unit_type				heavy infantry 0.1
		unit_type				any 0.001
		;default_melee_state		skirmish
		;unit_formation			square
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		0.2
		priority			1
	end_block


	;;; all other units behind the siege engine
	begin_block 2
		max_units				2
		not_general
		unit_type				heavy infantry 1.0
		unit_type				spearmen infantry 0.5
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		1 0.0 -20.0
		inter_unit_spacing		0.1
		priority			0.7
	end_block

	begin_block 3
		max_units				2
		not_general
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		2 0.0 -6.0
		inter_unit_spacing		0.2
		priority			0.1
	end_block

	begin_block 4
		max_units				2
		not_general
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		3 0.0 -6.0
		inter_unit_spacing		0.2
		priority			0.1
	end_block

	begin_block 5
		not_general
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		4 0.0 -15.0
		inter_unit_spacing		0.2
		priority			0.1
	end_block

	begin_dummy_block 6
		spans	1 2 3 4 5
	end_dummy_block

	;;; special general block
	begin_block 7
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		6 0.0 -10.0
		inter_unit_spacing		0.2
		priority			2.0
	end_block

	;; VIP is here
	begin_block 8
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		7 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

end_formation



;****************************************************************
; Wall Assault*ROMAN CULTURE*
; Siege engine in the centre, covering troops on the flanks
; other units in a column behind, waiting to go up the siege tower
;****************************************************************


begin_formation ai_wall_assault_roman

	wall_assault_force

	ai_priority				1.0	;; M2TW level of priority

	supported_factions			romans_julii,

	;;; gap for siege engines in the centre
	begin_dummy_block 0			;; centre slot left empty for assault column to pass through
		spacer 0.0 0.0 35 20
	end_dummy_block

	;;; Legions to the rear of siege engine in long maniples
	begin_block 1
		not_general
		unit_type				heavy_pilum_infantry 1.0
		unit_type				light_pilum_infantry 0.5
		unit_type				heavy infantry 0.1
		unit_type				any 0.001
		;default_melee_state		skirmish
		unit_formation			square	; can't use testudo here as it would cause weird exit
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 -25.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block


	;;; all other units behind the siege engine in long maniple formation
	begin_block 2
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		unit_type				any 0.001
		unit_formation			square	; can't use testudo here as it would cause weird exit
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		1 0.0 -5.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	begin_block 3
		not_general
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		2 0.0 -6.0
		inter_unit_spacing		10.0
		priority			0.1
	end_block

	begin_block 4
		not_general
		unit_type				any 0.001
		;unit_formation			square
		unit_density			close
		max_unit_width			20
		block_formation			line
		block_relative_pos		3 0.0 -6.0
		inter_unit_spacing		10.0
		priority			0.05
	end_block


	begin_dummy_block 5
		spans	1 2 3 4
	end_dummy_block

	;;; special general block
	begin_block 6
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		5 0.0 -10.0
		inter_unit_spacing		0.2
		priority			2.0
	end_block

	;; VIP is here
	begin_block 7
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		6 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

end_formation



;****************************************************************
; Wall Assault*GREEK CULTURE*
; Siege engine in the centre, covering troops on the flanks
; other units in a column behind, waiting to go up the siege tower
;****************************************************************


begin_formation ai_wall_assault_greek

	wall_assault_force

	ai_priority				1.0	;; M2TW level of priority

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, thrace

	;;; gap for siege engines in the centre
	begin_dummy_block 0					;; centre slot left empty for assault column to pass through
		spacer 0.0 0.0 35 20
	end_dummy_block

	;;; Infantry to the rear of siege engine
	begin_block 1
		not_general
		unit_type				heavy infantry 1.0
		unit_type				non_phalanx_spear 0.8
		;unit_type				phalanx 0.3
		unit_type				any 0.001
		;default_melee_state		skirmish
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		0 0.0 -25.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block


	;;; all other units behind the siege engine
	begin_block 2
		not_general
		unit_type				non_phalanx_spear 1.0
		unit_type				heavy infantry 0.5
		unit_type				phalanx 0.5
		unit_type				any 0.001
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		1 5.0 0.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block

	;;; all other units behind the siege engine
	begin_block 3
		not_general
		unit_type				non_phalanx_spear 0.3
		unit_type				heavy infantry 0.2
		unit_type				phalanx 1.0
		unit_type				any 0.001
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		1 -5.0 0.0
		inter_unit_spacing		0.2
		priority			0.3
	end_block


	begin_dummy_block 4
		spans	1 2 3
	end_dummy_block

	;;; special general block
	begin_block 5
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		4 0.0 -10.0
		inter_unit_spacing		0.2
		priority			2.0
	end_block

	;; VIP is here
	begin_block 6
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		5 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

end_formation



;****************************************************************
; Wall Assault*NOMAD CULTURE*
; Siege engine in the centre, covering troops on the flanks
; other units in a column behind, waiting to go up the siege tower
;****************************************************************

begin_formation ai_wall_assault_nomad

	wall_assault_force

	ai_priority				1.0	;; M2TW level of priority

	supported_factions			scythia, numidia

	;;; gap for siege engines in the centre
	begin_dummy_block 0				;; centre slot left empty for assault column to pass through
		spacer 0.0 0.0 35 20
	end_dummy_block

	;;; archers to the left of siege engine
	begin_block 1
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.1
		unit_type				any 0.001
		default_melee_state		fire_at_will
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 -5.0 0.0
		inter_unit_spacing		2.0
		priority			1
	end_block

	;;; archers to the right of siege engine
	begin_block 2
		not_general
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.1
		unit_type				any 0.001
		default_melee_state		fire_at_will
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 5.0 0.0
		inter_unit_spacing		2.0
		priority			1
	end_block

	;;; Infantry to the rear of siege engine
	begin_block 3
		not_general
		unit_type				heavy infantry 1.0
		unit_type				spearmen infantry 0.5
		unit_type				light infantry 0.5
		;default_melee_state		skirmish
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			20
		block_formation			column
		block_relative_pos		0 0.0 -25.0
		inter_unit_spacing		0.2
		priority			1.0
	end_block

	begin_block 4
		max_units				3
		not_general
		unit_type				missile cavalry 0.8
		unit_type				skirmish cavalry 0.4
		default_melee_state		fire_at_will_and_skirmish
		;unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		3 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.7
	end_block

	begin_block 5
		max_units				5
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		4 -5.0 0.0
		inter_unit_spacing		2.0
		priority			0.7
	end_block

	begin_block 6
		max_units				5
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		;unit_density			close
		max_unit_width			30
		block_formation			column
		block_relative_pos		4 5.0 0.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	begin_block 7
		max_units				3
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.5
		;unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		4 0.0 -10.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_block 8
		max_units				5
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.5
		;unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		8 -5.0 0.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	begin_block 9
		max_units				5
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 0.5
		;unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		9 5.0 0.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	begin_block 10
		not_general
		unit_type				siege 3.0
		unit_type				any 0.001
		;unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		7 0.0 -10.0
		inter_unit_spacing		2.0
		priority			0.1
	end_block

	begin_dummy_block 11
		spans	0 1 2 3 4 5 6 7 8 9 10
	end_dummy_block

	;;; general at the back
	begin_block 12
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		11 0.0 -10.0
		inter_unit_spacing		2.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 13
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		12 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block




end_formation




;****************************************************************
; Basic Wall Assault
; Modified from Wall Assault *by Germanicu5 for ReallyBadAI and Sinuhet's Wall Assault
; Siege engine in the centre, covering troops on the flanks
; other units in a column behind, waiting to go up the siege tower
; event "wall_assault_force" not support existence of siege engine in formation condition
;****************************************************************

begin_formation ai_wall_assault_basic_a

	wall_assault_force

	ai_priority				1.0	;; M2TW level of priority


	;;; gap for siege engines in the centre
	begin_dummy_block 0		;; centre slot left empty for assault column to pass through
		spacer 0.0 0.0 20 10
	end_dummy_block

	;; infantry covering artillery
	begin_block 1
		min_units				1
		max_units				1
		not_general
		unit_type				spearmen infantry 1.0
		unit_type				phalanx 0.9
		unit_type				heavy infantry 0.8
		unit_type				light infantry 0.7
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -0.1
		inter_unit_spacing		0.0
		priority			0.5
	end_block

	;;; all other units behind the siege engine


	; Screen of missile inf
	begin_block 2
		max_units				1
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		unit_density			loose
		max_unit_width			40
		block_formation			line
		block_relative_pos		0 0.0 20.0
		inter_unit_spacing		2.0
		priority			0.3
	end_block

	;;;;; next 3 blocks aren't used
	;;; rams at the centre
	begin_block 3
		max_units 2
		unit_type				carrying_siege_engine ram 1.0
		unit_density			close
		block_formation			line
		block_relative_pos		1 0.0 -5.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; other engines left side
	begin_block 4
		max_units 1
		unit_type				carrying_siege_engine ladder 1.0
		unit_type				carrying_siege_engine tower 1.0
		unit_density			close
		block_formation			line
		block_relative_pos		3 -15.0 0.0
		inter_unit_spacing		5.0
		priority			0.5
	end_block

	;; other engines right side
	begin_block 5
		max_units 1
		unit_type				carrying_siege_engine ladder 1.0
		unit_type				carrying_siege_engine tower 1.0
		unit_density			close
		block_formation			line
		block_relative_pos		3 15.0 0.0
		inter_unit_spacing		5.0
		priority			0.5
	end_block

	begin_dummy_block 6
		spans	0 1
	end_dummy_block

	;; First line of infantry
	begin_block 7
		min_units				2
		max_units				4
		not_general
		unit_type				light infantry 1.0
		unit_type				heavy infantry 0.9
		unit_type				non_phalanx_spear 0.8
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 0.0 -50.0
		inter_unit_spacing		7.5
		priority			0.4
	end_block

	;; second line of infantry
	begin_block 8
		max_units				4
		unit_type				heavy infantry 1.0
		unit_type				non_phalanx_spear 0.9
		unit_type				light infantry 0.8
		unit_formation			shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		7 0.0 -10.0
		inter_unit_spacing		7.5
		priority			0.3
	end_block

	;; 3rd line of infantry, guard of archers
	begin_block 9
		max_units				4
		unit_type				phalanx 1.0
		unit_type				non_phalanx_spear 0.8
		unit_type				heavy infantry 0.6
		unit_type				light infantry 0.2
		unit_formation			phalanx, shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		8 0.0 -10.0
		inter_unit_spacing		0.0
		priority			0.2
	end_block

	;; Archers behind
	begin_block 10
		max_units				3
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		unit_type				any 0.001
		default_melee_state		fire_at_will_and_defend
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 0.0 -10.0
		inter_unit_spacing		2.0
		priority			0.25
	end_block

	begin_dummy_block 11
		spans	7 8 9 10
	end_dummy_block

	;; missile left 1
	begin_block 12
		min_units				2
		max_units				3
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.9
		unit_density			close
		max_unit_width			40
		block_formation			column
		block_relative_pos		11 -7.5 -15.0
		inter_unit_spacing		5.0
		priority			0.5
	end_block

	;; missile right 1
		begin_block 13
		min_units				2
		max_units				3
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.9
		unit_density			close
		max_unit_width			40
		block_formation			column
		block_relative_pos		11 7.5 -15.0
		inter_unit_spacing		5.0
		priority			0.5
	end_block

	;; missile left 2
	begin_block 14
		min_units				1
		max_units				3
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.9
		unit_density			close
		max_unit_width			40
		block_formation			column
		block_relative_pos		12 -7.5 0.0
		inter_unit_spacing		5.0
		priority			0.4
	end_block

	;; missile right 2
	begin_block 15
		min_units				1
		max_units				3
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.9
		unit_density			close
		max_unit_width			40
		block_formation			column
		block_relative_pos		14 7.5 0.0
		inter_unit_spacing		5.0
		priority			0.4
	end_block

	begin_dummy_block 16
		spans	11 12 13 14 15
	end_dummy_block

	;; reserve of spearmen
	begin_block 17
		unit_type				phalanx 0.50
		unit_type				non_phalanx_spear 0.45
		default_melee_state		fire_at_will
		unit_formation			phalanx, shield_wall, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		16 0.0 -10.0
		inter_unit_spacing		0.0
		priority			0.20
	end_block

	;; reserve of missile units
	begin_block 18
		unit_type				ranged_missile_infantry 0.50
		unit_type				missile infantry 0.25
		default_melee_state		fire_at_will_and_skirmish
		;unit_formation			square
		max_unit_width			40
		block_formation			line
		block_relative_pos		17 0.0 -1.0
		inter_unit_spacing		7.5
		priority			0.10
	end_block

	;; reserve of heavy infantry
	begin_block 19
		unit_type				heavy infantry 0.50
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		18 0.0 -10.0
		inter_unit_spacing		7.5
		priority			0.20
	end_block

	;; reserve of light infantry
	begin_block 20
		unit_type				light infantry 0.50
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		19 0.0 -1.0
		inter_unit_spacing		7.5
		priority			0.20
	end_block

	begin_dummy_block 21
		spans 1 17 18 19 20
	end_dummy_block

	;; general at the back
	begin_block 22
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		21 0.0 -35.0
		inter_unit_spacing		20.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 23
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		22 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; left flank cav
	begin_block 24
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			24
		block_formation			square
		block_relative_pos		22 -10.0 10.0
		inter_unit_spacing		4.0
		priority			0.25
	end_block

	;; right flank cav
	begin_block 25
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		max_unit_width			24
		block_formation			square
		block_relative_pos		22 10.0 10.0
		inter_unit_spacing		4.0
		priority			0.25
	end_block

	;; left flank missile cav
	begin_block 26
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		unit_type				any 0.001
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			column
		block_relative_pos		24 -5.0 0.0
		inter_unit_spacing		4.0
		priority			0.3
	end_block

	;; right flank missile cav
	begin_block 27
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		unit_type				any 0.001
		default_melee_state		fire_at_will_and_skirmish
		max_unit_width			30
		block_formation			column
		block_relative_pos		25 5.0 0.0
		inter_unit_spacing		4.0
		priority			0.3
	end_block

	;; artillery and handlers at the back
	begin_block 28
		unit_type				handler 1.0
		block_formation			line
		block_relative_pos		23 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.25
	end_block

	;; any behind
	begin_block 29
		unit_type				any 0.001
		block_formation			line
		block_relative_pos		24 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.05
	end_block

end_formation



;****************************************************************
; Siege deployment Variation
; The engines have already been assigned at this point
; Put rams in the centre front, other engines at the front either side
;****************************************************************

;****************************************************************
; M2TW's AI settlement attack reform
;****************************************************************

begin_formation ai_settlement_attack_reform
	;;; purpose flags

	ai_priority				0.2


	;;; rams at the centre
	begin_block 0
		not_general
		unit_type				carrying_siege_engine ram 2.0
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.5
		priority			1.0
	end_block

	;; other engines left side
	begin_block 1
		not_general
		unit_type				carrying_siege_engine ladder 2.0
		unit_type				carrying_siege_engine tower 2.0
		unit_type				siege 3.0
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 -1.0 0.0
		inter_unit_spacing		0.5
		priority			1.0
	end_block

	;; other infantry left side(back)
	begin_block 2
		unit_type				heavy infantry 0.7
		unit_type				light infantry 0.7
		unit_type				skirmish infantry 0.7
		unit_type				missile infantry 0.4
		unit_formation			shield_wall, schiltrom, square
		;unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 -1.0 -10.0
		inter_unit_spacing		0.5
		priority			0.5
	end_block

	;; other engines right side
	begin_block 3
		not_general
		unit_type				carrying_siege_engine ladder 2.0
		unit_type				carrying_siege_engine tower 2.0
		unit_type				siege 3.0
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 1.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; other infantry right side(back)
	begin_block 4
		unit_type				heavy infantry 0.7
		unit_type				light infantry 0.7
		unit_type				skirmish infantry 0.7
		unit_type				missile infantry 0.4
		unit_formation			shield_wall, schiltrom, square
		;unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 1.0 -10.0
		inter_unit_spacing		0.5
		priority			0.5
	end_block

	begin_dummy_block 5
		spans	0 1 2 3 4
	end_dummy_block

	;;; cavalry on both sides
	begin_block 6
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		unit_type				skirmish cavalry 0.1
		unit_type				any 0.001
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		5 1.0 0.0
		inter_unit_spacing		0.5
		priority			0.1
	end_block

	begin_block 7
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		unit_type				skirmish cavalry 0.1
		unit_type				any 0.001
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			square
		block_relative_pos		5 -1.0 0.0
		inter_unit_spacing		0.5
		priority			0.1
	end_block

end_formation


;****************************************************************
; Siege deployment*EASTERN CULTURE*
; The engines have already been assigned at this point
; Put rams in the centre front, other engines at the front either side
;****************************************************************

begin_formation deployment_siege_eastern

	standard_siege_attacker_deployment

	ai_priority				1.0	;; set at M2TW level priority

	supported_factions			carthage, numidia, parthia, pontus, armenia

	;;; all engines at the center
	begin_block 0
		unit_type				carrying_siege_engine ram 2.0
		unit_type				carrying_siege_engine tower 1.8
		unit_type				carrying_siege_engine ladder 1.6
		unit_density			close		; always deploy and defend as close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		20.0
		priority			1.0
	end_block


	;; other infantry (back)
	begin_block 1
		not_general
		unit_type				heavy infantry 1.0
		unit_type				non_phalanx_spear 0.5
		unit_type				light infantry 0.3
		unit_type				any 0.001
		;default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -7.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; other infantry (back)(more)
	begin_block 2
		not_general
		unit_type				non_phalanx_spear 0.5
		unit_type				heavy infantry 0.3
		unit_type				phalanx 1.0
		unit_type				any 0.001
		;default_melee_state		defend
		unit_formation			phalanx, shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -7.0
		inter_unit_spacing		0.0
		priority			0.7
	end_block

	;; other infantry (back)(more)(missile)
	begin_block 3
		not_general
		unit_type				missile infantry 1.0
		unit_type				any 0.001
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		2 0.0 -15.0
		inter_unit_spacing		0.2
		priority			0.7
	end_block

	begin_dummy_block 4
		spans	1 2 3
	end_dummy_block

	;;; archers behind to give support
	begin_block 5
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		unit_type				ranged_missile_infantry 2.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 0.0 -15.0
		inter_unit_spacing		5.0
		priority			0.5
	end_block

	begin_dummy_block 6
		spans	1 2 3 4 5
	end_dummy_block

	;;; cavalry at the back
	begin_block 7
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		unit_type				skirmish cavalry 0.1
		unit_type				any 0.001
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 0.0 -25.0
		inter_unit_spacing		0.2
		priority			0.9
	end_block

	begin_dummy_block 8
		spans	1 2 3 4 5 6 7
	end_dummy_block

	;;; special general block
	begin_block 9
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		8 0.0 -5.0
		inter_unit_spacing		0.2
		priority			2.0
	end_block

	;; VIP is here
	begin_block 10
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		9 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

end_formation



;****************************************************************
; Siege deployment*BARBARIAN CULTURE*
; The engines have already been assigned at this point
; Put rams in the centre front, other engines at the front either side
;****************************************************************

begin_formation deployment_siege_barbarian

	standard_siege_attacker_deployment

	ai_priority				1.0	;; set at M2TW level priority

	supported_factions			gauls, galatians,, germans, spain, slave

	;;; rams at the centre
	begin_block 0
		unit_type				carrying_siege_engine ram 2.0
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		20.0
		priority			1.0
	end_block

	;; other engines left side
	begin_block 1
		unit_type				carrying_siege_engine ladder 2.0
		unit_type				carrying_siege_engine tower 2.0
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		0 -10.0 0.0
		inter_unit_spacing		20.0
		priority			1.0
	end_block

	;; other engines right side
	begin_block 2
		unit_type				carrying_siege_engine ladder 2.0
		unit_type				carrying_siege_engine tower 2.0
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		0 10.0 0.0
		inter_unit_spacing		20.0
		priority			1.0
	end_block

	begin_dummy_block 3
		spans	0 1 2
	end_dummy_block

	;; other infantry (back)
	begin_block 4
		not_general
		unit_type				heavy infantry 0.7
		unit_type				light infantry 0.7
		unit_type				skirmish infantry 0.1
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 0.0 -7.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block

	;; other infantry (back)(more)
	begin_block 5
		not_general
		unit_type				heavy infantry 0.7
		unit_type				light infantry 0.7
		unit_type				skirmish infantry 0.1
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 0.0 -7.0
		inter_unit_spacing		0.2
		priority			0.6
	end_block


	begin_dummy_block 6
		spans	1 2 3 4 5
	end_dummy_block

	;;; archers behind to give support
	begin_block 7
		not_general
		unit_type				missile infantry 1.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		6 0.0 -45.0
		inter_unit_spacing		0.2
		priority			0.9
	end_block

	;;; cavalry at the back
	begin_block 8
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		unit_type				skirmish cavalry 0.1
		unit_type				any 0.001
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		7 0.0 -15.0
		inter_unit_spacing		0.2
		priority			0.9
	end_block

	begin_dummy_block 9
		spans	1 2 3 4 5 6 7 8
	end_dummy_block

	;;; special general block
	begin_block 10
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		8 0.0 -8.0
		inter_unit_spacing		0.2
		priority			2.0
	end_block

	;; VIP is here
	begin_block 11
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		10 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

end_formation



;****************************************************************
; Siege deployment*ROMAN CULTURE* Darth&Sinuhet ExRM (merged)
; The engines have already been assigned at this point
; Put rams in the centre front, other engines at the front either side
;****************************************************************

begin_formation deployment_siege_roman

	;;; purpose flags
	standard_siege_attacker_deployment

	ai_priority				1.0	;; set at M2TW level priority

	supported_factions			romans_julii,

	;;; rams at the centre
	begin_block 0
		unit_type				carrying_siege_engine ram 2.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		20.0
		priority			1.0
	end_block

	;; other engines left side
	begin_block 1
		unit_type				carrying_siege_engine ladder 2.0
		unit_type				carrying_siege_engine tower 2.0
		unit_density			close		; always deploy and defend as close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 -20.0 0.0
		inter_unit_spacing		20.0
		priority			1.0
	end_block

	;; other engines right side
	begin_block 2
		unit_type				carrying_siege_engine ladder 2.0
		unit_type				carrying_siege_engine tower 2.0
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		0 20.0 0.0
		inter_unit_spacing		20.0
		priority			1.0
	end_block

	begin_dummy_block 3
		spans	0 1 2
	end_dummy_block

	;; other units behind

	;; hastati line
	begin_block 4
		max_units				3
		unit_type				light_pilum_infantry 1.0
		unit_type				carrying_siege_engine ram 0.0
		unit_type				carrying_siege_engine ladder 0.0
		unit_type				carrying_siege_engine tower 0.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		3 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.5
	end_block

	;; princeps left side
	begin_block 5
		min_units				1
		max_units				3
		unit_type				heavy_pilum_infantry 1.0
		unit_type				carrying_siege_engine ram 0.0
		unit_type				carrying_siege_engine ladder 0.0
		unit_type				carrying_siege_engine tower 0.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		4 -0.3 0.0
		inter_unit_spacing		0.3
		priority			0.5
	end_block

	;; princeps right side
	begin_block 6
		min_units				1
		max_units				3
		unit_type				heavy_pilum_infantry 1.0
		unit_type				carrying_siege_engine ram 0.0
		unit_type				carrying_siege_engine ladder 0.0
		unit_type				carrying_siege_engine tower 0.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		4 0.3 0.0
		inter_unit_spacing		0.3
		priority			0.5
	end_block

	begin_dummy_block 7
		spans	4 5 6
	end_dummy_block

	;;; support units behind to give support
	begin_block 8
		not_general
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		7 0.0 -15.0
		inter_unit_spacing		5.0
		priority			0.9
	end_block

	;; missile troops behind the infantry

	begin_block 9
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		unit_type				carrying_siege_engine ram 0.0
		unit_type				carrying_siege_engine ladder 0.0
		unit_type				carrying_siege_engine tower 0.0
		default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		8 0.0 -5.0
		inter_unit_spacing		2.0
		priority			0.4
	end_block

	begin_block 10
		max_units				2
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.8
		unit_type				carrying_siege_engine ram 0.0
		unit_type				carrying_siege_engine ladder 0.0
		unit_type				carrying_siege_engine tower 0.0
		;default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		9 0.0 -1.0
		inter_unit_spacing		2.0
		priority			0.35
	end_block

	begin_dummy_block 11
		spans	1 2 3 4 5 6 7 8 9 10
	end_dummy_block

	;; general
	begin_block 12
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will	; was defend_and_skirmish
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		11 0.0 -15.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 13
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		12 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; artillery and handler on the sides

	begin_block 14
		max_units				1
		unit_type				handler 1.0
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		12 -10.0 0.0
		inter_unit_spacing		3.0
		priority			0.05
	end_block

	begin_block 15
		max_units				1
		unit_type				handler 1.0
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		12 10.0 0.0
		inter_unit_spacing		3.0
		priority			0.05
	end_block

	begin_dummy_block 16
		spans	12 13 14 15
	end_dummy_block

	;; archers behind the general

	begin_block 17
			min_units				1
		max_units				2
		unit_type				ranged_missile_infantry 2.0
		;default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		16 0.0 -10.0
		inter_unit_spacing		2.0
		priority			0.4
	end_block

	begin_block 18
		max_units				2
		unit_type				ranged_missile_infantry 2.0
		;default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		7 0.0 -1.0
		inter_unit_spacing		2.0
		priority			0.35
	end_block

	;; cavalry on the flanks

	;; left flank
	begin_block 19
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		12 -80.0 0.0
		inter_unit_spacing		4.0
		priority			0.25
	end_block

	;; right flank
	begin_block 20
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		12 80.0 0.0
		inter_unit_spacing		4.0
		priority			0.25
	end_block

	;; left flank missile cav
	begin_block 21
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		19 -5.0 0.0
		inter_unit_spacing		4.0
		priority			0.3
	end_block

	;; right flank missile cav
	begin_block 22
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		20 5.0 0.0
		inter_unit_spacing		4.0
		priority			0.3
	end_block

	begin_dummy_block 23
		spans	12 13 14 15 16 17 18 19 20 21 22
	end_dummy_block

	;; back line of infantry

	;; hastati or auxilia line
	begin_block 24
		max_units				5
		unit_type				light infantry 1.0
		unit_type				carrying_siege_engine ram 0.0
		unit_type				carrying_siege_engine ladder 0.0
		unit_type				carrying_siege_engine tower 0.0
		;default_melee_state		fire_at_will
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		23 0.0 -5.0
		inter_unit_spacing		0.3
		priority			0.45
	end_block

	;; triarii left side
	begin_block 25
			min_units				1
		max_units				2
		unit_type				non_phalanx_spear 1.0
		unit_type				heavy_pilum_infantry 0.1
		unit_type				carrying_siege_engine ram 0.0
		unit_type				carrying_siege_engine ladder 0.0
		unit_type				carrying_siege_engine tower 0.0
		default_melee_state		fire_at_will
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		24 -0.3 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	;; triarii right side
	begin_block 26
			min_units				1
		max_units				2
		unit_type				non_phalanx_spear 1.0
		unit_type				heavy_pilum_infantry 0.1
		unit_type				carrying_siege_engine ram 0.0
		unit_type				carrying_siege_engine ladder 0.0
		unit_type				carrying_siege_engine tower 0.0
		;default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		24 0.3 0.0
		inter_unit_spacing		0.1
		priority			0.5
	end_block

	begin_dummy_block 27
		spans	24 25 26
	end_dummy_block

	;; back line of other units
	begin_block 28
		unit_type				any 0.001
		unit_type				carrying_siege_engine ram 0.0
		unit_type				carrying_siege_engine ladder 0.0
		unit_type				carrying_siege_engine tower 0.0
		;default_melee_state		defend
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		27 0.0 -10.0
		inter_unit_spacing		0.3
		priority			0.01
	end_block

end_formation



;****************************************************************
; Siege deployment*GREEK CULTURE*
; The engines have already been assigned at this point
; Put rams in the centre front, other engines at the front either side
;****************************************************************

begin_formation deployment_siege_greek

	standard_siege_attacker_deployment

	ai_priority				1.0	;; set at M2TW level priority

	supported_factions			greek_cities, pergamon, macedon, egypt, seleucid, thrace

	;;; all engines at the center
	begin_block 0
		unit_type				carrying_siege_engine ram 2.0
		unit_type				carrying_siege_engine tower 1.8
		unit_type				carrying_siege_engine ladder 1.6
		unit_density			close		; always deploy and defend as close
		max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block


	;; other infantry (back)
	begin_block 1
		not_general
		unit_type				heavy infantry 1.0
		unit_type				non_phalanx_spear 0.8
		unit_type				light infantry 0.3
		unit_type				any 0.001
		;default_melee_state		defend
		unit_formation			shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -7.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;; other infantry (back)(more)
	begin_block 2
		not_general
		unit_type				non_phalanx_spear 0.2
		unit_type				heavy infantry 0.1
		unit_type				phalanx 1.0
		unit_type				any 0.001
		;default_melee_state		defend
		unit_formation			phalanx, shield_wall, square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -7.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;; other infantry (back)(more)(missile)
	begin_block 3
		not_general
		unit_type				missile infantry 1.0
		unit_type				any 0.001
		;default_melee_state		defend
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		2 0.0 -7.0
		inter_unit_spacing		0.2
		priority			0.7
	end_block

	begin_dummy_block 4
		spans	1 2 3
	end_dummy_block

	;;; archers behind to give support
	begin_block 5
		not_general
		unit_type				handler 1.0
		unit_type				siege 3.0
		unit_type				chanting_screeching 3.0
		unit_type				ranged_missile_infantry 2.0
		unit_type				missile infantry 1.0
		;default_melee_state		skirmish
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		4 0.0 -15.0
		inter_unit_spacing		5.0
		priority			0.5
	end_block


	begin_dummy_block 6
		spans	1 2 3 4 5
	end_dummy_block

	;;; cavalry at the back
	begin_block 7
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		unit_type				skirmish cavalry 0.1
		unit_type				any 0.001
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 0.0 -25.0
		inter_unit_spacing		0.2
		priority			0.9
	end_block

begin_dummy_block 8
		spans	1 2 3 4 5 6 7
	end_dummy_block

	;;; special general block
	begin_block 9
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		8 0.0 -5.0
		inter_unit_spacing		0.2
		priority			2.0
	end_block

	;; VIP is here
	begin_block 10
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		9 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

end_formation



;****************************************************************
; Sinuhet's M2TW Siege deployment formation assigned to "Nomad Culture"
; The engines have already been assigned at this point
; Put rams in the centre front, other engines at the front either side
;****************************************************************
begin_formation deployment_siege_nomad

	standard_siege_attacker_deployment

	ai_priority				1.0	;; set at M2TW level priority

	supported_factions			scythia, numidia

	;;; rams at the centre
	begin_block 0
		unit_type				carrying_siege_engine ram 2.0
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		8.0
		priority			1.0
	end_block

	;; other engines left side
	begin_block 1
		unit_type				carrying_siege_engine ladder 2.0
		unit_type				carrying_siege_engine tower 2.0
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		0 -8.0 0.0
		inter_unit_spacing		8.0
		priority			1.0
	end_block

	;; other infantry left side
	begin_block 2
		not_general
		unit_type				heavy infantry 0.7
		unit_type				light infantry 0.7
		unit_type				skirmish infantry 0.7
		unit_type				missile infantry 0.7
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 -8.0 0.0
		inter_unit_spacing		8.0
		priority			0.5
	end_block

	;; other engines right side
	begin_block 3
		unit_type				carrying_siege_engine ladder 2.0
		unit_type				carrying_siege_engine tower 2.0
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		0 8.0 0.0
		inter_unit_spacing		8.0
		priority			1.0
	end_block

	;; other infantry rightt side
	begin_block 4
		not_general
		unit_type				heavy infantry 0.7
		unit_type				light infantry 0.7
		unit_type				skirmish infantry 0.7
		unit_type				missile infantry 0.7
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		3 8.0 0.0
		inter_unit_spacing		8.0
		priority			0.5
	end_block

	begin_dummy_block 5
		spans	0 1 2 3 4
	end_dummy_block

	;;; archers behind to give support
	begin_block 6
		not_general
		unit_type				missile infantry 1.0
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		5 0.0 -7.0
		inter_unit_spacing		2.0
		priority			0.1
	end_block

	;;; cavalry at the back
	begin_block 7
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		unit_type				skirmish cavalry 0.1
		unit_type				any 0.001
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			line
		block_relative_pos		6 0.0 -10.0
		inter_unit_spacing		2.0
		priority			0.1
	end_block

	begin_dummy_block 8
		spans	0 1 2 3 4 5 6 7
	end_dummy_block

	;;; general at the back
	begin_block 9
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		8 0.0 -5.0
		inter_unit_spacing		2.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 10
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		9 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

end_formation


;****************************************************************
; Basic Siege deployment (when they have not specfic way to do so)
; The engines have already been assigned at this point
; Put rams in the centre front, other engines at the front either side
;****************************************************************

begin_formation Basic_deployment_siege

	standard_siege_attacker_deployment

	ai_priority				1.0	;; set at M2TW level priority


	;;; rams at the centre
	begin_block 0
		unit_type				carrying_siege_engine ram 2.0
		unit_density			close		; always deploy and defend as close
		;max_unit_width			20
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		20.0
		priority			1.0
	end_block

	;; other engines left side
	begin_block 1
		unit_type				carrying_siege_engine tower 1.8
		unit_type				carrying_siege_engine ladder 1.6
		unit_density			close		; always deploy and defend as close
		;max_unit_width			24
		block_formation			line
		block_relative_pos		0 -20.0 0.0
		inter_unit_spacing		20.0
		priority			1.0
	end_block

	;; other engines right side
	begin_block 2
		unit_type				carrying_siege_engine tower 1.8
		unit_type				carrying_siege_engine ladder 1.6
		unit_density			close		; always deploy and defend as close
		;max_unit_width			24
		block_formation			line
		block_relative_pos		0 20.0 0.0
		inter_unit_spacing		20.0
		priority			1.0
	end_block

	;; other infantry left side
	begin_block 3
		max_units				1
		unit_type				light infantry 0.7
		unit_type				skirmish infantry 0.7
		unit_type				heavy infantry 0.1
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 -10.0 0.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	;; other infantry right side
	begin_block 4
		max_units				1
		unit_type				light infantry 0.7
		unit_type				skirmish infantry 0.7
		unit_type				heavy infantry 0.1
		unit_density			close		; always deploy and defend as close
		max_unit_width			40
		block_formation			line
		block_relative_pos		2 10.0 0.0
		inter_unit_spacing		10.0
		priority			0.3
	end_block

	begin_dummy_block 5
		spans	0 1 2 3 4 
	end_dummy_block

	; Screen of missile inf
	begin_block 6
		max_units				5
		unit_type				skirmish infantry 1.0
		unit_type				chanting_screeching 0.9
		unit_type				missile infantry 0.8
		unit_type				carrying_siege_engine ram 0.0
		unit_type				carrying_siege_engine ladder 0.0
		unit_type				carrying_siege_engine tower 0.0
		unit_density			close		; always deploy and defend as close
		;max_unit_width			40
		block_formation			line
		block_relative_pos		5 0.0 -20.0
		inter_unit_spacing		2.0
		priority			0.3
	end_block

	;; First line of infantry
	begin_block 7
		;min_units				1
		max_units				8
		unit_type				light infantry 1.0
		unit_type				heavy infantry 0.5
		unit_type				carrying_siege_engine ram 0.0
		unit_type				carrying_siege_engine ladder 0.0
		unit_type				carrying_siege_engine tower 0.0
		unit_density			close		; always deploy and defend as close
		;max_unit_width			24
		block_formation			line
		block_relative_pos		6 0.0 -7.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	;; second line of infantry
	begin_block 8
		;min_units				1
		max_units				8
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.1
		unit_type				carrying_siege_engine ram 0.0
		unit_type				carrying_siege_engine ladder 0.0
		unit_type				carrying_siege_engine tower 0.0
		unit_density			close		; always deploy and defend as close
		;max_unit_width			24
		block_formation			line
		block_relative_pos		7 0.0 -10.0
		inter_unit_spacing		10.0
		priority			0.5
	end_block

	begin_dummy_block 9
		spans	0 1 2 3 4 5 6 7 8
	end_dummy_block

	;; 3rd line of infantry, guard of archers
	begin_block 10
		;min_units				1
		unit_type				phalanx 1.0
		unit_type				non_phalanx_spear 0.9
		unit_type				carrying_siege_engine ram 0.0
		unit_type				carrying_siege_engine ladder 0.0
		unit_type				carrying_siege_engine tower 0.0
		unit_formation			phalanx, shield_wall, square
		unit_density			close		; always deploy and defend as close
		;max_unit_width			24
		block_formation			line
		block_relative_pos		9 0.0 -10.0
		inter_unit_spacing		0.0
		priority			0.4
	end_block

	;; Archers behind to give support
	begin_block 11
		max_units				6
		unit_type				ranged_missile_infantry 2.0
		unit_type				chanting_screeching 3.0
		unit_type				carrying_siege_engine ram 0.0
		unit_type				carrying_siege_engine ladder 0.0
		unit_type				carrying_siege_engine tower 0.0
		default_melee_state		fire_at_will_and_defend
		unit_density			close		; always deploy and defend as close
		;max_unit_width			40
		block_formation			line
		block_relative_pos		10 0.0 -10.0
		inter_unit_spacing		2.0
		priority			0.25
	end_block

	;; artillery and handlers are here
	begin_block 12
		unit_type				siege 3.0
		unit_type				handler 1.0
		unit_type				carrying_siege_engine ram 0.0
		unit_type				carrying_siege_engine ladder 0.0
		unit_type				carrying_siege_engine tower 0.0
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		;max_unit_width			24
		block_formation			line
		block_relative_pos		11 0.0 -5.0
		inter_unit_spacing		8.0
		priority			1.0
	end_block

	begin_dummy_block 13
		spans	0 1 2 3 4 5 6 7 8 9 10 11 12
	end_dummy_block

	;; general at the back
	begin_block 14
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		13 0.0 -5.0
		inter_unit_spacing		3.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 15
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		14 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;; cavalry on the flanks and back a bit

	;; left flank cav
	begin_block 16
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		14 -20.0 0.0
		inter_unit_spacing		4.0
		priority			0.25
	end_block

	;; right flank cav
	begin_block 17
		unit_type				heavy cavalry 1.0
		unit_type				light cavalry 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		unit_density			close		; always deploy and defend as close
		max_unit_width			24
		block_formation			square
		block_relative_pos		14 20.0 0.0
		inter_unit_spacing		4.0
		priority			0.25
	end_block

	;; left flank missile cav
	begin_block 18
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		16 -5.0 0.0
		inter_unit_spacing		4.0
		priority			0.3
	end_block

	;; right flank missile cav
	begin_block 19
		not_general
		unit_type				missile cavalry 1.0
		unit_type				skirmish cavalry 0.5
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close		; always deploy and defend as close
		max_unit_width			30
		block_formation			column
		block_relative_pos		17 5.0 0.0
		inter_unit_spacing		4.0
		priority			0.3
	end_block

	;; any behind
	begin_block 20
		unit_type				any 0.001
		unit_density			close		; always deploy and defend as close
		block_formation			line
		block_relative_pos		14 0.0 -20.0
		inter_unit_spacing		0.3
		priority			0.05
	end_block

end_formation


;****************************************************************
; DARTH's M2TW Siege AI
; Column marching formation for the army being ambushed
;****************************************************************

;****************************************************************

begin_formation ai_breach_defense_spearmen

	;;; purpose flags			modified from ReallyBadAI mod by Germanicu5
	breach_defense_force

	ai_priority				1.0


	begin_dummy_block 0		;; centre slot left empty for assault column to pass through
		spacer	0.0 0.0 0.5 0.5
	end_dummy_block

	;;; left and forward
	begin_block 1
		min_units				1
		max_units				1
		not_general
		unit_type				spearmen infantry 1.0
		unit_type				phalanx 0.7
		default_melee_state		defend
		unit_formation			phalanx, shield_wall, schiltrom, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 -0.5 0.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;;; right and forward
	begin_block 2
		min_units				1
		max_units				1
		not_general
		unit_type				spearmen infantry 1.0
		unit_type				phalanx 0.7
		default_melee_state		defend
		unit_formation			phalanx, shield_wall, schiltrom, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.5 0.0
		inter_unit_spacing		0.0
		priority			1.0
	end_block

	;;; left and forward
	begin_block 3
		max_units				1
		not_general
		unit_type				spearmen infantry 0.9
		unit_type				phalanx 0.7
		unit_type				heavy infantry 0.5
		unit_type				light infantry 0.3
		unit_type				any 0.001
		default_melee_state		fire_at_will
		unit_formation			phalanx, shield_wall, schiltrom, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		1 0.0 -0.5
		inter_unit_spacing		0.0
		priority			0.6
	end_block

	;;; right and forward
	begin_block 4
		max_units				1
		not_general
		unit_type				spearmen infantry 0.9
		unit_type				phalanx 0.7
		unit_type				heavy infantry 0.5
		unit_type				light infantry 0.3
		unit_type				any 0.001
		default_melee_state		fire_at_will
		unit_formation			phalanx, shield_wall, schiltrom, square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		2 0.0 -0.5
		inter_unit_spacing		0.0
		priority			0.6
	end_block

	;;; backup
	begin_block 5
		unit_type				missile infantry 1.0
		unit_type				light infantry 0.8
		unit_type				skirmish infantry 0.6
		unit_type				missile cavalry 0.5
		unit_type				light cavalry 0.4
		unit_type				skirmish cavalry 0.3
		unit_type				any 0.001
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		2.0
		priority			0.1
	end_block

end_formation


;****************************************************************

begin_formation ai_breach_defense_infantry

	;;; purpose flags			modified from Darth's M2TW
	breach_defense_force

	ai_priority				1.0


	begin_dummy_block 0			;; centre slot left empty for assault column to pass through
		spacer	0.0 0.0 20 20
	end_dummy_block

	;;; left and forward
	begin_block 1
		min_units				1
		max_units				1
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		unit_formation			shield_wall, schiltrom, square
		unit_density			close
		block_formation			line
		block_relative_pos		0 -1.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;;; right and forward
	begin_block 2
		min_units				1
		max_units				1
		not_general
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		unit_formation			shield_wall, schiltrom, square
		unit_density			close
		block_formation			line
		block_relative_pos		0 1.0 0.0
		inter_unit_spacing		0.1
		priority			1.0
	end_block

	;;; left and forward
	begin_block 3
		max_units				1
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		unit_type				spearmen infantry 0.3
		unit_type				any 0.001
		default_melee_state		fire_at_will
		unit_formation			phalanx, shield_wall, square
		unit_density			close
		block_formation			line
		block_relative_pos		1 0.0 -1.0
		inter_unit_spacing		0.1
		priority			0.6
	end_block

	;;; right and forward
	begin_block 4
		max_units				1
		unit_type				heavy infantry 1.0
		unit_type				light infantry 0.5
		unit_type				spearmen infantry 0.3
		unit_type				any 0.001
		default_melee_state		fire_at_will
		unit_formation			phalanx, shield_wall, square
		unit_density			close
		block_formation			line
		block_relative_pos		2 0.0 -1.0
		inter_unit_spacing		0.1
		priority			0.6
	end_block

	;;; backup
	begin_block 5
		unit_type				missile infantry 1.0
		unit_type				skirmish infantry 0.6
		unit_type				missile cavalry 0.5
		unit_type				light cavalry 0.4
		unit_type				skirmish cavalry 0.3
		unit_type				any 0.001
		default_melee_state		fire_at_will_and_skirmish
		unit_density			close
		max_unit_width			30
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		2.0
		priority			0.1
	end_block

end_formation


;****************************************************************

begin_formation ai_settlement_assault_gate
	;;; purpose flags			;; from M2TW's ReallyBadAI mod

	ai_priority				0.2


	begin_block 0
		min_units				1
		max_units				4
		unit_type				phalanx 1.0
		unit_type				heavy infantry 0.9
		unit_type				spearmen infantry 0.8
		unit_type				light infantry 0.7
		default_melee_state		hold_fire
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	begin_block 1
		max_units				4
		unit_type				phalanx 1.0
		unit_type				heavy infantry 0.9
		unit_type				spearmen infantry 0.8
		unit_type				light infantry 0.7
		default_melee_state		hold_fire
		;unit_formation			square
		unit_density			close
		max_unit_width			24
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		0.0
		priority			0.9
	end_block

	begin_block 2
		max_units				4
		unit_type				skirmish infantry 1.0
		unit_type				missile infantry 0.9
		unit_density			close
		max_unit_width			40
		block_formation			line
		block_relative_pos		1 0.0 -5.0
		inter_unit_spacing		2.0
		priority			0.8
	end_block

	begin_block 3
		unit_type				any 0.001
		unit_density			close
		block_formation			line
		block_relative_pos		2 0.0 -5.0
		inter_unit_spacing		2.0
		priority			0.7
	end_block

	;;; special general block
	begin_block 4
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 -45.0
		inter_unit_spacing		1.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 5
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			line
		block_relative_pos		4 0.0 -5.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

end_formation



;****************************************************************
; Ambush deployment
; Column marching formation for the army being ambushed
;****************************************************************

begin_formation ambush_defender_deployment_eastern

	standard_ambush_defender_deployment

	ai_priority				1.0

	supported_factions			carthage, numidia, pontus, parthia, armenia

	;;; general at the center
	begin_block 0
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		max_unit_width			4
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 1
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		max_unit_width			4
		block_formation			line
		block_relative_pos		0 0.0 -1.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;;; vanguard
	begin_block 2
		unit_type				any 0.001
		;unit_density			close
		max_unit_width			4
		block_formation			column
		block_relative_pos		0 0.0 2.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;;; all other units behind
	begin_block 3
		unit_type				any 0.001
		;unit_density			close
		max_unit_width			4
		block_formation			column
		block_relative_pos		1 0.0 -2.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;;; vanguard commander
	begin_block 4
		min_units				1
		;max_units				1
		unit_type				general_unit 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			4
		block_formation			column
		block_relative_pos		2 0.0 1.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

	;;; sentinel commander
	begin_block 5
		min_units				1
		;max_units				1
		unit_type				general_unit 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			4
		block_formation			column
		block_relative_pos		3 0.0 -1.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

end_formation


begin_formation ambush_defender_deployment_greco-roman

	standard_ambush_defender_deployment

	ai_priority				1.0

	supported_factions			romans_julii, greek_cities, pergamon, macedon, egypt, seleucid, thrace

	;;; general at the front
	begin_block 0
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		max_unit_width			4
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			2.0
	end_block

	;;; units behind general
	begin_block 1
		unit_type				any 0.001
		unit_density			close
		max_unit_width			4
		block_formation			column
		block_relative_pos		0 0.0 -2.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; VIP is in the middle
	begin_block 2
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will
		unit_formation			square
		;unit_density			close
		max_unit_width			4
		block_formation			line
		block_relative_pos		1 0.0 -2.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;;; all other units behind(2)
	begin_block 3
		unit_type				any 0.001
		unit_density			close
		max_unit_width			4
		block_formation			column
		block_relative_pos		2 0.0 -2.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;;; sentinel commander
	begin_block 4
		min_units				1
		;max_units				1
		unit_type				general_unit 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			4
		block_formation			column
		block_relative_pos		3 0.0 -1.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block

end_formation


begin_formation ambush_defender_deployment_barbarian

	standard_ambush_defender_deployment

	ai_priority				1.0

	supported_factions			gauls, galatians,, britons, dacia, germans, spain, scythia

	;;; general at the front
	begin_block 0
		min_units				1
		;max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			loose
		max_unit_width			4
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			2.0
	end_block

	;;; all other units behind
	begin_block 1
		unit_type				any 0.001
		unit_density			loose
		max_unit_width			4
		block_formation			column
		block_relative_pos		0 0.0 -2.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

		;;; all other units behind(2)
	begin_block 2
		unit_type				any 0.001
		unit_density			loose
		max_unit_width			4
		block_formation			column
		block_relative_pos		1 0.0 -2.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;; VIP is in the back
	begin_block 3
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			4
		block_formation			line
		block_relative_pos		0 0.0 -1.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

	;;; sentinel commander
	begin_block 4
		;min_units				1
		max_units				1
		unit_type				general_unit 1.0
		default_melee_state		fire_at_will
		;unit_formation			square
		;unit_density			close
		max_unit_width			4
		block_formation			column
		block_relative_pos		3 0.0 -1.0
		inter_unit_spacing		2.0
		priority			0.5
	end_block


end_formation


;****************************************************************
; Alternate Ambush deployment (required with Alexander exe)
; Column marching formation for the army being ambushed, allows stretching
;****************************************************************

begin_formation vulnerable_ambush_defend

	standard_ambush_defender_deployment

	ai_priority				 1.0	;; using when too few command officers in army


	;;; general at the front
	begin_block 0
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		max_unit_width			4
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 1
		;min_units				1
		max_units				0
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		max_unit_width			4
		block_formation			line
		block_relative_pos		0 0.0 -1.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;;; all other units behind
	begin_block 2
		not_general
		unit_type				any 0.001
		;unit_formation			square, schiltrom
		unit_density			close
		max_unit_width			4
		block_formation			column
		block_relative_pos		1 0.0 -2.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

end_formation



begin_formation alternate_ambush_defender_deployment

	alternate_ambush_defender_deployment

	ai_priority				 1.0


	;;; general at the front
	begin_block 0
		min_units				1
		max_units				1
		unit_type				general_unit 4.0
		default_melee_state		engage_at_will
		unit_formation			square
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority			2.0
	end_block

	;; VIP is here
	begin_block 1
		max_units				0
		unit_type				skirmish general_unit cavalry 3.0
		unit_type				missile general_unit cavalry 3.0
		unit_type				general_unit elephants 4.0
		default_melee_state		fire_at_will_and_engage_at_will
		unit_formation			square
		;unit_density			close
		block_formation			column
		block_relative_pos		0 0.0 -1.0
		inter_unit_spacing		10.0
		priority			1.0
	end_block

	;;; all other units behind
	begin_block 2
		unit_type				any 0.001
		unit_density			close
		block_formation			column
		block_relative_pos		1 0.0 -2.0
		inter_unit_spacing		2.0
		priority			1.0
	end_block

end_formation


